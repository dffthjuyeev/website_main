IE.fModule({f:function(exports,require,module,global){;},fn:"declarationgeogebra.js"});;
IE.fModule({f:function(exports,require,module,global){require('produit/css/curseur.css')
;},fn:"declarationcurseurpn.js"});;
IE.fModule({f:function(exports,require,module,global){;require('produit/css/fonts.css');},fn:"declarationindexfont.js"});;
IE.fModule({f:function(exports,require,module,global){if(typeof Object.assign!=='function'){(function(){Object.assign=function(target){'use strict';if(target===undefined||target===null){throw new TypeError('Cannot convert undefined or null to object');}
var output=Object(target);for(var index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&source!==null){for(var nextKey in source){if(source.hasOwnProperty(nextKey)){output[nextKey]=source[nextKey];}}}}
return output;};})();}},fn:"object.js"});;
IE.fModule({f:function(exports,require,module,global){String.prototype.ucfirst=function(){return this.replace(this.charAt(0),this.charAt(0).toUpperCase());};if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,'');};}
if(!String.prototype.trimStart){String.prototype.trimStart=function(){return this.replace(/^\s+/,"");};}
if(!String.prototype.trimEnd){String.prototype.trimEnd=function(){return this.replace(/\s+$/,"");};}
String.prototype.AvecQuotes=function(){return'&quot;'+this+'&quot;';};String.prototype.enleverZero=function(){return parseFloat(this.replace(/,/g,".")).toString();};String.prototype.premierCaractereEnHexa=function(){return this.charCodeAt(0).toString(16);};String.prototype.escapeJQ=function(){return this.replace(/(:|\.|\[|\]|\/)/g,'\\$1');};String.prototype.nl2br=function(){return this.replace(/\n/g,"<br />");};String.prototype.toHTML=function(){return!!this?this.replace(/\r\n|\n|\r|&#32;/g,"<br />"):'';};String.prototype.ajouterEntites=function(aSansQuote){var re=aSansQuote?/([<>'&])/g : /([<>"'&])/g;return this.replace(re,function(m){if(m==="<"){return"&lt;";}
if(m===">"){return"&gt;";}
if(m==="\""){return"&quot;";}
if(m==="'"){return"&#039;";}
if(m==="&"){return"&amp;";}});};String.prototype.enleverEntites=function(){var re=/&(lt|gt|quot|#039|amp);/g;return this.replace(re,function(m){if(m==="&lt;"){return"<";}
if(m==="&gt;"){return">";}
if(m==="&quot;"){return"\"";}
if(m==="&#039;"){return"'";}
if(m==="&amp;"){return"&";}});};if(!String.prototype.startsWith){String.prototype.startsWith=function(searchString,position){position=position||0;return this.substr(position,searchString.length)===searchString;};}
if(!String.prototype.endsWith){String.prototype.endsWith=function(searchString,position){var subjectString=this.toString();if(typeof position!=='number'||!isFinite(position)||Math.floor(position)!==position||position>subjectString.length){position=subjectString.length;}
position-=searchString.length;var lastIndex=subjectString.indexOf(searchString,position);return lastIndex!== -1&&lastIndex===position;};}
if(!String.prototype.includes){String.prototype.includes=function(search,start){if(typeof start!=='number'){start=0;}
if(start+search.length>this.length){return false;} else{return this.indexOf(search,start)!== -1;}};}},fn:"string.js"});;
IE.fModule({f:function(exports,require,module,global){
Math.borner=function(aValeur,aMin,aMax){return Math.max(Math.min(aValeur,aMax),aMin);};Math.log10=Math.log10||function(x){return Math.log(x)*Math.LOG10E;};(function(){function decimalAdjust(type,value,exp){if(typeof exp==='undefined'|| +exp===0){return Math[type](value);}
value= +value;exp= +exp;if(value===null||isNaN(value)||!(typeof exp==='number'&&exp%1===0)){return NaN;}
if(value<0){return-decimalAdjust(type,-value,exp);}
value=value.toString().split('e');value=Math[type](+(value[0]+'e'+(value[1]?(+value[1]-exp):-exp)));value=value.toString().split('e');return+(value[0]+'e'+(value[1]?(+value[1]+exp):exp));}
if(!Math.round10){Math.round10=function(value,exp){return decimalAdjust('round',value,exp);};}
if(!Math.floor10){Math.floor10=function(value,exp){return decimalAdjust('floor',value,exp);};}
if(!Math.ceil10){Math.ceil10=function(value,exp){return decimalAdjust('ceil',value,exp);};}})();},fn:"math.js"});;
IE.fModule({f:function(exports,require,module,global){require('es6-promise.auto.min.js');require('es6-promise.auto.js');if(!Promise.prototype['finally']){Promise.prototype['finally']=function finallyPolyfill(callback){var constructor=this.constructor;return this.then(function(value){return constructor.resolve(callback()).then(function(){return value;});},function(reason){return constructor.resolve(callback()).then(function(){throw reason;});});};}},fn:"promise.js"});;
IE.fModule({f:function(exports,require,module,global){(function(n,l){"object"===typeof exports&&"undefined"!==typeof module?module.exports=l():"function"===typeof define&&define.amd?define(l):n.ResizeObserver=l()})(this,function(){function n(b){for(var a=[],c=arguments.length-1;0<c--;)a[c]=arguments[c+1];return a.reduce(function(a,c){return a+(parseFloat(b["border-"+c+"-width"])||0)},0)}var l=function(){function b(b,c){var a=-1;b.some(function(b,e){return b[0]===c?(a=e,!0):!1});return a}return"undefined"!==typeof Map?Map:function(){function a(){this.__entries__=
[]}var c={size:{configurable:!0}};c.size.get=function(){return this.__entries__.length};a.prototype.get=function(a){a=b(this.__entries__,a);return(a=this.__entries__[a])&&a[1]};a.prototype.set=function(a,c){var e=b(this.__entries__,a);~e?this.__entries__[e][1]=c:this.__entries__.push([a,c])};a.prototype["delete"]=function(a){var c=this.__entries__;a=b(c,a);~a&&c.splice(a,1)};a.prototype.has=function(a){return!!~b(this.__entries__,a)};a.prototype.clear=function(){this.__entries__.splice(0)};a.prototype.forEach=function(a,b){void 0===b&&(b=null);for(var c=0,e=this.__entries__;c<e.length;c+=1){var g=e[c];a.call(b,g[1],g[0])}};Object.defineProperties(a.prototype,c);return a}()}(),q="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,p="undefined"!==typeof global&&global.Math===Math?global:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&Math===Math?window:Function("return this")(),x=function(){return"function"===typeof requestAnimationFrame?requestAnimationFrame.bind(p):function(b){return setTimeout(function(){return b(Date.now())},1E3/60)}}(),y=function(b,a){function c(){f&&(f=!1,b());h&&g()}function e(){x(c)}function g(){var b=Date.now();if(f){if(2>b-d)return;h=!0}else f=!0,h=!1,setTimeout(e,a);d=b}var f=!1,h=!1,d=0;return g},z="top right bottom left width height size weight".split(" "),A="undefined"!==typeof MutationObserver,d=function(){this.mutationEventsAdded_=this.connected_=!1;this.mutationsObserver_=null;this.observers_=[];this.onTransitionEnd_=this.onTransitionEnd_.bind(this);this.refresh=y(this.refresh.bind(this),20)};d.prototype.addObserver=function(b){~this.observers_.indexOf(b)||this.observers_.push(b);this.connected_||this.connect_()};d.prototype.removeObserver=function(b){var a=this.observers_;b=a.indexOf(b);~b&&a.splice(b,1);!a.length&&this.connected_&&this.disconnect_()};d.prototype.refresh=function(){this.updateObservers_()&&this.refresh()};d.prototype.updateObservers_=function(){var b=this.observers_.filter(function(a){return a.gatherActive(),a.hasActive()});b.forEach(function(a){return a.broadcastActive()});return 0<b.length};d.prototype.connect_=function(){q&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),A?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)};d.prototype.disconnect_=function(){q&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.connected_=this.mutationEventsAdded_=!1)};d.prototype.onTransitionEnd_=function(b){var a=b.propertyName;void 0===a&&(a="");z.some(function(b){return!!~a.indexOf(b)})&&
this.refresh()};d.getInstance=function(){this.instance_||(this.instance_=new d);return this.instance_};d.instance_=null;var u=function(b,a){for(var c=0,e=Object.keys(a);c<e.length;c+=1){var g=e[c];Object.defineProperty(b,g,{value:a[g],enumerable:!1,writable:!1,configurable:!0})}return b},m=function(b){return b&&b.ownerDocument&&b.ownerDocument.defaultView||p},v={x:0,y:0,width:0,height:0},B=function(){return"undefined"!==typeof SVGGraphicsElement?function(b){return b instanceof m(b).SVGGraphicsElement}:function(b){return b instanceof m(b).SVGElement&&"function"===typeof b.getBBox}}(),r=function(b){this.broadcastHeight=this.broadcastWidth=0;this.contentRect_={x:0,y:0,width:0,height:0};this.target=b};r.prototype.isActive=function(){var b=this.target;if(q)if(B(b)){var a=b.getBBox();a={x:0,y:0,width:a.width,height:a.height}}else{var c=b.clientWidth,e=b.clientHeight;if(c||e){var g=m(b).getComputedStyle(b);a={};for(var f=0,h=["top","right","bottom","left"];f<h.length;f+=1){var d=h[f];a[d]=parseFloat(g["padding-"+
d])||0}var k=a.left+a.right;d=a.top+a.bottom;f=parseFloat(g.width)||0;h=parseFloat(g.height)||0;"border-box"===g.boxSizing&&(Math.round(f+k)!==c&&(f-=n(g,"left","right")+k),Math.round(h+d)!==e&&(h-=n(g,"top","bottom")+d));b!==m(b).document.documentElement&&(b=Math.round(f+k)-c,e=Math.round(h+d)-e,1!==Math.abs(b)&&(f-=b),1!==Math.abs(e)&&(h-=e));a={x:a.left,y:a.top,width:f,height:h}}else a=v}else a=v;this.contentRect_=a;return a.width!==this.broadcastWidth||a.height!==this.broadcastHeight};r.prototype.broadcastRect=function(){var b=this.contentRect_;this.broadcastWidth=b.width;this.broadcastHeight=b.height;return b};var C=function(b,a){var c=a.x,e=a.y,d=a.width,f=a.height,h=Object.create(("undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object).prototype);u(h,{x:c,y:e,width:d,height:f,top:e,right:c+d,bottom:f+e,left:c});u(this,{target:b,contentRect:h})},k=function(b,a,c){this.activeObservations_=[];this.observations_=new l;if("function"!==typeof b)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=b;this.controller_=a;this.callbackCtx_=c};k.prototype.observe=function(b){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(b instanceof m(b).Element))throw new TypeError('parameter 1 is not of type "Element".');var a=this.observations_;a.has(b)||(a.set(b,new r(b)),this.controller_.addObserver(this),this.controller_.refresh())}};k.prototype.unobserve=function(b){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(b instanceof m(b).Element))throw new TypeError('parameter 1 is not of type "Element".');var a=this.observations_;a.has(b)&&(a["delete"](b),a.size||this.controller_.removeObserver(this))}};k.prototype.disconnect=function(){this.clearActive();this.observations_.clear();this.controller_.removeObserver(this)};k.prototype.gatherActive=function(){var b=this;this.clearActive();this.observations_.forEach(function(a){a.isActive()&&b.activeObservations_.push(a)})};k.prototype.broadcastActive=function(){if(this.hasActive()){var b=this.callbackCtx_,a=this.activeObservations_.map(function(a){return new C(a.target,a.broadcastRect())});this.callback_.call(b,a,b);this.clearActive()}};k.prototype.clearActive=function(){this.activeObservations_.splice(0)};k.prototype.hasActive=function(){return 0<this.activeObservations_.length};var w="undefined"!==typeof WeakMap?new WeakMap:new l,t=function(b){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var a=d.getInstance();a=new k(b,a,this);w.set(this,a)};["observe","unobserve","disconnect"].forEach(function(b){t.prototype[b]=function(){var a;return(a=w.get(this))[b].apply(a,arguments)}});var D="undefined"!==typeof p.ResizeObserver?p.ResizeObserver:t;return D});},fn:"resizeobserver_polyfill.js"});;
IE.fModule({f:function(exports,require,module,global){(function(){function l(a){try{return a.defaultView&&a.defaultView.frameElement||null}catch(b){return null}}function v(a){this.time=a.time;this.target=a.target;this.rootBounds=u(a.rootBounds);this.boundingClientRect=u(a.boundingClientRect);this.intersectionRect=u(a.intersectionRect||m());this.isIntersecting=!!a.intersectionRect;a=this.boundingClientRect;a=a.width*a.height;var b=this.intersectionRect;b=b.width*b.height;this.intersectionRatio=a?Number((b/a).toFixed(4)):this.isIntersecting?1:0}function g(a,b){var c=b||{};if("function"!=typeof a)throw Error("callback must be a function");if(c.root&&1!=c.root.nodeType&&9!=c.root.nodeType)throw Error("root must be a Document or Element");this.l=A(this.l.bind(this),this.F);this.H=a;this.g=[];this.h=[];this.v=this.M(c.rootMargin);this.thresholds=this.L(c.threshold);this.root=c.root||null;this.rootMargin=this.v.map(function(d){return d.value+d.D}).join(" ");this.i=[];this.j=[]}function A(a,b){var c=null;return function(){c||(c=setTimeout(function(){a();c=null},b))}}function w(a,b,c,d){"function"==typeof a.addEventListener?a.addEventListener(b,c,d||!1):"function"==typeof a.attachEvent&&a.attachEvent("on"+b,c)}function x(a,b,c,d){"function"==typeof a.removeEventListener?a.removeEventListener(b,c,d||!1):"function"==typeof a.R&&a.R("on"+b,c)}function n(a){try{var b=a.getBoundingClientRect()}catch(c){}if(!b)return m();b.width&&b.height||(b={top:b.top,right:b.right,bottom:b.bottom,left:b.left,width:b.right-b.left,height:b.bottom-b.top});return b}function m(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function u(a){return!a||"x"in a?a:{top:a.top,y:a.top,bottom:a.bottom,left:a.left,x:a.left,right:a.right,width:a.width,height:a.height}}function y(a,b){for(var c=b;c;){if(c==a)return!0;c=p(c)}return!1}function p(a){var b=a.parentNode;if(9==a.nodeType&&a!=k)return l(a);b&&b.assignedSlot&&(b=b.assignedSlot.parentNode);return b&&11==b.nodeType&&b.host?b.host:b}function z(a){return a&&9===a.nodeType}if("object"===typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}});else{var k=function(a){for(var b=l(a);b;)a=b.ownerDocument,b=l(a);return a}(window.document),q=[];g.prototype.F=100;g.prototype.m=null;g.prototype.G=!0;g.prototype.observe=function(a){if(!this.g.some(function(b){return b.element==
a})){if(!a||1!=a.nodeType)throw Error("target must be an Element");this.N();this.g.push({element:a,C:null});this.s(a.ownerDocument);this.l()}};g.prototype.unobserve=function(a){this.g=this.g.filter(function(b){return b.element!=a});this.A(a.ownerDocument);0==this.g.length&&this.B()};g.prototype.disconnect=function(){this.g=[];this.P();this.B()};g.prototype.takeRecords=function(){var a=this.h.slice();this.h=[];return a};g.prototype.L=function(a){a=a||[0];Array.isArray(a)||(a=[a]);return a.sort().filter(function(b,c,d){if("number"!=typeof b||isNaN(b)||0>b||1<b)throw Error("threshold must be a number between 0 and 1 inclusively");return b!==d[c-1]})};g.prototype.M=function(a){a=(a||"0px").split(/\s+/).map(function(b){b=/^(-?\d*\.?\d+)(px|%)$/.exec(b);if(!b)throw Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(b[1]),D:b[2]}});a[1]=a[1]||a[0];a[2]=a[2]||a[0];a[3]=a[3]||a[1];return a};g.prototype.s=function(a){var b=a.defaultView;if(b&&-1==this.i.indexOf(a)){var c=this.l,d=null,e=null;this.m?d=b.setInterval(c,this.m):(w(b,"resize",c,!0),w(a,"scroll",c,!0),this.G&&"MutationObserver"in b&&(e=new b.MutationObserver(c),e.observe(a,{attributes:!0,childList:!0,characterData:!0,subtree:!0})));this.i.push(a);this.j.push(function(){var f=a.defaultView;f&&(d&&f.clearInterval(d),x(f,"resize",c,!0));x(a,"scroll",c,!0);e&&e.disconnect()});a!=(this.root&&(this.root.ownerDocument||this.root)||k)&&(b=l(a))&&this.s(b.ownerDocument)}};g.prototype.A=function(a){var b=this.i.indexOf(a);if(-1!=
b){var c=this.root&&(this.root.ownerDocument||this.root)||k;if(!this.g.some(function(e){e=e.element.ownerDocument;if(e==a)return!0;for(;e&&e!=c;)if(e=(e=l(e))&&e.ownerDocument,e==a)return!0;return!1})){var d=this.j[b];this.i.splice(b,1);this.j.splice(b,1);d();a!=c&&(b=l(a))&&this.A(b.ownerDocument)}}};g.prototype.P=function(){var a=this.j.slice(0);this.i.length=0;for(var b=this.j.length=0;b<a.length;b++)a[b]()};g.prototype.l=function(){var a=this.O(),b=a?this.J():m();this.g.forEach(function(c){var d=c.element,e=n(d),f=this.u(d),h=c.C,r=a&&f&&this.o(d,e,b);var t=this.u(d)?b:m();c=c.C=new v({time:window.performance&&performance.now&&performance.now(),target:d,boundingClientRect:e,rootBounds:t,intersectionRect:r});h?a&&f?this.K(h,c)&&this.h.push(c):h&&h.isIntersecting&&this.h.push(c):this.h.push(c)},this);this.h.length&&this.H(this.takeRecords(),this)};g.prototype.o=function(a,b,c){if("none"!=window.getComputedStyle(a).display){var d=b;b=p(a);for(a=!1;!a&&b;){var e=null,f=1==b.nodeType?window.getComputedStyle(b):{};if("none"==f.display)return null;if(b==this.root||9==b.nodeType)if(a=!0,b==this.root||b==k)e=c;else{var h=(b=p(b))&&n(b);f=b&&this.o(b,h,c);h&&f?(e=f.top-h.top,h=f.left-h.left,e={top:e,left:h,height:f.height,width:f.width,bottom:e+f.height,right:h+f.width}):d=b=null}else h=b.ownerDocument,b!=h.body&&b!=h.documentElement&&"visible"!=f.overflow&&(e=n(b));if(e){f=Math.max(e.top,d.top);h=Math.min(e.bottom,d.bottom);var r=Math.max(e.left,d.left);d=Math.min(e.right,d.right);e=d-r;var t=h-f;d=0<=e&&0<=
t&&{top:f,bottom:h,left:r,right:d,width:e,height:t}||null}if(!d)break;b=b&&p(b)}return d}};g.prototype.J=function(){if(this.root&&!z(this.root))var a=n(this.root);else{var b=z(this.root)?this.root:k;a=b.documentElement;b=b.body;a={top:0,left:0,right:a.clientWidth||b.clientWidth,width:a.clientWidth||b.clientWidth,bottom:a.clientHeight||b.clientHeight,height:a.clientHeight||b.clientHeight}}return this.I(a)};g.prototype.I=function(a){var b=this.v.map(function(c,d){return"px"==c.D?c.value:c.value*(d%
2?a.width:a.height)/100});b={top:a.top-b[0],right:a.right+b[1],bottom:a.bottom+b[2],left:a.left-b[3]};b.width=b.right-b.left;b.height=b.bottom-b.top;return b};g.prototype.K=function(a,b){var c=a&&a.isIntersecting?a.intersectionRatio||0:-1,d=b.isIntersecting?b.intersectionRatio||0:-1;if(c!==d)for(var e=0;e<this.thresholds.length;e++){var f=this.thresholds[e];if(f==c||f==d||f<c!==f<d)return!0}};g.prototype.O=function(){return!this.root||y(k,this.root)};g.prototype.u=function(a){var b=this.root&&(this.root.ownerDocument||
this.root)||k;return y(b,a)&&(!this.root||b==a.ownerDocument)};g.prototype.N=function(){0>q.indexOf(this)&&q.push(this)};g.prototype.B=function(){var a=q.indexOf(this);-1!=a&&q.splice(a,1)};window.IntersectionObserver=g;window.IntersectionObserverEntry=v}})();},fn:"intersectionobserver_polyfill.js"});;
IE.fModule({f:function(exports,require,module,global){require('Object.js');require('String.js');require('Math.js');require('Promise.js');if(!global.ResizeObserver){global.ResizeObserver=require('ResizeObserver_polyfill.js');}
require('IntersectionObserver_polyfill.js');},fn:"declarationextensionsobjetnatif.js"});;
IE.fModule({f:function(exports,require,module,global){require('NamespaceIE.js');let lGUID_id=1;let lGUID_ClassCss=1;const GUID={getId:function(){const lResult='id_'+lGUID_id;lGUID_id+=1;return lResult;},getClassCss:function(){const lResult='c_'+lGUID_ClassCss;lGUID_ClassCss+=1;return lResult;},generateur:function(){let lGUID=1;let lCompteur=0;this.get=function(){let lResult='g';if(lCompteur>0){lResult+=lCompteur+'x';}
lResult+=lGUID;if(lGUID===Number.MAX_VALUE){lGUID=1;lCompteur+=1;} else{lGUID+=1;}
return lResult;};},getGUIDDelphiVide:function(){return'{00000000-0000-0000-0000-000000000000}';}};module.exports=GUID;},fn:"guid.js"});;
IE.fModule({f:function(exports,require,module,global){require('namespaceie.js');require('DeclarationExtensionsObjetNatif.js');function MethodesObjet(){}
MethodesObjet.getObjectClass=function(aObjet){if(aObjet&&aObjet.constructor){return MethodesObjet.getNomClassDeConstructeur(aObjet.constructor);}
return undefined;};MethodesObjet.getNomClassDeConstructeur=function(aConstructeur){if(aConstructeur&&aConstructeur.name){return aConstructeur.name;}
if(aConstructeur&&aConstructeur.toString&&MethodesObjet.isFunction(aConstructeur)){const T=aConstructeur.toString().match(/function\s*(\w+)/);if(T&&T.length===2){return T[1];}}
return undefined;};function _dupliquer(aObjet,_aProfondeur,_aDuplicationParesseuse,aProprietaires,aProprietairesCopie){if((!aObjet)||(!MethodesObjet.isObject(aObjet))){return aObjet;}
if(aObjet.dupliquer){return aObjet.dupliquer();}
if(Object.prototype.toString.call(aObjet)==='[object File]'){return aObjet;}
if(_aProfondeur>1000){return aObjet;}
let lIndice= -1;if(aProprietaires.length>0){lIndice=aProprietaires.indexOf(aObjet);}
if(lIndice>=0){return aProprietairesCopie[lIndice];}
let lObjetDuplique,lProp;if(aObjet.join&&MethodesObjet.isArray(aObjet)){lObjetDuplique=new Array(aObjet.length);} else if(aObjet.setTime&&MethodesObjet.isDate(aObjet)){lObjetDuplique=new Date();lObjetDuplique.setTime(aObjet.getTime());} else if(MethodesObjet.isBlob(aObjet)){lObjetDuplique=new Blob([aObjet],{type:aObjet.type});} else{lObjetDuplique=Object.create(aObjet.constructor.prototype);}
const lProfondeur=_aProfondeur+1;aProprietaires.push(aObjet);aProprietairesCopie.push(lObjetDuplique);try{const lKeys=Object.keys(aObjet);for(let i=0;i<lKeys.length;i++){lProp=lKeys[i];const lValeur=aObjet[lProp];if(MethodesObjet.isObject(lValeur)){if(_aDuplicationParesseuse&&(_aProfondeur===0)){lObjetDuplique[lProp]=lValeur;} else{lObjetDuplique[lProp]=_dupliquer(lValeur,lProfondeur,false,aProprietaires,aProprietairesCopie);}} else{lObjetDuplique[lProp]=lValeur;}}} finally{aProprietaires.pop();aProprietairesCopie.pop();}
return lObjetDuplique;}
MethodesObjet.dupliquer=function(aObjet,aDuplicationParesseuse){return _dupliquer(aObjet,0,aDuplicationParesseuse,[],[]);};MethodesObjet.isArray=function(object){return Array.isArray(object);};MethodesObjet.isFunction=function(object){return typeof object==='function';};MethodesObjet.isString=function(object){return Object.prototype.toString.call(object)==='[object String]';};MethodesObjet.isNumber=function(object){return!isNaN(object)&&Object.prototype.toString.call(object)==='[object Number]';};MethodesObjet.isUndefined=function(object){return typeof object==='undefined';};MethodesObjet.isObject=function(object){return!!object&&typeof object==='object';};MethodesObjet.isDate=function(object){return Object.prototype.toString.call(object)==='[object Date]';};MethodesObjet.isNan=function(object){const rdigit=/\d/;return object===null||object===undefined||!rdigit.test(object)||isNaN(object);};MethodesObjet.isWindow=function(object){return!!object&&typeof object==='object'&&'setInterval' in object;};MethodesObjet.isArguments=function(object){return Object.prototype.toString.call(object)==='[object Arguments]';};MethodesObjet.isBlob=function(object){return Object.prototype.toString.call(object)==='[object Blob]';};MethodesObjet.get=function(aObjet,aAccesseur){let lObjet,i,lNomProp,lIndexProp;if(!aObjet||!aAccesseur||!aAccesseur.length){return aObjet;}
if(aAccesseur.trim&&aAccesseur.split){aAccesseur=aAccesseur.split('.');}
const lLength=aAccesseur.length;if(lLength===0){return aObjet;}
lObjet=aObjet;for(i=0;i<lLength;i++){if(!lObjet){return undefined;}
lNomProp=aAccesseur[i];lIndexProp=false;if(lNomProp.indexOf('[')>0&&lNomProp.indexOf(']')===lNomProp.length-1){lIndexProp=lNomProp.match(/\[['"]?(.*)['"]?\]$/)[1];lNomProp=lNomProp.replace(/\[['"]?(.*)['"]?\]$/,'');}
lObjet=lObjet[lNomProp];if(lIndexProp){lObjet=lObjet[lIndexProp];}}
return lObjet;};MethodesObjet.set=function(aObjet,aAccesseur,aValue){if(aAccesseur&&aAccesseur.trim&&aAccesseur.split){aAccesseur=aAccesseur.split('.');}
let lConteneur;let lNomProp;if(!aAccesseur||!aAccesseur.length){return false;}
lNomProp=aAccesseur[aAccesseur.length-1];if(aAccesseur.length===1){lConteneur=aObjet;} else{lConteneur=MethodesObjet.get(aObjet,aAccesseur.slice(0,aAccesseur.length-1));}
if(lConteneur&&lNomProp){lConteneur[lNomProp]=aValue;return true;}
return false;};MethodesObjet.nomProprieteDeValeur=function(aObjet,aValeur){const lKeys=Object.keys(aObjet);for(let i=0;i<lKeys.length;i++){if(aValeur===aObjet[lKeys[i]]){return lKeys[i];}}
return'';};function _indenterEnumere(aEnumere,aParam){let lProp;if(!aParam){aParam={};}
aParam.indice=aParam.indice||0;if(!aEnumere){return;}
for(lProp in aEnumere){if(MethodesObjet.isNumber(aEnumere[lProp])){aEnumere[lProp]=aParam.indice;aParam.indice+=1;} else if(MethodesObjet.isObject(aEnumere[lProp])){_indenterEnumere(aEnumere[lProp],aParam);}}}
MethodesObjet.indenterEnumere=function(aEnumere,aIndiceInitiale){if(MethodesObjet.isObject(aEnumere)){_indenterEnumere(aEnumere,{indice:aIndiceInitiale});}};function _affecterValeurEnumere(aEnumere){let lProp;if(!aEnumere){return;}
const lKeys=Object.keys(aEnumere);for(let i=0;i<lKeys.length;i++){lProp=lKeys[i];if(MethodesObjet.isObject(aEnumere[lProp])){_affecterValeurEnumere(aEnumere[lProp]);} else{aEnumere[lProp]=lProp;}}}
MethodesObjet.affecterValeurEnumere=function(aEnumere){if(MethodesObjet.isObject(aEnumere)){_affecterValeurEnumere(aEnumere);}};MethodesObjet.objetsIdentiques=function(aObjet1,aObjet2,aComparaisonProfonde){if(!aObjet1&&aObjet2||aObjet1&&!aObjet2){return false;}
if(!aObjet1&&!aObjet2){return true;}
if(aObjet1===aObjet2){return true;}
let i;let lKeys=Object.keys(aObjet1);const lDejaCompare={};for(i=0;i<lKeys.length;i++){if(aObjet1[lKeys[i]]!==aObjet2[lKeys[i]]){if(aComparaisonProfonde===true&&
MethodesObjet.isObject(aObjet1[lKeys[i]])&&
MethodesObjet.isObject(aObjet2[lKeys[i]])){lDejaCompare[lKeys[i]]=true;if(!MethodesObjet.objetsIdentiques(aObjet1[lKeys[i]],aObjet2[lKeys[i]],true)){return false;}} else{return false;}}}
lKeys=Object.keys(aObjet2);for(i=0;i<lKeys.length;i++){if(aObjet1[lKeys[i]]!==aObjet2[lKeys[i]]){if(aComparaisonProfonde===true){if(!lDejaCompare[lKeys[i]]&&
MethodesObjet.isObject(aObjet1[lKeys[i]])&&
MethodesObjet.isObject(aObjet2[lKeys[i]])&&
!MethodesObjet.objetsIdentiques(aObjet1[lKeys[i]],aObjet2[lKeys[i]],true)){return false;}} else{return false;}}}
return true;};module.exports=MethodesObjet;},fn:"methodesobjet.js"});;
IE.fModule({f:function(exports,require,module,global){require('NamespaceIE.js');require('DeclarationJQuery.js');require('divers.js');const GUID=require('GUID.js');const MethodesObjet=require('MethodesObjet.js');const lGUID_GlobalNomPile=new GUID.generateur();class ObjetInvocateur{constructor(aAbonnementInstanceInterdite){this.pile={};this.pileEvents={};this.generateurGUID=new GUID.generateur();this.abonnementInstanceInterdite=aAbonnementInstanceInterdite;this.nomPileInstance='__pileInvocateur__'+(aAbonnementInstanceInterdite?'':lGUID_GlobalNomPile.get());}
abonner(aEvent,aCallback,aInstance,aAvecAbonnementUnicite){if(this.abonnementInstanceInterdite&&aInstance){throw new Error('interdiction');}
return _abonnerTous.call(this,{e:aEvent,callB:aCallback,inst:aInstance,unicite:aAvecAbonnementUnicite!==false?true:false});}
abonnerUnique(aEvent,aCallback,aInstance,aAvecAbonnementUnicite){return _abonnerTous.call(this,{e:aEvent,callB:aCallback,inst:aInstance,u:true,unicite:aAvecAbonnementUnicite!==false?true:false});}
desabonner(aParam1,aParam2,aParam3){if(!aParam1){return;}
let lEvent,lInstance,lCallBack,lEventsASupprimer,lPileInstance,lId;if(aParam1.push&&aParam1.pop&&MethodesObjet.isArray(aParam1)){_supprimerIds.bind(this)(aParam1);return;}
if(MethodesObjet.isObject(aParam1)){lInstance=aParam1;lCallBack=aParam2;} else{lEvent=aParam1.toString();if(MethodesObjet.isObject(aParam2)){lInstance=aParam2;} else{lCallBack=aParam2;if(MethodesObjet.isObject(aParam3)){lInstance=aParam3;}}}
if(lEvent){const lTab=lEvent.split(' ');for(let i=0;i<lTab.length;i++){_desabonnerParEvent.call(this,lTab[i].trim(),lInstance,lCallBack);}} else if(lInstance){lPileInstance=lInstance[this.nomPileInstance];if(lPileInstance){lEventsASupprimer=[];for(lId in lPileInstance){if(lPileInstance.hasOwnProperty(lId)){if(lCallBack){if(this.pile[lId]&&this.pile[lId].callB===lCallBack){lEventsASupprimer.push(lId);}} else{lEventsASupprimer.push(lId);}}}
if(!lCallBack){delete lInstance[this.nomPileInstance];}
_supprimerIds.bind(this)(lEventsASupprimer);}}}
evenement(aEvent,...aArgs){if(!aEvent){return;}
aEvent=aEvent.toString();const lEvents=this.pileEvents[aEvent];let i,lId,lElement,lLength,lResult;const lEventsATraiter=[];let lAvecEvenement=false;if(lEvents){for(lId in lEvents){lAvecEvenement=true;lElement=this.pile[lId];if(lElement&&lElement.callB){lEventsATraiter.push(lElement);}}}
if(!lAvecEvenement){delete this.pileEvents[aEvent];}
for(i=0,lLength=lEventsATraiter.length;i<lLength;i+=1){lElement=lEventsATraiter[i];if(lElement&&!lElement.__INACTIF__){if(lElement.u){_supprimerIds.bind(this)([lElement.id]);}
;if(lElement.callB){lResult=lElement.callB.call(lElement.inst,...aArgs);if(lResult===false){return;}}}}}}
function _abonner(aParams){if(!aParams.e||!aParams.e.toString){return null;}
aParams.e=aParams.e.toString();if(!aParams.callB){return null;}
if(aParams.unicite){this.desabonner(aParams.e,aParams.callB,aParams.inst);}
if(!this.pileEvents[aParams.e]){this.pileEvents[aParams.e]={};}
const lId=this.generateurGUID.get();aParams.id=lId;this.pile[lId]=aParams;this.pileEvents[aParams.e][lId]=true;if(aParams.inst){if(!aParams.inst[this.nomPileInstance]){aParams.inst[this.nomPileInstance]={};}
aParams.inst[this.nomPileInstance][lId]=true;}
return lId;}
function _supprimerIds(aIds){if(!aIds){return;}
let lId,i,lElement,lInstance,lLength;for(i=0,lLength=aIds.length;i<lLength;i+=1){lId=aIds[i];lElement=this.pile[lId];if(lElement){lInstance=lElement.inst;if(lInstance&&lInstance[this.nomPileInstance]&&lInstance[this.nomPileInstance][lId]){delete lInstance[this.nomPileInstance][lId];if($.isEmptyObject(lInstance[this.nomPileInstance])){delete lInstance[this.nomPileInstance];}}
if(this.pileEvents[lElement.e]){if(this.pileEvents[lElement.e][lId]){delete this.pileEvents[lElement.e][lId];}}
lElement=null;if(this.pile[lId]){this.pile[lId].__INACTIF__=true;}
delete this.pile[lId];}}}
function _abonnerTous(aParam){const lIds=[];let lEvent;if(aParam.e&&aParam.e.split){const lTab=aParam.e.split(' ');for(let i=0,lNb=lTab.length;i<lNb;i++){lEvent=lTab[i].trim();lIds.push(_abonner.call(this,{e:lEvent,callB:aParam.callB,inst:aParam.inst,unicite:aParam.unicite,u:aParam.u}));}}
if(lIds.length===0){return null;}
if(lIds.length===1){return lIds[0];}
return lIds;}
function _desabonnerParEvent(aEvent,aInstance,aCallback){const lEvents=this.pileEvents[aEvent];let lPileInstance,lEventsASupprimer,lId,lElement;if(!lEvents){return;}
if(aInstance){lPileInstance=aInstance[this.nomPileInstance];if(!lPileInstance){return;}
lEventsASupprimer=[];for(lId in lPileInstance){if(lPileInstance.hasOwnProperty(lId)){lElement=this.pile[lId];if(lElement&&lElement.e===aEvent){if(!aCallback||aCallback===lElement.callB){lEventsASupprimer.push(lId);}}}}} else if(aCallback){lEventsASupprimer=[];for(lId in lEvents){if(this.pile[lId]&&this.pile[lId].callB===aCallback){lEventsASupprimer.push(lId);}}} else{lEventsASupprimer=lEvents;delete this.pileEvents[aEvent];}
if(lEventsASupprimer&&lEventsASupprimer.length>0){_supprimerIds.bind(this)(lEventsASupprimer);}}
ObjetInvocateur.events={initChiffrement:'IIE_initChiffrement',patience:'IIE_patience',modificationModeExclusif:'IIE_modification_ModeExclusif',modeExclusif:'IIE_ModeExclusif',modificationPresenceUtilisateur:'IIE_ModificationPresenceUtilisateur',interruption_Requete:'IIE_Interruption_Requete',modification_RequeteAttente:'IIE_Modification_RequeteAttente',activationImpression:'IIE_Activation_Impression',choixImpression:'IIE_choix_impression',autorisationRechargementPage:'IIE_AutorisationRechargementPage',surRechargementPage:'IIE_SurRechargementPage',etatSaisie:'IIE_SetEtatSaisie',fermerFenetres:'IIE_fermer_fenetres',resizeNavigateur:'IIE_resizeNavigateur',actualisationAffichage:'IIE_actualisation_affichage',eventReponseUpload:'IIE_eventReponseUpload',eventIOAjax:'IIE_eventIOAjax',refreshIEHtml:'IEE_refreshIEHtml',erreurCommunication:'IEE_erreurCommunication',navigationOnglet:'IEE_navigationOnglet',toucheDEBUG:'IIE_ToucheDEBUG',DEBUG_log:'IIE_ADDLOG',DEBUG_logRequete:'IIE_ADDLOG_REQUETE'};const Invocateur=new ObjetInvocateur();module.exports.ObjetInvocateur=ObjetInvocateur;module.exports.Invocateur=Invocateur;},fn:"invocateur.js"});;
IE.fModule({f:function(exports,require,module,global){require('NamespaceIE.js');require('DeclarationJQuery.js');const GLog={genre:{Message:0,Avertissement:1,Erreur:2,Deprecated:3}};let _actif=false;let _actifRequete=false;const _idLogAutorises=[];let _compteurRequete=0;const _nbRequetesMax=200;let _pileLog=[];const _pileRequete=[];_idLogAutorises.ERROR=true;GLog.getActif=function(){return _actif;};GLog.setActif=function(aActif){_actif=aActif;if(aActif){this.addLog('Démarrage Log',null,GLog.genre.Avertissement);}};GLog.getActifRequete=function(){return _actifRequete;};GLog.setActifRequete=function(aActif){_actifRequete=aActif;};GLog.addLog=function(aMessage,aIdFiltrage,aGenreLog){if(!_actif){return;}
if(aIdFiltrage&&_idLogAutorises&&!_idLogAutorises[aIdFiltrage]){return;}
const lMessage=aMessage&&aMessage.toString?aMessage.toString():'aMessage NON LOGGABLE !!!';const lLog={message:lMessage,genreLog:aGenreLog,date:new Date()};_pileLog.push(lLog);this.addConsoleLog(aMessage,aGenreLog);require('Invocateur.js').Invocateur.evenement(require('Invocateur.js').ObjetInvocateur.events.DEBUG_log,lLog);};GLog.vider=function(){_pileLog=[];require('Invocateur.js').Invocateur.evenement(require('Invocateur.js').ObjetInvocateur.events.DEBUG_log,null);};GLog.setIDFiltrageLog=function(aID,aAutoriser){if(aAutoriser){_idLogAutorises[aID]=true;} else{delete _idLogAutorises[aID];}};GLog.addRequete=function(aDonnees){if(!this.getActifRequete()){return;}
const lDonnees={nomRequete:'',numeroRequete:0,numeroOrdre:0,chrono:null,estReponse:false,lgcontenu:null};Object.assign(lDonnees,aDonnees);lDonnees.date=new Date();_compteurRequete+=1;_pileRequete.push(lDonnees);if(_pileRequete.length>_nbRequetesMax){_pileRequete.shift();}
require('Invocateur.js').Invocateur.evenement(require('Invocateur.js').ObjetInvocateur.events.DEBUG_logRequete,lDonnees);};GLog.getCompteurRequete=function(){return _compteurRequete;};GLog.getPile=function(){return _pileLog;};GLog.getRequetes=function(){return _pileRequete;};GLog.addConsoleLog=function(aMessage,aGenreMsg){};GLog.addConsoleLogObjet=function(aObjet,aLibelle){};GLog.addConsolePileAppel=function(aLibelle){};module.exports=GLog;},fn:"ielog.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationExtensionsObjetNatif.js');global.assert=function(aIgnorer,aMessage){};function breakpoint(){}
module.exports.breakpoint=breakpoint;},fn:"divers.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationJQuery.js');const MethodesObjet=require('MethodesObjet.js');let Support={init:false};Support.GenreNavigateur={Standard:1,Webkit:2,Moz:3,Opera:4,IE:5};function _initTableau(){const lTableau=[];for(const lProp in Support.GenreNavigateur){lTableau[Support.GenreNavigateur[lProp]]=false;}
return lTableau;}
let uPileInit=[];Support.addInit=function(aCallback){if(this.init){aCallback();} else{uPileInit.push(aCallback);}};function _testerSupports(aDoc){let lProp;const LExtensionsStyle={};LExtensionsStyle[(MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,Support.GenreNavigateur.Standard))]='';LExtensionsStyle[(MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,Support.GenreNavigateur.Webkit))]='Webkit';LExtensionsStyle[(MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,Support.GenreNavigateur.Moz))]='Moz';LExtensionsStyle[(MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,Support.GenreNavigateur.Opera))]='O';LExtensionsStyle[(MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,Support.GenreNavigateur.IE))]='MS';const lExtensionsCss={};lExtensionsCss[(MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,Support.GenreNavigateur.Standard))]='';lExtensionsCss[(MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,Support.GenreNavigateur.Webkit))]='-webkit-';lExtensionsCss[(MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,Support.GenreNavigateur.Moz))]='-moz-';lExtensionsCss[(MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,Support.GenreNavigateur.Opera))]='-o-';lExtensionsCss[(MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,Support.GenreNavigateur.IE))]='-ms-';const lElement=aDoc.createElement('div');function _contains(aChaine,aSousChaine){return(''+aChaine).indexOf(aSousChaine)!== -1;}
function _getNomPropEtendu(aStyle,aExtension){return(aExtension.length>0)?aExtension+aStyle.ucfirst():aStyle;}
function _existeStyle(aStyle,aExtension){return!MethodesObjet.isUndefined(lElement.style[_getNomPropEtendu(aStyle,aExtension)]);}
function _leStyleContientLaChaine(aStyle,aExtension,aChaine){const lStyle=lElement.style[_getNomPropEtendu(aStyle,aExtension)];return!MethodesObjet.isUndefined(lStyle)&&_contains(lStyle,aChaine);}
Support.supportFilterIE=!MethodesObjet.isUndefined(lElement.style.filter);if(!MethodesObjet.isUndefined(lElement.style.filter)){lElement.style.filter="progid:DXImageTransform.Microsoft.Gradient(gradientType=1,startColorStr=yellow,endColorStr=red);";Support.supportFilterIE=(lElement.style.filter.length>0);}
for(lProp in LExtensionsStyle){Support.supportBorderRadius[Support.GenreNavigateur[lProp]]=_existeStyle('borderRadius',LExtensionsStyle[lProp]);if(Support.supportBorderRadius[Support.GenreNavigateur[lProp]]){Support.avecBorderRadius=true;}}
lElement.style.cssText='background: linear-gradient(180deg, yellow, blue);';Support.supportGradient[Support.GenreNavigateur.Standard]=_contains(lElement.style.background,'gradient');lElement.style.cssText='background: -ms-linear-gradient(180deg, yellow, blue);';Support.supportGradient[Support.GenreNavigateur.IE]=_contains(lElement.style.background,'gradient');lElement.style.cssText='background: -webkit-gradient(180deg, left top, right top, from(blue), to(yellow));';Support.supportGradient[Support.GenreNavigateur.Webkit]=_contains(lElement.style.background,'gradient');lElement.style.cssText='background: -moz-linear-gradient(180deg, yellow, blue);';Support.supportGradient[Support.GenreNavigateur.Moz]=_contains(lElement.style.background,'gradient');for(lProp in LExtensionsStyle){lElement.style.cssText=lExtensionsCss[lProp]+'opacity:.5;';Support.supportOpacity[Support.GenreNavigateur[lProp]]=_leStyleContientLaChaine('opacity',LExtensionsStyle[lProp],'0.5');if(Support.supportOpacity[Support.GenreNavigateur[lProp]]){Support.avecSupportOpacity=true;}}
for(lProp in LExtensionsStyle){Support.supportBoxShadow[Support.GenreNavigateur[lProp]]=_existeStyle('boxShadow',LExtensionsStyle[lProp]);if(Support.supportBoxShadow[Support.GenreNavigateur[lProp]]){Support.avecSupportBoxShadow=true;}}
for(lProp in LExtensionsStyle){Support.supportBackgroundSize[Support.GenreNavigateur[lProp]]=_existeStyle('backgroundSize',LExtensionsStyle[lProp]);if(Support.supportBackgroundSize[Support.GenreNavigateur[lProp]]){Support.avecBackgroundSize=true;}}
for(lProp in LExtensionsStyle){Support.supportTransitions[Support.GenreNavigateur[lProp]]=_existeStyle('transitionProperty',LExtensionsStyle[lProp]);if(Support.supportTransitions[Support.GenreNavigateur[lProp]]){Support.avecSupportTransitions=true;}}
Support.transitionEndEvent=(function(){const el=document.createElement('fakeelement');const transitions={'WebkitTransition':'webkitTransitionEnd','MozTransition':'transitionend','MSTransition':'msTransitionEnd','OTransition':'oTransitionEnd','transition':'transitionEnd'};for(const t in transitions){if(el.style[t]!==undefined){return transitions[t];}}})();let lNomTransform;for(const lProp in LExtensionsStyle){lNomTransform='';switch(Support.GenreNavigateur[lProp]){case Support.GenreNavigateur.Standard:lNomTransform='transform';break;case Support.GenreNavigateur.Webkit:lNomTransform='WebkitTransform';break;case Support.GenreNavigateur.Moz:lNomTransform='MozTransform';break;case Support.GenreNavigateur.Opera:lNomTransform='OTransform';break;case Support.GenreNavigateur.IE:lNomTransform='msTransform';break;}
Support.supportTransforms[Support.GenreNavigateur[lProp]]=!MethodesObjet.isUndefined(lElement.style[lNomTransform]);if(Support.supportTransforms[Support.GenreNavigateur[lProp]]){Support.avecSupportTransform=true;}}
Support.supportEventOnPopState=!MethodesObjet.isUndefined(window.onpopstate);Support.supportEventPaste='onpaste' in lElement;Support.supportEventInput='oninput' in lElement;Support.supportTouch=('ontouchstart' in window)||!!(window.DocumentTouch&&document instanceof window.DocumentTouch);Support.tactile=Support.supportTouch||window.navigator.maxTouchPoints>0;Support.avecSupportFileUpload=(function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/)){return false;}
const el=document.createElement("input");el.type="file";return!el.disabled;})();Support.supportCanvas=!!aDoc.createElement('canvas').getContext;Support.supportCanvasText=!!(Support.supportCanvas&&typeof(aDoc.createElement('canvas').getContext('2d').fillText)==='function');Support.supportBlob=_supportBlob();Support.permissionNotification={defaut:"default",granted:"granted",denied:"denied"};Support.supportNotification=_supportNotif();Support.refreshNotification=function(){Support.supportNotification=_supportNotif();};Support.speechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition||null;Support.speechSynthesis=window.speechSynthesis||null;Support.contentEditable=false;if('contentEditable' in document.documentElement){lElement.contentEditable=true;Support.contentEditable=lElement.contentEditable==='true';}}
function _supportBlob(){let lBlob=false;try{lBlob=new Blob(['a'],{type:'text/plain'});} catch(e1){try{const BlobBuilder=window.MozBlobBuilder||window.WebKitBlobBuilder||window.BlobBuilder;if(e1.name==='TypeError'&&window.BlobBuilder){const bb=new BlobBuilder();bb.append(['a']);lBlob=bb.getBlob('text/plain');} else if(e1.name==='InvalidStateError'){lBlob=new Blob(['a'],{type:'text/plain'});}} catch(e2){return false;}}
if(lBlob){return true;}
return false;}
function _supportNotif(){let isSupported=false;try{isSupported=!!(window.Notification||window.webkitNotifications||navigator.mozNotification);if(isSupported){if(window.Notification&&window.Notification.permissionLevel){isSupported=window.Notification.permissionLevel();} else if(window.webkitNotifications&&window.webkitNotifications.checkPermission){if(window.webkitNotifications.checkPermission()===0){isSupported=Support.permissionNotification.granted;} else if(window.webkitNotifications.checkPermission()===2){isSupported=Support.permissionNotification.denied;} else{isSupported=Support.permissionNotification.defaut;}} else if(navigator.mozNotification){isSupported=Support.permissionNotification.granted;} else if(window.Notification&&window.Notification.permission){isSupported=window.Notification.permission;}}} catch(e){}
return isSupported;}
function _testerSupportHtml(){const lBody=document.getElementsByTagName("BODY")[0];const lElement=document.createElement('div');lBody.appendChild(lElement);const lTaille=50;const lId='_test_';lElement.innerHTML='<div id="'+lId+'" style="height:auto;"><div style="height:'+lTaille+'px; padding:4px;">&nbsp;</div></div>';Support.bordureExterneDIV=document.getElementById(lId).offsetHeight===lTaille;lElement.innerHTML='<table cellpadding="0" cellspacing="0" border="0"><tr><td class="PetitEspace" id="'+lId+'" style="height:'+lTaille+'px;"><div style="">&nbsp;</div></td></tr></table>';Support.bordureExterneTD=document.getElementById(lId).offsetHeight===lTaille;lElement.innerHTML='<table style="position:absolute; z-index:-1; visibility:hidden"><tr>'+'<td style="height:'+lTaille+'px;">'+'<div id="'+lId+'" style="height:100%"><div style="height:'+(lTaille+20)+'px;"></div></div>'+'</td></tr></table>';Support.div100PourcentDansTDGardeHauteurTD=document.getElementById(lId).offsetHeight===lTaille;lElement.innerHTML='<div id="dessous" style="position:absolute;height:10px;width:10px;top:0;left:0;"></div>'+'<div id="dessus" style="position:absolute;height:10px;width:10px;top:0;left:0; pointer-events:none;"></div>';const lTrouve=document.elementFromPoint?document.elementFromPoint(1,1):null;Support.supportPointerEventsNone=!!lTrouve&&lTrouve.id==='dessous';lElement.innerHTML='<div style="overflow:scroll;"><div></div></div>';Support.tailleScrollBar=$(lElement).find('>div').get(0).offsetWidth-$(lElement).find('>div>div').get(0).offsetWidth;Support.estOverlayScrollbar=Support.tailleScrollBar===0;lBody.removeChild(lElement);}
Support.toString=function(){let lChaine='';let lValeur;let lChaineSupport;for(const lProp in Support){lValeur=Support[lProp];if(MethodesObjet.isArray(lValeur)){lChaine+=lProp+' - [';lChaineSupport='';for(const i in lValeur){if(lValeur[i]){lChaineSupport+=(lChaineSupport.length>0?', ':'')+MethodesObjet.nomProprieteDeValeur(Support.GenreNavigateur,parseInt(i,10));}}
lChaine+=(lChaineSupport.length>0?lChaineSupport:'NON SUPPORTE')+']\n';} else if(!MethodesObjet.isFunction(lValeur)&&!MethodesObjet.isObject(lValeur)){lChaine+=lProp+' - '+Support[lProp]+'\n';}}
return lChaine;};Support=$.extend({supportFilterIE:false,supportEventOnPopState:false,supportEventPaste:false,supportEventInput:false,supportTouch:false,tactile:false,supportBorderRadius:_initTableau(),avecBorderRadius:false,supportGradient:_initTableau(),supportOpacity:_initTableau(),avecSupportOpacity:false,supportBoxShadow:_initTableau(),avecSupportBoxShadow:false,supportTransitions:_initTableau(),avecSupportTransitions:false,transitionEndEvent:'',supportTransforms:_initTableau(),avecSupportTransform:false,supportBackgroundSize:_initTableau(),avecBackgroundSize:false,scrollBarWidth:-1,avecSupportFileUpload:false,supportPointerEventsNone:false,supportCanvas:false,supportCanvasText:false,supportBlob:false,supportNotification:false,speechRecognition:false,speechSynthesis:false,contentEditable:false},Support);$(window).on('load',function(){Support.init=true;_testerSupports(window.document);_testerSupportHtml();uPileInit.forEach(function(aCallback){aCallback();});uPileInit=[];});module.exports=Support;},fn:"objetsupport.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationJQuery.js');$.fn.inputDisabled=function(aValue){const $this=$(this);if(aValue===undefined){return $this.is(':disabled');} else{$this.attr('disabled',!!aValue);$this.trigger('IEDisabled');return $this;}};},fn:"jinputdisabled.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationJQuery.js');$.fn.inputChecked=function(aValue){const $this=$(this);if(aValue===undefined){return $this.is(':checked');}
$this.prop('checked',aValue);$this.trigger('IEChecked');return $this;};$.fn.cbIndeterminate=function(aValue){const $this=$(this);if(aValue===undefined){let lValeur=false;try{lValeur=$this.is(':indeterminate');} catch(e){lValeur=!!this.indeterminate;}
return lValeur;}
$this.prop('indeterminate',aValue);$this.trigger('IECBIndeterminate');return $this;};},fn:"jinputchecked.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationExtensionsObjetNatif.js');function MethodesTableau(){}
MethodesTableau.existe=function(aValeur,aTableau){return aTableau.indexOf(aValeur)!== -1;};function _filterIntersection(aTableauCompare ,aElement){return aTableauCompare.indexOf(aElement)!== -1;}
MethodesTableau.intersection=function(aTableau1,aTableau2){let lResult;let i;if(aTableau1&&aTableau1.filter){return aTableau1.filter(_filterIntersection.bind(this,aTableau2));}
lResult=[];for(i=0;i<aTableau1.length;i++){if(MethodesTableau.existe(aTableau2,aTableau1[i])){lResult.push(aTableau1[i]);}}
return lResult;};MethodesTableau.existeIntersection=function(aTableau1,aTableau2){return MethodesTableau.intersection(aTableau1,aTableau2).length>0;};function _everyInclus(aTableauCompare ,aElement){return aTableauCompare.indexOf(aElement)!== -1;}
MethodesTableau.inclus=function(aTableau1,aTableau2){if(!Array.isArray(aTableau1)||!Array.isArray(aTableau2)){return false;}
if(aTableau1.every){return!!aTableau1.every(_everyInclus.bind(this,aTableau2));}
for(let I=0;I<aTableau1.length;I++){if(!_everyInclus(aTableau2,aTableau1[I])){return false;}}
return true;};MethodesTableau.insererElement=function(aValeur,aTableau,aIndex){if(!Array.isArray(aTableau)){return false;}
if(aIndex>=0){const T=aTableau.slice(aIndex);aTableau.length=aIndex;aTableau.push(aValeur);Array.prototype.push.apply(aTableau,T);} else{aTableau.push(aValeur);}};MethodesTableau.supprimerElement=function(aTableau,aIndex){aTableau.splice(aIndex,1);};MethodesTableau.remove=function(aTableau,aElement){let lIndex=aTableau.indexOf(aElement);let lResult=false;while(lIndex>=0){aTableau.splice(lIndex,1);lResult=true;lIndex=aTableau.indexOf(aElement);}
return lResult;};MethodesTableau.parcourir=function(aTableau,aMethode,thisArg){if(!Array.isArray(aTableau)){return;}
for(let i=0,lLength=aTableau.length;i<lLength;i++){if(aMethode.call(thisArg,aTableau[i],i)===true){return;}}};MethodesTableau.nombreElements=function(aTableau){let lNombre=0;for(let i=0;i<aTableau.length;i++){let lElement=aTableau[i];if(lElement!==null||lElement!==undefined){lNombre++;}}
return lNombre;};MethodesTableau.binaryIndexOf=function(aArray,aElement){if(!Array.isArray(aArray)){return-1;}
let lMinIndex=0;let lMaxIndex=aArray.length-1;let lIndexCourant;let lElementCourant;while(lMinIndex<=lMaxIndex){lIndexCourant=(lMinIndex+lMaxIndex)/2 | 0;lElementCourant=aArray[lIndexCourant];if(lElementCourant<aElement){lMinIndex=lIndexCourant+1;} else if(lElementCourant>aElement){lMaxIndex=lIndexCourant-1;} else{return lIndexCourant;}}
return-1;};MethodesTableau.indexOfMask=function(aArray,aMask){let lIndice= -1;if(!Array.isArray(aArray)){return lIndice;}
if(!aMask||aArray.length===0){return lIndice;}
try{const lKeys=Object.keys(aMask);if(lKeys.length>0){aArray.every(function(aBouton,aIndice){let lTrouve=true;lKeys.every(function(aKey){if(aMask[aKey]===aBouton[aKey]){return true;}
lTrouve=false;return false;});if(lTrouve){lIndice=aIndice;}
return lIndice<0;});}} catch(e){lIndice= -1;}
return lIndice;};module.exports=MethodesTableau;},fn:"methodestableau.js"});;
IE.fModule({f:function(exports,require,module,global){const GLog=require('IELog.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const MethodesObjet=require('MethodesObjet.js');let uSaisieEnCours=null,uSaisieEnCoursExecution=false;function ControleSaisieEvenement(aCallback,aSansControleNavigation){if(!aCallback||!MethodesObjet.isFunction(aCallback)){return;}
if(aSansControleNavigation!==true&&window.GApplication&&!GApplication.getModeExclusif()){let lCallback=null;if(_avecSaisieEnCoursActive()){lCallback=uSaisieEnCours.saisie.bind(this,aCallback);uSaisieEnCours=null;}
if(lCallback||(window.GEtatUtilisateur&&window.GEtatUtilisateur.EtatSaisie)){let lPage=window.GEtatUtilisateur&&window.GEtatUtilisateur.GetPageCourante?window.GEtatUtilisateur.GetPageCourante():null;if(!lPage){lPage=window.GInterface&&window.GInterface.getPageCourante?window.GInterface.getPageCourante():null;}
if(!lPage){aCallback();return;}
if(!lCallback){lCallback=lPage.Valider?lPage.Valider.bind(lPage):null;}
if(!MethodesObjet.isFunction(lCallback)){aCallback();return;}
Invocateur.evenement(ObjetInvocateur.events.etatSaisie,false);delete lPage._callbackNavigation;let lCallbackTransmis=false;if(!IE.estMobile&&lPage.ActionSurValidation){lPage._callbackNavigation=aCallback;lCallbackTransmis=true;}
const lResult=lCallback();if(lPage){lPage.focusSurPremierObjet();}
if(!lCallbackTransmis){aCallback();}
return lResult;}}
return aCallback();}
function _avecSaisieEnCoursActive(){if(uSaisieEnCours){if(uSaisieEnCours.instance&&MethodesObjet.isFunction(uSaisieEnCours.instance.isDestroyed)&&uSaisieEnCours.instance.isDestroyed()){uSaisieEnCours=null;return false;}
return MethodesObjet.isFunction(uSaisieEnCours.saisie)&&(!MethodesObjet.isFunction(uSaisieEnCours.actif)||uSaisieEnCours.actif()===true);}
return false;}
ControleSaisieEvenement.saisieEnCours=function(){if(window.GApplication&&GApplication.getModeExclusif()){uSaisieEnCours=null;uSaisieEnCoursExecution=false;return false;}
if(_avecSaisieEnCoursActive()){if(!uSaisieEnCoursExecution){uSaisieEnCoursExecution=true;const lSaisieEnCours=uSaisieEnCours;uSaisieEnCours=null;Promise.resolve().then(function(){return lSaisieEnCours.saisie.apply(this,arguments);}.bind(this)).catch(function(e){GLog.addLog('erreur saisieEnCours '+e);}).then(function(){uSaisieEnCoursExecution=false;}.bind(this));}
return true;}
return false;};ControleSaisieEvenement.addSaisieEnCours=function(aCallback){uSaisieEnCoursExecution=false;if(window.GApplication&&GApplication.getModeExclusif()){uSaisieEnCours=null;return;}
const lSaisie={actif:null,saisie:null,instance:null};if(MethodesObjet.isFunction(aCallback)){lSaisie.saisie=aCallback;} else if(MethodesObjet.isObject(aCallback)&&MethodesObjet.isFunction(aCallback.saisie)){lSaisie.saisie=aCallback.saisie;lSaisie.actif=aCallback.actif;lSaisie.instance=aCallback.instance;}
if(lSaisie.saisie){uSaisieEnCours=lSaisie;} else{uSaisieEnCours=null;}};module.exports=ControleSaisieEvenement;},fn:"controlesaisieevenement.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeChampsJSON={type:'_T',valeur:'V'};module.exports=TypeChampsJSON;},fn:"enumere_champsjson.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreEtat={Aucun:0,Creation:1,Modification:2,Suppression:3,FilsModification:4};module.exports=EGenreEtat;},fn:"enumere_etat.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const EGenreEtat=require('Enumere_Etat.js');let _numeroCreation= -1000;class ObjetElement{constructor(ALibelle,ANumero,AGenre,APosition,AActif){this.Libelle=ALibelle;this.Numero=ANumero;this.Genre=AGenre;this.Position=APosition;this.Actif=AActif===null||AActif===undefined?true:AActif;this.Etat=EGenreEtat.Aucun;if(arguments.length===1&&MethodesObjet.isObject(ALibelle)){Object.assign(this,ALibelle);}}
toJSON(){return _toJSON(this);}
toJSONAll(){const lJSON=_toJSON(this);return _propToJSONHorsFormat(this,lJSON);}
fromJSON(aJSON){if(!aJSON){return this;}
this.Libelle=aJSON[ObjetElement.const_JSON.libelle.JSON]||'';this.Numero=aJSON[ObjetElement.const_JSON.numero.JSON]==='0'?0:aJSON[ObjetElement.const_JSON.numero.JSON];this.Genre=aJSON[ObjetElement.const_JSON.genre.JSON];this.Position=aJSON[ObjetElement.const_JSON.position.JSON];if(aJSON[ObjetElement.const_JSON.actif.JSON]!==undefined){this.Actif=aJSON[ObjetElement.const_JSON.actif.JSON];}
return this;}
copieJSON(aJSON){let lProp;for(lProp in aJSON){if(lProp!==ObjetElement.const_JSON.libelle.JSON&&lProp!==ObjetElement.const_JSON.numero.JSON&&lProp!==ObjetElement.const_JSON.genre.JSON&&lProp!==ObjetElement.const_JSON.position.JSON){this[lProp]=aJSON[lProp];}}
return this;}
copieToJSON(aJSON){return _propToJSONHorsFormat(this,aJSON);}
GetLibelle(){return this.Libelle;}
GetNumero(){return this.Numero;}
GetGenre(){return this.Genre;}
GetActif(){return this.Actif;}
GetPosition(){return this.Position;}
getDonnees(){return this.donnees;}
existeNumero(){let lNumero=this.GetNumero();if(lNumero&&lNumero.indexOf&&lNumero.length>ObjetElement.const_JSON.tailleNumero){lNumero=lNumero.substr(lNumero.length-ObjetElement.const_JSON.tailleNumero,lNumero.length);}
return lNumero&&(lNumero!=='0')?true:false;}
Existe(){return this.Etat!==EGenreEtat.Suppression;}
PourValidation(){return this._validationSaisie||false;}
SetLibelle(aLibelle){this.Libelle=aLibelle;}
SetNumero(aNumero){this.Numero=aNumero;}
SetActif(aActif){this.Actif=aActif;}
setDonnees(aDonnees){this.donnees=aDonnees;}
getGenreTable(){if(this.Numero&&this.Numero.indexOf&&this.Numero.length>ObjetElement.const_JSON.tailleNumero){const lGenreTable=parseInt(this.Numero.substr(0,this.Numero.length-ObjetElement.const_JSON.tailleNumero),10);if(MethodesObjet.isNumber(lGenreTable)){return lGenreTable;}}
return 0;}
egalParNumeroEtGenre(aNumero,aGenre,aAvecExiste){if((aNumero===null||aNumero===undefined)&&(aGenre===null||aGenre===undefined)){return false;}
return(!aAvecExiste||this.Existe())&&((aNumero===null||aNumero===undefined)||(this.GetNumero()===aNumero))&&((aGenre===null||aGenre===undefined)||(this.GetGenre()===aGenre));}
getCle(){return'_'+this.Genre+'_'+this.Numero;}
SetEtat(AEtat){if(this.Etat===AEtat){return this;}
switch(AEtat){case EGenreEtat.Aucun:delete this._validationSaisie;this.Etat=EGenreEtat.Aucun;break;case EGenreEtat.Creation:if(this.Etat===EGenreEtat.Aucun){this._validationSaisie=true;this.Etat=EGenreEtat.Creation;if(this.Numero===null||this.Numero===undefined){this.Numero=ObjetElement.getNumeroCreation();}}
break;case EGenreEtat.Modification:if((this.Etat===EGenreEtat.Aucun)||(this.Etat===EGenreEtat.FilsModification)){this._validationSaisie=true;this.Etat=(this.Numero!==0)&&((this.Numero!==null&&this.Numero!==undefined))?EGenreEtat.Modification:EGenreEtat.Creation;if(this.Numero===null||this.Numero===undefined){this.Numero=ObjetElement.getNumeroCreation();}}
break;case EGenreEtat.Suppression:if(this.Etat===EGenreEtat.Creation){delete this._validationSaisie;} else{this._validationSaisie=true;}
this.Etat=EGenreEtat.Suppression;break;case EGenreEtat.FilsModification:if(this.Etat===EGenreEtat.Aucun){this._validationSaisie=true;this.Etat=EGenreEtat.FilsModification;}
break;}
return this;}
afficher(){}
static getNumeroCreation(){_numeroCreation+= -1;return _numeroCreation;}}
ObjetElement.const_JSON={numero:{JSON:'N',champ:'Numero'},libelle:{JSON:'L',champ:'Libelle'},genre:{JSON:'G',champ:'Genre'},position:{JSON:'P',champ:'Position'},etat:{JSON:'E',champ:'Etat'},actif:{JSON:'A',champ:'Actif'},tailleNumero:12};function _toJSON(aElement){const lNumero=aElement.GetNumero(),lGenre=aElement.GetGenre(),lLibelle=aElement.GetLibelle();const lJSON={};lJSON[ObjetElement.const_JSON.numero.JSON]=lNumero;if(lGenre!==undefined&&lGenre!==null){lJSON[ObjetElement.const_JSON.genre.JSON]=lGenre;}
if(lLibelle){lJSON[ObjetElement.const_JSON.libelle.JSON]=lLibelle;}
if(aElement.Etat){lJSON[ObjetElement.const_JSON.etat.JSON]=aElement.Etat;}
return lJSON;}
function _propToJSONHorsFormat(aSource,aCible){let lProp;const lCible=aCible||{};const lKeys=Object.keys(aSource);for(let i=0;i<lKeys.length;i++){lProp=lKeys[i];if(aSource[lProp]!==undefined&&!MethodesObjet.isFunction(aSource[lProp])&&lProp!==ObjetElement.const_JSON.libelle.champ&&lProp!==ObjetElement.const_JSON.numero.champ&&lProp!==ObjetElement.const_JSON.genre.champ&&lProp!==ObjetElement.const_JSON.position.champ&&lProp!==ObjetElement.const_JSON.etat.champ){lCible[lProp]=aSource[lProp];}}
return lCible;}
module.exports=ObjetElement;},fn:"objetelement.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreTriElement={Croissant:1,Decroissant:-1};module.exports=EGenreTriElement;},fn:"enumere_trielement.js"});;
IE.fModule({f:function(exports,require,module,global){
let uSupportLocaleCompare=false,uSupportCollator=!!(window.Intl&&window.Intl.Collator),uLocales,uCollator=uSupportCollator?new window.Intl.Collator(uLocales,{sensitivity:"accent"}):null,uCollatorCaseSensitive=uSupportCollator?new window.Intl.Collator(uLocales,{sensitivity:"variant"}):null,uCollator_NonCaseSensitive_IgnoreAccent=uSupportCollator?new window.Intl.Collator(uLocales,{sensitivity:"base"}):null,uCollator_CaseSensitive_IgnoreAccent=uSupportCollator?new window.Intl.Collator(uLocales,{sensitivity:"case"}):null;const ComparateurChaines={egal:function(aStrA,aStrB,aOptions){return ComparateurChaines.compare(aStrA,aStrB,aOptions)===0;},compare:function(aStrA,aStrB,aOptions){const lOptions=Object.assign({caseSensitive:false,accentSensitive:false,avecTrim:false,unifierEspacements:false,unifierCarWord:false},aOptions);const lResult=ComparateurChaines.compareChamps(ComparateurChaines.getValeurPourTri(aStrA,lOptions),ComparateurChaines.getValeurPourTri(aStrB,lOptions),lOptions);return lResult===false?0:lResult;},normalize:function(aChaine){if(aChaine&&aChaine.normalize){return aChaine.normalize('NFD').replace(/[\u0300-\u036f]/g,"");}
return ComparateurChaines.latinize(aChaine);},latinize:function(aChaine){return aChaine&&aChaine.replace?aChaine.replace(new RegExp('['+_latinize()+']','gi'),_latinize):'';},getValeurPourTri:function(aChamp,aOptions){let lResult=aChamp
;if(!lResult){return lResult;}
if(lResult.getTime){return lResult.getTime();}
if(lResult.enleverEntites){lResult=lResult.enleverEntites();if(!uSupportLocaleCompare&&!uSupportCollator&&!aOptions.accentSensitive){lResult=ComparateurChaines.normalize(lResult);}
if(aOptions.avecTrim){lResult=lResult.trim();}
if(aOptions.unifierEspacements){lResult=lResult.replace(/\s+/gi,' ');}
if(aOptions.unifierCarWord){lResult=lResult.replace(/’/g,"'").replace(/«|»/g,'"');}}
if(!aOptions.caseSensitive&&!uSupportCollator&&!uSupportLocaleCompare&&lResult&&lResult.toLowerCase){lResult=lResult.toLowerCase();}
return lResult;},compareChamps:function(aChampA,aChampB,aOptions){const lChampAString=aChampA&&aChampA.localeCompare;const lChampBString=aChampB&&aChampB.localeCompare
;if((uSupportLocaleCompare||uSupportCollator)&&lChampAString&&lChampBString){let lResult=0;if(uSupportCollator){lResult=(aOptions.caseSensitive?aOptions.accentSensitive?uCollatorCaseSensitive:uCollator_CaseSensitive_IgnoreAccent:aOptions.accentSensitive?uCollator:uCollator_NonCaseSensitive_IgnoreAccent).compare(aChampA,aChampB);} else{lResult=aChampA.localeCompare(aChampB,'fr',{sensitivity:(aOptions.caseSensitive?aOptions.accentSensitive?"variant":"case":aOptions.accentSensitive?"accent":"base")});}
if(lResult<0){return-1;}
if(lResult>0){return 1;}
return false;}
const lChampANull=aChampA===undefined||aChampA===null,lChampBNull=aChampB===undefined||aChampB===null;if(lChampANull&&lChampBNull){return false;}
if(lChampAString&&aChampB===ComparateurChaines.MAX_STRING){return-1;}
if(lChampBString&&aChampA===ComparateurChaines.MAX_STRING){return 1;}
if(aChampA>aChampB||lChampBNull){return 1;}
if(aChampA<aChampB||lChampANull){return-1;}
return false;},MAX_STRING:{MAX_STRING:true}};try{if(''.localeCompare){uSupportLocaleCompare='e'.localeCompare('é','fr',{sensitivity:"base"})===0;}} catch(e){uSupportLocaleCompare=false;}
let uCache_regexLatinize=null;function _latinize(aMatch){let x;const lTranslate={'á':'a','à':'a','â':'a','ä':'a','ã':'a','ç':'c','é':'e','è':'e','ê':'e','ë':'e','í':'i','ì':'i','î':'i','ï':'i','ñ':'n','ó':'o','ò':'o','ô':'o','ö':'o','õ':'o','ő':'o','ß':'ss','š':'szz','ú':'u','ù':'u','û':'u','ü':'u','ű':'u','ý':'y','ÿ':'y','æ':'ae','œ':'oe'};if(!aMatch){if(!uCache_regexLatinize){const lRegex=[];for(x in lTranslate){lRegex.push(x);}
uCache_regexLatinize=lRegex.join('');}
return uCache_regexLatinize;}
const lMatchLower=aMatch.toLowerCase();const lIsUpperCase=lMatchLower!==aMatch;return lIsUpperCase?lTranslate[lMatchLower].ucfirst():lTranslate[lMatchLower];}
module.exports=ComparateurChaines;},fn:"comparateurchaines.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const MethodesTableau=require('MethodesTableau.js');const EGenreTriElement=require('Enumere_TriElement.js');const ComparateurChaines=require('ComparateurChaines.js');const ObjetTri=(function(){function _construirePilePere(aValeur,aNomChampePere,aPile){let lObjet=aValeur;while(lObjet&&lObjet[aNomChampePere]&&MethodesObjet.isObject(lObjet[aNomChampePere])&&!MethodesTableau.existe(lObjet[aNomChampePere],aPile)){lObjet=lObjet[aNomChampePere];aPile.push(lObjet);}}
function _comparerTriRecursif(A,B,aTri){let lPileParentA=[A.contenu],lPileParentB=[B.contenu],i,lResult,j,lNb,lTri,lCount,lA,lB;if(!aTri.tris){return false;}
_construirePilePere(A.contenu,aTri.nomChampPere,lPileParentA);_construirePilePere(B.contenu,aTri.nomChampPere,lPileParentB);lPileParentA.reverse();lPileParentB.reverse();lCount=Math.max(lPileParentA.length,lPileParentB.length);for(i=0;i<lCount;i++){lA=lPileParentA[i];lB=lPileParentB[i];if((!lA&&lB)||(!lA&&!lB)){return-aTri.ordreTri;} else if(lA&&!lB){return aTri.ordreTri;} else if(lA===lB){continue;}
for(j=0,lNb=aTri.tris.length;j<lNb;j++){lTri=aTri.tris[j];lResult=_comparerTri(lA,lB,lTri,null,false,i);if(lResult!==false){return lResult;}}}
return false;}
function _getValeurPourTri(aTri,aElement,aProfondeur){let lResult;if(aTri.estFonction){lResult=aTri.nomChamp(aElement,aProfondeur);} else if(aTri.estAccesseurChaine){lResult=MethodesObjet.get(aElement,aTri.nomChamp);} else{if(!aElement){return aElement;}
lResult=aElement[aTri.nomChamp];}
return ComparateurChaines.getValeurPourTri(lResult,{caseSensitive:aTri.caseSensitive,accentSensitive:aTri.accentSensitive});}
function _comparerTri(A,B,aTri,aIndiceTri,aAvecCacheTri,aProfondeur){let lChampTriA;let lChampTriB;if(aAvecCacheTri){if(!A.cache[aIndiceTri]){lChampTriA=_getValeurPourTri(aTri,A.contenu,aProfondeur);A.cache[aIndiceTri]={valeur:lChampTriA};} else{lChampTriA=A.cache[aIndiceTri].valeur;}
if(!B.cache[aIndiceTri]){lChampTriB=_getValeurPourTri(aTri,B.contenu,aProfondeur);B.cache[aIndiceTri]={valeur:lChampTriB};} else{lChampTriB=B.cache[aIndiceTri].valeur;}} else{lChampTriA=_getValeurPourTri(aTri,A,aProfondeur);lChampTriB=_getValeurPourTri(aTri,B,aProfondeur);}
if(lChampTriA===lChampTriB||(lChampTriA===undefined&&lChampTriB===null)||(lChampTriB===undefined&&lChampTriA===null)){return false;}
const lResult=ComparateurChaines.compareChamps(lChampTriA,lChampTriB,{caseSensitive:aTri.caseSensitive,accentSensitive:aTri.accentSensitive});if(lResult===false){return false;}
return lResult*aTri.ordreTri;}
function _comparer(aTris,A,B){let i,lNb,lTri,lResult;for(i=0,lNb=aTris.length;i<lNb;i++){lTri=aTris[i];if(!lTri){return 0;}
if(lTri.triRecursif){lResult=_comparerTriRecursif(A,B,lTri);} else{lResult=_comparerTri(A,B,lTri,i,true,0);}
if(lResult!==false){return lResult;}}
return A.ordre-B.ordre;}
return{init:function(aNomChamp,aGenreTri,aCaseSensitive,aIgnorerAccents){return{estFonction:MethodesObjet.isFunction(aNomChamp),estAccesseurChaine:MethodesObjet.isString(aNomChamp)&&aNomChamp.indexOf('.')>=0,nomChamp:aNomChamp,ordreTri:aGenreTri===EGenreTriElement.Decroissant?-1:1,caseSensitive:aCaseSensitive===true?true:false,accentSensitive:aIgnorerAccents===true?false:true};},initRecursif:function(aNomChampPere,aTris){const lTris=aTris;return{triRecursif:true,nomChampPere:aNomChampPere,tris:lTris,ordreTri:EGenreTriElement.Croissant};},trierTableau:function(aTableau,aTris){if(!aTableau||!aTableau.sort||!aTris||aTableau.length<2){return;}
const lLength=aTableau.length;const lTableau=new Array(lLength);let lValeur;for(let i=0;i<lLength;i++){lValeur=aTableau[i];if(lValeur!==undefined||lValeur!==null){lTableau[i]={contenu:lValeur,cache:[],ordre:i};} else{lTableau[i]=lValeur;}}
lTableau.sort(_comparer.bind(null,aTris));for(let i=0;i<lLength;i++){lValeur=lTableau[i];if(lValeur!==undefined||lValeur!==null){aTableau[i]=lValeur.contenu;} else{aTableau[i]=lValeur;}}},genreTri:EGenreTriElement};}());module.exports=ObjetTri;},fn:"objettri.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const MethodesTableau=require('MethodesTableau.js');const EGenreEtat=require('Enumere_Etat.js');const EGenreTriElement=require('Enumere_TriElement.js');const ObjetTri=require('ObjetTri.js');const ObjetElement=require('ObjetElement.js');const ComparateurChaines=require('ComparateurChaines.js');class ObjetListeElements{constructor(){this.vider();}
vider(){this.ListeElements=[];return this;}
add(aElement){if(aElement){if(ObjetElement.prototype.isPrototypeOf(aElement)){this.ListeElements.push(aElement);return this;}
if(aElement.parcourir&&ObjetListeElements.prototype.isPrototypeOf(aElement)){aElement.parcourir(function(a){this.add(a);}.bind(this));return this;}
if(Array.isArray(aElement)){aElement.forEach(function(a){this.add(a);}.bind(this));return this;}}
require('IELog.js').addLog('ObjetListeElements.add : aElement incorrect => '+aElement);return this;}
AddElement(AElement,I){if(I===null||I===undefined){this.ListeElements.push(AElement);} else{this.ListeElements[I]=AElement;}
return this;}
insererElement(AElement,I){MethodesTableau.insererElement(AElement,this.ListeElements,I);return this;}
remove(aIndice){if(aIndice>=0&&MethodesObjet.isNumber(aIndice)){MethodesTableau.supprimerElement(this.ListeElements,aIndice);}
return this;}
GetNbrElements(){return this.ListeElements.length;}
GetNbrElementsExistes(aGenre){let N=0;for(let I=0;I<this.ListeElements.length;I++){if(this.Existe(I)&&(aGenre===null||aGenre===undefined||this.GetElement(I).Genre===aGenre)){N++;}}
return N;}
GetListeElements(){return this.ListeElements;}
parcourir(aFunction,aThis){if(!aFunction||!MethodesObjet.isFunction(aFunction)){return this;}
this.ListeElements.every(function(aElement,aIndex){return aFunction.call(aThis,aElement,aIndex,this)!==false;}.bind(this));return this;}
getTableau(aFunction){const T=[];if(!aFunction||!MethodesObjet.isFunction(aFunction)){return T;}
this.ListeElements.forEach(function(aElement,aIndex){T.push(aFunction(aElement,aIndex));});return T;}
removeFilter(aFilter){if(aFilter&&MethodesObjet.isFunction(aFilter)){const lTab=[];this.ListeElements.forEach(function(aElement,aIndex){if(aFilter(aElement,aIndex)!==true){lTab.push(aElement);}});this.ListeElements=lTab;}
return this;}
getTableauLibelles(aGenre,aTrier,aAvecExiste){const T=[];if(aTrier){this.trier();}
for(let I=0;I<this.ListeElements.length;I++){if((aGenre===null||aGenre===undefined)||($.isNumeric(aGenre)&&aGenre===this.GetGenre(I))||($.isArray(aGenre)&&$.inArray(this.GetGenre(I),aGenre)> -1)){if(!aAvecExiste||this.Existe(I)){T.push(this.GetLibelle(I));}}}
return T;}
getTableauNumeros(aAvecExiste){const T=[];for(let I=0;I<this.ListeElements.length;I++){if(!aAvecExiste||this.Existe(I)){T.push(this.GetNumero(I));}}
return T;}
getTableauGenres(){const T=[];for(let I=0;I<this.ListeElements.length;I++){T.push(this.GetGenre(I));}
return T;}
getTableauPositions(){const T=[];for(let I=0;I<this.ListeElements.length;I++){T.push(this.GetPosition(I));}
return T;}
getCle(){return this.getTableauNumeros().sort().join('_');}
GetElement(I){return this.ListeElements[I];}
getListeElements(aFiltre){const lListe=new ObjetListeElements();for(let I=0;I<this.ListeElements.length;I++){if(!aFiltre||aFiltre(this.ListeElements[I],I)){lListe.AddElement(this.ListeElements[I]);}}
return lListe;}
getIndiceElementParFiltre(aFiltre){let lResult= -1;for(let I=0;I<this.ListeElements.length&&lResult<0;I++){if(!aFiltre||aFiltre(this.ListeElements[I])){lResult=I;}}
return lResult;}
GetElementParNumero(ANumero){for(let I=0,lNb=this.GetNbrElements();I<lNb;I++){if(this.Existe(I)&&(this.GetNumero(I)===ANumero)){return this.GetElement(I);}}}
getListeElementsParNumero(aNumero){const lListe=new ObjetListeElements();this.parcourir(function(aElement){if(aElement&&aElement.Existe()&&(aElement.GetNumero()===aNumero)){lListe.AddElement(aElement);}}.bind(this));return lListe;}
GetElementParGenre(aGenre){for(let I=0,lNb=this.GetNbrElements();I<lNb;I++){if(this.Existe(I)&&(this.GetGenre(I)===aGenre)){return this.GetElement(I);}}}
GetNumero(I){return this.ListeElements[I].Numero;}
GetGenre(I){return this.ListeElements[I].Genre;}
GetLibelle(I){return this.ListeElements[I].Libelle;}
GetActif(I){return this.ListeElements[I].Actif;}
GetPosition(I){return this.ListeElements[I].Position;}
existeNumero(I){const N=this.GetNumero(I);return N&&(N!=='0')?true:false;}
Existe(I){return this.ListeElements[I].Existe();}
PourValidation(I){return this.ListeElements[I].PourValidation();}
SetLibelle(I,ALibelle){this.ListeElements[I].Libelle=ALibelle;}
TrierPourValidation(){ObjetTri.trierTableau(this.ListeElements,[ObjetTri.init('Etat')]);}
existeElementPourValidation(){for(let I=0,lNb=this.GetNbrElements();I<lNb;I++){if(this.PourValidation(I)){return true;}}
return false;}
setTri(aTableauTris){this._tris=aTableauTris;return this;}
getTri(){return this._tris;}
trier(aGenreTri){if(this.ListeElements){aGenreTri=aGenreTri===null||aGenreTri===undefined?EGenreTriElement.Croissant:aGenreTri;if(!this._tris){this.setTri([
ObjetTri.init('Position'),ObjetTri.init('Libelle')
]);}
const lTris=[].concat(this._tris);lTris.unshift(ObjetTri.init(function(aElement){return(aElement.Visible===false)||(aElement.Etat===EGenreEtat.Suppression);},aGenreTri));ObjetTri.trierTableau(this.ListeElements,lTris);if(aGenreTri===EGenreTriElement.Decroissant){this.ListeElements.reverse();}}
return this;}
GetIndiceParNumeroEtGenre(ANumero,AGenre,aAvecExiste){if(this.ListeElements&&(((ANumero!==null&&ANumero!==undefined))||((AGenre!==null&&AGenre!==undefined)))){const N=this.GetNbrElements();for(let I=0;I<N;I++){const lElement=this.ListeElements[I];if(lElement&&lElement.egalParNumeroEtGenre(ANumero,AGenre,aAvecExiste)){return I;}}}}
GetIndiceExisteParNumeroEtGenre(ANumero,AGenre){if(this.ListeElements&&(((ANumero!==null&&ANumero!==undefined))||((AGenre!==null&&AGenre!==undefined)))){const N=this.GetNbrElements();let J= -1;for(let I=0;I<N;I++){if(this.Existe(I)){J++;if(((ANumero===null||ANumero===undefined)||(this.GetNumero(I)===ANumero))&&((AGenre===null||AGenre===undefined)||(this.GetGenre(I)===AGenre))){return J;}}}}}
GetElementParNumeroEtGenre(ANumero,AGenre,aAvecExiste){return this.GetElement(this.GetIndiceParNumeroEtGenre(ANumero,AGenre,aAvecExiste));}
GetIndiceParElement(aElement,aAvecExiste){return aElement?this.GetIndiceParNumeroEtGenre(aElement.GetNumero(),aElement.GetGenre(),aAvecExiste):null;}
GetIndiceExisteParElement(aElement){return this.GetIndiceExisteParNumeroEtGenre(aElement.GetNumero(),aElement.GetGenre());}
GetElementParElement(aElement,aAvecExiste){return this.GetElement(this.GetIndiceParElement(aElement,aAvecExiste));}
GetIndiceParLibelle(ALibelle){if(this.ListeElements){const N=this.GetNbrElements();for(let I=0;I<N;I++){if(this.GetLibelle(I)===ALibelle){return I;}}}}
getIndiceParParsingLibelle(aLibelle){if(!this.ListeElements){return-1;}
if(!aLibelle||aLibelle.length===0||!MethodesObjet.isString(aLibelle)){return 0;}
const N=this.GetNbrElements();let lIndice=0;for(let I=0;I<N;I++){const lLibelle=this.GetLibelle(I);if(ComparateurChaines.compare(lLibelle,aLibelle)<0){lIndice++;} else{break;}}
return lIndice>=N?lIndice-1:lIndice;}
GetElementParLibelle(ALibelle){return this.GetElement(this.GetIndiceParLibelle(ALibelle));}
GetPremierElement(){let lResult=null;for(let i=0,lNb=this.GetNbrElements();i<lNb&&!lResult;i++){if(this.Existe(i)){lResult=this.GetElement(i);}}
return lResult;}
FusionnerListe(AListeElements,APere,AFaireCeQuIlFaut){if(AListeElements){const LNbrElts=AListeElements.GetNbrElements();for(let I=0;I<LNbrElts;I++){let LRetour=true;if(APere&&AFaireCeQuIlFaut){LRetour=AFaireCeQuIlFaut.call(APere,AListeElements.GetElement(I));}
if(LRetour){this.AddElement(AListeElements.GetElement(I));}}}
return this;}
listeIdentiqueParElementsOrdonnes(aListeElements){if(!aListeElements||!aListeElements.GetNbrElements){return false;}
if(this.GetNbrElements()!==aListeElements.GetNbrElements()){return false;}
let lResult=true;this.parcourir(function(aElement,aIndice){const lIndice=aListeElements.GetIndiceParElement(aElement);if(lIndice!==aIndice){lResult=false;return false;}});return lResult;}
setSerialisateurJSON(aSerialisateur){this.serialisateurJSON={ignorerEtatsElements:false,methodeSerialisation:null,nePasTrierPourValidation:false};Object.assign(this.serialisateurJSON,aSerialisateur);return this;}
toJSON(){let I,lNb,lElement,lJSONElement,lGarderElement,lExisteElement,lAvecSerialisation=this.serialisateurJSON&&this.serialisateurJSON.methodeSerialisation,lResult=[],lListe=new ObjetListeElements();lListe.FusionnerListe(this);if(!this.serialisateurJSON||!this.serialisateurJSON.nePasTrierPourValidation){lListe.TrierPourValidation();}
for(I=0,lNb=lListe.GetNbrElements();I<lNb;I++){lElement=lListe.GetElement(I);if(lElement){lExisteElement=(this.serialisateurJSON&&this.serialisateurJSON.ignorerEtatsElements)||lElement.PourValidation();lJSONElement=null;if(lExisteElement||lAvecSerialisation){lJSONElement=lElement.toJSON();if(lAvecSerialisation){lGarderElement=this.serialisateurJSON.methodeSerialisation(lElement,lJSONElement,I);lExisteElement=lGarderElement===null||lGarderElement===undefined?lExisteElement:lGarderElement;}}
if(lExisteElement&&lJSONElement){lResult.push(lJSONElement);}}}
return lResult;}
fromJSON(aJSON,aMethodeDeserialisation,aTrier){if(!aJSON||!MethodesObjet.isArray(aJSON)){return this;}
for(let i=0,lNb=aJSON.length;i<lNb;i++){const lElement=new ObjetElement().fromJSON(aJSON[i]);if(!aMethodeDeserialisation||(aMethodeDeserialisation(aJSON[i],lElement,i)!==false)){this.AddElement(lElement);}}
if(aTrier){this.trier();}
return this;}}
module.exports=ObjetListeElements;},fn:"objetlisteelements.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeHttpVariable={TypeHttpCategorie:0,TypeHttpCardinal:1,TypeHttpBoolean:2,TypeHttpString:3,TypeHttpColor:4,TypeHttpAlignment_Inutilise:5,TypeHttpFontStyles_Inutilise:6,TypeHttpDateTime:7,TypeHttpDomaine:8,TypeHttpTraduction:9,TypeHttpNote:10,TypeHttpEnsembleCardinal:11,_TypeHttpLongNote_Inutilise:12,TypeHttpDouble:13,TypeHttpArrondi:14,TypeHttpEnsemble:15,TypeHttpIP:16,TypeHttpUrl:17,TypeHttpSetOf_MrFiche:18,_TypeHttpDoubleNote_Inutilise:19,TypeHttpInteger:20,TypeHttpHtml:21,_TypeHttpJSON_Inutilise:22,TypeHttpChaineBrute:23,TypeHttpElement:24,TypeHttpFichierBase64:25,TypeHttpEnsembleNombre:26};module.exports.TypeHttpVariable=TypeHttpVariable;},fn:"typehttpvariable.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const TypeChampsJSON=require('Enumere_ChampsJSON.js');const ObjetElement=require('ObjetElement.js');const TypeHttpVariable=require('TypeHttpVariable.js').TypeHttpVariable;class TypeDomaine{constructor(AValeurParDefaut,ANombreValeurs){this.valeurSemaine={plein:'1',vide:'0'};this.nombreValeurs=ANombreValeurs?ANombreValeurs:TypeDomaine.C_MaxDomaineCycle;AValeurParDefaut=(AValeurParDefaut===null)||AValeurParDefaut===undefined||(AValeurParDefaut==='')?'[]':AValeurParDefaut;this.Domaine=_getDomaine.call(this,AValeurParDefaut,this.nombreValeurs);this.cache={};}
strToDomaine(aChaine,aNombreValeurs){if(!((aChaine.charAt(0)==='[')&&(aChaine.charAt(aChaine.length-1)===']'))){const lTab=aChaine.split('');if(aNombreValeurs!==null&&aNombreValeurs>=0){lTab.length=aNombreValeurs;}
return lTab;}
aChaine=aChaine.substring(1,aChaine.length-1);const R=new Array(aNombreValeurs!==TypeDomaine.CTailleOuverte?aNombreValeurs:0);const T1=aChaine.split(',');for(let I=0;I<T1.length;I++){const T2=T1[I].split('..');const V1=parseInt(T2[0]);const V2=parseInt(T2.length===1?V1:T2[1]);for(let J=V1;J<=V2;J++){R[J-1]=this.valeurSemaine.plein;}}
if(this.nombreValeurs!==TypeDomaine.CTailleOuverte){this.nombreValeurs=R.length;}
return R;}
toString(){let S='',N=0;for(let I=0;I<=this.Domaine.length;I++){if(this.Domaine[I]==='1'){N++;} else if(N>0){if(S.length){S+=',';}
if(N>1){S+=(I+1-N)+'..';}
S+=(I);N=0;}}
return'['+S+']';}
Vider(){this.cache={};this.SetValeur(false,1,this.GetTaille());return this;}
EstVide(){return this.GetNbrValeurs(true)===0;}
SetValeur(AValeur,ADeb,AFin){if((ADeb>this.GetTaille())&&(this.nombreValeurs!==TypeDomaine.CTailleOuverte)){return;}
this.cache={};if(this.nombreValeurs!==TypeDomaine.CTailleOuverte){ADeb=Math.borner(ADeb,1,this.GetTaille());AFin=Math.borner(AFin===null||AFin===undefined?ADeb:AFin,1,this.GetTaille());} else{ADeb=Math.max(ADeb,1);AFin=AFin===null||AFin===undefined?ADeb:Math.max(ADeb,AFin);}
for(let I=ADeb-1;I<AFin;I++){this.Domaine[I]=AValeur?this.valeurSemaine.plein:this.valeurSemaine.vide;}
return this;}
GetValeur(APos){return this.Domaine[APos-1]===this.valeurSemaine.plein;}
GetPremierePosition(aValeur){for(let I=0;I<this.Domaine.length;I++){const lValeur=this.Domaine[I]===null||this.Domaine[I]===undefined?this.valeurSemaine.vide:this.Domaine[I];if(lValeur===(aValeur===false?this.valeurSemaine.vide:this.valeurSemaine.plein)){return I+1;}}
return-1;}
enListeDomainesContinues(){const ObjetListeElements=require('ObjetListeElements.js');const lResult=new ObjetListeElements();let lValeurPrecedente;let lPeriode=new ObjetElement('');for(let I=0;I<this.Domaine.length;I++){const lValeur=this.Domaine[I]===null||this.Domaine[I]===undefined?this.valeurSemaine.vide:this.Domaine[I];if(lValeur===(this.valeurSemaine.plein)){if(lPeriode.debut===undefined){lPeriode.debut=I+1;}
if(lValeurPrecedente===this.valeurSemaine.plein||lPeriode.fin===undefined){lPeriode.fin=I+1;}} else{if(lPeriode.debut!==undefined){lResult.AddElement(lPeriode);}
lPeriode=new ObjetElement('');}
lValeurPrecedente=lValeur;}
if(lPeriode.debut!==undefined){lResult.AddElement(lPeriode);}
return lResult;}
GetDernierePosition(aValeur){for(let I=this.Domaine.length-1;I>=0;I--){const lValeur=this.Domaine[I]===null||this.Domaine[I]===undefined?this.valeurSemaine.vide:this.Domaine[I];if(lValeur===(aValeur===false?this.valeurSemaine.vide:this.valeurSemaine.plein)){return I+1;}}
return-1;}
GetNbrValeurs(AValeur){let N=0;const LValeur=AValeur||(AValeur===null)||AValeur===undefined?this.valeurSemaine.plein:this.valeurSemaine.vide;if(this.cache['GetNbrValeurs_'+LValeur]!==undefined){return this.cache['GetNbrValeurs_'+LValeur];}
for(let I=0;I<this.Domaine.length;I++){if(this.Domaine[I]===LValeur){N++;}}
this.cache['GetNbrValeurs_'+LValeur]=N;return N;}
EstUnNombre(){return this.GetNbrValeurs(true)<=1;}
getNombre(){return this.GetNbrValeurs(true)===1?this.GetPremierePosition(true):0;}
GetTaille(){return this.Domaine.length;}
GetIntersection(aDomaine){if(!aDomaine){return MethodesObjet.dupliquer(this);}
const lTaille=Math.min(this.GetTaille(),aDomaine.GetTaille());const lIntersect=new TypeDomaine(null,lTaille);for(let I=1;I<=lTaille;I++){if(this.GetValeur(I)&&aDomaine.GetValeur(I)){lIntersect.SetValeur(true,I);}}
return lIntersect;}
getInversion(){const lTaille=this.GetTaille();const lInversion=new TypeDomaine(null,lTaille);for(let I=1;I<=lTaille;I++){lInversion.SetValeur(!this.GetValeur(I),I);}
return lInversion;}
getDomaineSoustraction(aDomaineASoustraire){const lDomaine=MethodesObjet.dupliquer(this);if(!aDomaineASoustraire||!aDomaineASoustraire.GetTaille||!aDomaineASoustraire.GetValeur){return lDomaine;}
for(let I=1,lTaille=aDomaineASoustraire.GetTaille();I<=lTaille;I++){if(aDomaineASoustraire.GetValeur(I)){lDomaine.SetValeur(false,I);}}
return lDomaine;}
getDomaineUnion(aDomaineAAjouter){const lDomaine=MethodesObjet.dupliquer(this);if(!aDomaineAAjouter){return lDomaine;}
for(let I=1,lTaille=aDomaineAAjouter.GetTaille();I<=lTaille;I++){if(aDomaineAAjouter.GetValeur(I)){lDomaine.SetValeur(true,I);}}
return lDomaine;}
egal(aDomaine){if(!aDomaine||!aDomaine.GetTaille||!aDomaine.GetValeur){return false;}
for(let I=1,lTaille=this.GetTaille();I<=lTaille;I++){if(this.GetValeur(I)!==aDomaine.GetValeur(I)){return false;}}
return true;}
getSemaines(){if(this.cache['getSemaines']!==undefined){return this.cache['getSemaines'];}
const lTaille=this.GetTaille();const lSemaines=[];for(let I=1;I<=lTaille;I++){if(this.GetValeur(I)){lSemaines.push(I);}}
this.cache['getSemaines']=lSemaines;return lSemaines;}
dupliquer(){const lDomaine=new TypeDomaine(null,this.nombreValeurs);lDomaine.Domaine=[].concat(this.Domaine);return lDomaine;}
toJSON(){const lJSON={};lJSON[TypeChampsJSON.type]=TypeHttpVariable.TypeHttpDomaine;lJSON[TypeChampsJSON.valeur]=this.toString();return lJSON;}}
TypeDomaine.CTailleOuverte= -1;TypeDomaine.C_MaxDomaineCycle=62;function _getDomaine(AValeurParDefaut,ANombreValeurs){const lType=typeof(AValeurParDefaut);let D;if((lType!=='objet')&&(lType!=='string')){D=new Array(1+(ANombreValeurs===null||ANombreValeurs===undefined?TypeDomaine.C_MaxDomaineCycle:ANombreValeurs)).join((lType==='boolean')&&AValeurParDefaut?this.valeurSemaine.plein:this.valeurSemaine.vide).split('');}
switch(lType){case'number':D[AValeurParDefaut-1]=this.valeurSemaine.plein;return D;case'objet':return AValeurParDefaut;case'string':return this.strToDomaine(AValeurParDefaut,ANombreValeurs);case'boolean':return D;default:return D;}}
module.exports=TypeDomaine;},fn:"typedomaine.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreDocumentJoint={Url:0,Fichier:1,Cloud:2,LienKiosque:3,LienVisio:4};module.exports=EGenreDocumentJoint;},fn:"enumere_documentjoint.js"});;
IE.fModule({f:function(exports,require,module,global){const EFormatDocJoint={Inconnu:0,Texte:1,Pdf:2,Excel:3,Archive:4,Image:5,Son:6,Video:7,Diapo:8,Geogebra:9};EFormatDocJoint.getClassImgDeGenre=function(aGenre){switch(aGenre){case EFormatDocJoint.Texte:return'Image_FormatTexte';case EFormatDocJoint.Pdf:return'Image_FormatPDF';case EFormatDocJoint.Excel:return'Image_FormatExcel';case EFormatDocJoint.Archive:return'Image_FormatArch';case EFormatDocJoint.Image:return'Image_FormatImg';case EFormatDocJoint.Son:return'Image_FormatSon';case EFormatDocJoint.Video:return'Image_FormatVideo';case EFormatDocJoint.Diapo:return'Image_FormatPPT';case EFormatDocJoint.Geogebra:return'Image_FormatGGB';default:return'Image_FormatInconnu';}};EFormatDocJoint.getGenreDExtension=function(aParam){switch(aParam.ext){case'doc':case'docx':case'txt':return EFormatDocJoint.Texte;case'pdf':return EFormatDocJoint.Pdf;case'gzip':case'zip':case'rar':return EFormatDocJoint.Archive;case'xls':case'xlsx':return EFormatDocJoint.Excel;case'png':case'mng':case'tiff':case'jpeg':case'gif':case'jpg':return EFormatDocJoint.Image;case'mp3':case'ogg':case'wav':return EFormatDocJoint.Son;case'mp4':case'mpeg':case'avi':return EFormatDocJoint.Video;case'ppt':case'pptx':return EFormatDocJoint.Diapo;case'ggb':return EFormatDocJoint.Geogebra;default:return EFormatDocJoint.Inconnu;}};EFormatDocJoint.getClassIconDeGenre=function(aGenre){switch(aGenre){case EFormatDocJoint.Texte:return'icon_fichier_word';case EFormatDocJoint.Pdf:return'icon_uniF1C1';case EFormatDocJoint.Excel:return'icon_fichier_excel';case EFormatDocJoint.Archive:return'icon_fichier_zip';case EFormatDocJoint.Image:return'icon_fichier_image';case EFormatDocJoint.Son:return'icon_fichier_audio';case EFormatDocJoint.Video:return'icon_fichier_video';case EFormatDocJoint.Diapo:return'icon_fichier_powerpoint';case EFormatDocJoint.Geogebra:return'icon_file_text_alt';default:return'icon_file_alt';}};EFormatDocJoint.getGenreDeFichier=function(aExtension){if(aExtension!==''){return EFormatDocJoint.getGenreDExtension({ext:aExtension.toLowerCase()});} else{return EFormatDocJoint.Inconnu;}};module.exports=EFormatDocJoint;},fn:"enumere_formatdocjoint.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const GLog=require('IELog.js');function UtilitaireCss(){}
let uCacheReglesCss=null;let uCacheCss=null;const uTailleMaxCacheCss=50;function _trouverSelecteur(aSelecteursTexte,aNomRegleCss){if(aSelecteursTexte&&aSelecteursTexte.join){for(let i=0;i<aSelecteursTexte.length;i++){if(aSelecteursTexte[i]===aNomRegleCss){return true;}}}
return false;}
function _remplirCacheReglesCss(){let lStyleSheet,lRules,lRegles,lRegle,lSelecteurTexte;uCacheReglesCss=[];for(let I=document.styleSheets.length-1;I>=0;I--){lStyleSheet=document.styleSheets[I];if(lStyleSheet&&lStyleSheet.href){try{lRules=lStyleSheet.cssRules||lStyleSheet.rules;} catch(e){lRules=null;GLog.addLog('lecture cssRules : exception=> '+e);}
if(lRules){lRegles=[];uCacheReglesCss.push(lRegles);for(let J=0;J<lRules.length;J++){try{lSelecteurTexte=lRules[J].selectorText;} catch(e){GLog.addLog(e);}
lRegle={selecteurs:[],regle:lRules[J]};if(lSelecteurTexte&&lSelecteurTexte.split){const lTabSelector=lSelecteurTexte.split(',');if(lTabSelector){for(let i=0;i<lTabSelector.length;i++){lRegle.selecteurs.push(lTabSelector[i]&&lTabSelector[i].trim&&(lTabSelector[i].trim().toLowerCase().replace(/'/g,'"')));}}}
lRegles.push(lRegle);}}}}}
function _chercherReglesCss(aNomRegleCss){let lRules,lRegle,lProp;if(!aNomRegleCss||!MethodesObjet.isString(aNomRegleCss)){return null;}
aNomRegleCss=aNomRegleCss.toLowerCase();if(!uCacheReglesCss){_remplirCacheReglesCss();}
if(uCacheCss&&uCacheCss[aNomRegleCss]){return uCacheCss[aNomRegleCss];}
const lRegles=[];try{aNomRegleCss=aNomRegleCss.trim().toLowerCase().replace(/'/g,'"');for(let I=uCacheReglesCss.length-1;I>=0;I--){lRules=uCacheReglesCss[I];if(lRules){for(let J=lRules.length-1;J>=0;J--){lRegle=lRules[J];if(lRegle){if(_trouverSelecteur(lRegle.selecteurs,aNomRegleCss)){lRegles.push(lRegle.regle);}}}}}
if(lRegles.length>0){if(!uCacheCss){uCacheCss=[];}
if(uCacheCss.length>=uTailleMaxCacheCss){for(lProp in uCacheCss){delete uCacheCss[lProp];break;}}
uCacheCss[aNomRegleCss]=lRegles;return lRegles;} else{return null;}} catch(e){GLog.addLog('lecture cssRules : exception=> '+e);}}
function _convertirProprieteCSS(aProprieteCSS){const lTab=aProprieteCSS.split('-');for(let i=1;i<lTab.length;i++){lTab[i]=lTab[i].ucfirst();}
return lTab.join('');}
function _modifierProprieteCSS(aRule,aProprieteCSS,aValeur){try{if(aRule&&aRule.style){if(aRule.style.setProperty){aRule.style.setProperty(aProprieteCSS,aValeur,null);} else{aProprieteCSS=_convertirProprieteCSS(aProprieteCSS);if(!MethodesObjet.isUndefined(aRule.style[aProprieteCSS])){aRule.style[aProprieteCSS]=aValeur;}}}} catch(e){return false;}
return true;}
function _getRegleQuiDefinitProprieteCSS(aTabRegles,aProprieteCSS){if(!aTabRegles){return null;}
let lAttribut;for(let i=0;i<aTabRegles.length;i++){const lRegle=aTabRegles[i];if(lRegle&&lRegle.style){aProprieteCSS=_convertirProprieteCSS(aProprieteCSS);lAttribut=lRegle.style[aProprieteCSS];if(((lAttribut!==null&&lAttribut!==undefined))&&(lAttribut!=='')){return lRegle;}}}
return null;}
UtilitaireCss.modifierRegleCss=function(aNomRegleCss,aProprieteCSS,aValeur){const lRegles=_chercherReglesCss(aNomRegleCss);if(!lRegles){return false;}
let lRegleAModifier=_getRegleQuiDefinitProprieteCSS(lRegles,aProprieteCSS);if(lRegleAModifier===null||lRegleAModifier===undefined){lRegleAModifier=lRegles[0];}
return _modifierProprieteCSS(lRegleAModifier,aProprieteCSS,aValeur);};UtilitaireCss.chercherAttributReglesCss=function(aNomRegleCss,aAttribut){const lRegles=_chercherReglesCss(aNomRegleCss,false);if(!lRegles){return false;}
let lAttribut;for(let i=0;i<lRegles.length;i++){if(lRegles[i]&&lRegles[i].style){lAttribut=lRegles[i].style[aAttribut];if(((lAttribut!==null&&lAttribut!==undefined))&&(lAttribut!=='')){return lRegles[i].style[aAttribut];}}}
return false;};UtilitaireCss.extraireUrlReglesCss=function(aNomRegleCss){const lUrl=UtilitaireCss.chercherAttributReglesCss(aNomRegleCss,'backgroundImage');if(!lUrl||(lUrl.length===0)){return'';}
let lTab=lUrl.split('"');lTab=lTab[1];if(!lTab){lTab=lUrl.split("'");lTab=lTab[1];}
if(!lTab){lTab=lUrl.split('(');lTab=lTab[1];if(!lTab){return'';}
lTab=lTab.split(')');lTab=lTab[0];}
if(!lTab){return'';}
lTab=lTab.split('/');const lTab2=[];for(let j=0;j<lTab.length;j++){if(lTab[j]!=='..'){lTab2.push(lTab[j]);}}
return lTab2.join('/');};module.exports=UtilitaireCss;},fn:"utilitairecss.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');let u_collection={br:{autoFermante:true},input:{autoFermante:true},img:{autoFermante:true}};const tag=function(aBalise,...aParams){let lNomBalise=aBalise;if(!lNomBalise||!lNomBalise.trim){return'';}
lNomBalise=lNomBalise.trim();if(!lNomBalise){return'';}
const T=['<',lNomBalise];const lArgs=aParams;const lAttrs=lArgs[0];let lInner='';if(lAttrs&&MethodesObjet.isObject(lAttrs)){T.push(_attrsToString(lAttrs));lArgs.shift();}
if(lArgs.length>0){lArgs.forEach(function(aVal){let lInnerArg=aVal;if(lInnerArg&&MethodesObjet.isFunction(lInnerArg)){const lTabInner=[];lInnerArg=lInnerArg(lTabInner);if(lTabInner.length>0){lInnerArg=lTabInner.join('');}}
if(lInnerArg===0){lInnerArg=lInnerArg+'';}
if(lInnerArg){lInner+=lInnerArg;}});}
if(!lInner&&
u_collection[lNomBalise]&&
u_collection[lNomBalise].autoFermante){T.push(' />');} else{T.push('>');if(lInner){T.push(lInner);}
T.push('</',lNomBalise,'>');}
return T.join('');};function _attrsToString(aAttrs){if(aAttrs&&MethodesObjet.isString(aAttrs)){return aAttrs;}
if(aAttrs&&MethodesObjet.isObject(aAttrs)){const T=[];Object.keys(aAttrs).forEach(function(aKey){let lVal=aAttrs[aKey];if(lVal&&Array.isArray(lVal)){if(aKey==='class'){const lTab=[];lVal.forEach(function(aVal){const lVal=aVal&&aVal.trim?aVal.trim():'';if(lVal){lTab.push(lVal);}});lVal=lTab.join(' ');} else if(aKey==='style'){lVal=lVal.map(function(aVal){let lVal=aVal&&aVal.trim?aVal.trim():'';if(lVal&&lVal.length>0){if(lVal[lVal.length-1]!==';'){lVal+=';';}}
return lVal;}).join(' ').trim();} else{lVal=lVal.join(' ');}}
if(lVal&&lVal.trim&&lVal.trim()===''){return;}
;if(lVal===0||lVal>0||lVal===true||(lVal&&lVal.trim)){T.push(tag.composeAttr(aKey,lVal===true?'':lVal).trimEnd());}});return T.join('');}
return'';}
tag.toArg=function(aArgs){let lArray=aArgs;if(!Array.isArray(lArray)){lArray=[aArgs];}
let lArg='';const lTab=[];for(let i=0;i<lArray.length;i++){lArg=lArray[i];if(lArg===null||lArg===undefined){lTab.push(lArg+'');} else if(MethodesObjet.isString(lArg)){lTab.push('\''+lArg+'\'');} else if(MethodesObjet.isObject(lArg)||MethodesObjet.isFunction(lArg)){lTab.push(null+'');} else{lTab.push(lArg);}}
return lTab.join(',').replace(/"/g,'&quot;');};tag.funcAttr=function(aNomFonction,aArgs){if(!aNomFonction||!aNomFonction.replace){return'';}
let lResult=aNomFonction;if(arguments.length>1){lResult+='('+tag.toArg(aArgs)+')';}
return lResult;};tag.composeAttr=function(aAttribut,aValue,aArgs){if(!aAttribut||!aAttribut.trim){return'';}
;let lAttribut=aAttribut.trim();if(!lAttribut){return'';}
lAttribut=' '+lAttribut;let lValue=aValue===0?aValue+'':aValue;if(!lValue||lValue===true){return lAttribut+' ';}
if(lValue.replace){lValue=lValue.replace(/"/g,'&quot;');if(aAttribut==='title'){lValue=lValue.replace(/\r\n/g,"&#010;").replace(/\n/g,"&#010;");}} else{if(!(lValue>0)){return lAttribut+' ';}
lValue=lValue+'';}
const lArgs=[lValue];if(arguments.length>2){lArgs.push(aArgs);}
return lAttribut+'="'+tag.funcAttr.apply(tag,lArgs)+'" ';};tag.styleToStr=function(aRule,aValue){if(!aRule||!aRule.trim){return'';}
if(!aValue&&aValue!==0){return'';}
return aRule+':'+aValue+(aValue.length>0&&aValue[aValue.length-1]===';'?'':';');};module.exports=tag;},fn:"tag.js"});;
IE.fModule({f:function(exports,require,module,global){require('divers.js');const GUID=require('GUID.js');const MethodesObjet=require('MethodesObjet.js');const TypeChampsJSON=require('Enumere_ChampsJSON.js');const EGenreDocumentJoint=require('Enumere_DocumentJoint.js');const ObjetElement=require('ObjetElement.js');const EGenreEtat=require('Enumere_Etat.js');const Support=require('ObjetSupport.js');const TypeHttpVariable=require('TypeHttpVariable.js').TypeHttpVariable;const EFormatDocJoint=require('Enumere_FormatDocJoint.js');const UtilitaireCss=require('UtilitaireCss.js');const ComparateurChaines=require('ComparateurChaines.js');const tag=require('tag.js');let GChaine;class _ObjetChaine{constructor(){this.ListeZeros='0000000000';this.ListeAvecAccents=['éèê','à'];this.ListeSansAccents=['e','a'];this.ListeExpAccents=[];for(let I=0;I<this.ListeAvecAccents.length;I++){this.ListeExpAccents[I]=new RegExp('['+this.ListeAvecAccents[I]+']','ig');}
this.LongueurCaracteres=new Array(30);for(let I=0;I<30;I++){this.LongueurCaracteres[I]=new Array(2);for(let J=0;J<2;J++){this.LongueurCaracteres[I][J]=[];}}
this.maskTelephone='99 99 99 99 99 99';this.regexURL=/(https?:\/\/|www\.)[^ \n,]+/gi;}
enleverChemin(aFichier){let N=aFichier.lastIndexOf('/');if(N=== -1){N=aFichier.lastIndexOf('\\');}
return aFichier.substring(N+1,aFichier.length);}
AvecEspaceSiVide(AChaine){return AChaine&&(AChaine.length>0)?AChaine:'&nbsp;';}
ToStringHtml(aChaine,aSansConversionSautDeLigne){const lSeperateur=aSansConversionSautDeLigne?"":"<br>";return aChaine.replace(/\n/g,lSeperateur);}
toTitle(aChaine){const lChaine=aChaine&&aChaine.toString?aChaine.toString():'';return lChaine&&lChaine.replace?lChaine.replace(/\r\n/g,"&#010;").replace(/\n/g,"&#010;").replace(/"/g,'&quot;'):'';}
StrToDate(ADate){ADate=ADate.split(' ');const LJour=ADate[0].split('/');const LHeure=ADate[1]?ADate[1].split(':'):[0,0,0];return new Date(LJour[2],LJour[1]-1,LJour[0],LHeure[0],LHeure[1],LHeure[2]);}
strToInteger(aInteger){return parseInt(aInteger,10);}
strToDouble(aDouble){return parseFloat(aDouble.replace(',','.'));}
StrToCardinal(ACardinal){return parseInt(ACardinal,10);}
StrToBoolean(ABoolean){return(ABoolean==='1')||(ABoolean.toUpperCase()==='TRUE')||(ABoolean.toUpperCase()==='VRAI');}
strToIp(aIP){const T=aIP.split('.');if(T.length!==4){return'';}
let lIp=0;let lValeur;for(let I=0;I<4;I++){lValeur=parseInt(T[I],10);if((lValeur<0)||(lValeur>255)){return 0;}
lIp=256*lIp+lValeur;}
return lIp;}
DateToStr(ADate){return ADate?ADate.getDate()+'/'+(ADate.getMonth()+1)+'/'+ADate.getFullYear()+' '+ADate.getHours()+':'+ADate.getMinutes()+':'+ADate.getSeconds():'';}
domaineToStr(aDomaine){return aDomaine?aDomaine.toString():'';}
doubleToStr(aDouble){return(''+aDouble).replace('.',',');}
ChaineToStr(AChaine){return!AChaine?'':AChaine;}
CardinalToStr(ACardinal){return''+ACardinal;}
ipToStr(aIp){aIp=parseInt(aIp,10);if(isNaN(aIp)){return'';}
const T=[];for(let I=4;I>0;I--){T[I-1]=(aIp%256);if(T[I-1]<0){T[I-1]+=256;}
aIp=Math.floor(aIp/256);}
return T.join('.');}
Format(aChaine,aTabElements){if(!aChaine||!aTabElements||!aTabElements.length||!MethodesObjet.isString(aChaine)){return aChaine;}
if(!aTabElements.map){aTabElements=[aTabElements];}
const lMapElements=aTabElements.map(function(aElement){if(MethodesObjet.isFunction(aElement)){try{return aElement();} catch(e){return'';}}
return aElement;});const lFuncSubst=function(aSubst,aCarSuiv){let lSubst=aSubst;if(aCarSuiv==='d'){lSubst=parseInt(lSubst);if(isNaN(lSubst)){lSubst=''
;}}
return lSubst;};let lIndex=0;let lStrResult='';let lCar;let lCarSuiv;let lIndexSubsSansNumero=0;let lDieseEnCours=false;let lStrPourcentEnCours='';let lStrNumeroSubst='';let lNumeroSubst;const lRegNumber=new RegExp('[0-9]');const lRegExType=new RegExp('(s|d|e|f|g|n|m)');while(lIndex<aChaine.length){lCar=aChaine[lIndex];lCarSuiv=aChaine[lIndex+1];if(lStrPourcentEnCours){if(lCarSuiv&&lCar===':'&&lCarSuiv.match(lRegExType)){lNumeroSubst=parseInt(lStrPourcentEnCours)
;if(lNumeroSubst<lMapElements.length){lStrResult+=lFuncSubst(lMapElements[lNumeroSubst],lCarSuiv);}
lIndex+=1;lStrPourcentEnCours='';} else if(lCarSuiv&&lCarSuiv.match(lRegNumber)){lStrPourcentEnCours+=lCarSuiv;} else{lStrResult+='%'+lStrPourcentEnCours+lCar;lStrPourcentEnCours='';}} else if(lDieseEnCours){lStrNumeroSubst+=lCar;if(!lCarSuiv||!lCarSuiv.match(lRegNumber)){lDieseEnCours=false;lNumeroSubst=parseInt(lStrNumeroSubst)-1
;if(lNumeroSubst<lMapElements.length){lStrResult+=lMapElements[lNumeroSubst];}
lStrNumeroSubst='';}} else{switch(lCar){case'#':if(lCarSuiv.match(lRegNumber)){lDieseEnCours=true;}
break;case'%':if(lCarSuiv==='s'||lCarSuiv==='d'){lIndex+=1
;if(lIndexSubsSansNumero<lMapElements.length){lStrResult+=lFuncSubst(lMapElements[lIndexSubsSansNumero],lCarSuiv);}
lIndexSubsSansNumero+=1;} else if(lCarSuiv.match(lRegNumber)){lStrPourcentEnCours=lCarSuiv;lIndex+=1;} else{lStrResult+=lCar;}
break;default:lStrResult+=lCar;}}
lIndex+=1;}
return lStrResult;}
tailleOctetsToStr(aTailleEnOctets){const GTraductions=_ObjetChaine.GTraductions;if(aTailleEnOctets<0||!MethodesObjet.isNumber(aTailleEnOctets)){return`0 ${GTraductions.getValeur('unite.Ko')}`;}
const lUnit=1024;let lFixed=0;let lVal=aTailleEnOctets;let lUnite=GTraductions.getValeur('unite.O');if(lVal===0){lUnite=GTraductions.getValeur('unite.Ko');} else if(lVal>lUnit){lUnite=GTraductions.getValeur('unite.Ko');lVal=lVal/lUnit;lFixed=1;if(lVal>lUnit){lUnite=GTraductions.getValeur('unite.Mo');lVal=lVal/lUnit;lFixed=2;if(lVal>lUnit){lUnite=GTraductions.getValeur('unite.Go');lVal=lVal/lUnit;}}}
return`${this.doubleToStr(lVal.toFixed(lFixed))} ${lUnite}`;}
Insecable(AChaine){try{return AChaine?AChaine.replace(/ /g,"&nbsp;").replace(/-/g,"&#x2011;"):'';} catch(e){return'';}}
formatTelephone(aChaine,aOptions){if(!aChaine||!aChaine.trim){return'';}
const lOptions=Object.assign({mask:'',avecTailleMask:true},aOptions);let lMask=lOptions.mask||this.maskTelephone;const lChaine=aChaine.trim().replace(/([^0-9\s])/g,'');lMask=_reverseString(lMask.replace(/([^9\s])/g,''));const lLengthCharMask=lMask.replace(/([^9])/g,'').length;const lNumeroSansEspace=lChaine.replace(/([^0-9])/g,'');const lEcart=Math.max(0,lNumeroSansEspace.length-lLengthCharMask);let lPartieDroite=lNumeroSansEspace.slice(lEcart,lNumeroSansEspace.length);let lPartieGaucheIntacte='';let lPartieGauche;let lResult;lPartieDroite=_reverseString(lPartieDroite);let lIndice= -1;lResult=lMask.replace(/9/g,function(){lIndice+=1;return lPartieDroite[lIndice]||'';});if(!lOptions.avecTailleMask){lPartieGauche=lNumeroSansEspace.slice(0,lEcart);lIndice=0;for(let i=0;i<lChaine.length;i++){if(lChaine.charAt(i)===' '){lPartieGaucheIntacte+=' ';} else{lPartieGaucheIntacte+=lPartieGauche.charAt(lIndice);lIndice+=1;if(lIndice>=lPartieGauche.length){break;}}}}
return(lPartieGaucheIntacte+_reverseString(lResult)).trim();}
formatTelephoneAvecIndicatif(aIndicatif,aNumeroTel){const lIndicatif=(aIndicatif?'+'+aIndicatif:'');if(!!aIndicatif&&aNumeroTel.length===10&&aNumeroTel.startsWith('0')){aNumeroTel=aNumeroTel.slice(1);}
return lIndicatif+aNumeroTel;}
_getConteneurCalculChaine(){const ldLongueurChaineEnPixel='LongueurChaineEnPixel';let E=document.getElementById(ldLongueurChaineEnPixel);if(!E){let lConteneur=document.body;if(global.GApplication){lConteneur=document.getElementById(GApplication.getIdConteneur())||document.body;}
lConteneur.insertAdjacentHTML('beforeend','<div id="'+ldLongueurChaineEnPixel+'" class="Texte10 hide" style="position:absolute; top:-50px; white-space:pre;"></div>');E=document.getElementById(ldLongueurChaineEnPixel);}
if(E){return E;}
;return null;}
GetLongueurChaineDansDiv(AChaine,ATaille,AGras,aNonToTexte){if(!AChaine){return 0;}
if(!ATaille){ATaille=10;}
if(!this.__cacheCanvas){this.__cacheCanvas=Support.supportCanvasText&&UtilitaireCss.chercherAttributReglesCss?{canvas:document.createElement("canvas"),fontFamily:global.getComputedStyle(document.body).getPropertyValue('font-family'),fontSize:{}}:{};this.__cacheCanvas.actif=!!this.__cacheCanvas.canvas&&
!!this.__cacheCanvas.fontFamily;if(!this.__cacheCanvas.actif){this.__cacheCanvas.canvas=null;}}
if(this.__cacheCanvas.actif){const lContext=this.__cacheCanvas.canvas.getContext("2d");if(!this.__cacheCanvas.fontSize[ATaille]){if(ATaille&&ATaille.endsWith&&ATaille.endsWith('rem')){this.__cacheCanvas.fontSize[ATaille]=_cacheCanvas_convertREMToPx.call(this,ATaille);} else if(ATaille&&ATaille.endsWith&&ATaille.endsWith('px')){this.__cacheCanvas.fontSize[ATaille]=ATaille;} else{let lVal=UtilitaireCss.chercherAttributReglesCss('.Texte'+ATaille,'fontSize');if(!lVal){lVal=Math.round(ATaille*1.1)+'px';} else if(lVal.endsWith&&lVal.endsWith('rem')){lVal=_cacheCanvas_convertREMToPx.call(this,lVal);}
this.__cacheCanvas.fontSize[ATaille]=lVal;}}
let lFontWeight='';if(AGras===true){lFontWeight='bold';} else if(AGras&&(MethodesObjet.isString(AGras)||MethodesObjet.isNumber(AGras))){lFontWeight=AGras;}
lContext.font=(lFontWeight?lFontWeight+' ':'')+this.__cacheCanvas.fontSize[ATaille]+' '+this.__cacheCanvas.fontFamily;const lMetrics=lContext.measureText(AChaine);return lMetrics.width;}
const E=this._getConteneurCalculChaine();if(!E){return 0;}
E.className='hide Texte'+ATaille+(AGras?' Gras':'');let lChaine=aNonToTexte===true?AChaine:this.ajouterEntites(AChaine);lChaine=lChaine&&lChaine.replace?lChaine.replace(/ /g,"&nbsp;"):lChaine;E.innerHTML=lChaine;const lLongueur=E.clientWidth;E.innerHTML='';return lLongueur;}
GetLongueurChaine(AChaine,ATaille,AGras,ALongueur,aChaineEnTexte){if(!AChaine){return'';}
const lChaine=this.enleverEntites(AChaine);let LLongueur=0;let I;const N=lChaine.length;if(lChaine.length>0){LLongueur=this.GetLongueurChaineDansDiv(lChaine,ATaille,AGras);}
if(ALongueur===null||ALongueur===undefined){return LLongueur;}
if(ALongueur>0&&LLongueur>=ALongueur){LLongueur=0;const G=AGras?1:0;for(I=0;(I<N)&&((ALongueur===null||ALongueur===undefined)||(LLongueur<ALongueur));I++){let C=lChaine.charCodeAt(I);let L=this.LongueurCaracteres[ATaille][G][C];if(!L){L=this.LongueurCaracteres[ATaille][G][C]=this.GetLongueurChaineDansDiv(lChaine.charAt(I),ATaille,AGras);}
LLongueur+=L===0?10:L;}}
if(LLongueur>=ALongueur){let lChaineTronque=lChaine.substring(0,I);if(lChaineTronque&&
lChaine!==lChaineTronque&&
LLongueur>0){LLongueur=this.GetLongueurChaineDansDiv(lChaineTronque,ATaille,AGras);}
if(LLongueur===0){return aChaineEnTexte?'':'<font style="font-size:1px">&nbsp;</font>';}
if(LLongueur>=ALongueur){lChaineTronque=lChaine.substring(0,I-1);while(I>2){if(this.GetLongueurChaineDansDiv(lChaineTronque,ATaille,AGras)<ALongueur){break;}
I--;lChaineTronque=lChaine.substring(0,I-1);}}
return this.ajouterEntites(lChaineTronque);}
return AChaine;}
GetChaine(AChaine,ATaille,AGras,ALongueur,aChaineEnTexte){return this.GetLongueurChaine(AChaine,ATaille,AGras,ALongueur,aChaineEnTexte);}
encoderComposantUrl(S){if(!MethodesObjet.isString(S)){return'';}
try{return encodeURIComponent(decodeURI(S).replace(_ObjetChaine.regexCarControl,''));} catch(e){return'';}}
encoderUrl(S){if(!MethodesObjet.isString(S)){return'';}
try{return encodeURI(decodeURI(S).replace(_ObjetChaine.regexCarControl,''));} catch(e){return'';}}
ToHTML(AChaine){return AChaine?AChaine.toHTML():'';}
fromHTML(AChaine){return AChaine?AChaine.replace(/<br( \/)?>/gi,'\n'):'';}
nodeToTextAvecRC(aNode){return aNode?(aNode.innerText||''):'';}
ajouterEntites(aChaine,aSansQuote){if(aChaine&&aChaine.ajouterEntites){return aChaine.ajouterEntites(aSansQuote);}
return aChaine;}
enleverEntites(aChaine){if(aChaine&&aChaine.enleverEntites){return aChaine.enleverEntites();}
return aChaine;}
nettoyerCommentaire(aChaine){return aChaine&&aChaine.replace?aChaine.replace(/(<!--)(.+)(-->)/g,''):aChaine;}
verifierURLHttp(aUrl){return aUrl?(aUrl.toLowerCase().indexOf('http://')===0)||(aUrl.toLowerCase().indexOf('https://')===0)?aUrl:'http://'+aUrl:aUrl;}
ajouterLiensURL(aTexte){if(!aTexte){aTexte='';}
const urlRegex=this.regexURL;return aTexte.replace(urlRegex,function(url){return'<a href="'+this.verifierURLHttp(url)+'" target="_blank">'+url+'</a>';}.bind(this));}
contientAuMoinsUneURL(aTexte){if(!aTexte){aTexte='';}
const lTexteAvecLiensURL=this.ajouterLiensURL(aTexte);return(aTexte!==lTexteAvecLiensURL);}
creerUrlBruteLienExterne(aDocumentJoint,aParam){if(!aDocumentJoint){return'';}
if(aDocumentJoint.Etat===EGenreEtat.Creation||!aDocumentJoint.existeNumero()){return'';}
if(!aParam){aParam={};}
let lUrl='';let lGenreDocumentJoint=aParam.genreDocumentJoint;if(!MethodesObjet.isNumber(lGenreDocumentJoint)){lGenreDocumentJoint=aDocumentJoint.GetGenre();}
let lLibelleLienExterne=aParam.libelle;if(!lLibelleLienExterne){lLibelleLienExterne=aDocumentJoint.GetLibelle();}
if(lGenreDocumentJoint===EGenreDocumentJoint.Url){lLibelleLienExterne='link';}
const lInfoFichier=new ObjetElement('',aDocumentJoint.GetNumero(),aParam.genreRessource);if(!!aParam.infoSupp){Object.assign(lInfoFichier,aParam.infoSupp);}
if(aParam.miniature!==null&&aParam.miniature!==undefined){Object.assign(lInfoFichier,{miniature:aParam.miniature});}
lUrl=GApplication.getCommunication().composeUrlFichierExterne(this.encoderComposantUrl(lLibelleLienExterne),lInfoFichier,true);if(aParam.forcerURLComplete){const lBalise=document.createElement('a');lBalise.href=lUrl;lUrl=lBalise.href;}
return lUrl;}
composerUrlLienExterne(aParam){const lParam={documentJoint:undefined,genreDocumentJoint:undefined,genreRessource:undefined,infoSupp:undefined,libelle:'',libelleEcran:undefined,ariaLabel:'',ariaLabelledby:'',avecAriaLabelledby:false,title:'',iconeOverride:'',afficherIconeDocument:true,avecLien:true,maxWidth:0,ieModelChips:null,ieChipsMinimal:false,argsIEModel:null,class:''};Object.assign(lParam,aParam);if(!MethodesObjet.isNumber(lParam.genreDocumentJoint)){lParam.genreDocumentJoint=lParam.documentJoint?lParam.documentJoint.GetGenre():EGenreDocumentJoint.Fichier;}
if(lParam.documentJoint&&(lParam.documentJoint.Etat===EGenreEtat.Creation||!lParam.documentJoint.existeNumero())){lParam.avecLien=false;}
if(lParam.genreDocumentJoint===EGenreDocumentJoint.Url&&!lParam.libelleEcran&&!lParam.libelle){if(lParam.documentJoint.GetLibelle()){lParam.libelleEcran=lParam.documentJoint.GetLibelle();} else{lParam.libelleEcran=lParam.documentJoint.url;lParam.avecAriaLabelledby=true;}
lParam.libelle='link';}
if(lParam.genreDocumentJoint===EGenreDocumentJoint.LienVisio&&!lParam.libelleEcran&&!lParam.libelle){lParam.libelleEcran=!!lParam.documentJoint.libelleLien?lParam.documentJoint.libelleLien:undefined;lParam.libelle=lParam.documentJoint.url;}
let lUrl='';if(lParam.avecLien){lUrl=this.creerUrlBruteLienExterne(lParam.documentJoint,{genreRessource:lParam.genreRessource,genreDocumentJoint:lParam.genreDocumentJoint,forcerURLComplete:lParam.forcerURLComplete,libelle:lParam.libelle,infoSupp:lParam.infoSupp});}
const lInfosLiens={tag:'ie-chips',ieModel:'',title:lParam.title||false,libelle:lParam.libelleEcran!==undefined&&lParam.libelleEcran!==null?lParam.libelleEcran:lParam.libelle?lParam.libelle:lParam.documentJoint?lParam.documentJoint.GetLibelle():'',href:lUrl,classes:[],ariaLabel:lParam.ariaLabel?' '+tag.composeAttr('aria-label',lParam.ariaLabel):'',ariaLabelledby:lParam.avecAriaLabelledby&&lParam.ariaLabelledby?' '+tag.composeAttr('aria-labelledby',lParam.ariaLabelledby):''};if(!!lParam.class){lInfosLiens.classes.push(lParam.class);}
if(!!lParam.ieModelChips){lInfosLiens.ieModel=' '+tag.composeAttr('ie-model',lParam.ieModelChips,lParam.argsIEModel);}
let lIconeLien='';if(!!lParam.afficherIconeDocument){if(lParam.iconeOverride){lIconeLien=lParam.iconeOverride;} else{lIconeLien=_getClasseIconeDocumentJoint(lParam.documentJoint);}}
if(!!lIconeLien){lInfosLiens.classes.push('iconic');lInfosLiens.classes.push(lIconeLien);}
if(!!lParam.ieChipsMinimal){lInfosLiens.classes.push('chips-minimal');}
const lGenreFichier=EFormatDocJoint.getGenreDeFichier(this.extraireExtensionFichier(lParam.libelle?lParam.libelle:lParam.documentJoint?lParam.documentJoint.GetLibelle():''));if(lGenreFichier===EFormatDocJoint.Geogebra){lInfosLiens.href='geogebra.html?view='+encodeURIComponent(lInfosLiens.href)+'';}
return'<'+lInfosLiens.tag+' id="'+GUID.getId()+'"'+(lParam.maxWidth>0?' style="max-width:'+lParam.maxWidth+'px;"':'')+(lInfosLiens.title?' title="'+GChaine.toTitle(lInfosLiens.title)+'"':'')+(!!lInfosLiens.href?' href="'+lInfosLiens.href+'"':'')+(!!lInfosLiens.ieModel?lInfosLiens.ieModel:'')+(lInfosLiens.classes.length>0?' class="'+lInfosLiens.classes.join(' ')+'"':'')+(lInfosLiens.ariaLabel?lInfosLiens.ariaLabel:'')+(lInfosLiens.ariaLabelledby?lInfosLiens.ariaLabelledby:'')+'>'+
lInfosLiens.libelle+'</'+lInfosLiens.tag+'>';}
composeUrlRequete(aParam){let lResult='';if(aParam.url){lResult=aParam.url;if(lResult.charAt(lResult.length-1)!=='/'){lResult+='/';}}
if(aParam.nomRequete){if(aParam.nomRequete.charAt(0)!=='/'){lResult+=aParam.nomRequete;} else{lResult+=aParam.nomRequete.substring(1,aParam.nomRequete.length-1);}}
return lResult;}
composeUrl_ImgPhotoIndividu(aIndividu){if(!aIndividu||!aIndividu.GetNumero){return'';}
return GApplication.getCommunication().composeUrlFichierExterne(aIndividu.GetLibelle().replace(/[\s]/gi,'_')+'.jpg',new ObjetElement('',aIndividu.GetNumero()));}
supprimerEspaces(aChaine){return aChaine&&aChaine.replace?aChaine.replace(/ /g,''):aChaine;}
latinize(aChaine){return ComparateurChaines.latinize(aChaine);}
normalize(aChaine){return ComparateurChaines.normalize(aChaine);}
miseEnFormeEmail(aEmail){return aEmail?aEmail.replace(/;/g,'<br/>'):'';}
composerEmail(aEmail,aNotMailTo,aSansTabulation){return!aNotMailTo?'<a href="mailto:'+aEmail+'"'+(aSansTabulation?' tabindex="-1"':'')+' target="_blank">'+GChaine.miseEnFormeEmail(aEmail)+'</a>':'<span class="LienAccueil AvecMain">'+GChaine.miseEnFormeEmail(aEmail)+'</span>';}
controleTailleTexte(aParam){let lResult={controleOK:true,chaine:aParam.chaine};let lValeurSansEntites=this.enleverEntites(aParam.chaine);if((aParam.tailleTexteMax>0)&&(lValeurSansEntites.length>aParam.tailleTexteMax)){lValeurSansEntites=lValeurSansEntites.slice(0,aParam.tailleTexteMax);lResult={controleOK:false,chaine:this.ajouterEntites(lValeurSansEntites)};}
return lResult;}
extraireNomFichier(aNomFichier){if(!aNomFichier||!aNomFichier.split){return aNomFichier;}
const lTab=aNomFichier.split('.');if(lTab.length>1){lTab.pop();}
return lTab.join('.');}
extraireExtensionFichier(aNomFichier){if(!aNomFichier||!aNomFichier.split){return'';}
const lTab=aNomFichier.split('.');return lTab.length>1?lTab[lTab.length-1]:'';}
getLibelleSurligne(aLibelle,aRecherches,aOptions){if(!aLibelle){return aLibelle;}
let lRecherche,lIndex;const lArray=[];const lLibelle=GChaine.enleverEntites(aLibelle||'').replace(/&nbsp;/g,' ');let lResult;const lOptions=Object.assign({couleur:GCouleur.surlignageTexte},aOptions);if(Array.isArray(aRecherches)){for(let i=0;i<aRecherches.length;i++){lRecherche=aRecherches[i].trim();if(lRecherche.length>0){for(lIndex=0;lIndex<lLibelle.length;lIndex++){if(lIndex+lRecherche.length<=lLibelle.length&&ComparateurChaines.egal(lRecherche,lLibelle.slice(lIndex,lIndex+lRecherche.length))){for(let j=0;j<lRecherche.length;j++){lArray[lIndex+j]=true;}}}}}}
lResult='';for(let i=0;i<lLibelle.length;i++){if(lArray[i]){if(!lArray[i-1]){lResult+='<span style="background-color:'+lOptions.couleur+'">';}
lResult+=GChaine.ajouterEntites(lLibelle[i]);if(!lArray[i+1]){lResult+='</span>';}} else{lResult+=GChaine.Insecable(GChaine.ajouterEntites(lLibelle[i]));}}
return lResult;}
supprimerBalisesHtml(aContenu){if(!aContenu||!MethodesObjet.isString(aContenu)){return'';}
let lContenu=aContenu.replace(/\n/g,'').replace(/(<\/div>|<\/ol>|<\/ul>|<\/li>|<\/p>)(?!(<br>|<br\/>|<\/div>|<\/ol>|<\/ul>|<\/li>|<\/p>))/g,'$1\n').replace(/(<br>|<br\/>)/g,'$1\n').replace(/<[^>]*?>/gi,'');if(lContenu.endsWith('\n')){lContenu=lContenu.slice(0,lContenu.length-1);}
return lContenu;}
htmlToSafeHtml(aHtml){try{const lDoc=new DOMParser().parseFromString(aHtml,'text/html');if(lDoc&&lDoc.body){return lDoc.body.innerHTML||'';}} catch(e){}
return aHtml;}}
_ObjetChaine.regexCarControl=/[\x00-\x1F\x7F-\x9f]/gi;function _reverseString(a){return a.split('').reverse().join('');}
function _cacheCanvas_convertREMToPx(aTailleREM){if(!this.__cacheCanvas.fontSizeRoot){let lSize='';try{lSize=parseFloat(global.getComputedStyle(document.documentElement).getPropertyValue('font-size'),10);} catch(e){lSize=10;}
this.__cacheCanvas.fontSizeRoot=lSize;}
return(parseFloat(aTailleREM,10)*this.__cacheCanvas.fontSizeRoot)+'px';}
function _getClasseIconeDocumentJoint(aDocJoint){let lClasseIcone='';const lGenreFichier=EFormatDocJoint.getGenreDeFichier(GChaine.extraireExtensionFichier(aDocJoint.GetLibelle()));if(lGenreFichier!==EFormatDocJoint.Inconnu){lClasseIcone=EFormatDocJoint.getClassIconDeGenre(lGenreFichier);} else{if(aDocJoint.GetGenre()===EGenreDocumentJoint.Cloud){lClasseIcone='icon_cloud';} else if(aDocJoint.GetGenre()===EGenreDocumentJoint.Url){lClasseIcone='icon_link';} else if(aDocJoint.GetGenre()===EGenreDocumentJoint.LienKiosque){lClasseIcone='icon_external_link';} else if(aDocJoint.GetGenre()===EGenreDocumentJoint.LienVisio){lClasseIcone='icon_cours_virtuel';}}
return lClasseIcone;}
GChaine=new _ObjetChaine();module.exports={_ObjetChaine:_ObjetChaine,GChaine:GChaine};Date.prototype.toJSON=function(){const lJSON={};lJSON[TypeChampsJSON.type]=TypeHttpVariable.TypeHttpDateTime;lJSON[TypeChampsJSON.valeur]=_ObjetChaine.prototype.DateToStr(this);return lJSON;};},fn:"_objetchaine.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');require('divers.js');const{GChaine,_ObjetChaine}=require('_ObjetChaine.js');const trad=require('traductions.js');class ObjetTraduction{add(aNom,aValeur,aAccepteTableau){try{let lNomDernierNoeud=aNom;let lObjet=this;if(aNom.indexOf('.')>0){const T=aNom.split('.');for(let J=0;J<T.length-1;J++){const lProp=aNom.split('.')[J];if(!lObjet[lProp]){lObjet[lProp]=new ObjetTraduction();}
lObjet=lObjet[lProp];}
if(T.length>0){lNomDernierNoeud=aNom.split('.')[T.length-1];}}
if(MethodesObjet.isString(lObjet)){return;}
if(lObjet[lNomDernierNoeud]||lObjet[lNomDernierNoeud]===''){if(MethodesObjet.isString(lObjet[lNomDernierNoeud])){lObjet[lNomDernierNoeud]=[lObjet[lNomDernierNoeud]];}
lObjet[lNomDernierNoeud].push(aValeur||'');} else{lObjet[lNomDernierNoeud]=aValeur||'';}} catch(e){}}
getValeur(aNom,aTableauRemplacements){let lValeur=MethodesObjet.get(this,aNom);if(!lValeur&&!MethodesObjet.isString(lValeur)){return lValeur||'';}
if(aTableauRemplacements){if(MethodesObjet.isString(lValeur)){lValeur=GChaine.Format(lValeur,aTableauRemplacements);}}
return lValeur;}
getTitreMFiche(aIdRessource){const lChaine=this.getValeur(aIdRessource);if(lChaine!==''){const lJson=JSON.parse(lChaine);if(lJson&&lJson.titre){return lJson.titre;} else{}} else{}}
_DEBUG_PasserEnCleDeTraductions(aChaine){}}
let lTraduction=new ObjetTraduction();_ObjetChaine.GTraductions=lTraduction;if(trad){const lFunc=function(){lTraduction.add.apply(lTraduction,arguments);};trad(lFunc);}
module.exports=lTraduction;},fn:"objettraduction.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreAnnotation={erreur:-1,note:0,absent:1,dispense:2,nonNote:3,inapte:4,nonRendu:5,absentZero:6,nonRenduZero:7,felicitations:8};module.exports=EGenreAnnotation;},fn:"enumere_annotation.js"});;
IE.fModule({f:function(exports,require,module,global){const ToucheClavier={};ToucheClavier.Backspace=8;ToucheClavier.Tab=9;ToucheClavier.RetourChariot=13;ToucheClavier.Espace=32;ToucheClavier.Shift=16;ToucheClavier.Ctrl=17;ToucheClavier.Alt=18;ToucheClavier.Windows=91;ToucheClavier.ContextMenu=93;ToucheClavier.Echap=27;ToucheClavier.FlecheGauche=37;ToucheClavier.FlecheDroite=39;ToucheClavier.FlecheHaut=38;ToucheClavier.FlecheBas=40;ToucheClavier.Inserer=45;ToucheClavier.Supprimer=46;ToucheClavier.Debut=36;ToucheClavier.Fin=35;ToucheClavier.PageHaut=33;ToucheClavier.PageBas=34;ToucheClavier._0=48;ToucheClavier._1=49;ToucheClavier._2=50;ToucheClavier._3=51;ToucheClavier._4=52;ToucheClavier._5=53;ToucheClavier._6=54;ToucheClavier._7=55;ToucheClavier._8=56;ToucheClavier._9=57;ToucheClavier.A=65;ToucheClavier.B=66;ToucheClavier.C=67;ToucheClavier.D=68;ToucheClavier.E=69;ToucheClavier.F=70;ToucheClavier.G=71;ToucheClavier.H=72;ToucheClavier.I=73;ToucheClavier.J=74;ToucheClavier.K=75;ToucheClavier.L=76;ToucheClavier.M=77;ToucheClavier.N=78;ToucheClavier.O=79;ToucheClavier.P=80;ToucheClavier.Q=81;ToucheClavier.R=82;ToucheClavier.S=83;ToucheClavier.T=84;ToucheClavier.U=85;ToucheClavier.V=86;ToucheClavier.W=87;ToucheClavier.X=88;ToucheClavier.Y=89;ToucheClavier.Z=90;ToucheClavier.AccoladeDroite=222;ToucheClavier.AccoladeGauche=220;ToucheClavier.Dollar=223;ToucheClavier.CrochetGauche=186;ToucheClavier.CrochetDroite=192;ToucheClavier.Circonflexe=221;ToucheClavier.PointInterrogation=219;ToucheClavier.VerrMaj=20;ToucheClavier.VerrNum=144;ToucheClavier.F1=115;ToucheClavier.F3=114;ToucheClavier.F2=113;ToucheClavier.F5=116;ToucheClavier.F6=117;ToucheClavier.F7=118;ToucheClavier.F8=119;ToucheClavier.F9=120;ToucheClavier.F10=121;ToucheClavier.F11=122;ToucheClavier.F12=123;ToucheClavier.ArretDefilement=145;ToucheClavier.Pause=19;ToucheClavier.Inferieur=226;ToucheClavier.Virgule=188;ToucheClavier.Tiret=189;ToucheClavier.Point=190;ToucheClavier.Section=191;ToucheClavier.NumpadPlus=107;ToucheClavier.NumpadMoins=109;ToucheClavier.NumpadSlash=111;ToucheClavier.NumpadStar=106;ToucheClavier.Numpad_0=96;ToucheClavier.Numpad_1=97;ToucheClavier.Numpad_2=98;ToucheClavier.Numpad_3=99;ToucheClavier.Numpad_4=100;ToucheClavier.Numpad_5=101;ToucheClavier.Numpad_6=102;ToucheClavier.Numpad_7=103;ToucheClavier.Numpad_8=104;ToucheClavier.Numpad_9=105;ToucheClavier.NumpadPoint=110;ToucheClavier.estCaractere=function(aChar,aRegExp){return(aChar==='')||new RegExp('['+aRegExp+']').test(aChar);};ToucheClavier.estEventRetourChariot=function(aEventJQuery){return!!aEventJQuery&&aEventJQuery.which===ToucheClavier.RetourChariot&&!aEventJQuery.shiftKey&&!aEventJQuery.altKey&&!aEventJQuery.ctrlKey;};ToucheClavier.estEventEspace=function(aEventJQuery){return!!aEventJQuery&&aEventJQuery.which===ToucheClavier.Espace&&!aEventJQuery.shiftKey;};ToucheClavier.estEventSelection=function(aEventJQuery){return(ToucheClavier.estEventRetourChariot(aEventJQuery)||ToucheClavier.estEventEspace(aEventJQuery));};ToucheClavier.estEventCaractereAlphaNumerique=function(aEventJQuery){return!!aEventJQuery&&!aEventJQuery.altKey&&!aEventJQuery.ctrlKey&&(new RegExp('[0-9.a-z.A-Z]').test(String.fromCharCode(aEventJQuery.which)));};ToucheClavier.estToucheFleche=function(aTouche){return aTouche===ToucheClavier.FlecheBas||aTouche===ToucheClavier.FlecheHaut||aTouche===ToucheClavier.FlecheGauche||aTouche===ToucheClavier.FlecheDroite;};module.exports=ToucheClavier;},fn:"toucheclavier.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeChampsJSON=require('Enumere_ChampsJSON.js');const TypeHttpVariable=require('TypeHttpVariable.js').TypeHttpVariable;const EGenreAnnotation=require('Enumere_Annotation.js');const GTraductions=require('ObjetTraduction.js');const ToucheClavier=require('ToucheClavier.js');const GChaine=require('_ObjetChaine.js').GChaine;const MethodesObjet=require('MethodesObjet.js');const ObjetTri=require('ObjetTri.js');class TypeNote{constructor(aParametre,N){this.note='0.00';this.valeur=0.00;this.genre=EGenreAnnotation.note;this.bareme=0.00;const lType=typeof(aParametre);if(lType==='string'){this.genre=this.getGenreNote(aParametre);this.valeur=this.noteToValeur(aParametre);this.note=this.estUneAnnotation()?this.getChaineAnnotationDeGenre(this.genre):this.valeurToNote(this.valeur,N);if(this.genre===EGenreAnnotation.absentZero||this.genre===EGenreAnnotation.nonRenduZero){this.valeur=0.00;} else if(this.genre===EGenreAnnotation.felicitations){const lAvecFelicitationAutorisee=TypeNote.estAnnotationPermise(EGenreAnnotation.felicitations);if(lAvecFelicitationAutorisee){this.bareme=this.getBaremeNote(aParametre);this.note=this.valeurToNote(this.bareme,N)+this.note;try{const lSurplusBareme=TypeNote.getValeurSurplusBaremeAAppliquer(this.bareme);this.valeur=this.bareme+lSurplusBareme;} catch(error){}} else{this.genre=EGenreAnnotation.note;this.bareme=this.getBaremeNote(aParametre);this.note=this.valeurToNote(this.bareme,N);this.valeur=this.bareme;}}
this.chaine=aParametre;} else if(lType==='number'){this.note=this.valeurToNote(aParametre,N);this.valeur=aParametre;this.genre=EGenreAnnotation.note;}}
getCaractereAnnotation(aArrayGenresNote){const lCaractereAnnotation={};for(const x in aArrayGenresNote){switch(aArrayGenresNote[x]){case(EGenreAnnotation.absent):lCaractereAnnotation.Absent=GTraductions.getValeur('TypeNote.CaractereAnnotation.Absent');break;case(EGenreAnnotation.dispense):lCaractereAnnotation.Dispense=GTraductions.getValeur('TypeNote.CaractereAnnotation.Dispense');break;case(EGenreAnnotation.nonNote):lCaractereAnnotation.NonNote=GTraductions.getValeur('TypeNote.CaractereAnnotation.NonNote');break;case(EGenreAnnotation.inapte):lCaractereAnnotation.Inapte=GTraductions.getValeur('TypeNote.CaractereAnnotation.Inapte');break;case(EGenreAnnotation.nonRendu):lCaractereAnnotation.NonRendu=GTraductions.getValeur('TypeNote.CaractereAnnotation.NonRendu');break;case(EGenreAnnotation.absentZero):lCaractereAnnotation.AbsentZero=GTraductions.getValeur('TypeNote.CaractereAnnotation.AbsentZero');break;case(EGenreAnnotation.nonRenduZero):lCaractereAnnotation.NonRenduZero=GTraductions.getValeur('TypeNote.CaractereAnnotation.NonRenduZero');break;case(EGenreAnnotation.felicitations):lCaractereAnnotation.Felicitations=GTraductions.getValeur('TypeNote.CaractereAnnotation.Felicitations');break;}}
return lCaractereAnnotation;}
getGenreNote(aChaine){if(aChaine.split('|').length>=2){return parseInt(aChaine.split('|')[1]);}
const lTabNotations=_getTableauNotations();for(const I in lTabNotations){if(lTabNotations[I].toLowerCase()===aChaine.toLowerCase()){return parseInt(I);} else if(parseInt(I)===EGenreAnnotation.felicitations){const lObjCaracteresAnnotation=this.getCaractereAnnotation([EGenreAnnotation.felicitations]);if(aChaine.indexOf(lObjCaracteresAnnotation.Felicitations)>0){return EGenreAnnotation.felicitations;}}}
return EGenreAnnotation.note;}
getBaremeNote(aChaine){let lStrBareme=aChaine.split('|')[2];if(!!lStrBareme){lStrBareme=lStrBareme.replace(',','.');}
return parseFloat(lStrBareme);}
getNote(){return this.note;}
getValeur(){return this.valeur;}
getGenre(){return this.genre;}
estUneValeur(){return!isNaN(this.valeur);}
toString(){return this.note;}
getNoteSansDecimaleForcee(){if(this.genre===EGenreAnnotation.note&&!isNaN(this.valeur)){return this.valeur.toString().replace('.',',');}
return this.getNote();}
toStr(){let str;if(this.genre===EGenreAnnotation.note){str=this.note;} else{str='|'+this.genre;if(this.genre===EGenreAnnotation.felicitations&&(this.bareme!==null&&this.bareme!==undefined)){str+='|'+this.bareme;}}
return str;}
toJSON(){const lJSON={};lJSON[TypeChampsJSON.type]=TypeHttpVariable.TypeHttpNote;lJSON[TypeChampsJSON.valeur]=this.toStr();return lJSON;}
noteToValeur(aStrNote){return parseFloat(aStrNote.replace(',','.'));}
valeurToNote(aValeur,N){if(isNaN(aValeur)){return'';}
N=N===null||N===undefined?TypeNote.decimalNotation:N;return(''+(parseFloat(aValeur).toFixed(N))).replace('.',',');}
estUneNoteVide(){return(this.note==='');}
estUneAnnotation(){return(this.genre!==EGenreAnnotation.note);}
estVide(){return(this.note==='')&&!this.estUneValeur();}
estUneNoteValide(aNoteMin,aNoteMax,aAvecNotationSpecifique,aAvecVide){if(this.estUneNoteVide()){return aAvecVide===true;}
if(aAvecNotationSpecifique){if(this.genre!==EGenreAnnotation.note){return true;}}
let lChaine=this.note.replace(/\./g,',');if(lChaine.indexOf(',')=== -1){lChaine+=',';}
const lPosVirgule=lChaine.indexOf(',');const lNbrVirgule=lChaine.split(',').length-1;const lPosMoins=lChaine.indexOf('-');const lPosVirguleMax=Math.max((''+(parseInt(aNoteMin))).length,(''+(parseInt(aNoteMax))).length);return(lPosMoins<=0)&&(lPosVirgule<=lPosVirguleMax)&&(lChaine.length-(lPosVirgule+1)<=TypeNote.decimalNotation)&&(lNbrVirgule<=1)&&(this.valeur>=aNoteMin.getValeur())&&(this.valeur<=aNoteMax.getValeur());}
getNoteEntier(){return this.estUneValeur()?this.getNote().enleverZero():this.getNote();}
getBaremeEntier(){return'/'+this.getNote().enleverZero();}
getBaremeEntierSansSlash(){return this.getNote().enleverZero();}
getCoefficientEntier(){return this.getNote().enleverZero();}
estBaremeParDefaut(){return TypeNote.baremeNotation?this.getValeur()===TypeNote.baremeNotation.getValeur():false;}
estCoefficientParDefaut(){return this.valeur===1;}
getCoefficient(){if(this.estUneValeur()){return this.getNote();} else{return'xx.xx';}}
getChaineAnnotationDeCaractere(aCaractere){const lAnnotation=TypeNote.getGenreAnnotationDeRaccourci(aCaractere);if(!!lAnnotation){return _getTableauNotations()[lAnnotation];}}
getChaineAnnotationDeGenre(aGenre){return _getTableauNotations()[aGenre];}
egal(aNote){return!!aNote&&this.toStr()===aNote.toStr();}
dupliquer(){const lNote=new TypeNote();lNote.note=this.note;lNote.valeur=this.valeur;lNote.genre=this.genre;return lNote;}
static getValeurSurplusBaremeAAppliquer(aValeurBareme){let lSurplusBaremeCalcule=0;if(!!aValeurBareme&&!!TypeNote.surplusBareme&&TypeNote.surplusBareme.getValeur()){const lBaremeParDefaut=TypeNote.baremeNotation;if(!!lBaremeParDefaut&&aValeurBareme!==lBaremeParDefaut.getValeur()){lSurplusBaremeCalcule=(TypeNote.surplusBareme.getValeur()*aValeurBareme)/lBaremeParDefaut.getValeur();} else{lSurplusBaremeCalcule=TypeNote.surplusBareme.getValeur();}}
return lSurplusBaremeCalcule;}
static estAnnotationPermise(aGenreAnnotation){const lListeAutorisee=TypeNote.listeAnnotationsAutorisees;return!!aGenreAnnotation&&(!lListeAutorisee||lListeAutorisee.indexOf(aGenreAnnotation)!== -1);}
static avecVirgule(){return TypeNote.decimalNotation>0;}
static getGenreAnnotationDeRaccourci(aCaractere){let lGenreAnnotation=null;if(!!aCaractere&&aCaractere.toLowerCase){switch(aCaractere.toLowerCase()){case(GTraductions.getValeur('TypeNote.CaractereAnnotation.Absent')):lGenreAnnotation=EGenreAnnotation.absent;break;case(GTraductions.getValeur('TypeNote.CaractereAnnotation.Dispense')):lGenreAnnotation=EGenreAnnotation.dispense;break;case(GTraductions.getValeur('TypeNote.CaractereAnnotation.NonNote')):lGenreAnnotation=EGenreAnnotation.nonNote;break;case(GTraductions.getValeur('TypeNote.CaractereAnnotation.Inapte')):lGenreAnnotation=EGenreAnnotation.inapte;break;case(GTraductions.getValeur('TypeNote.CaractereAnnotation.NonRendu')):lGenreAnnotation=EGenreAnnotation.nonRendu;break;case(GTraductions.getValeur('TypeNote.CaractereAnnotation.AbsentZero')):lGenreAnnotation=EGenreAnnotation.absentZero;break;case(GTraductions.getValeur('TypeNote.CaractereAnnotation.NonRenduZero')):lGenreAnnotation=EGenreAnnotation.nonRenduZero;break;case(GTraductions.getValeur('TypeNote.CaractereAnnotation.Felicitations')):lGenreAnnotation=EGenreAnnotation.felicitations;break;}}
return lGenreAnnotation;}
static estCaractereNote(aChar,aAvecLettre,aAvecVirgule,aAvecMoins,aCaractereAnnotation){aAvecLettre=aAvecLettre===null||aAvecLettre===undefined?true:aAvecLettre;aAvecVirgule=aAvecVirgule===null||aAvecVirgule===undefined?true:aAvecVirgule;aAvecMoins=aAvecMoins===null||aAvecMoins===undefined?true:aAvecMoins;aCaractereAnnotation=aCaractereAnnotation===null||aCaractereAnnotation===undefined?GTraductions.getValeur('TypeNote.CaractereAnnotation'):aCaractereAnnotation;let lRegExp='0-9';if(aAvecLettre){let lCarAnnot='';for(const x in aCaractereAnnotation){if(aCaractereAnnotation[x].toLowerCase&&aCaractereAnnotation[x]!==' '){lCarAnnot+=aCaractereAnnotation[x].toLowerCase();}}
lRegExp+=lCarAnnot+lCarAnnot.toUpperCase();}
if(aAvecVirgule){lRegExp+='.,';}
if(aAvecMoins){lRegExp+='-';}
return ToucheClavier.estCaractere(aChar,lRegExp);}
static formatStrToNote(aChaine,aOptions={}){const lNote=new TypeNote(aChaine);let lValeurMin=0;if(MethodesObjet.isFunction(aOptions.min)){lValeurMin=aOptions.min();} else if(!!aOptions.min){lValeurMin=aOptions.min;}
if(lNote.getGenre()>0){return aOptions.avecAnnotation?lNote:null;}
if(aChaine===''){return aOptions.sansNotePossible?lNote:null;}
if(aChaine===','||aChaine==='.'){return aOptions&&aOptions.avecVirgule&&aOptions.sansNotePossible?lNote:null;}
if(aChaine==='-'){return lValeurMin<0?lNote:null;}
if(lNote.estUneValeur()){const lTest='0-9'+(aOptions.avecVirgule?',.':'')+(lValeurMin<0?'-':'');if(new RegExp('^['+lTest+']+$').test(aChaine)){return lNote;}}
return null;}
static validerNote(aValeur,aOptions={}){const lDefaultOptions={avecVirgule:true,afficherAvecVirgule:true,avecAnnotation:true,sansNotePossible:true,min:0,max:100,titreMessageMinMax:'',messageMinMax:GTraductions.getValeur('InputNote.MinMax')};const lOptions=$.extend(lDefaultOptions,aOptions);if(!!aValeur&&typeof(aValeur)!=='string'){aValeur=String(aValeur);}
if(!lOptions.avecVirgule){lOptions.afficherAvecVirgule=false;}
let lResult;let lValueTemp=aValeur;if(lValueTemp.search(/^[0-9]*(,|\.)[0-9]+/)===0){const lRegExp=new RegExp('^([0-9]*(,|\\.)[0-9]{'+TypeNote.decimalNotation+'}).*$');lValueTemp=lValueTemp.replace(lRegExp,"$1");}
const lNote=TypeNote.formatStrToNote(lValueTemp,lOptions);let lValeurMin;if(MethodesObjet.isFunction(lOptions.min)){lValeurMin=lOptions.min();} else{lValeurMin=lOptions.min;}
let lValeurMax;if(MethodesObjet.isFunction(lOptions.max)){lValeurMax=lOptions.max();} else{lValeurMax=lOptions.max;}
const lNoteMin=new TypeNote(lValeurMin),lNoteMax=new TypeNote(lValeurMax);if(!lNote||
!lNote.estUneNoteValide(lNoteMin,lNoteMax,lOptions.avecAnnotation,lOptions.sansNotePossible)||
lValueTemp==='-'){const lMessage=GChaine.Format(lOptions.messageMinMax,[
lOptions.afficherAvecVirgule?lNoteMin.getNote():lNoteMin.getNoteSansDecimaleForcee(),lOptions.afficherAvecVirgule?lNoteMax.getNote():lNoteMax.getNoteSansDecimaleForcee()
]);lResult={estValide:false,titre:lOptions.titreMessageMinMax,message:lMessage};} else{lResult={estValide:true,note:lNote};}
return lResult;}
static getTrisDefaut(aGetNote,aGenreTri){if(!MethodesObjet.isFunction(aGetNote)){return[];}
return[
ObjetTri.init(function(D){const lNote=aGetNote(D);if(lNote&&lNote.genre===EGenreAnnotation.note&&lNote.estUneValeur()){return lNote.valeur;}
return-1000;},aGenreTri),ObjetTri.init(function(D){const lNote=aGetNote(D);if(lNote){return lNote.genre===EGenreAnnotation.note?-100:lNote.genre;}
return-1000;},aGenreTri)
];}}
let lTableauNotations=null;function _getTableauNotations(){if(!lTableauNotations){lTableauNotations=['',GTraductions.getValeur('TypeNote.Annotation.Absent'),GTraductions.getValeur('TypeNote.Annotation.Dispense'),GTraductions.getValeur('TypeNote.Annotation.NonNote'),GTraductions.getValeur('TypeNote.Annotation.Inapte'),GTraductions.getValeur('TypeNote.Annotation.NonRendu'),GTraductions.getValeur('TypeNote.Annotation.Absent')+'*',GTraductions.getValeur('TypeNote.Annotation.NonRendu')+'*',GTraductions.getValeur('TypeNote.Annotation.Felicitations')
];}
return lTableauNotations;}
TypeNote.decimalNotation=2;TypeNote.baremeNotation=null;TypeNote.surplusBareme=null;TypeNote.listeAnnotationsAutorisees=null;module.exports=TypeNote;},fn:"typenote.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreArrondi={sans:0,superieur:1,inferieur:2,plusProche:3};module.exports=EGenreArrondi;},fn:"enumere_arrondi.js"});;
IE.fModule({f:function(exports,require,module,global){
const TypeChampsJSON=require('Enumere_ChampsJSON.js');const GTraductions=require('ObjetTraduction.js');const TypeHttpVariable=require('TypeHttpVariable.js').TypeHttpVariable;const TypeNote=require('TypeNote.js');const EGenreArrondi=require('Enumere_Arrondi.js');class TypeArrondi{constructor(aGenrePronote){this.precision=0;this.genre=EGenreArrondi.sans;this.precisionMini=1/Math.pow(10,TypeNote.decimalNotation);this.toType(aGenrePronote);}
getPrecision(){return this.precision;}
getGenre(){return this.genre;}
setPrecision(aPrecision){this.precision=aPrecision;}
setGenre(aGenre){this.genre=aGenre;}
arrondir(aValeur){aValeur=Math.round(Number(aValeur/this.precisionMini).toFixed(TypeNote.decimalNotation))*this.precisionMini;switch(this.genre){case EGenreArrondi.superieur:return Math.ceil(Number(aValeur/this.precision).toFixed(TypeNote.decimalNotation))*this.precision;case EGenreArrondi.inferieur:return Math.floor(Number(aValeur/this.precision).toFixed(TypeNote.decimalNotation))*this.precision;case EGenreArrondi.plusProche:return Math.round(Number(aValeur/this.precision).toFixed(TypeNote.decimalNotation))*this.precision;default:return aValeur;}}
toType(aGenrePronote){this.precision=[this.precisionMini,0.10,0.25,0.50,1,0.10,0.25,0.50,1][aGenrePronote];this.genre=parseInt(aGenrePronote)!==0?parseInt(aGenrePronote)<=4?EGenreArrondi.superieur:EGenreArrondi.plusProche:EGenreArrondi.sans;}
toString(){switch(this.genre){case EGenreArrondi.sans:return 0;case EGenreArrondi.superieur:switch(this.precision){case 0.10:return 1;case 0.25:return 2;case 0.50:return 3;case 1:return 4;default:;return 0;}
case EGenreArrondi.plusProche:switch(this.precision){case 0.10:return 5;case 0.25:return 6;case 0.50:return 7;case 1:return 8;default:;return 0;}
default:return 0;}}
strPrecision(){switch(this.precision){case this.precisionMini:return GTraductions.Arrondi[0];case 0.10:return GTraductions.Arrondi[1];case 0.25:return GTraductions.Arrondi[2];case 0.50:return GTraductions.Arrondi[3];case 1.00:return GTraductions.Arrondi[4];}
return GTraductions.Arrondi[0];}
dupliquer(){const lArrondi=new TypeArrondi(0);lArrondi.precision=this.precision;lArrondi.genre=this.genre;return lArrondi;}
toJSON(){const lJSON={};lJSON[TypeChampsJSON.type]=TypeHttpVariable.TypeHttpArrondi;lJSON[TypeChampsJSON.valeur]=this.toString();return lJSON;}}
module.exports=TypeArrondi;},fn:"typearrondi.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const MethodesTableau=require('MethodesTableau.js');const TypeChampsJSON=require('Enumere_ChampsJSON.js');const TypeHttpVariable=require('TypeHttpVariable.js').TypeHttpVariable;class TypeEnsembleNombre{constructor(aValeur){this.clear();this.add(aValeur);}
clear(){this._hash={};this._cacheItems=null;return this;}
add(aValeur){let lProp,lNombre;this._cacheItems=null;if(MethodesObjet.isNumber(aValeur)){this._hash[aValeur]=true;} else if(aValeur instanceof TypeEnsembleNombre){for(lProp in aValeur._hash){this._hash[lProp]=true;}} else if(MethodesObjet.isArray(aValeur)){for(lProp in aValeur){lNombre=aValeur[lProp];if(MethodesObjet.isNumber(lNombre)){this._hash[lNombre]=true;}}}
return this;}
remove(aValeur){let lProp,lNombre;this._cacheItems=null;if(MethodesObjet.isNumber(aValeur)){delete this._hash[aValeur];} else if(aValeur instanceof TypeEnsembleNombre){for(lProp in aValeur._hash){delete this._hash[lProp];}} else if(MethodesObjet.isArray(aValeur)){for(lProp in aValeur){lNombre=aValeur[lProp];if(MethodesObjet.isNumber(lNombre)){delete this._hash[lNombre];}}}
return this;}
contains(aValeur){let lProp,lResult;if(MethodesObjet.isNumber(aValeur)){return this._hash[aValeur]!==undefined;}
if(aValeur instanceof TypeEnsembleNombre){lResult=false;for(lProp in aValeur._hash){if(!this._hash[lProp]){return false;}
lResult=true;}
return lResult;}
if(MethodesObjet.isArray(aValeur)){if(aValeur.length===0){return false;}
for(lProp in aValeur){if(!this._hash[aValeur[lProp]]){return false;}}
return true;}
return false;}
intersect(aValeur){let lProp,lNombre;const lHash={};this._cacheItems=null;if(aValeur instanceof TypeEnsembleNombre){for(lProp in aValeur._hash){if(this._hash[lProp]){lHash[lProp]=true;}}
this._hash=lHash;} else if(MethodesObjet.isArray(aValeur)){for(lProp in aValeur){lNombre=aValeur[lProp];if(this._hash[lNombre]){lHash[lNombre]=true;}}
this._hash=lHash;} else{}
return this;}
get(aIndex){const lItems=this.items();if(aIndex<0||aIndex>lItems.length||!MethodesObjet.isNumber(aIndex)){return null;}
return lItems[aIndex];}
indexOf(aValeur){if(this._hash[aValeur]===undefined){return-1;}
return MethodesTableau.binaryIndexOf(this.items(),aValeur);}
items(){if(!this._cacheItems){this._cacheItems=[];let lProp;for(lProp in this._hash){this._cacheItems.push(parseInt(lProp,10));}
this._cacheItems.sort(_sort);}
return this._cacheItems;}
count(){if(this._cacheItems){return this._cacheItems.length;}
return Object.keys(this._hash).length;}
each(aMethode,thisArg){const lItems=this.items(),lNb=lItems.length;for(let i=0;i<lNb;i++){aMethode.call(thisArg,lItems[i],i);}
return this;}
dupliquer(){const lEnsemble=new TypeEnsembleNombre();for(let i in this._hash){lEnsemble._hash[i]=true;}
return lEnsemble;}
toString(){let lResult='',lNbDeSuite=0,lValeur,lItems=this.items();for(let lIx=1;lIx<=lItems.length;lIx++){lValeur=lItems[lIx];if((lItems.length>lIx)&&(lValeur===lItems[lIx-1]+1)){lNbDeSuite++;} else{if(lResult.length>0){lResult+=',';}
if(lNbDeSuite>0){lResult+=lItems[lIx-1-lNbDeSuite]+'..';}
lResult+=lItems[lIx-1];lNbDeSuite=0;}}
return'['+lResult+']';}
fromString(aChaine){if(!aChaine||!aChaine.length||aChaine.length<2){return this;}
aChaine=aChaine.substring(1,aChaine.length-1);const T1=aChaine.split(',');let T2,V1,V2;for(let I=0;I<T1.length;I++){T2=T1[I].split('..');V1=parseInt(T2[0],10);V2=parseInt(T2.length===1?V1:T2[1],10);for(let J=V1;J<=V2;J++){this._hash[J]=true;}}
return this;}
toJSON(){const lJSON={};lJSON[TypeChampsJSON.type]=TypeHttpVariable.TypeHttpEnsembleNombre;lJSON[TypeChampsJSON.valeur]=this.toString();return lJSON;}}
function _sort(a,b){return a<b?-1:a>b?1:0;}
module.exports=TypeEnsembleNombre;},fn:"typeensemblenombre.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationJQuery.js');const MethodesObjet=require('MethodesObjet.js');const TypeChampsJSON=require('Enumere_ChampsJSON.js');const ObjetElement=require('ObjetElement.js');const ObjetListeElements=require('ObjetListeElements.js');const TypeHttpVariable=require('TypeHttpVariable.js').TypeHttpVariable;const TypeDomaine=require('TypeDomaine.js');const TypeArrondi=require('TypeArrondi.js');const TypeEnsembleNombre=require('TypeEnsembleNombre.js');const GChaine=require('_ObjetChaine.js').GChaine;const TypeNote=require('TypeNote.js');const ObjetJSON={};ObjetJSON.parse=function(data,aParametres){const lParametres=Object.assign({ignorerEntites:false,JSONCollection:null},aParametres);const lJSON=ObjetJSON.parseJSON(data);return ObjetJSON.parseVariables(lJSON,lParametres);};ObjetJSON.parseJSON=function(data){let lJSON;try{lJSON=JSON.parse(data);} catch(e){lJSON=''
;}
return lJSON;};ObjetJSON.parseVariables=function(aJSON,aParametres){let lJSON;const lParametres=Object.assign({ignorerEntites:false,JSONCollection:null},aParametres);try{lJSON=_parseVariables(aJSON,lParametres);} catch(e){lJSON={};}
return lJSON;};ObjetJSON.toJSON=function(aObjet,aParametres){let lJSON;try{if(aParametres&&aParametres.ignorerEntites&&!aParametres.JSONCollection){lJSON=aObjet;} else{lJSON=ObjetJSON.preparerJSON(aObjet,aParametres);}
lJSON=JSON.stringify(lJSON);} catch(e){}
return lJSON;};ObjetJSON.preparerJSON=function(aObjet,aParametres){let lJSON,lChaine;lChaine=JSON.stringify(aObjet);lJSON=JSON.parse(lChaine);if(aParametres&&aParametres.ignorerEntites&&!aParametres.JSONCollection){return lJSON;}
lJSON=_toJSON(lJSON,{ignorerEntites:!!(aParametres&&aParametres.ignorerEntites),JSONCollection:aParametres&&aParametres.JSONCollection?aParametres.JSONCollection:null});return lJSON;};function _parseElement(aJSON,aParametres){const lElement=new ObjetElement().fromJSON(aJSON);let lValeur;let lProp;if(aJSON){if(lElement.Libelle){lElement.Libelle=aParametres.ignorerEntites?lElement.Libelle:GChaine.ajouterEntites(lElement.Libelle);}
for(lProp in aJSON){if(lProp!==ObjetElement.const_JSON.libelle.JSON&&lProp!==ObjetElement.const_JSON.numero.JSON&&lProp!==ObjetElement.const_JSON.genre.JSON&&lProp!==ObjetElement.const_JSON.position.JSON&&lProp!==ObjetElement.const_JSON.actif.JSON){lValeur=aJSON[lProp];if(!_parseVariablesDeSource(lElement,lProp,lValeur,aParametres)){lElement[lProp]=lValeur;}}}}
return lElement;}
function _strToNote(aNote){if(!TypeNote){return null;}
if(MethodesObjet.isArray(aNote)){const T=[];for(const i in aNote){T[i]=new TypeNote(aNote[i]);}
return T;}
return new TypeNote(aNote);}
function _parseVariable(aJSON,aParametres){if(!aJSON){return null;}
const lType=aJSON[TypeChampsJSON.type];const lValeur=aJSON[TypeChampsJSON.valeur];switch(lType){case TypeHttpVariable.TypeHttpElement:if(MethodesObjet.isArray(lValeur)){const lListeElements=new ObjetListeElements();if(lValeur&&lValeur.length){for(let i=0,lNb=lValeur.length;i<lNb;i++){const lElement=_parseElement(lValeur[i],aParametres);lListeElements.AddElement(lElement);}}
return lListeElements;}
return _parseElement(lValeur,aParametres);case TypeHttpVariable.TypeHttpFichierBase64:if(aParametres&&aParametres.JSONCollection&&aParametres.JSONCollection.fichiers&&aParametres.JSONCollection.fichiers){const lFichierBase64=aParametres.JSONCollection.fichiers[lValeur];aParametres.JSONCollection.fichiers[lValeur]=null;return lFichierBase64;}
;return'';case TypeHttpVariable.TypeHttpCardinal:return GChaine.StrToCardinal(lValeur);case TypeHttpVariable.TypeHttpBoolean:return GChaine.StrToBoolean(lValeur);case TypeHttpVariable.TypeHttpString:return GChaine.ajouterEntites(lValeur);case TypeHttpVariable.TypeHttpColor:return lValeur;case TypeHttpVariable.TypeHttpDateTime:return GChaine.StrToDate(lValeur);case TypeHttpVariable.TypeHttpNote:return _strToNote(lValeur);case TypeHttpVariable.TypeHttpTraduction:return lValeur;case TypeHttpVariable.TypeHttpIP:return GChaine.strToIp(lValeur);case TypeHttpVariable.TypeHttpInteger:return GChaine.strToInteger(lValeur);case TypeHttpVariable.TypeHttpDouble:return GChaine.strToDouble(lValeur);case TypeHttpVariable.TypeHttpDomaine:case TypeHttpVariable.TypeHttpEnsemble:return new TypeDomaine(lValeur);case TypeHttpVariable.TypeHttpEnsembleCardinal:return new TypeDomaine(lValeur,TypeDomaine.CTailleOuverte);case TypeHttpVariable.TypeHttpArrondi:return new TypeArrondi(lValeur);case TypeHttpVariable.TypeHttpHtml:return GChaine.htmlToSafeHtml(lValeur);case TypeHttpVariable.TypeHttpEnsembleNombre:return new TypeEnsembleNombre().fromString(lValeur);default:return lValeur;}}
function _estVariable(aJSON){if(aJSON&&aJSON[TypeChampsJSON.type]&&aJSON[TypeChampsJSON.valeur]!==undefined&&aJSON[TypeChampsJSON.type]>=0){const lKeys=Object.keys(aJSON);if(lKeys.length===2&&((lKeys[0]===TypeChampsJSON.type&&lKeys[1]===TypeChampsJSON.valeur)||(lKeys[1]===TypeChampsJSON.type&&lKeys[0]===TypeChampsJSON.valeur))){return true;}
return false;}
return false;}
function _estObjet(aValeur){return aValeur&&!aValeur.trim&&typeof aValeur==='object';}
function _parseVariablesDeSource(aObjetResultat,aNomProprieteSource,aValeurSource,aParametres){let lEstVariable;let lResult=true;if(MethodesObjet.isString(aValeurSource)){aObjetResultat[aNomProprieteSource]=aParametres.ignorerEntites?aValeurSource:GChaine.ajouterEntites(aValeurSource);} else if(_estObjet(aValeurSource)){lEstVariable=false;if(!aValeurSource.pop){lEstVariable=_estVariable(aValeurSource);}
aObjetResultat[aNomProprieteSource]=lEstVariable?_parseVariable(aValeurSource,aParametres):_parseVariables(aValeurSource,aParametres);} else{lResult=false;}
return lResult;}
function _parseVariables(aJSON,aParametres){if(!aJSON){return aJSON;}
for(const i in aJSON){_parseVariablesDeSource(aJSON,i,aJSON[i],aParametres);}
return aJSON;}
function _preparerVariableToJSON(aJSON,aParametres){if(!aJSON){return aJSON;}
const lType=aJSON[TypeChampsJSON.type];switch(lType){case TypeHttpVariable.TypeHttpFichierBase64:if(aParametres&&aParametres.JSONCollection){if(!aParametres.JSONCollection.fichiers){aParametres.JSONCollection.fichiers=[];}
aParametres.JSONCollection.fichiers.push(aJSON[TypeChampsJSON.valeur]);aJSON[TypeChampsJSON.valeur]=aParametres.JSONCollection.fichiers.length-1;return aJSON;}
;return aJSON;default:return aJSON;}}
function _toJSON(aJSON,aParametres){if(!aJSON){return aJSON;}
let lValeur;for(const i in aJSON){lValeur=aJSON[i];if(lValeur){if(!!lValeur.trim&&!!lValeur.toLowerCase){if(!aParametres.ignorerEntites){aJSON[i]=GChaine.enleverEntites(lValeur);}} else if(_estVariable(lValeur)){aJSON[i]=_preparerVariableToJSON(lValeur,aParametres);} else if(lValeur!==true&&!lValeur.MAX_VALUE&&!lValeur.getDate&&typeof lValeur==='object'){aJSON[i]=_toJSON(lValeur,aParametres);}}}
return aJSON;}
module.exports=ObjetJSON;},fn:"objetjson.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationJQuery.js');require('divers.js');require('jInputDisabled.js');require('jInputChecked.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const MethodesObjet=require('MethodesObjet.js');const MethodesTableau=require('MethodesTableau.js');const ControleSaisieEvenement=require('ControleSaisieEvenement.js');const ObjetJSON=require('ObjetJSON.js');const{GChaine}=require('_ObjetChaine.js');const ToucheClavier=require('ToucheClavier.js');const Support=require('ObjetSupport.js');const IEHtml=(function(){const uBalises={};const uAttributs={};const uClassesCss={};const uNodeNames=[];let lGUIDControleur1=1;let lGUIDControleur2=1;let lGUIDCollectionIdentite=1;const C_id_event_iemodel='ie-model_verification';const C_RegExp_Match=/^\/(.*)\/([gim]*)$/;let lOutils=null;const uInvocateur=new ObjetInvocateur();let uTailleMaxTelephone=null;function _$refreshSelf_controleur(aForcerSynchrone){if(this.instance&&this.instance.isDestroyed&&this.instance.isDestroyed()){this.$promRefreshSelf=null;return Promise.resolve();}
if(this.$asyncPromise!==false&&!aForcerSynchrone){if(this.$promRefreshSelf&&!this.$promRefreshSelf._isFullfilled){return this.$promRefreshSelf;}
this.$promRefreshSelf=new Promise((aResolve) =>{setTimeout(() =>{this.$promRefreshSelf._isFullfilled=true;this.$promRefreshSelf=null;aResolve(this.$invocateur.evenement(C_id_event_iemodel));},0);});return this.$promRefreshSelf;}
this.$invocateur.evenement(C_id_event_iemodel);return Promise.resolve();}
function _$refresh_controleur(aForcerSynchrone){if(this.$asyncPromise!==false&&!aForcerSynchrone){if(this.$promRefresh&&!this.$promRefresh._isFullfilled){return this.$promRefresh;}
this.$promRefresh=new Promise((aResolve) =>{setTimeout(() =>{this.$promRefresh._isFullfilled=true;this.$promRefresh=null;aResolve(uInvocateur.evenement(C_id_event_iemodel));},0);});return this.$promRefresh;}
uInvocateur.evenement(C_id_event_iemodel);return Promise.resolve();}
function _initControleur(aControleur){if(!aControleur.$GUID){aControleur.$GUID=lGUIDControleur1+'_'+lGUIDControleur2;if(lGUIDControleur1===Number.MAX_VALUE){lGUIDControleur1=1;lGUIDControleur2+=1;} else{lGUIDControleur1+=1;}}
if(!aControleur.$refreshSelf){aControleur.$refreshSelf=_$refreshSelf_controleur;}
if(!aControleur.$refresh){aControleur.$refresh=_$refresh_controleur;}
if(!aControleur.$invocateur){aControleur.$invocateur=new ObjetInvocateur();}
return aControleur;}
function _transfererFragmentDansHTML(aNodesFragment,aParent,aInsererAvantLeNode){const lTab=_sliceNodes(aNodesFragment);while(aNodesFragment&&aNodesFragment.firstChild){aNodesFragment.removeChild(aNodesFragment.firstChild);}
if(lTab.length===0){return;}
let lSafeFragment=lTab.length>1?_createSafeFragment(document):null;lTab.forEach((aNode) =>{if(lSafeFragment){lSafeFragment.appendChild(aNode);} else{if(aInsererAvantLeNode){aParent.insertBefore(aNode,aInsererAvantLeNode);} else{aParent.appendChild(aNode);}}});if(lSafeFragment){if(aInsererAvantLeNode){aParent.insertBefore(lSafeFragment,aInsererAvantLeNode);} else{aParent.appendChild(lSafeFragment);}
lSafeFragment=null;}
let lNode=lTab[0];if(lTab[1]&&_estNoeudCommentaire(lNode)){lNode=lTab[1];}
return lNode;}
function _sliceNodes(aNodes){return aNodes&&aNodes.length?Array.from(aNodes):[];}
function _preInjectionHTML(aElementParent,aIgnorerScroll){const lResult={elementParent:aElementParent,parentDocument:false,initOverflowParent:false};let lElement=aElementParent;let lParent;while(!lResult.parentDocument&&lElement){lParent=null;if(lElement.nodeType===1){if(lElement.parentElement){lParent=lElement.parentElement;} else if(lElement.parentNode){lParent=lElement.parentNode;}}
lElement=lParent;lResult.parentDocument=lElement===document;}
if(lResult.parentDocument&&aIgnorerScroll!==true){let lOverflow=$(aElementParent).css('overflow');lResult.initOverflowParent=lOverflow==='auto'||lOverflow==='scroll';lOverflow=null;}
return lResult;}
function _finaliserInjectionHTML(aPreInjectionHtml,aContexte){if(aPreInjectionHtml.parentDocument){if(aPreInjectionHtml.initOverflowParent&&aPreInjectionHtml.elementParent){aPreInjectionHtml.elementParent.scrollLeft=0;aPreInjectionHtml.elementParent.scrollTop=0;}
try{if(aContexte&&aContexte.eventsInjectionHtml&&aContexte.eventsInjectionHtml.length>0){let lMeasures=[];let lMutates=[];const lEventsInjectionHtml=aContexte.eventsInjectionHtml;delete aContexte.eventsInjectionHtml;const lMeasureMutate={addMeasure:function(aMethode){lMeasures.push(aMethode);},addMutate:function(aMethode){lMutates.push(aMethode);}};const lExec=function(){lMeasures.forEach((aMethode) =>{if(aMethode){aMethode();}});lMutates.forEach((aMethode) =>{if(aMethode){aMethode();}});};lEventsInjectionHtml.forEach((aElement) =>{if(aElement&&!aElement.after&&aElement.methode){aElement.methode(lMeasureMutate);}});lExec();lMeasures=[];lMutates=[];lEventsInjectionHtml.forEach((aElement) =>{if(aElement&&aElement.after&&aElement.methode){aElement.methode(lMeasureMutate);}});lExec();}} catch(e){}}}
function _findFirstChild(aNode,aNiveau){let lNode=aNode;let lNiveau=aNiveau;while(lNode&&lNiveau>0){lNode=lNode.firstChild;lNiveau-=1;}
return lNode;}
function _getPremiereBalise(aChaine){if(!aChaine||!aChaine.search){return'';}
let lPosDebut=aChaine.search('<');if(lPosDebut<0){return'';}
lPosDebut+=1;const lChaine=aChaine.slice(lPosDebut);let lPosFinSup=lChaine.search('>');let lPosFinEsp=lChaine.search(' ');if(lPosFinSup<0&&lPosFinEsp<0){return'';}
if(lPosFinSup<0){lPosFinSup=lChaine.length;}
if(lPosFinEsp<0){lPosFinEsp=lChaine.length;}
return aChaine.slice(lPosDebut,lPosDebut+Math.min(lPosFinSup,lPosFinEsp)).toLowerCase();}
function _createSafeFragment(aDocument){const list=[].concat(uNodeNames),safeFrag=(aDocument||document).createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop());}}
return safeFrag;}
function _injectEtCompilNode(aParametres){let lSafe=_createSafeFragment(document);let lNodeParent;let lNiveauFirstChild;lNodeParent=lSafe.appendChild(document.createElement('div'));if(aParametres.html&&aParametres.html.nodeType>0){switch(aParametres.html.nodeName.toLowerCase()){case'td':lNodeParent.appendChild(document.createElement('table'));lNodeParent.firstChild.appendChild(document.createElement('tbody'));lNodeParent.firstChild.firstChild.appendChild(document.createElement('tr'));lNodeParent=lNodeParent.firstChild.firstChild.firstChild;break;case'tr':lNodeParent.appendChild(document.createElement('table'));lNodeParent=lNodeParent.firstChild;lNodeParent.appendChild(document.createElement('tbody'));lNodeParent=lNodeParent.firstChild;break;case'ul':lNodeParent.appendChild(document.createElement('ul'));lNodeParent=lNodeParent.firstChild;break;default:lNodeParent.appendChild(document.createElement('div'));lNodeParent=lNodeParent.firstChild;}
lNodeParent.appendChild(aParametres.html);} else{lNiveauFirstChild=1;switch(_getPremiereBalise(aParametres.html)){case'td':lNodeParent.insertAdjacentHTML('beforeend','<table><tbody><tr>'+aParametres.html+'</tr></tbody></table>');lNiveauFirstChild=3;break;case'tr':lNodeParent.insertAdjacentHTML('beforeend','<table><tbody>'+aParametres.html+'</tbody></table>');lNiveauFirstChild=2;break;case'li':lNodeParent.insertAdjacentHTML('beforeend','<ul>'+aParametres.html+'</ul>');break;default:lNodeParent.insertAdjacentHTML('beforeend','<div>'+aParametres.html+'</div>');}
lNodeParent=_findFirstChild(lNodeParent,lNiveauFirstChild);}
if(!aParametres.contexte){aParametres.contexte={};}
aParametres.childNodes=lNodeParent.childNodes;_compile(aParametres.childNodes,aParametres.element,aParametres.controleur,aParametres.contexte,aParametres.invocateur,0);lNodeParent=null;lSafe=null;}
function _injectHTML(aParametres){let lNode=null;if(aParametres.controleur){if(aParametres.instance&&!aParametres.controleur.instance){aParametres.controleur.instance=aParametres.instance;}
_initControleur(aParametres.controleur);}
if(!aParametres.element||aParametres.element.nodeType===undefined){return null;}
const lPreInjectionHtml=_preInjectionHTML(aParametres.element,aParametres.ignorerScroll);_injectEtCompilNode(aParametres);lNode=_transfererFragmentDansHTML(aParametres.childNodes,aParametres.element,aParametres.insererAvantLeNode);aParametres.childNodes=null;_finaliserInjectionHTML(lPreInjectionHtml,aParametres.contexte);return lNode;}
function _remplirDataModel(aContexteCourant){const lModele=aContexteCourant.node.getAttribute('ie-model');if(!lModele){return null;}
const lModeleArg=_parseValueEvent(lModele,aContexteCourant.contexte);if(lModeleArg&&lModeleArg.nom){aContexteCourant.data.$modeleParsed=lModeleArg;aContexteCourant.data.$modeleValue=lModele;}
return true;}
function _getModel(aContexteCourant){const lAvecModele=_remplirDataModel(aContexteCourant);const lModele=aContexteCourant.data.$modeleValue;if(!lModele){return null;}
if(lAvecModele){aContexteCourant.node.removeAttribute('ie-model');if(!aContexteCourant.ignorerCommentaires){lOutils.addCommentaireDebug(aContexteCourant.node,'ie-model="'+lModele+'"');}}
return lModele;}
function _getControleSaisieEvent(aContexteCourant){if(!aContexteCourant.node.hasAttribute('ie-controlesaisie')){return false;}
aContexteCourant.$controleSaisie=!!ControleSaisieEvenement
;aContexteCourant.node.removeAttribute('ie-controlesaisie');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-controleSaisie');return true;}
function _creerInstanceIdentite(aClass,aParametresIdentite){const lGUID=lGUIDCollectionIdentite;lGUIDCollectionIdentite+=1;aParametresIdentite.nomComplet='IEHtml.collectionIdentite['+lGUID+']';const lInstance=new aClass(aParametresIdentite);IEHtml.collectionIdentite[lGUID]=lInstance;return{instance:lInstance,callbackDestruction:function(){delete IEHtml.collectionIdentite[lGUID];}};}
function _callbackRefresh(aControleur,aData,aCallback){if(aControleur&&aControleur.$off&&aControleur.$off()){return;}
aCallback();}
function _abonnerRefresh(aCallback,aElementPourDestruction,aContexteCourant,aCallbackDestroy,aMutationObserverNoeudDetruit){let lCallbacks=[];let lAjouterAbonnement=true;let lId;let lIdSelf;if(!aElementPourDestruction){return;}
if(aContexteCourant.data){if(!aContexteCourant.data.$callbacksRefresh){aContexteCourant.data.$callbacksRefresh=[];} else{lAjouterAbonnement=false;}
lCallbacks=aContexteCourant.data.$callbacksRefresh;}
lCallbacks.push(_callbackRefresh.bind(this,aContexteCourant.controleur,aContexteCourant.data,aCallback));if(lAjouterAbonnement){const lInvocateur=aContexteCourant.invocateur?aContexteCourant.invocateur:uInvocateur;lId=lInvocateur.abonner(C_id_event_iemodel,() =>{if(aContexteCourant.controleur&&aContexteCourant.controleur.instance&&aContexteCourant.controleur.instance.isDestroyed&&aContexteCourant.controleur.instance.isDestroyed()){return;}
const lNb=lCallbacks.length;for(let i=0;i<lNb;i++){lCallbacks[i]();}},null,false);if(!aContexteCourant.invocateur&&aContexteCourant.controleur){lIdSelf=aContexteCourant.controleur.$invocateur.abonner(C_id_event_iemodel,() =>{if(aContexteCourant.controleur&&aContexteCourant.controleur.instance&&aContexteCourant.controleur.instance.isDestroyed&&aContexteCourant.controleur.instance.isDestroyed()){return;}
const lNb=lCallbacks.length;for(let i=0;i<lNb;i++){lCallbacks[i]();}},null,false);}
let lDejaDetruit=false;let lObserver=null;const lDestroy=function(){if(lDejaDetruit){return;}
lInvocateur.desabonner([lId]);if(!aContexteCourant.invocateur&&aContexteCourant.controleur){aContexteCourant.controleur.$invocateur.desabonner([lIdSelf]);}
if(aContexteCourant.data){aContexteCourant.data.$destroy=true;}
if(lObserver&&lObserver.disconnect){lObserver.disconnect();lObserver=null;}
if(aCallbackDestroy){aCallbackDestroy();}
lDejaDetruit=true;};$(aElementPourDestruction).on('destroyed',lDestroy);if(aMutationObserverNoeudDetruit){const lMutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(lMutationObserver){lObserver=new lMutationObserver((mutations) =>{MethodesTableau.parcourir(mutations,(mutation) =>{if(!lDejaDetruit&&mutation.type==='childList'){try{if(aMutationObserverNoeudDetruit()){lDestroy();return false;}} catch(e){}}});});}
if(lObserver){lObserver.observe(aElementPourDestruction,{childList:true});}}}}
function _getAccesParametres(aNomEnChaine,aContexteCourant,aAccepteErreur,aIgnorerNomOrigine){let lParsed=null;const lResult={valide:false,estFonction:false,nom:aNomEnChaine,args:[]};if(aNomEnChaine){lParsed=_parseValueEvent(aNomEnChaine,aContexteCourant.contexte,aAccepteErreur);if(lParsed){aNomEnChaine=lParsed.nom;}}
const lNomEnChaineOrigine=aNomEnChaine;if(aNomEnChaine&&(!aContexteCourant.data||!aContexteCourant.data.$modeleParsed)){if(!lParsed){return lResult;}}
let lAncreControleur=aContexteCourant.controleur;let lTab;let lNom;if(aContexteCourant.data&&aContexteCourant.data.$modeleParsed){if(!lParsed||!lParsed.args||lParsed.args.length===0){lParsed=aContexteCourant.data.$modeleParsed;} else{lParsed.nom=aContexteCourant.data.$modeleParsed.nom;}
if(aContexteCourant.data.$modeleParsed.nom){aNomEnChaine=lParsed.nom+(aNomEnChaine?'.'+aNomEnChaine:'');}}
const lArgs=lResult.args=lParsed?lParsed.args:[];if(!aContexteCourant.controleur||!aNomEnChaine){return lResult;}
lTab=aNomEnChaine.split('.');lNom=lTab.pop();lAncreControleur=MethodesObjet.get(aContexteCourant.controleur,lTab);let lEstFonction=lAncreControleur&&lAncreControleur[lNom]!==undefined&&MethodesObjet.isFunction(lAncreControleur[lNom]);if(!lEstFonction&&aContexteCourant.data&&aContexteCourant.data.$modeleParsed&&!aIgnorerNomOrigine){const lTabHorsModele=lNomEnChaineOrigine.split('.');const lNomHorsModel=lTabHorsModele.pop();const lAncreControleurHorsModele=MethodesObjet.get(aContexteCourant.controleur,lTabHorsModele);if(lAncreControleurHorsModele&&lAncreControleurHorsModele[lNom]!==undefined&&MethodesObjet.isFunction(lAncreControleurHorsModele[lNomHorsModel])){lEstFonction=true;lAncreControleur=lAncreControleurHorsModele;lTab=lTabHorsModele;lNom=lNomHorsModel;}}
const lTabRempli=lTab.length>0;if(lEstFonction){const lArgsCallback=lArgs||[];let lAvecArgsBoucleREPEAT=false;let lArray;for(let lIx=0;lIx<lArgsCallback.length;lIx++){if(lArgsCallback[lIx]&&lArgsCallback[lIx].getterArray){lAvecArgsBoucleREPEAT=true;break;}}
lResult.valide=true;lResult.controleur=aContexteCourant.controleur;lResult.getAncre=function(){return lTabRempli?MethodesObjet.get(aContexteCourant.controleur,lTab):aContexteCourant.controleur;};lResult.callback=function(aTabArguments){const lAncre=lTabRempli?MethodesObjet.get(aContexteCourant.controleur,lTab):aContexteCourant.controleur;if(!lAncre||!lAncre[lNom]||!lAncre[lNom].apply){return'';}
let lArgs=lArgsCallback;let lArgCallback;if(lAvecArgsBoucleREPEAT){lArgs=new Array(lArgsCallback.length);for(let lIx=0,lLength=lArgsCallback.length;lIx<lLength;lIx++){lArgCallback=lArgsCallback[lIx];if(lArgCallback&&lArgCallback.getterArray){lArray=lArgCallback.getterArray();lArgs[lIx]={indice:lArgCallback.indice,element:lArray[lArgCallback.indice],tableau:lArray,arguments:lArgCallback.arguments};} else{lArgs[lIx]=lArgsCallback[lIx];}}}
try{return lAncre[lNom].apply(aContexteCourant,aTabArguments&&aTabArguments.length>0?lArgs.concat(aTabArguments):lArgs);} catch(e){}};lResult.estFonction=true;lResult.nom=lNom;return lResult;}
lResult.valide=!!MethodesObjet.get(aContexteCourant.controleur.instance,lTab);lResult.getAncre=function(){return lTabRempli?MethodesObjet.get(aContexteCourant.controleur.instance,lTab):aContexteCourant.controleur.instance;};lResult.getAncreControleur=lAncreControleur&&lAncreControleur[lNom]!==undefined?function(){return lTabRempli?MethodesObjet.get(aContexteCourant.controleur,lTab):aContexteCourant.controleur;}:null;lResult.callback=function(){const lAncre=lTabRempli?MethodesObjet.get(aContexteCourant.controleur.instance,lTab):aContexteCourant.controleur.instance;if(!lAncre){return'';}
return lAncre[lNom];};lResult.estFonction=false;lResult.nom=lNom;return lResult;}
function _getAccesParametresModel(aNomEnChaine,aContexteCourant,aAccepteErreur){return _getAccesParametres(aNomEnChaine,aContexteCourant,aAccepteErreur,true);}
function _addCommentaireDebug(aNode,aCommentaire){}
function _estNoeudCommentaire(aNode){return!!aNode&&aNode.nodeType===8;}
function _getContexteCourant(aControleur,aContexte,aNode,aData,aInvocateur){return{controleur:aControleur,instance:aControleur?aControleur.instance:null,contexte:aContexte,data:aData,node:aNode,invocateur:aInvocateur,invocateurNode:new ObjetInvocateur(true)};}
function _getAttributesDeNode(aNode){return _sliceNodes(aNode.attributes);}
function _getMapDeNode(aNode){const lMap={};for(let attr,nAttrs=_getAttributesDeNode(aNode),j=0,jj=nAttrs&&nAttrs.length;j<jj;j++){attr=nAttrs[j];if(attr.name){const lName=attr.name.toLowerCase();lMap[lName]=attr.value;}}
return lMap;}
function _copyAttributs(aNodeSource,aNodeCible,aCallback){const lMap=_getMapDeNode(aNodeSource);const lJCible=$(aNodeCible);for(const llName in lMap){try{if(!aCallback||aCallback(llName,lMap[llName],lMap)!==false){lJCible.attr(llName,lMap[llName]);}} catch(e){}}
return lMap;}
function _addGetterHtml(aContexteCourant,aInfosParametres,aWrapperHtml){const lNodeDestination=aContexteCourant.nodeTransfertContenuDynamique||aContexteCourant.node;const lGetter=function(){const lResult=aInfosParametres.callback([lNodeDestination,aContexteCourant.data]);if(MethodesObjet.isNumber(lResult)){return lResult+'';}
return(lResult||'')+'';};const lWrapperHtml=aWrapperHtml||function(aHtml){return aHtml;};const lHtml=lGetter();if(!aInfosParametres.estFonction&&!MethodesObjet.isString(lHtml)){return;}
const lInvocateur=new ObjetInvocateur();$(lNodeDestination).empty();try{lNodeDestination.innerHTML=lWrapperHtml(lHtml);} catch(e){$(lNodeDestination).html(lWrapperHtml(lHtml));}
aContexteCourant.invocateurNode.evenement(lOutils.nomInvocRefresh,{refreshHtml:true,html:lHtml});_compile(lNodeDestination.childNodes,lNodeDestination,aContexteCourant.controleur,aContexteCourant.contexte,lInvocateur);let lOldHtmlValue=lHtml;_abonnerRefresh(() =>{const lHtml=lGetter();if(lHtml!==lOldHtmlValue){lOldHtmlValue=lHtml;IEHtml.empty(lNodeDestination);const lContexte=Object.assign({},aContexteCourant.contexte);lContexte.eventsInjectionHtml=[];_injectHTML({element:lNodeDestination,html:lWrapperHtml(lHtml),controleur:aContexteCourant.controleur,contexte:lContexte,invocateur:lInvocateur});aContexteCourant.invocateurNode.evenement(lOutils.nomInvocRefresh,{refreshHtml:true,html:lHtml});} else{lInvocateur.evenement(IEHtml.C_id_event_iemodel);}},lNodeDestination,aContexteCourant);return lNodeDestination;}
lOutils={nomInvocRefresh:'__refresh_node__',parseValueEvent:_parseValueEvent,getModel:_getModel,creerInstanceIdentite:_creerInstanceIdentite,abonnerRefresh:_abonnerRefresh,getAccesParametres:_getAccesParametres,getAccesParametresModel:_getAccesParametresModel,injectHTML:_injectHTML,getContexteCourant:_getContexteCourant,getControleSaisieEvent:_getControleSaisieEvent,getAttributesDeNode:_getAttributesDeNode,getMapDeNode:_getMapDeNode,copyAttributs:_copyAttributs,gererInputCB:_gererInputCB,gererInputText:_gererInputText,addCommentaireDebug:_addCommentaireDebug,composantsAttributs:uAttributs,createSafeFragment:_createSafeFragment,caret:_caret,compile:_compile,addGetterHtml:_addGetterHtml,surInjectionHtml:function(aContexteCourant,aMethode,aAfter){if(!aContexteCourant||!aContexteCourant.contexte){return;}
if(!aContexteCourant.contexte.eventsInjectionHtml){aContexteCourant.contexte.eventsInjectionHtml=[];}
if(MethodesObjet.isFunction(aMethode)){if(aAfter){aContexteCourant.contexte.eventsInjectionHtml.unshift({methode:aMethode,after:true});} else{aContexteCourant.contexte.eventsInjectionHtml.push({methode:aMethode,after:false});}
return true;} else{}},surInjectionHtml_promise:function(aContexteCourant,aAfter){return new Promise((aResolve,aReject) =>{const lResult=lOutils.surInjectionHtml(aContexteCourant,() =>{aResolve();},aAfter);if(lResult!==true){aReject();}});},surNodeEtNodeAfter:function(aContexteCourant){const lInfosGetNode=this.getAccesParametres('node',aContexteCourant);if(lInfosGetNode&&lInfosGetNode.estFonction){this.surInjectionHtml(aContexteCourant,(...aArgs) =>{lInfosGetNode.callback(aArgs);});}
const lInfosGetNodeAfter=this.getAccesParametres('nodeAfter',aContexteCourant);if(lInfosGetNodeAfter&&lInfosGetNodeAfter.estFonction){this.surInjectionHtml(aContexteCourant,(...aArgs) =>{lInfosGetNodeAfter.callback(aArgs);},true);}},replaceNode:function(aNodeAncien,aNodeNouveau){if(aNodeAncien&&aNodeNouveau&&aNodeAncien.parentNode&&aNodeAncien.parentNode.replaceChild){$.cleanData(aNodeAncien);aNodeAncien.parentNode.replaceChild(aNodeNouveau,aNodeAncien);}}};function _parseArg(aArg,aEstChaine,aContexte){if(aEstChaine){return aArg;}
if(aContexte&&aContexte.repeat&&aContexte.repeat[aArg]){return aContexte.repeat[aArg];}
if(aArg==='null'){return null;}
if(aArg==='undefined'){return undefined;}
if(aArg==='true'){return true;}
if(aArg==='false'){return false;}
let lNumber=parseInt(aArg,10);if(isNaN(lNumber)){lNumber=null;throw'erreur _parseArg';}
return lNumber;}
function _parseValueEvent(aValue,aContexte,aSortieEnErreur){if(!aValue){return null;}
const lResult={nom:'',args:[]};let lEtat='rech_fonction';let lChar;let lNomFonction='';let lArg='';let LArgEstChaine=false;const lLength=aValue.length;const lSepDebut='(';const lSepFin=')';try{for(let lIPars=0;lIPars<lLength;lIPars++){lChar=aValue.charAt(lIPars);switch(lEtat){case'rech_fonction':if(lChar===lSepDebut||lIPars===lLength-1){lEtat='rech_param';if(lIPars===aValue.length-1){lNomFonction+=lChar;}
lResult.nom=lNomFonction.trim();if(lResult.nom.length===0){return null;}
lArg='';} else{lNomFonction+=lChar;}
break;case'rech_param':if(lChar===lSepFin){if(lIPars<lLength-1){if(aValue.charAt(lIPars+1)!==';'){throw'erreur fermeture fonction';}}
lArg=lArg.trim();if(LArgEstChaine||lArg.length>0||lResult.args.length>0){lResult.args.push(_parseArg(lArg,LArgEstChaine,aContexte));}
lEtat='fin';break;}
if(lChar===','){lResult.args.push(_parseArg(lArg.trim(),LArgEstChaine,aContexte));lArg='';LArgEstChaine=false;} else if(lChar==='\''){if(lArg.trim().length>0){}
lArg='';lEtat='rech_chaine';} else{lArg+=lChar;}
break;case'rech_chaine':if(lChar==='\''&&(aValue.charAt(lIPars+1)===')'||aValue.charAt(lIPars+1)===',')){lEtat='rech_param';LArgEstChaine=true;break;}
lArg+=lChar;break;case'fin':if(lChar!==';'){throw'erreur fin fonction';}
break;default:throw'cas non géré';}}} catch(e){if(aSortieEnErreur){return null;}}
return lResult;}
function _positionnerObjetSelonAccesseur(aChaineAccesseur,aObjet){if(!aObjet){return null;}
const lTab=aChaineAccesseur.split('.');let lResult=aObjet;for(let i=0;i<lTab.length;i++){lResult=lResult[lTab[i]];if(!lResult){return null;}}
return lResult;}
function _caret(aElement,begin,end){let range;if(!aElement){return;}
if(typeof begin==='number'){end=(typeof end==='number')?end:begin;const lValue=aElement.value;begin=Math.min(begin,lValue.length);end=Math.min(end,lValue.length);if(aElement.setSelectionRange){aElement.setSelectionRange(begin,end);} else if(aElement.createTextRange){range=aElement.createTextRange();range.collapse(true);range.moveEnd('character',end);range.moveStart('character',begin);range.select();}} else{if(aElement.setSelectionRange){begin=aElement.selectionStart;end=aElement.selectionEnd;} else if(document.selection&&document.selection.createRange){range=document.selection.createRange();begin=0-range.duplicate().moveStart('character',-100000);end=begin+range.text.length;}
return{begin:begin,end:end};}}
function _verificationInputModel(aContexteCourant,aParametres,aPatternValidateRegex){if(aParametres.data.$ignoreRefresh){return;}
let lValue;if(aParametres.getterValueInit){if(aParametres.declencherExitChange){if(aParametres.getterValue){lValue=aParametres.getterValue();} else{return;}} else{lValue=aParametres.getterValueInit();}} else{if(!aParametres.getterValue){return;}
lValue=aParametres.getterValue();}
let lValueInput;if(aParametres.saveValues.value!==lValue){if(aParametres.estCB){aParametres.eventActif=false;$(aParametres.node).inputChecked(lValue);aParametres.eventActif=true;aParametres.saveValues.value=aParametres.saveValues.inputValue=lValue;} else{aParametres.eventActif=false;lValueInput=lValue;if(aParametres.toDisplay){lValueInput=aParametres.toDisplay(lValueInput);}
if(aParametres.contentEditable){aParametres.node.innerHTML=lValueInput;} else{aParametres.node.value=lValueInput;}
aParametres.eventActif=true;if(aPatternValidateRegex){const lAncreControleur=_positionnerObjetSelonAccesseur(aParametres.data.$modeleParsed.nom,aParametres.controleur);if(lAncreControleur){aContexteCourant.$patternOK=aPatternValidateRegex(lValue);}}
aParametres.saveValues.value=lValue;aParametres.saveValues.inputValue=lValueInput;}} else{if(aParametres.estCB&&
aContexteCourant.data&&
aContexteCourant.data.estRadioBouton&&
lValue!==$(aContexteCourant.node).is(':checked')){$(aParametres.node).inputChecked(lValue);}
if(aParametres.toDisplay){lValueInput=aParametres.toDisplay(lValue);if(aParametres.saveValues.inputValue!==lValueInput){aParametres.eventActif=false;if(aParametres.contentEditable){aParametres.node.innerHTML=lValueInput;} else{aParametres.node.value=lValueInput;}
aParametres.eventActif=true;}}}
if(aParametres.getterDisabled){lValue=!!aParametres.getterDisabled();if(lValue!==aParametres.saveDisabled){$(aParametres.node).inputDisabled(lValue);aParametres.saveDisabled=lValue;}}
if(aParametres.getterReadOnly){lValue=!!aParametres.getterReadOnly();if(lValue!==aParametres.saveReadOnly){$(aParametres.node).prop('readonly',lValue);aParametres.saveReadOnly=lValue;}}}
function _affecterGetterSetterInputModel(aParametres,aContexteCourant,aEstCB){let lValue,lAncre;const lInfosGetValueInit=_getAccesParametresModel('getValueInit',aContexteCourant);if(lInfosGetValueInit.estFonction){aParametres.getterValueInit=function(){const lValue=lInfosGetValueInit.callback([aParametres.node]);if(aEstCB){return!!lValue;}
return lValue===undefined||lValue===null?'':lValue.toString();};}
const lInfosGetValue=_getAccesParametresModel('getValue',aContexteCourant);const lInfosGetSetModele=_getAccesParametres('',aContexteCourant);if(lInfosGetValue.estFonction){aParametres.getterValue=function(){const lValue=lInfosGetValue.callback([aParametres.node]);if(aEstCB){return!!lValue;}
return lValue===undefined||lValue===null?'':lValue.toString();};} else if(!aParametres.getterValueInit){lAncre=lInfosGetSetModele.getAncre();if(!lInfosGetSetModele.valide||!lAncre){return false;}
lValue=lAncre[lInfosGetSetModele.nom];if(lValue){if(aEstCB&&lValue!==true){return false;}
if(!aEstCB&&!MethodesObjet.isString(lAncre[lInfosGetSetModele.nom])){return false;}}
aParametres.getterValue=function(){const lValue=lInfosGetSetModele.callback();if(aEstCB){return!!lValue;}
return lValue===undefined||lValue===null?'':lValue.toString();};}
const lInfosSetValue=_getAccesParametresModel('setValue',aContexteCourant);if(lInfosSetValue.estFonction){aParametres.setterValue=function(aValue,aParametresSetter){return lInfosSetValue.callback([aValue,aParametresSetter]);};} else if(!aParametres.getterValueInit){lAncre=lInfosGetSetModele.getAncre();if(!lInfosGetSetModele.valide||!lAncre){return false;}
aParametres.setterValue=function(aValue){const lAncre=lInfosGetSetModele.getAncre();if(!lAncre){return;}
lAncre[lInfosGetSetModele.nom]=aValue;};}
const lInfosGetDisabled=_getAccesParametresModel('getDisabled',aContexteCourant);if(lInfosGetDisabled.estFonction){aParametres.getterDisabled=lInfosGetDisabled.callback.bind(null,[aParametres.node,aContexteCourant.data]);}
const lInfosGetReadOnly=_getAccesParametresModel('getReadOnly',aContexteCourant);if(lInfosGetReadOnly.estFonction){aParametres.getterReadOnly=lInfosGetReadOnly.callback.bind(null,[aParametres.node,aContexteCourant.data]);}
const lInfosExitChange=_getAccesParametresModel('exitChange',aContexteCourant);if(lInfosExitChange.estFonction){aParametres.infosExitChange=lInfosExitChange;}
if(aParametres.getterValueInit&&!aParametres.infosExitChange){aParametres.getterValueInit=null;}
const lInfosInterrompreEvent=_getAccesParametresModel('interrompreEvent',aContexteCourant);if(lInfosInterrompreEvent.estFonction){aParametres.interrompreEvent=lInfosInterrompreEvent;}
const lInfosNode=_getAccesParametresModel('node',aContexteCourant);if(lInfosNode.estFonction){aParametres.infosNode=lInfosNode;}
const lInfosNodeAfter=_getAccesParametresModel('nodeAfter',aContexteCourant);if(lInfosNodeAfter.estFonction){aParametres.infosNodeAfter=lInfosNodeAfter;}
const lInfoskeyupEnter=_getAccesParametresModel('keyupEnter',aContexteCourant);if(lInfoskeyupEnter.estFonction){aParametres.infoskeyupEnter=lInfoskeyupEnter;}
return true;}
function _estNodeContentEditable(aNode){if(aNode&&Support.contentEditable&&(aNode.isContentEditable||aNode.contentEditable==='true')){const lNodeName=aNode.nodeName?aNode.nodeName.toLowerCase():'';return lNodeName!=='input'&&lNodeName!=='textarea';}
return false;}
function _gererInputModele(aContexteCourant,aJNode,aEstCB,aAttributType,aMaxLength){let lModele=null,lMask,lMatchMask,lPattern,lMatchPattern,lPatternValidateRegex,lTrim=false,lAvecAttrTrim=false,lValue=aEstCB?false:'',lDisabled=false,lReadOnly=false,lInfosToDisplay=null,lInfosFromDisplay=null,lFuncExitChange=null,lEstTexteBrut=false;const lEstInputTime=aAttributType==='time';const lSaveValues={},lRefresh=aContexteCourant.contexte.refresh,lParametres={node:aContexteCourant.node,controleur:aContexteCourant.controleur,data:aContexteCourant.data,estCB:aEstCB,saveValues:lSaveValues,eventActif:true,saveDisabled:false,getterValue:null,getterValueInit:null,setterValue:null,getterDisabled:null,getterReadOnly:null,toDisplay:null,fromDisplay:null,declencherExitChange:false,contentEditable:_estNodeContentEditable(aContexteCourant.node)};if(lParametres.contentEditable&&aMaxLength>0){aMaxLength=0;}
if(aContexteCourant.node.hasAttribute('ie-etatsaisie')){aContexteCourant.etatSaisie=true;aContexteCourant.node.removeAttribute('ie-etatsaisie');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-etatsaisie');}
if(aContexteCourant.controleur){lModele=_getModel(aContexteCourant);if(lModele){Object.assign(lParametres,{modele:lModele,modeleArg:aContexteCourant.data.$modeleParsed});if(!_affecterGetterSetterInputModel(lParametres,aContexteCourant,aEstCB)){return;}
if(lParametres.infosExitChange){aContexteCourant.data.forceExitChange=function(aParametresExit){if(lFuncExitChange){lFuncExitChange(aParametresExit);}};}
lValue=lParametres.getterValueInit?lParametres.getterValueInit():lParametres.getterValue();if(lParametres.getterDisabled){lDisabled=lParametres.saveDisabled=!!lParametres.getterDisabled();aJNode.inputDisabled(lDisabled);}
if(lParametres.getterReadOnly){lReadOnly=lParametres.saveReadOnly=!!lParametres.getterReadOnly();aJNode.prop('readonly',lReadOnly);}
if(aEstCB){lValue=!!lValue;lSaveValues.value=lSaveValues.inputValue=lValue;aJNode.inputChecked(lValue);} else{lValue=lValue||'';lSaveValues.value=lSaveValues.inputValue=lValue;lAvecAttrTrim=aContexteCourant.node.hasAttribute('ie-trim');if(lAvecAttrTrim){lOutils.addCommentaireDebug(aContexteCourant.node,'ie-trim');aContexteCourant.node.removeAttribute('ie-trim');}
lTrim=(aAttributType!=='password'&&lAvecAttrTrim)||aContexteCourant.estIndicatifTelephone;if(lParametres.contentEditable){lEstTexteBrut=true;} else if(aContexteCourant.estTelephone||aContexteCourant.estIndicatifTelephone||aAttributType==='password'||aAttributType==='email'){lEstTexteBrut=true;} else if(aContexteCourant.node.hasAttribute('ie-textbrut')){lEstTexteBrut=true;aContexteCourant.node.removeAttribute('ie-textbrut');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-textbrut');}
if(!uTailleMaxTelephone){uTailleMaxTelephone=GChaine.maskTelephone.replace(/ /g,'').length;}
lInfosToDisplay=_getAccesParametresModel('toDisplay',aContexteCourant);lInfosFromDisplay=_getAccesParametresModel('fromDisplay',aContexteCourant);lParametres.toDisplay=function(aChaine){if(!lEstTexteBrut){aChaine=GChaine.enleverEntites(aChaine);}
if(aContexteCourant.estIndicatifTelephone){aChaine='+ '+aChaine.replace(IEHtml.REGEXP_INDICATIF_TELEPHONE,'').slice(0,IEHtml.TAILLEMAX_INDICATIF_TELEPHONE);}
if(aContexteCourant.estTelephone&&GChaine&&GChaine.formatTelephone){aChaine=GChaine.formatTelephone(aChaine.replace(IEHtml.REGEXP_TELEPHONE,'').slice(0,uTailleMaxTelephone));}
if(lInfosToDisplay&&lInfosToDisplay.estFonction){aChaine=lInfosToDisplay.callback([aChaine,aContexteCourant.data]);}
return aChaine;};lParametres.fromDisplay=function(aChaine){if(lInfosFromDisplay&&lInfosFromDisplay.estFonction){aChaine=lInfosFromDisplay.callback([aChaine,aContexteCourant.data]);}
if(!lEstTexteBrut){aChaine=GChaine.ajouterEntites(aChaine);}
if(lTrim&&aChaine.trim){aChaine=aChaine.trim();}
if(aContexteCourant.estIndicatifTelephone){aChaine=aChaine.replace(/\+| /g,'').replace(IEHtml.REGEXP_INDICATIF_TELEPHONE,'').slice(0,IEHtml.TAILLEMAX_INDICATIF_TELEPHONE);}
if(aContexteCourant.estTelephone){aChaine=aChaine.replace(/ /g,'').replace(IEHtml.REGEXP_TELEPHONE,'').slice(0,uTailleMaxTelephone);}
return aChaine;};lValue=lSaveValues.inputValue=lParametres.toDisplay(lValue);if(lParametres.contentEditable){aContexteCourant.node.innerHTML=lValue;} else{aContexteCourant.node.value=lValue;}
lPattern=aContexteCourant.node.getAttribute('ie-pattern');lMatchPattern=lPattern&&lPattern.match?lPattern.match(C_RegExp_Match):null;if(lMatchPattern){const lRegExp=new RegExp(lMatchPattern[1],lMatchPattern[2]);lPatternValidateRegex=function(value){return!value||lRegExp.test(value);};aContexteCourant.$patternOK=lPatternValidateRegex(lSaveValues.inputValue);}
if(lPattern){lOutils.addCommentaireDebug(aContexteCourant.node,'ie-pattern="'+lPattern+'"');aContexteCourant.node.removeAttribute('ie-pattern');}}}}
if(!aEstCB){lMask=aContexteCourant.node.getAttribute('ie-mask');if(lMask){lOutils.addCommentaireDebug(aContexteCourant.node,'ie-mask="'+lMask+'"');aContexteCourant.node.removeAttribute('ie-mask');if(lParametres.contentEditable){lMask='';}}
if(lMask&&!lModele){lSaveValues.value=aContexteCourant.node.value;}
lMatchMask=lMask&&lMask.match?lMask.match(C_RegExp_Match):null;}
if(lModele){_abonnerRefresh(() =>{_verificationInputModel(aContexteCourant,lParametres,lPatternValidateRegex);},aContexteCourant.node,aContexteCourant);}
if(lModele||(!aEstCB&&(lMatchMask||aMaxLength))){aJNode.on(aEstCB?IEHtml.C_eventsModifyCheckbox:IEHtml.C_eventsModifyInput,function(aEvent){if(!lParametres.eventActif){return;}
let lNewValue=null,lNewInputValue=null,lValueInput,lCaret=null;if(aEstCB){lNewValue=$(this).is(':checked');} else{lValueInput=lParametres.contentEditable?this.innerHTML:this.value;lNewValue=lValueInput;lNewInputValue=lNewValue;if(lParametres.interrompreEvent&&lParametres.interrompreEvent.callback([aEvent])){return false;}
if(aMaxLength>0&&lNewValue.length>aMaxLength&&!lParametres.contentEditable){const lTop=$(this).scrollTop();this.value=lNewValue=lNewValue.slice(0,aMaxLength);$(this).scrollTop(lTop);}
if(lMatchMask&&lNewValue.length>0){let lSanitize='';let lCharMask='';const lRegExpMask=new RegExp(lMatchMask[1],lMatchMask[2]);for(let lIx=0;lIx<lNewValue.length;lIx++){lCharMask=lNewValue.charAt(lIx);if(!lRegExpMask.test(lCharMask)){lSanitize+=lCharMask;}}
if(lParametres.fromDisplay){lNewValue=lParametres.fromDisplay(lNewValue);}
if(lSanitize!==lNewValue){const lNomProp=lParametres.contentEditable?'innerHTML':'value';if(lSanitize===lSaveValues.value){if(lParametres.toDisplay){this[lNomProp]=lParametres.toDisplay(lSaveValues.value);} else{this[lNomProp]=lSaveValues.value;}
return false;}
lNewValue=lSanitize;lNewInputValue=lSanitize;if(lParametres.toDisplay){this[lNomProp]=lNewInputValue=lParametres.toDisplay(lNewValue);} else{this[lNomProp]=lNewValue;}}} else if(lParametres.fromDisplay){lNewValue=lParametres.fromDisplay(lNewValue);}
if(lParametres.toDisplay){lNewInputValue=lParametres.toDisplay(lNewValue);if((lTrim&&lNewInputValue.trim()!==lValueInput.trim())||(!lTrim&&lNewInputValue!==lValueInput)){lCaret=null;if(aContexteCourant.estTelephone){lCaret=_caret(this);if(lValueInput.length<lSaveValues.inputValue.length){lCaret.begin=Math.max(0,lCaret.begin-(lSaveValues.inputValue.length-lNewInputValue.length)+1);if(lNewInputValue.charAt(lCaret.begin-1)===' '){lCaret.begin-=1;}
lCaret.change=true;} else{if(lNewInputValue.length<lSaveValues.inputValue.length){lCaret.begin-=lValueInput.length-lNewInputValue.length+1;}
if(lNewInputValue===lSaveValues.inputValue){lCaret.begin-=lValueInput.length-lNewInputValue.length;} else if(lNewInputValue.charAt(lCaret.begin-1)===' '){lCaret.begin+=1;} else if(lNewInputValue.length>lSaveValues.inputValue.length&&
lCaret.begin>lSaveValues.inputValue.length){lCaret.begin=lNewInputValue.length;}
lCaret.change=true;}}
if(lParametres.contentEditable){this.innerHTML=lNewInputValue;} else{this.value=lNewInputValue;}
if(lCaret&&lCaret.change){_caret(this,lCaret.begin);}}}}
if(lSaveValues.value!==lNewValue){let lPatternOK,lCloneSave;if(lModele){lPatternOK=true;if(lPatternValidateRegex){lPatternOK=lPatternValidateRegex(lNewValue);aContexteCourant.$patternOK=lPatternOK;}
lCloneSave=MethodesObjet.dupliquer(lSaveValues);}
lParametres.declencherExitChange=true;lSaveValues.value=lNewValue;lSaveValues.inputValue=lNewInputValue;if(aContexteCourant.etatSaisie){if(aContexteCourant.controleur&&aContexteCourant.controleur.instance&&aContexteCourant.controleur.instance.SetEtatSaisie){aContexteCourant.controleur.instance.SetEtatSaisie(true);} else{Invocateur.evenement(ObjetInvocateur.events.etatSaisie,true);}}
if(lModele){const lParametresSetValue={node:this,event:aEvent,value:lNewValue,inputValue:lNewInputValue,textBrut:lEstTexteBrut,oldValues:lCloneSave,patternOK:lPatternOK,selectionTexte:false};if(lEstInputTime&&IEHtml.GDate){lParametresSetValue.time=IEHtml.GDate.parseHeureMinute(lNewValue);}
if(lParametres.setterValue){lParametres.setterValue(lNewValue,lParametresSetValue);}
aContexteCourant.data.$ignoreRefresh=true;try{lRefresh();} finally{delete aContexteCourant.data.$ignoreRefresh;}
if(aContexteCourant.data.$destroy===true){return;}
_verificationInputModel(aContexteCourant,lParametres);if(lParametresSetValue.selectionTexte&&!aEstCB){aContexteCourant.node.select();}}}});}
if(lTrim){aJNode.on('change blur',function(){const lValue=lParametres.contentEditable?this.innerHTML:this.value;const lValueTrim=lValue.trim();if(lValueTrim!==lValue){lSaveValues.value=lValueTrim;lSaveValues.inputValue=lValueTrim;if(lParametres.contentEditable){this.innerHTML=lValueTrim;} else{this.value=lValueTrim;}}});}
if(lParametres.infosExitChange){lFuncExitChange=function(aParamsExit){const lParametresExitChange=Object.assign(aParamsExit||{},{data:aContexteCourant.data,event:null});let lValue=lSaveValues.value;if(lEstInputTime&&IEHtml.GDate){const lTime=IEHtml.GDate.parseHeureMinute(lSaveValues.value);lParametresExitChange.time=lTime;const lStepStr=aContexteCourant.node.getAttribute('step');if(lStepStr){const lStepInputTime_enM=Math.floor(parseInt(lStepStr,10)/60);if(lStepInputTime_enM>0){const lReste=(lTime.minute%lStepInputTime_enM);if(lReste<=(lStepInputTime_enM/2)){lTime.minute=(lTime.minute-lReste);} else{lTime.minute=(lTime.minute+(lStepInputTime_enM-lReste));}}}
const lMinInputTimeStr=aContexteCourant.node.getAttribute('min');if(lMinInputTimeStr){const lTimeMin=IEHtml.GDate.parseHeureMinute(lMinInputTimeStr);if(lTimeMin.ok){if(lTimeMin.heure>lTime.heure){lTime.heure=lTimeMin.heure;lTime.minute=lTimeMin.minute;} else if(lTimeMin.heure===lTime.heure&&lTimeMin.minute>lTime.minute){lTime.minute=lTimeMin.minute;}}}
const lMaxInputTimeStr=aContexteCourant.node.getAttribute('max');if(lMaxInputTimeStr){const lTimeMax=IEHtml.GDate.parseHeureMinute(lMaxInputTimeStr);if(lTimeMax.ok){if(lTime.heure>lTimeMax.heure){lTime.heure=lTimeMax.heure;lTime.minute=lTimeMax.minute;} else if(lTime.heure===lTimeMax.heure&&lTime.minute>lTimeMax.minute){lTime.minute=lTimeMax.minute;}}}
const lDateModif=new Date();lDateModif.setHours(lTime.heure);lDateModif.setMinutes(lTime.minute);lValue=IEHtml.GDate.FormatDate(lDateModif,'%hh:%mm');}
lParametres.infosExitChange.callback([lValue,lParametresExitChange]);_verificationInputModel(aContexteCourant,lParametres,lPatternValidateRegex);lRefresh();if(lParametresExitChange.selectionTexte&&!aEstCB){aContexteCourant.node.select();}};let lEventsExitChange='blur focusout';if(!lEstInputTime){lEventsExitChange+=' change';}
aJNode.on(lEventsExitChange,(aEvent) =>{if(!lParametres.declencherExitChange){return;}
lParametres.declencherExitChange=false;lFuncExitChange(aEvent);});}
if(lParametres.infosNode){lOutils.surInjectionHtml(aContexteCourant,(...aParams) =>{lParametres.infosNode.callback(aParams);});}
if(lParametres.infosNodeAfter){lOutils.surInjectionHtml(aContexteCourant,(...aParams) =>{lParametres.infosNodeAfter.callback(aParams);},true);}
if(lParametres.infoskeyupEnter){aJNode.on('keyup',(aEvent) =>{if(aEvent.which===ToucheClavier.RetourChariot){lParametres.infoskeyupEnter.callback([aEvent]);lRefresh();}});}
if(!aEstCB&&IE.estMobile&&aJNode.is('input[type=text], input[type=password], input[type=email], input[type=url], input[type=tel], input[type=number], input[type=search], input[type=date], input[type=time], textarea')){aJNode.on({'focus'(){_findElementPourGererActive_mobile(this).addClass('active');},'blur'(){if(this.value.length===0&&!aContexteCourant.node.getAttribute('placeholder')){_findElementPourGererActive_mobile(this).removeClass('active');}},'change input'(){if(this.value.length!==0||aContexteCourant.node.getAttribute('placeholder')){_findElementPourGererActive_mobile(this).addClass('active');}}});}}
function _findElementPourGererActive_mobile(aNode){return $(aNode).closest('.input-field').find('>label, >.prefix');}
function _gererInputCB(aContexteCourant,aAttributType){_gererInputModele(aContexteCourant,$(aContexteCourant.node),true,aAttributType);}
function _gererMaxLengthInputText(aContexteCourant,aNode,aJNode,aEstInput,aAttributType){const lAttrMaxLength=aNode.getAttribute('maxlength');let lMaxLength=0;if(aEstInput){if(aContexteCourant.estIndicatifTelephone||aContexteCourant.estTelephone){return;}
if(IEHtml.MAX_LENGTH_Default===0){return;}
if(!lAttrMaxLength&&(aAttributType==='text'||aAttributType===''||aAttributType==='number'||aAttributType==='email'||aAttributType==='url')){aJNode.attr('maxlength',IEHtml.MAX_LENGTH_Default);} else if(parseInt(lAttrMaxLength,10)===0){aNode.removeAttribute('maxlength');}} else{lMaxLength=lAttrMaxLength?parseInt(lAttrMaxLength,10):IEHtml.MAX_LENGTH_Default;if(isNaN(lMaxLength)){lMaxLength=IEHtml.MAX_LENGTH_Default;}}
return lMaxLength;}
function _actualiserClassScrollTextArea(aNode){if(aNode.scrollHeight>aNode.offsetHeight){$(aNode).addClass('has-scroll');} else{$(aNode).removeClass('has-scroll');}}
function _gererInputText(aContexteCourant,aAttributType){let lJNode=$(aContexteCourant.node);const lEstInput=aContexteCourant.nodeName==='input';const lEstTextArea=aContexteCourant.nodeName==='textarea';if(lEstInput&&aContexteCourant.node.hasAttribute('ie-indicatiftel')){aContexteCourant.estIndicatifTelephone=true;lJNode.addClass('ie-indicatiftel');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-indicatiftel');aContexteCourant.node.removeAttribute('ie-indicatiftel');} else if(lEstInput&&aContexteCourant.node.hasAttribute('ie-telephone')){aContexteCourant.estTelephone=true;lJNode.addClass('ie-telephone');lOutils.addCommentaireDebug(aContexteCourant.node,'ie-telephone');aContexteCourant.node.removeAttribute('ie-telephone');}
const lMaxLength=lEstInput||lEstTextArea?_gererMaxLengthInputText(aContexteCourant,aContexteCourant.node,lJNode,lEstInput,aAttributType):0;if(lEstInput&&aAttributType==='time'){aContexteCourant.node.setAttribute('ie-mask','/[^0-9:]/i');aContexteCourant.node.setAttribute('pattern','[0-9]{2}:[0-9]{2}');aContexteCourant.node.setAttribute('size','3');}
if(lEstInput||lEstTextArea||aContexteCourant.data.$modeleValue){_gererInputModele(aContexteCourant,lJNode,false,aAttributType,lMaxLength);}
if(lEstTextArea){lOutils.surInjectionHtml(aContexteCourant,() =>{_actualiserClassScrollTextArea(aContexteCourant.node);},true);_abonnerRefresh(() =>{_actualiserClassScrollTextArea(aContexteCourant.node);},aContexteCourant.node,aContexteCourant);$(aContexteCourant.node).on(IEHtml.C_eventsModifyInput,function(){_actualiserClassScrollTextArea(this);});}
lJNode=null;}
function _getDataDeNode(aNode){const lNodeValue=aNode.getAttribute('ie-data');let lData=null;if(lNodeValue&&lNodeValue.length>2&&lNodeValue.charAt(0)==='{'&&lNodeValue.charAt(lNodeValue.length-1)==='}'){try{lData=ObjetJSON.parse(lNodeValue,{ignorerEntites:true});} catch(e){lData=null;}}
return lData;}
function _traiterIF(aNode,aNodeParent,aControleur,aContexte,aData){const lValueAttr=aNode.getAttribute('ie-if');aNode.removeAttribute('ie-if');if(!lValueAttr){return true;}
if(!aControleur){return true;}
const lContexteCourant=_getContexteCourant(aControleur,aContexte,aNode,Object.assign({},aData));_remplirDataModel(lContexteCourant);const lInfos=_getAccesParametres(lValueAttr,lContexteCourant);const lValue=!!lInfos.callback();let lOldValue=lValue;const lChaineData='ie-if';const lNodeComm=document.createComment(lChaineData);const lCloneModele=aNode.cloneNode(true);aNode.parentNode.insertBefore(lNodeComm,aNode);const lInvocateur=new ObjetInvocateur();_abonnerRefresh(() =>{const lValue=!!lInfos.callback();if(lOldValue!==lValue){lOldValue=lValue;if(lValue){const lParams={element:aNodeParent,html:lCloneModele.cloneNode(true),controleur:aControleur,contexte:aContexte,invocateur:lInvocateur};const lPreInjectionHtml=_preInjectionHTML(aNodeParent,null);_injectEtCompilNode(lParams);_transfererFragmentDansHTML(lParams.childNodes,aNodeParent,lNodeComm.nextSibling);_finaliserInjectionHTML(lPreInjectionHtml,aContexte);lParams.childNodes=null;} else{while(lNodeComm.nextSibling&&_estNoeudCommentaire(lNodeComm.nextSibling)){$(lNodeComm.nextSibling).remove();}
if(lNodeComm.nextSibling){$(lNodeComm.nextSibling).remove();}}} else{lInvocateur.evenement(C_id_event_iemodel);}},aNodeParent,lContexteCourant,null,() =>{if(aNodeParent&&aNodeParent.contains&&!aNodeParent.contains(lNodeComm)){return true;}
return false;});if(!lValue){$(aNode).remove();}
return lValue;}
function _addNodeDeREPEAT(aNodeParent,aControleur,aCloneModele,aNomVariableBoucle,aIndice,aInfosAcces,aNodeComm,aContexte,aArrayNodes,aInvocateur,aInitialisationRepeat){let lNodeAvant;lNodeAvant=aNodeComm;if(aIndice>0){lNodeAvant=aArrayNodes[aIndice-1];}
if(!aContexte.repeat){aContexte.repeat={};}
const lContexte=Object.assign({},aContexte),lContexteBoucles={};if(!lContexte.eventsInjectionHtml){lContexte.eventsInjectionHtml=aContexte.eventsInjectionHtml=[];}
lContexteBoucles[aNomVariableBoucle]={indice:aIndice,arguments:aInfosAcces.args,getterArray:function(){return aInfosAcces.callback()||[];}};lContexte.repeat=Object.assign(lContexteBoucles,aContexte.repeat);if(aInitialisationRepeat){const lNodeClone=aCloneModele.cloneNode(true);aNodeParent.insertBefore(lNodeClone,lNodeAvant.nextSibling);aArrayNodes[aIndice]=_compileNode(lNodeClone,aNodeParent,aControleur,lContexte,aInvocateur);} else{const lParams={element:aNodeParent,html:aCloneModele.cloneNode(true),controleur:aControleur,contexte:lContexte,invocateur:aInvocateur};_injectEtCompilNode(lParams);aArrayNodes[aIndice]=_transfererFragmentDansHTML(lParams.childNodes,aNodeParent,lNodeAvant.nextSibling);lParams.childNodes=null;}}
function _getDiffTab(aTabOld,aTabNew){const lLength=Math.max(aTabOld.length,aTabNew.length),lResult=[];for(let i=0;i<lLength;i++){if(aTabOld[i]!==aTabNew[i]){lResult[i]={supprimer:true,ajouter:aTabNew[i]!==null&&aTabNew[i]!==undefined};}}
return lResult;}
function _traiterREPEAT(aNode,aNodeParent,aControleur,aContexte,aData){let lValueAttr=aNode.getAttribute('ie-repeat');aNode.removeAttribute('ie-repeat');if(!lValueAttr){return true;}
if(!aControleur){return true;}
const lTab=lValueAttr.split('in');if(lTab.length!==2){return true;}
lValueAttr=lTab[1].trim();const lNomVariableBoucle=lTab[0].trim();if(!aContexte.repeat){aContexte.repeat={};}
if(aContexte.repeat[lNomVariableBoucle]){return true;}
const lContexteCourant=_getContexteCourant(aControleur,aContexte,aNode,aData);const lInfos=_getAccesParametres(lValueAttr,lContexteCourant);let lArrayValue=[].concat(lInfos.callback()||[]);const lChaineData='ie-repeat';const lNodeComm=document.createComment(lChaineData);const lArrayNodes=[];const lArrayComms=[];const lCloneModele=aNode.cloneNode(true);aNode.parentNode.insertBefore(lNodeComm,aNode);const lInvocateur=new ObjetInvocateur();_abonnerRefresh(() =>{const lNewArrayValue=lInfos.callback()||[];const lDiff=_getDiffTab(lArrayValue,lNewArrayValue);let lArrayRemove;let lAvecModif=false;let lPreInjectionHtml;if(lDiff.length>0){lArrayRemove=[];for(let i=0;i<lDiff.length;i++){if(lDiff[i]&&lDiff[i].supprimer){lAvecModif=true;if(!lPreInjectionHtml){lPreInjectionHtml=_preInjectionHTML(aNodeParent,null);}
lArrayRemove.push(lArrayNodes[i]);lArrayNodes[i]=null;if(i>0&&lArrayComms[i]){lArrayRemove.push(lArrayComms[i]);lArrayComms[i]=null;}}}
if(lArrayRemove.length>0){$(lArrayRemove).remove();}
for(let i=0;i<lDiff.length;i++){if(lDiff[i]&&lDiff[i].ajouter){lAvecModif=true;if(!lPreInjectionHtml){lPreInjectionHtml=_preInjectionHTML(aNodeParent,null);}
_addNodeDeREPEAT(aNodeParent,aControleur,lCloneModele,lNomVariableBoucle,i,lInfos,lNodeComm,aContexte,lArrayNodes,lInvocateur);}}
lArrayValue=[].concat(lNewArrayValue);if(lAvecModif&&lPreInjectionHtml){_finaliserInjectionHTML(lPreInjectionHtml,aContexte);}}
lInvocateur.evenement(C_id_event_iemodel);},aNodeParent,lContexteCourant,null,() =>{if(aNodeParent&&aNodeParent.contains&&!aNodeParent.contains(lNodeComm)){return true;}
return false;});$(aNode).remove();for(let i=0;i<lArrayValue.length;i++){_addNodeDeREPEAT(aNodeParent,aControleur,lCloneModele,lNomVariableBoucle,i,lInfos,lNodeComm,aContexte,lArrayNodes,lInvocateur,true);}
return false;}
function _compileNode(aNode,aNodeParent,aControleur,aContexte,aInvocateur,aProfondeur){let lResultBalise,lNodeName,lNode=aNode,lData=null,lAvecAttributData=false,lJSONDebugData,lNameAttribut,lAvecCompilFils=true;const lProfondeur=aProfondeur||0;const lContexteCourant=_getContexteCourant(aControleur,aContexte,aNode,null,aInvocateur);if(lProfondeur>1000){return;}
const lNodeType=lNode.nodeType;lNodeName=lNode.nodeName;if(lNodeType===1&&!!lNodeName){lNodeName=lNodeName?lNodeName.toLowerCase():'';if(!aContexte.refresh){aContexte.refresh=function(){if(aControleur&&aControleur.$refresh){return aControleur.$refresh(true);}
return IEHtml.refresh();};}
if(!aContexte.refreshSelf){aContexte.refreshSelf=function(){if(aControleur&&aControleur.$refreshSelf){return aControleur.$refreshSelf(true);}
return Promise.resolve();};}
lJSONDebugData=null;lData=_getDataDeNode(lNode);lAvecAttributData=!!lData;if(!lData){lData={};}
let lAvecIeRepeat=false;if(aNode.hasAttribute('ie-repeat')){lAvecIeRepeat=true;if(!_traiterREPEAT(aNode,aNodeParent,aControleur,aContexte,lData)){return;}}
if(aNode.hasAttribute('ie-if')){if(!lAvecIeRepeat&&!_traiterIF(aNode,aNodeParent,aControleur,aContexte,lData)){return;}}
lContexteCourant.data=lData;lContexteCourant.nodeName=lNodeName;_getModel(lContexteCourant);let lAvecTransformationNoeud=!!uBalises[lNodeName];let lNomBaliseTransform=lNodeName;if(!lAvecTransformationNoeud){for(lNameAttribut in uBalises){if(lNode.hasAttribute(lNameAttribut)){lAvecTransformationNoeud=true;lNomBaliseTransform=lNameAttribut;lNode.removeAttribute(lNameAttribut);break;}}}
if(lAvecTransformationNoeud){lResultBalise=uBalises[lNomBaliseTransform](lContexteCourant,lOutils);lAvecCompilFils=!lResultBalise||lResultBalise.avecCompileFils!==false;if(lResultBalise&&lResultBalise.node){lNode=lResultBalise.node;lContexteCourant.node=lNode;lNodeName=lNode.nodeName?lNode.nodeName.toLowerCase():'';lContexteCourant.nodeNameBefore=lContexteCourant.nodeName;lContexteCourant.nodeName=lNodeName;}}
const lEstNodeInput=lNodeName==='input';let lAttributType='';if(lEstNodeInput){lAttributType=(lNode.getAttribute('type')||'').toLowerCase();}
if(lEstNodeInput&&(lAttributType==='radio'||lAttributType==='checkbox')){if(!lResultBalise||!lResultBalise.ignorerGererInputCB){_gererInputCB(lContexteCourant,lAttributType);}} else if(lEstNodeInput||lNodeName==='textarea'||_estNodeContentEditable(lNode)){if(!lResultBalise||!lResultBalise.ignorerInputText){_gererInputText(lContexteCourant,lAttributType);}}
if(lData&&!$.isEmptyObject(lData)){$(lNode).IEData(lData);if(lAvecAttributData){if(lJSONDebugData){lOutils.addCommentaireDebug(lNode,'ie-data="'+lJSONDebugData+'"');}
lNode.removeAttribute('ie-data');}}
for(lNameAttribut in uAttributs){if(lNode.hasAttribute(lNameAttribut)){const lAttrValue=lNode.getAttribute(lNameAttribut);try{const lParametresCompile={};lNode.removeAttribute(lNameAttribut);uAttributs[lNameAttribut](lContexteCourant,lNodeName,lAttrValue,lOutils,lParametresCompile);if(lAvecCompilFils){lAvecCompilFils=lParametresCompile.avecCompileFils!==false;}} catch(e){}}}
for(const lClass of Array.from(lNode.classList)){if(uClassesCss[lClass]){try{const lParametresCompile={};uClassesCss[lClass](lContexteCourant,lNodeName,lOutils,lParametresCompile);if(lAvecCompilFils){lAvecCompilFils=lParametresCompile.avecCompileFils!==false;}} catch(e){}}}}
if(lAvecCompilFils&&lNode.childNodes&&lNode.childNodes.length>0){_compile(lNode.childNodes,lNode,aControleur,aContexte,aInvocateur,lProfondeur+1);}
return lContexteCourant.node;}
function _compile(aNodeList,aNodeParent,aControleur,aContexte,aInvocateur,aProfondeur){const lProfondeur=aProfondeur||0;if(lProfondeur>1000){return;}
const lChildNodes=_sliceNodes(aNodeList);let lNode;for(let i=0;i<lChildNodes.length;i++){lNode=lChildNodes[i];_compileNode(lNode,aNodeParent,aControleur,aContexte,aInvocateur,lProfondeur);}}
return{initControleur:_initControleur,addBalise:function(aBalise,aFonction){aBalise=aBalise.toLowerCase()
;uBalises[aBalise]=aFonction;uNodeNames.push(aBalise);},addAttribut(aAttribut,aFonction){aAttribut=aAttribut.toLowerCase()
;uAttributs[aAttribut]=aFonction;},addClass(aClass,aFonction){uClassesCss[aClass]=aFonction;},ieData:function(aObjet){if(!aObjet){return'';}
const lChaine=ObjetJSON.toJSON(aObjet,{ignorerEntites:true});if(!lChaine){return'';}
return' ie-data="'+lChaine.replace(/"/g,'&quot;')+'" ';},refresh:function(aRefreshAsynchrone){if(aRefreshAsynchrone){return new Promise((aResolve) =>{setTimeout(() =>{uInvocateur.evenement(C_id_event_iemodel);aResolve();},0);});} else{uInvocateur.evenement(C_id_event_iemodel);return Promise.resolve();}},injectHTML:function(aElement,aHtml,aControleur,aIgnorerScroll,aInsererAvantNode,aAvecCommentaireConstructeur,aCommentaireHtmlDebug){return _injectHTML({element:aElement,insererAvantLeNode:aInsererAvantNode,html:aHtml,controleur:aControleur,ignorerScroll:aIgnorerScroll,avecCommentaireConstructeur:aAvecCommentaireConstructeur!==false,commentaireHtmlDebug:aCommentaireHtmlDebug});},injectHTMLParams:_injectHTML,empty:function(aNode){if(aNode&&aNode.getElementsByTagName){$.cleanData(aNode.getElementsByTagName('*'));}
while(aNode&&aNode.firstChild){aNode.removeChild(aNode.firstChild);}},outils:lOutils,collectionIdentite:{},C_id_event_iemodel:C_id_event_iemodel,C_eventsModifyCheckbox:'IEChecked change input',C_eventsModifyInput:'input change paste cut keydown keypress keyup',MAX_LENGTH_Default:0,REGEXP_INDICATIF_TELEPHONE:/[^0-9]/ig,TAILLEMAX_INDICATIF_TELEPHONE:3,REGEXP_TELEPHONE:/[^0-9]/ig};}());$.fn.IEHtml=function(aHtml,aParametres){const lParametres={html:aHtml,ignorerScroll:false,controleur:null,sansCompile:false,avecCommentaireConstructeur:true,commentaireHtmlDebug:''};Object.assign(lParametres,aParametres);return this.empty().each(function(){if(lParametres.sansCompile){this.innerHTML=aHtml;} else{while(this&&this.firstChild){this.removeChild(this.firstChild);}
IEHtml.injectHTMLParams(Object.assign({element:this},lParametres));}});};$.fn.IEHtmlAppend=function(aHtml,aParametres){const lParametres={ignorerScroll:false,controleur:null,sansCompile:false};Object.assign(lParametres,aParametres);return this.each(function(){if(lParametres.sansCompile){this.innerHTML+=aHtml;} else{IEHtml.injectHTMLParams(Object.assign({element:this,html:aHtml},lParametres));}});};$.fn.IEData=function(aData){if(arguments.length>0){return this.each(function(){$(this).data('ieData',aData);});}
return $(this).data('ieData');};let u_SurEventMouse_0x0=false;let u_timer_SurEventMouse_0x0;const u_estEventEn0x0=function(aEvent){return(aEvent.pageX===0&&aEvent.pageY===0)||(aEvent.clientX===0&&aEvent.clientY===0);};$.fn.eventValidation=function(aCallback){return this.each(function(){$(this).on({mouseup:function(aEvent){u_SurEventMouse_0x0=false;if(u_timer_SurEventMouse_0x0){clearTimeout(u_timer_SurEventMouse_0x0);u_timer_SurEventMouse_0x0=null;}
if(u_estEventEn0x0(aEvent)){u_SurEventMouse_0x0=true;u_timer_SurEventMouse_0x0=setTimeout(() =>{u_SurEventMouse_0x0=false;u_timer_SurEventMouse_0x0=null;},100);}},click:function(aEvent){if(!u_SurEventMouse_0x0&&u_estEventEn0x0(aEvent)){return;}
u_SurEventMouse_0x0=false;return aCallback.call(this,aEvent);},keyup:function(aEvent){if(aEvent.which===ToucheClavier.Espace||aEvent.which===ToucheClavier.RetourChariot){return aCallback.call(this,aEvent);}}});});};Invocateur.abonner(ObjetInvocateur.events.refreshIEHtml,() =>{IEHtml.refresh();});module.exports=IEHtml;},fn:"iehtml.js"});;
IE.fModule({f:function(exports,require,module,global){require('divers.js');const GLog=require('IELog.js');const MethodesObjet=require('MethodesObjet.js');const IEHtml=require('IEHtml.js');const tag=require('tag.js');const{GChaine}=require('_ObjetChaine.js');class _ObjetHtml{elementExiste(aElement){return aElement&&(this.estElement(aElement)||this.estDocument(aElement)||document.getElementById(aElement))?true:false;}
estElement(aElement){return aElement&&(aElement.nodeType===1);}
estDocument(aElement){return aElement&&(aElement.nodeType===9);}
viderNode(aNode){return IEHtml.empty(aNode);}
getParent(aElement){const lElement=this.getElement(aElement);if(this.estElement(lElement)){if(lElement.parentElement){return lElement.parentElement;}
if(lElement.parentNode){return lElement.parentNode;}}
return null;}
getParentOverflowNonVisible(aId){const lParent=this.getParent(aId);if(lParent&&lParent!==document.body){try{if(global.getComputedStyle(lParent).overflowY!=='visible'){return lParent;}} catch(e){return document.body;}
return this.getParentOverflowNonVisible(lParent);}
return document.body;}
htmlToDOM(aHtml){let lFrag=document.createDocumentFragment();let lDiv=document.createElement('div');let lNoeudDOM;lFrag.appendChild(lDiv);lDiv.insertAdjacentHTML('afterbegin',aHtml);if(lDiv.childNodes.length>1){lNoeudDOM=Array.from(lDiv.childNodes);} else{lNoeudDOM=lDiv.firstChild;}
this.viderNode(lDiv);lDiv=null;lFrag=null;return lNoeudDOM;}
insererElementDOM(aElementPere,aElement,aInsererEnPremier){if(this.estElement(aElement)&&this.estElement(aElementPere)){if(aInsererEnPremier&&aElementPere.firstChild){aElementPere.insertBefore(aElement,aElementPere.firstChild);} else{aElementPere.appendChild(aElement);}}}
addHtml(aId,aHtml,aParametres){const lElement=this.getElement(aId);if(this.elementExiste(lElement)&&lElement.appendChild){const lParametres=Object.assign({},aParametres);if(lParametres.instance&&lParametres.instance.controleur){lParametres.controleur=lParametres.instance.controleur;}
if(lParametres.sansCompile){lElement.insertAdjacentHTML('beforeend',aHtml);} else{IEHtml.injectHTML(lElement,aHtml,lParametres.controleur,lParametres.ignorerScroll,null,false);}}}
supprimerElementDOM(aId){const lElement=this.getElement(aId);if(lElement){$(lElement).remove();}}
getElement(aId){const E=this.estElement(aId)||this.estDocument(aId)?aId:document.getElementById(aId);return E||null;}
getHtml(aId){const E=this.getElement(aId);if(E){return E.innerHTML;}}
getValue(aId){const E=this.getElement(aId);if(E){return GChaine.ajouterEntites(E.value);}
return'';}
getClass(aId){const E=this.getElement(aId);return E&&E.className?E.className:'';}
addClass(aId,aClass){this.modifierClass(aId,null,aClass);}
delClass(aId,aClass){this.modifierClass(aId,aClass,null);}
modifierClass(aId,aClassSuppression,aClasseAjout){if((!aClassSuppression&&!aClasseAjout)||!this.elementExiste(aId)){return;}
const lJElement=this.estElement(aId)?$(aId):$('#'+aId.escapeJQ());if(aClassSuppression){lJElement.removeClass(aClassSuppression);}
if(aClasseAjout){lJElement.addClass(aClasseAjout);}}
getDisplay(aId){const E=this.getElement(aId);if(E){if(E.style&&E.style.display==='none'){return false;} else if(!E.parentNode){return true;} else{return this.getDisplay(E.parentNode);}}
return false;}
extraireNombreDId(aId,aIndiceAvant,aSeparateur){let lOptions,T,lResult,lId=aId;if(!MethodesObjet.isString(lId)){if(this.estElement(lId)&&lId.id){lId=lId.id;} else{return null;}}
lOptions={separateur:aSeparateur||'_',indiceAvant:aIndiceAvant||0};T=lId.split(lOptions.separateur);lResult=parseInt(T[Math.max(0,T.length-1-lOptions.indiceAvant)],10);return MethodesObjet.isNumber(lResult)?lResult:null;}
setClass(aId,aClass){const E=this.getElement(aId);if(E){E.className=aClass;}}
setHtml(aId,aHtml,aIgnorerScroll){const E=this.getElement(aId);if(E){const lParametres=Object.assign({},aIgnorerScroll);if(aIgnorerScroll===true){lParametres.ignorerScroll=true;}
if(lParametres.instance&&lParametres.instance.controleur){lParametres.controleur=lParametres.instance.controleur;}
if($.fn.IEHtml&&(!lParametres.instance||!lParametres.instance.IGNORER_IEHTML)){$(E).IEHtml(aHtml,lParametres);} else{if(E.getElementsByTagName){$.cleanData(E.getElementsByTagName("*"));}
E.innerHTML=aHtml;if(aIgnorerScroll!==true){const lOverflow=$(E).css('overflow');if(lOverflow==='auto'||lOverflow==='scroll'){E.scrollLeft=0;E.scrollTop=0;}}}}}
setTitle(aId,aTitle){const E=this.getElement(aId);if(E){E.title=_valeurToProp(aTitle);}}
setValue(aId,aValue){const E=this.getElement(aId);if(E){E.value=_valeurToProp(aValue);}}
setDisabled(aId,aDisabled){const E=this.getElement(aId);if(E){$(E).inputDisabled(aDisabled);}}
setAvecMain(aId,aDisabled){const E=this.getElement(aId);if(E){$(E).toggleClass('AvecMain',!aDisabled);}}
setDisplay(aId,aVisible){const E=this.getElement(aId);if(E){if(aVisible){$(E).show();} else{$(E).hide();}}}
setFocus(aId,aFocus,aAvecDecalage){function _focus(aHtml,aElement){if(!aHtml.elementExiste(aElement)){return;}
try{if(aFocus||aFocus===null||aFocus===undefined){aElement.focus();} else{aElement.blur();}} catch(e){GLog.addLog('Erreur _ObjetHtml.setFocus : '+e.toString()+' ((fv) remarqué uniquement sur IE avec un delai)');}}
if(this.elementExiste(aId)){try{if(this.getDisplay(aId)){const lElement=this.getElement(aId);if(lElement){let lAvecDecalage=aAvecDecalage,lDecalage=200;if(aAvecDecalage>=0&&MethodesObjet.isNumber(aAvecDecalage)){lAvecDecalage=true;lDecalage=aAvecDecalage;}
if(lAvecDecalage){setTimeout(_focus.bind(null,this,lElement),lDecalage);} else{_focus(this,lElement);}}}} catch(e){}}}
setFocusEdit(aId){if(this.elementExiste(aId)){try{if(this.getDisplay(aId)){const E=this.getElement(aId);if(E){E.focus();E.value=E.value;}}} catch(e){}}}
setCursorAtEnd(aId){try{const E=this.getElement(aId);if(E&&E.value!==undefined){const end=E.value.length;this.setSelectionEdit(E,end,end);}} catch(e){}}
setSelectionEdit(aId,aBegin,aEnd){if(this.elementExiste(aId)){try{if(this.getDisplay(aId)){const E=this.getElement(aId);if(E){const begin=MethodesObjet.isNumber(aBegin)?aBegin:0,end=MethodesObjet.isNumber(aEnd)?aEnd:E.value.length;if(E.setSelectionRange){E.setSelectionRange(begin,end);} else if(E.createTextRange){const range=E.createTextRange();range.collapse(true);range.moveEnd('character',end);range.moveStart('character',begin);range.select();}}}} catch(e){}}}
setImage(aId,aSrc){const E=this.getElement(aId);if(E){E.src=aSrc;}}
setAlt(aId,aValue){const E=this.getElement(aId);if(E){E.alt=aValue;}}
setTexte(aId,aTexte){const E=this.getElement(aId);if(E){this.viderNode(E);E.appendChild(document.createTextNode(aTexte));}}
composeBlanc(){return'<span style="font-size : 1px">&nbsp;</span>';}
setCheckBox(aId,aValue){if(aValue===undefined){aValue=false;}
const E=this.getElement(aId);if(E){$(E).inputChecked(aValue);}}
toArg(aArgs){return tag.toArg(aArgs);}
composeAttr(){return tag.composeAttr.apply(tag,arguments);}
deselectionTexte(){try{if(window.getSelection&&window.getSelection()&&window.getSelection().removeAllRanges){window.getSelection().removeAllRanges();}} catch(e){}}
nettoyerHtml(aHtml){return GChaine.htmlToSafeHtml(aHtml);}}
function _valeurToProp(aValeur){if(aValeur===null||aValeur===undefined){return'';}
if(MethodesObjet.isString(aValeur)){return GChaine.enleverEntites(aValeur);}
if(MethodesObjet.isNumber(aValeur)){return aValeur+'';}
return aValeur;}
const GHtml=new _ObjetHtml();module.exports={_ObjetHtml:_ObjetHtml,GHtml:GHtml};},fn:"_objethtml.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const GHtml=require('_ObjetHtml.js').GHtml;const Support=require('ObjetSupport.js');const EGenreBordure={gauche:1,haut:2,droite:4,bas:8,avecBordure(aBordures,aGenreBordure){return aGenreBordure>0&&aBordures>0?!!(aBordures&aGenreBordure):false;}};class _ObjetStyle{composeCouleur(aCouleurFond,aCouleurTexte,aCouleurBordure,aLargeurBordure,aListeBordures){return this.composeCouleurFond(aCouleurFond)+this.composeCouleurTexte(aCouleurTexte)+this.composeCouleurBordure(aCouleurBordure,aLargeurBordure,aListeBordures);}
composeCouleurBordure(aCouleurBordure,aLargeurBordure,aListeBordures,aStyle){if(aCouleurBordure&&MethodesObjet.isString(aCouleurBordure)){const lStyle=aStyle||'solid';if(!$.isNumeric(aLargeurBordure)){aLargeurBordure=1;}
if(!aListeBordures){return' border: '+aLargeurBordure+'px '+lStyle+' '+aCouleurBordure+';';}
const H=[];H.push(aListeBordures&EGenreBordure.gauche?' border-left: '+aLargeurBordure+'px '+lStyle+' '+aCouleurBordure+';':'');H.push(aListeBordures&EGenreBordure.haut?' border-top: '+aLargeurBordure+'px '+lStyle+' '+aCouleurBordure+';':'');H.push(aListeBordures&EGenreBordure.droite?' border-right: '+aLargeurBordure+'px '+lStyle+' '+aCouleurBordure+';':'');H.push(aListeBordures&EGenreBordure.bas?' border-bottom: '+aLargeurBordure+'px '+lStyle+' '+aCouleurBordure+';':'');return H.join('');}
return'';}
composeCouleurFond(aCouleurFond){if(!aCouleurFond){return'';}
if(MethodesObjet.isString(aCouleurFond)){return' background-color:'+aCouleurFond+';';}
;return'';}
composeCouleurTexte(aCouleurTexte){if(!aCouleurTexte){return'';}
if(MethodesObjet.isString(aCouleurTexte)){return' color:'+aCouleurTexte+';';}
;return'';}
composeBordureArrondi(){return'';}
composeHeight(aValeur,aFormat){if(aValeur&&aValeur.indexOf&&aValeur.indexOf('%')>0){aValeur=parseFloat(aValeur);aFormat='%';}
if(!MethodesObjet.isNumber(aValeur)){return'';}
if(!aFormat){aFormat='px';}
return'height:'+aValeur+aFormat+';';}
composeWidth(aValeur,aFormat){if(aValeur&&aValeur.indexOf&&aValeur.indexOf('%')>0){aValeur=parseFloat(aValeur);aFormat='%';}
if(!MethodesObjet.isNumber(aValeur)){return'';}
if(!aFormat){aFormat='px';}
return'width:'+aValeur+aFormat+';';}
composeHeightCalc(aValeur){if(!MethodesObjet.isNumber(aValeur)){return'';}
return'height: calc(100% - '+aValeur+'px);';}
composeWidthCalc(aValeur){if(!MethodesObjet.isNumber(aValeur)){return'';}
return'width: calc(100% - '+aValeur+'px);';}
composeMarge(aHaut,aBas,aGauche,aDroit){let lResult='';if($.isNumeric(aHaut)){lResult+='margin-top: '+aHaut+'px; ';}
if($.isNumeric(aBas)){lResult+='margin-bottom: '+aBas+'px; ';}
if($.isNumeric(aGauche)){lResult+='margin-left: '+aGauche+'px; ';}
if($.isNumeric(aDroit)){lResult+='margin-right: '+aDroit+'px; ';}
return lResult;}
composeBoxShadow(aParametres){const lParametres={x:0,y:9,blur:18,spread:0,r:50,g:50,b:50,opacity:0.35};$.extend(lParametres,aParametres);let lValeur='';if($.isNumeric(lParametres.x)&&lParametres.x>0){lValeur+=lParametres.x+'px';} else{lValeur+='0px';}
lValeur+=' ';if($.isNumeric(lParametres.y)&&lParametres.y>0){lValeur+=lParametres.y+'px';} else{lValeur+='0px';}
lValeur+=' ';if($.isNumeric(lParametres.blur)&&lParametres.blur>0){lValeur+=lParametres.blur+'px';} else{lValeur+='0px';}
lValeur+=' ';if($.isNumeric(lParametres.spread)&&lParametres.spread!==0){lValeur+=lParametres.spread+'px';} else{lValeur+='0px';}
if(lParametres.opacity>0){lValeur+=' rgba('+lParametres.r+', '+lParametres.g+', '+lParametres.b+', '+lParametres.opacity+')';} else{lValeur+=' rgb('+lParametres.r+', '+lParametres.g+', '+lParametres.b+')';}
if(Support.supportBoxShadow[Support.GenreNavigateur.Standard]){return'box-shadow: '+lValeur+';';} else if(Support.supportBoxShadow[Support.GenreNavigateur.Webkit]){return'-webkit-box-shadow: '+lValeur+';';} else if(Support.supportBoxShadow[Support.GenreNavigateur.Moz]){return'-moz-box-shadow: '+lValeur+';';} else{return'';}}
composeTransitions(aPropriete,aDureeEnS,aDelaiEnS,aTiming){if(!MethodesObjet.isString(aPropriete)||!MethodesObjet.isString(aDureeEnS)){return'';}
if(Support.supportTransitions[Support.GenreNavigateur.Standard]){return'transition-property: '+aPropriete+';'+'transition-duration:'+aDureeEnS+';'+(MethodesObjet.isString(aDelaiEnS)?'transition-delay:'+aDelaiEnS+';':'')+(MethodesObjet.isString(aTiming)?'transition-timing-function:'+aTiming+';':'');} else if(Support.supportTransitions[Support.GenreNavigateur.Webkit]){return'-webkit-transition-property: '+aPropriete+';'+'-webkit-transition-duration:'+aDureeEnS+';'+(MethodesObjet.isString(aDelaiEnS)?'-webkit-transition-delay:'+aDelaiEnS+';':'')+(MethodesObjet.isString(aTiming)?'-webkit-transition-timing-function:'+aTiming+';':'');} else if(Support.supportTransitions[Support.GenreNavigateur.Moz]){return'-moz-transition-property: '+aPropriete+';'+'-moz-transition-duration:'+aDureeEnS+';'+(MethodesObjet.isString(aDelaiEnS)?'-moz-transition-delay:'+aDelaiEnS+';':'')+(MethodesObjet.isString(aTiming)?'-moz-transition-timing-function:'+aTiming+';':'');} else if(Support.supportTransitions[Support.GenreNavigateur.Opera]){return'-o-transition-property: '+aPropriete+';'+'-o-transition-duration:'+aDureeEnS+';'+(MethodesObjet.isString(aDelaiEnS)?'-o-transition-delay:'+aDelaiEnS+';':'')+(MethodesObjet.isString(aTiming)?'-o-transition-timing-function:'+aTiming+';':'');} else{return'';}}
whichTransitionEvent(){const lElement=document.createElement('fakeelement');const lTransitions={'WebkitTransition':'webkitTransitionEnd','transition':'transitionEnd','OTransition':'oTransitionEnd','MSTransition':'msTransitionEnd','MozTransition':'transitionend'};for(let t in lTransitions){if(lElement.style[t]!==undefined){return lTransitions[t];}}}
setTransitions(aId,aPropriete,aDureeEnS,aDelaiEnS,aTiming){if(!MethodesObjet.isString(aPropriete)||!MethodesObjet.isString(aDureeEnS)){return'';}
const lStyle=this.getStyle(aId);if(lStyle){const lChaine=aPropriete+' '+aDureeEnS+' '+(MethodesObjet.isString(aDelaiEnS)?aDelaiEnS+' ':'')+(MethodesObjet.isString(aTiming)?aTiming+' ':'');if(Support.supportTransitions[Support.GenreNavigateur.Standard]){lStyle.transition=lChaine;} else if(Support.supportTransitions[Support.GenreNavigateur.Webkit]){lStyle.webkitTransition=lChaine;} else if(Support.supportTransitions[Support.GenreNavigateur.Moz]){lStyle.MozTransition=lChaine;} else if(Support.supportTransitions[Support.GenreNavigateur.Opera]){lStyle.OTransition=lChaine;}}}
getStyle(aId){const E=GHtml.getElement(aId);if(E){return E.style;}}
setCouleurBordure(aId,aCouleur){const E=GHtml.getElement(aId);if(E){E.style.borderColor=aCouleur;}}
setCouleurBordureHaut(aId,aCouleur){const E=GHtml.getElement(aId);if(E){E.style.borderTopColor=aCouleur;}}
setCouleurBordureBas(aId,aCouleur){const E=GHtml.getElement(aId);if(E&&E.style){E.style.borderBottomColor=aCouleur;}}
setCouleurBordureGauche(aId,aCouleur){const E=GHtml.getElement(aId);if(E){E.style.borderLeftColor=aCouleur;}}
setCouleurBordureDroit(aId,aCouleur){const E=GHtml.getElement(aId);if(E){E.style.borderRightColor=aCouleur;}}
setCouleur(aId,aCouleurFond,aCouleurTexte,aCouleurBordure){if(aCouleurFond||aCouleurFond===''){this.setCouleurFond(aId,aCouleurFond);}
if(aCouleurTexte||aCouleurTexte===''){this.setCouleurTexte(aId,aCouleurTexte);}
if(aCouleurBordure||aCouleurBordure===''){this.setCouleurBordure(aId,aCouleurBordure);}}
setCouleurFond(aId,aCouleurFond){const S=this.getStyle(aId);if(S){S.backgroundColor=aCouleurFond;}}
setCouleurTexte(aId,aCouleurTexte){const S=this.getStyle(aId);if(S){S.color=aCouleurTexte;}}
setVisible(aId,aVisible){const S=this.getStyle(aId);if(S){S.visibility=aVisible?'visible':'hidden';}}
setGras(aId,aGras){const E=GHtml.getElement(aId);if(E&&GHtml.estElement(E)){E.style.fontWeight=(aGras?'bold':'normal');}}
getZindex(aId){const S=this.getStyle(aId);if(S&&S.zIndex){return parseInt(S.zIndex);}}
setZindex(aId,aZindex){const S=this.getStyle(aId);if(S){S.zIndex=aZindex;}}
setDisplay(aId,aDisplay){GHtml.setDisplay(aId,aDisplay);}
composeDegradeVertical(aCouleurDebut,aCouleurFin){let lResult=this.composeCouleurFond(aCouleurDebut);if(Support.supportFilterIE){lResult+=' FILTER: progid:DXImageTransform.Microsoft.Gradient(gradientType=0,startColorStr='+aCouleurDebut+',endColorStr='+aCouleurFin+');';} else if(Support.supportGradient[Support.GenreNavigateur.Standard]){lResult+=' background: linear-gradient(to bottom, '+aCouleurDebut+', '+aCouleurFin+');';} else if(Support.supportGradient[Support.GenreNavigateur.IE]){lResult+=' background: -ms-linear-gradient(top, '+aCouleurDebut+', '+aCouleurFin+');';} else if(Support.supportGradient[Support.GenreNavigateur.Moz]){lResult+=' background: -moz-linear-gradient(top, '+aCouleurDebut+', '+aCouleurFin+');';} else if(Support.supportGradient[Support.GenreNavigateur.Webkit]){lResult+=' background: -webkit-gradient(linear, left top, left bottom, from('+aCouleurDebut+'), to('+aCouleurFin+'));';}
return lResult;}
composeContenuDegradeVertical(aCouleurDebut,aCouleurFin){return this.composeContenuDegrade(180,aCouleurDebut,aCouleurFin);}
composeContenuDegrade(aAngle,aCouleurDebut,aCouleurFin){let lResult='';if(Support.supportGradient[Support.GenreNavigateur.Standard]){lResult+='linear-gradient('+aAngle+'deg, '+aCouleurDebut+', '+aCouleurFin+')';} else if(Support.supportGradient[Support.GenreNavigateur.IE]){lResult+='-ms-linear-gradient('+aAngle+'deg, '+aCouleurDebut+', '+aCouleurFin+')';} else if(Support.supportGradient[Support.GenreNavigateur.Moz]){lResult+='-moz-linear-gradient('+aAngle+'deg, '+aCouleurDebut+', '+aCouleurFin+')';} else if(Support.supportGradient[Support.GenreNavigateur.Webkit]){lResult+='-webkit-gradient('+aAngle+'deg, left top, left bottom, from('+aCouleurDebut+'), to('+aCouleurFin+'))';} else{lResult+=aCouleurDebut;}
return lResult;}
getComputedValue(aNode,aPropertyName){const lNode=GHtml.getElement(aNode);if(lNode&&global.getComputedStyle&&aPropertyName){try{return global.getComputedStyle(lNode).getPropertyValue(aPropertyName);} catch(e){}}
return'';}
getFloatComputedValue(aNode,aPropertyName){const lNumber=parseFloat(this.getComputedValue(aNode,aPropertyName),10);return isNaN(lNumber)?0:lNumber;}
styleSheetDisabled(){let lResult=false;try{const lBody=document.getElementsByTagName("BODY")[0];const lElement=document.createElement('div');lBody.appendChild(lElement);lElement.classList.add('support-css-test');lResult=this.getFloatComputedValue(lElement,'height')===0;lBody.removeChild(lElement);} catch(e){}
return lResult;}}
const GStyle=new _ObjetStyle();module.exports={EGenreBordure:EGenreBordure,_ObjetStyle:_ObjetStyle,GStyle:GStyle};},fn:"_objetstyle.js"});;
IE.fModule({f:function(exports,require,module,global){
;const _ObjetStyle=require('_ObjetStyle.js')._ObjetStyle;class ObjetStyle_Mobile extends _ObjetStyle{constructor(){super();}}
require('_ObjetStyle.js').GStyle=new ObjetStyle_Mobile();Object.assign(module.exports,{ObjetStyle_Mobile:ObjetStyle_Mobile,GStyle:require('_ObjetStyle.js').GStyle});},fn:"objetstyle_mobile.js"});;
IE.fModule({f:function(exports,require,module,global){if(IE.estMobile){module.exports=require('ObjetStyle_Mobile.js').GStyle;} else{module.exports=require('ObjetStyle_Espace.js').GStyle;}},fn:"gstyle.js"});;
IE.fModule({f:function(exports,require,module,global){const GLog=require('IELog.js');const MethodesObjet=require('MethodesObjet.js');const GHtml=require('_ObjetHtml.js').GHtml;let GPosition;class _ObjetPosition{constructor(){this._cacheFontSize=null;}
getWidth(aId){const lElement=GHtml.getElement(aId);return GHtml.estElement(lElement)?lElement.offsetWidth:0;}
getHeight(aId){const lElement=GHtml.getElement(aId);return GHtml.estElement(lElement)?lElement.offsetHeight:0;}
getLeft(aId){const lElement=GHtml.getElement(aId);return GHtml.estElement(lElement)?this.getClientRect(lElement).left:0;}
getTop(aId){const lElement=GHtml.getElement(aId);return GHtml.estElement(lElement)?this.getClientRect(aId).top:0;}
setWidth(aId,aWidth,aAjuster,aFormat){try{if(aWidth===undefined||aWidth===null||isNaN(aWidth)){GLog.addLog('setWidth invalide : '+aWidth);return;}
const lElement=GHtml.getElement(aId);if(!lElement||!lElement.style){return;}
const lWidthEnString=MethodesObjet.isString(aWidth);aFormat=!aFormat&&!lWidthEnString?'px':aFormat;if(lWidthEnString&&aWidth==='auto'){lElement.style.width=aWidth;} else{aWidth=Math.max(0,aWidth);lElement.style.width=aWidth+aFormat;}
if(aAjuster&&(aFormat==='px')&&GHtml.getDisplay(lElement)){const lWidth=this.getWidth(lElement);if(aWidth!==lWidth){lElement.style.width=Math.max(0,aWidth-(lWidth-aWidth))+aFormat;}}} catch(e){}}
setHeight(aId,aHeight,aAjuster,aFormat){try{if(aHeight===undefined||aHeight===null||isNaN(aHeight)){GLog.addLog('setHeight invalide : '+aHeight);return;}
const lElement=GHtml.getElement(aId);if(!lElement||!lElement.style){return;}
const lHeightEnString=MethodesObjet.isString(aHeight);aFormat=!aFormat&&!lHeightEnString?'px':aFormat;if(lHeightEnString&&aHeight==='auto'){lElement.style.height=aHeight;} else{aHeight=Math.max(0,aHeight);lElement.style.height=aHeight+aFormat;}
if(aAjuster&&(aFormat==='px')&&GHtml.getDisplay(lElement)){const lHeight=this.getHeight(lElement);if(aHeight!==lHeight){lElement.style.height=Math.max(0,aHeight-(lHeight-aHeight))+aFormat;}}} catch(e){}}
setLeft(aId,aLeft,aAjuster,aFormat){aFormat=!aFormat?'px':aFormat;try{if(aLeft===undefined||aLeft===null||isNaN(aLeft)){GLog.addLog('setLeft invalide : '+aLeft);return;}
const lElement=GHtml.getElement(aId);if(!lElement||!lElement.style){return;}
aLeft=isNaN(aLeft)?0:aLeft;lElement.style.left=aLeft+aFormat;if(aAjuster&&(aFormat==='px')&&GHtml.getDisplay(lElement)){const lLeft=this.getLeft(lElement);if(aLeft!==lLeft){lElement.style.left=aLeft-(lLeft-aLeft)+aFormat;}}} catch(e){}}
setTop(aId,aTop,aAjuster,aFormat){aFormat=!aFormat?'px':aFormat;try{if(aTop===undefined||aTop===null||isNaN(aTop)){GLog.addLog('setTop invalide : '+aTop);return;}
const lElement=GHtml.getElement(aId);if(!lElement||!lElement.style){return;}
aTop=isNaN(aTop)?0:aTop;lElement.style.top=aTop+aFormat;if(aAjuster&&(aFormat==='px')&&GHtml.getDisplay(lElement)){const lTop=this.getTop(lElement);if(aTop!==lTop){lElement.style.top=aTop-(lTop-aTop)+aFormat;}}} catch(e){}}
getRect(aId,aPositionAbsolue,aAvecInner){const lElement=GHtml.getElement(aId);if(lElement&&lElement.getBoundingClientRect){const lBoundingRect=lElement.getBoundingClientRect();if(lBoundingRect){const lOffsetX=window.pageXOffset||0;const lOffsetY=window.pageYOffset||0;const lRect={left:lBoundingRect.left+lOffsetX,right:lBoundingRect.right+lOffsetX,top:lBoundingRect.top+lOffsetY,bottom:lBoundingRect.bottom+lOffsetY,x:lBoundingRect.left+lOffsetX,y:lBoundingRect.top+lOffsetY,width:lBoundingRect.right-lBoundingRect.left,height:lBoundingRect.bottom-lBoundingRect.top,leftScroll:aPositionAbsolue?lBoundingRect.left:0,topScroll:aPositionAbsolue?lBoundingRect.top:0};if(aAvecInner){try{const lComputedStyle=global.getComputedStyle(lElement);lRect.paddingLeft=parseFloat(lComputedStyle.getPropertyValue('padding-left'),10);lRect.paddingRight=parseFloat(lComputedStyle.getPropertyValue('padding-right'),10);lRect.paddingTop=parseFloat(lComputedStyle.getPropertyValue('padding-top'),10);lRect.paddingBottom=parseFloat(lComputedStyle.getPropertyValue('padding-bottom'),10);lRect.borderLeft=parseFloat(lComputedStyle.getPropertyValue('border-left-width'),10);lRect.borderRight=parseFloat(lComputedStyle.getPropertyValue('border-right-width'),10);lRect.borderTop=parseFloat(lComputedStyle.getPropertyValue('border-top-width'),10);lRect.borderBottom=parseFloat(lComputedStyle.getPropertyValue('border-bottom-width'),10);lRect.innerWidth=lRect.width-lRect.paddingLeft-lRect.paddingRight-lRect.borderLeft-lRect.borderRight;lRect.innerHeight=lRect.height-lRect.paddingTop-lRect.paddingBottom-lRect.borderTop-lRect.borderBottom;lRect.innerLeft=lRect.left+lRect.paddingLeft+lRect.borderLeft;lRect.innerRight=lRect.right-lRect.paddingRight-lRect.borderRight;lRect.innerTop=lRect.top+lRect.paddingTop+lRect.borderTop;lRect.innerBottom=lRect.bottom-lRect.paddingBottom-lRect.borderBottom;} catch(e){}}
if(!aPositionAbsolue){if($.css(lElement,"position")==="fixed"){return lRect;}
let lOffsetParent=lElement.offsetParent;while(lOffsetParent&&$.css(lOffsetParent,"position")==="static"){lOffsetParent=lOffsetParent.offsetParent;}
lOffsetParent=lOffsetParent||document.documentElement;if(lOffsetParent&&lOffsetParent.nodeName&&lOffsetParent.nodeName.toLowerCase()!=='html'){const lRectOffset=this.getRect(lOffsetParent,true);return Object.assign(lRect,{x:lRect.x-lRectOffset.x,y:lRect.y-lRectOffset.y,left:lRect.left-lRectOffset.left,right:lRect.left-lRectOffset.left+lRect.width,top:lRect.top-lRectOffset.top,bottom:lRect.top-lRectOffset.top+lRect.height});}}
return lRect;}}
;return{left:0,right:0,top:0,bottom:0,width:0,height:0,x:0,y:0,leftScroll:0,topScroll:0,erreur:true};}
getClientRect(aId,aAvecInner){return this.getRect(aId,true,aAvecInner);}
setPosition(aId,aLeft,aTop,aAjuster,aFormat){this.setLeft(aId,aLeft,aAjuster,aFormat);this.setTop(aId,aTop,aAjuster,aFormat);}
centrer(aId){let lLeft,lTop,lWidth,lHeight;lLeft=window.pageXOffset||0;lTop=window.pageYOffset||0;if(document.documentElement){lLeft=lLeft||document.documentElement.scrollLeft;lTop=lTop||document.documentElement.scrollTop;}
if(window.visualViewport){lLeft=lLeft||window.visualViewport.offsetLeft;lTop=lTop||window.visualViewport.offsetTop;}
if(GNavigateur.isTactile&&window.visualViewport){lWidth=window.visualViewport.width;lHeight=window.visualViewport.height;} else if(GNavigateur.isTactile&&window.innerHeight){lWidth=window.innerWidth;lHeight=window.innerHeight;} else{lWidth=GNavigateur.ClientL;lHeight=GNavigateur.ClientH;}
const lWidthId=this.getWidth(aId),lHeightId=this.getHeight(aId);if(lWidthId*lHeightId){const lPosition={x:Math.max(0,lLeft+(lWidth-lWidthId)/2),y:Math.max(0,lTop+(lHeight-lHeightId)/2),width:lWidthId,height:lHeightId};_ramenerPositionDansLAffichage(lPosition);this.setPosition(aId,Math.max(0,lPosition.x),Math.max(0,lPosition.y),true);}}
placer(aId,aLeft,aTop,aEcartBordEcran){let lX1=MethodesObjet.isNumber(aLeft)?aLeft:0;const lX2=lX1+this.getWidth(aId);let lY1=MethodesObjet.isNumber(aTop)?aTop:0;const lY2=lY1+this.getHeight(aId);const lEcartBordEcran=$.extend({x:2,y:2},aEcartBordEcran);if(lX2+lEcartBordEcran.x>GNavigateur.EcranL){lX1=GNavigateur.EcranL-this.getWidth(aId)-lEcartBordEcran.x;}
if(lY2+lEcartBordEcran.y>GNavigateur.EcranH){lY1=GNavigateur.EcranH-this.getHeight(aId)-lEcartBordEcran.y;}
this.setPosition(aId,Math.max(lEcartBordEcran.x,lX1),Math.max(lEcartBordEcran.y,lY1),true);}
placerFiche(aId,aIdSource,aVisible,aDecalage){const lPositionSource=_getPositionElement(aIdSource);this.placerFicheSource(aId,lPositionSource.x,lPositionSource.x+lPositionSource.width,lPositionSource.y,lPositionSource.y+lPositionSource.height,aVisible,aDecalage);}
placerFicheSource(aId,aX1Source,aX2Source,aY1Source,aY2Source,aVisible,aDecalage){const lVisible=aVisible===null||aVisible===undefined?GHtml.getElement(aId).style.visibility==='visible':aVisible,lDecalage=$.extend({x:6,y:0},aDecalage);const lPosition=_getPositionElement(aId),lPositionSource={x:aX1Source,y:aY1Source,width:aX2Source-aX1Source,height:aY2Source-aY1Source};_ramenerPositionDansLAffichage(lPosition);if(!lVisible||_avecChevauchement(lPosition,lPositionSource)){lPosition.x=lPositionSource.x+lPositionSource.width;if(lPosition.x+lPosition.width+lDecalage.x>GNavigateur.EcranL){lPosition.x=Math.max(aX1Source-lPosition.width-lDecalage.x,1);} else{lPosition.x+=lDecalage.x;}
if(!lVisible){lPosition.y=lPositionSource.y;if(lPosition.y+lPosition.height+lDecalage.y>GNavigateur.EcranH){lPosition.y=Math.max(lPositionSource.y+lPositionSource.height-lPosition.height-lDecalage.y,1);} else{lPosition.y+=lDecalage.y;}}}
_modifierPositionSiChevauchement(lPosition,lPositionSource);_ramenerPositionDansLAffichage(lPosition);if(lPosition.x<10){lPosition.x=10;}
if(lPosition.y<10){lPosition.y=10;}
this.setPosition(aId,Math.max(0,lPosition.x),Math.max(0,lPosition.y),true);}
deplacerSiChevauchement(aIdMobile,aIdReference){const lPosition=_getPositionElement(aIdMobile),lPositionSource=_getPositionElement(aIdReference);_modifierPositionSiChevauchement(lPosition,lPositionSource);this.setPosition(aIdMobile,Math.max(0,lPosition.x),Math.max(0,lPosition.y),true);}
setScrollTop(aId,aScrollTop){const E=GHtml.getElement(aId);if(E&&GHtml.estElement(E)){E.scrollTop=aScrollTop;}}
setTaille(aId,aWidth,aHeight,aFormat){this.setWidth(aId,aWidth,aFormat);this.setHeight(aId,aHeight,aFormat);}
positionDansZone(aPosition,aId){const X1=this.getLeft(aId);const X2=X1+this.getWidth(aId);const Y1=this.getTop(aId);const Y2=Y1+this.getHeight(aId);return aPosition&&(aPosition.x>X1)&&(aPosition.x<X2)&&(aPosition.y>Y1)&&(aPosition.y<Y2);}
estEnCollision(aId1,aId2){const E1=GHtml.getElement(aId1);const E2=GHtml.getElement(aId2);if(!!E1&&!!E2){const x1=this.getLeft(aId1);const y1=this.getTop(aId1);const h1=this.getHeight(aId1);const w1=this.getWidth(aId1);const b1=y1+h1;const r1=x1+w1;const x2=this.getLeft(aId2);const y2=this.getTop(aId2);const h2=this.getHeight(aId2);const w2=this.getWidth(aId2);const b2=y2+h2;const r2=x2+w2;return!(b1<y2||y1>b2||r1<x2||x1>r2);}
return false;}
getPositionEventJQuery(aEvent){if(!aEvent){return{x:0,y:0};}
if(aEvent.pageX!==undefined){return{x:Math.round(aEvent.pageX),y:Math.round(aEvent.pageY)};}
if(aEvent.originalEvent&&aEvent.originalEvent.changedTouches&&aEvent.originalEvent.changedTouches[0]){return{x:aEvent.originalEvent.changedTouches[0].pageX||0,y:aEvent.originalEvent.changedTouches[0].pageY||0};}
;return{x:0,y:0};}
remToPixels(aRem){if(!this._cacheFontSize){this._cacheFontSize=require('GStyle.js').getFloatComputedValue(document.documentElement,'font-size');}
return aRem*this._cacheFontSize;}
scrollToElement(aElement,aElementScrollParent){const lElement=GHtml.getElement(aElement);const lElementScroll=GHtml.getElement(aElementScrollParent);if(!lElement||!lElementScroll){return;}
const lRect=this.getRect(lElement,true);const lRectScroll=this.getRect(lElementScroll,true);let lTop=0;let lLeft=0;let lJElement=$(lElement);while(lJElement.get(0)!==lElementScroll&&$.contains(lElementScroll,lJElement.get(0))){const lPosElement=lJElement.position();lTop+=lPosElement.top;lLeft+=lPosElement.left;lJElement=lJElement.offsetParent();if(/^body|html$/i.test(lJElement[0].nodeName)){break;}}
const lPosition={top:lTop,left:lLeft,heightVisible:Math.min(lRect.height,lRectScroll.height),widthVisible:Math.min(lRect.width,lRectScroll.width)};if(lPosition.top<0){lElementScroll.scrollTop= -lPosition.top;} else if(lPosition.top+lPosition.heightVisible-lElementScroll.scrollTop>lRectScroll.height){lElementScroll.scrollTop=lPosition.top+lPosition.heightVisible-lElementScroll.scrollTop-lRectScroll.height;}
if(lPosition.left<0){lElementScroll.scrollLeft= -lPosition.left;} else if(lPosition.left+lPosition.widthVisible-lElementScroll.scrollLeft>lRectScroll.width){lElementScroll.scrollLeft=lPosition.left+lPosition.widthVisible-lElementScroll.scrollLeft-lRectScroll.width;}}}
function _ramenerPositionDansLAffichage(aPosition){if(aPosition.x+aPosition.width>GNavigateur.EcranL){aPosition.x=Math.max(0,GNavigateur.EcranL-aPosition.width);}
if(aPosition.y+aPosition.height>GNavigateur.EcranH){aPosition.y=Math.max(0,GNavigateur.EcranH-aPosition.height);}}
function _avecChevauchement(aPosition,aPositionSource){return(aPosition.x<(aPositionSource.x+aPositionSource.width))&&((aPosition.x+aPosition.width)>aPositionSource.x)&&(aPosition.y<(aPositionSource.y+aPositionSource.height))&&((aPosition.y+aPosition.height)>aPositionSource.y);}
function _getPositionElement(aElement){const lX=GPosition.getLeft(aElement),lY=GPosition.getTop(aElement),lWidth=GPosition.getWidth(aElement),lHeight=GPosition.getHeight(aElement);return{x:lX,y:lY,width:lWidth,height:lHeight};}
function _modifierPositionSiChevauchement(aPositionMobile,aPositionSource){if((aPositionMobile.x+aPositionMobile.width)>GNavigateur.EcranL){aPositionMobile.x=GNavigateur.EcranL-aPositionMobile.width;}
if((aPositionMobile.y+aPositionMobile.height)>GNavigateur.EcranH){aPositionMobile.y=GNavigateur.EcranH-aPositionMobile.height;}
if(_avecChevauchement(aPositionMobile,aPositionSource)){aPositionMobile.x=aPositionSource.x+aPositionSource.width+6;if(aPositionMobile.x+aPositionMobile.width>GNavigateur.EcranL){aPositionMobile.x=Math.max(aPositionSource.x-aPositionMobile.width,1);}}
if(aPositionMobile.x+aPositionMobile.width>GNavigateur.EcranL){aPositionMobile.x=GNavigateur.EcranL-aPositionMobile.width;}
if(aPositionMobile.x<6){aPositionMobile.x=6;}
if(_avecChevauchement(aPositionMobile,aPositionSource)){aPositionMobile.y=aPositionSource.y+aPositionSource.height+6;if(aPositionMobile.y+aPositionMobile.height>GNavigateur.EcranH){aPositionMobile.y=Math.max(aPositionSource.y-aPositionMobile.height,1);}}
if(aPositionMobile.y+aPositionMobile.height>GNavigateur.EcranH){aPositionMobile.y=GNavigateur.EcranH-aPositionMobile.height;}}
GPosition=new _ObjetPosition();$(window).one('load',function(){GPosition._cacheFontSize=null;});module.exports._ObjetPosition=_ObjetPosition;module.exports.GPosition=GPosition;},fn:"_objetposition.js"});;
IE.fModule({f:function(exports,require,module,global){
;const lPosition=require('_ObjetPosition.js');class ObjetPosition_Mobile extends lPosition._ObjetPosition{declencherResize(){return;}}
lPosition.GPosition=new ObjetPosition_Mobile();module.exports.ObjetPosition_Mobile=ObjetPosition_Mobile;module.exports.GPosition=lPosition.GPosition;},fn:"objetposition_mobile.js"});;
IE.fModule({f:function(exports,require,module,global){if(IE.estMobile){module.exports=require('ObjetPosition_Mobile.js').GPosition;} else{module.exports=require('ObjetPosition_Espace.js').GPosition;}},fn:"gposition.js"});;
IE.fModule({f:function(exports,require,module,global){require('divers.js');require('DeclarationJQuery.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const Support=require('ObjetSupport.js');const GPosition=require('GPosition.js');global.GNavigateur=null;let uTimerPresenceUtilisateur;let uTimerDeclencherVerifierPresenceUtilisateur=null;const c_dureeInteractionUtilisateur=10*60*1000;class _ObjetNavigateur{constructor(){this.Nom='GNavigateur';this.OnEvent=[];this.nbBlocageClavier=0;this.interactionUtilisateur=true;if(document.body){this.Initialiser(this);} else{const lThis=this;$(document).ready(function(){lThis.Initialiser();});}}
Initialiser(){this.UserAgent=navigator.userAgent;const LIndex=this.UserAgent.lastIndexOf("MSIE");this.isIpad=this.UserAgent.lastIndexOf("iPad")!== -1;this.isIphone=this.UserAgent.lastIndexOf("iPhone")!== -1;this.isAndroid=this.UserAgent.lastIndexOf("Android")!== -1;this.isWinMob=this.UserAgent.toLowerCase().lastIndexOf("windows phone")!== -1||this.UserAgent.toLowerCase().lastIndexOf("windows mobile")!== -1;this.isEdge=this.UserAgent.lastIndexOf("Edge")!== -1;this.isMacOs=this.UserAgent.search(/Mac\s?OS/gi)> -1;if(this.isAndroid){try{const lMatchAndroid=(this.UserAgent).match(/android\s([0-9.]*)/i);if(lMatchAndroid&&lMatchAndroid[1]){this.versionAndroid=lMatchAndroid[1].split('.');[0,1,2].forEach(function(aVal){this.versionAndroid[aVal]=parseInt(this.versionAndroid[aVal]||0,10);}.bind(this));}} catch(e){}}
if(this.isIpad||this.isIphone){try{const lMatchIOS=(navigator.appVersion||'').match(/OS (\d+)_(\d+)_?(\d+)?/);if(lMatchIOS){this.isIOS=true;this.versionIOS=[
parseInt(lMatchIOS[1],10),parseInt(lMatchIOS[2],10),parseInt(lMatchIOS[3]||0,10)
];}} catch(e){}}
if(this.isMacOs){try{const lMatchMacOS=(navigator.appVersion||'').match(/Mac OS X (\d+)_(\d+)_?(\d+)?/);if(lMatchMacOS){this.versionMacOS=[
parseInt(lMatchMacOS[1],10),parseInt(lMatchMacOS[2],10),parseInt(lMatchMacOS[3]||0,10)
];}} catch(e){}}
if(document.body.parentNode.parentNode.firstChild.nodeValue===null||document.body.parentNode.parentNode.firstChild.nodeValue===undefined){this.IsIE9=parseInt(this.UserAgent.substring(LIndex+5,LIndex+6),10)===9;}
try{this.IsIE=LIndex!== -1;} catch(e){this.IsIE=LIndex!== -1;}
this.IsIE=(LIndex!== -1)||(this.UserAgent.lastIndexOf("Trident")!== -1);if(this.IsIE){this.IEVersion=this.UserAgent.match(/MSIE (.*?);/)?parseInt(this.UserAgent.match(/MSIE (.*?);/)[1],10):0;this.IEModeCompatible=this.IEVersion>document.documentMode;}
this.isIETouch=this.IsIE&& /Touch/.test(this.UserAgent);this.isIE9Mobile=this.IsIE&& /Windows Phone OS 7/.test(this.UserAgent);this.isTactile=this.isIpad||this.isIphone||this.isAndroid||this.isIETouch;this.IsWebKit=this.UserAgent.lastIndexOf('AppleWebKit/')> -1;this.IsGecko=!this.IsIE&&this.UserAgent.lastIndexOf('Gecko')> -1&&this.UserAgent.lastIndexOf('KHTML')=== -1;this.IsOpera=Object.prototype.toString.call(window.opera)==='[object Opera]';this.isSafari=this.UserAgent.search(/safari/gi)> -1&&this.UserAgent.search(/chrome/gi)=== -1;if(!this.isTactile&&this.isSafari&&this.isMacOs&&this.UserAgent.lastIndexOf("Macintosh")!== -1&&'ontouchstart' in window&&window.navigator&&window.navigator.maxTouchPoints>1&&!this.isAndroid){this.isIpad=true;this.isTactile=true;}
this.withContentEditable=this.IsIE||this.IsOpera||this.IsGecko||(this.IsWebKit&&!this.isAndroid&&!this.isIphone&&!this.isIpad)||(this.IsWebKit&&parseInt(this.UserAgent.match(/AppleWebKit\/(\d*)/)[1],10)>=534);Support.addInit(function(){_uniformisationTouch();if(Support.supportTouch&&(this.isIphone||this.isIpad)){_emulationContextMenu.call(this);}
if(Support.supportTouch){document.addEventListener('touchmove',function(aEvent){if(aEvent.target.closest('.IE_draggable')){aEvent.preventDefault();}},{passive:false});}}.bind(this));document.addEventListener('pointerdown',(aEvent) =>{GNavigateur.pointerX=aEvent.pageX;GNavigateur.pointerY=aEvent.pageY;},{capture:true});document.addEventListener('pointermove',(aEvent) =>{GNavigateur.pointerX=aEvent.pageX;GNavigateur.pointerY=aEvent.pageY;},{capture:true});Invocateur.abonner(ObjetInvocateur.events.eventIOAjax,_surEventIOAjax,this);Invocateur.abonner(ObjetInvocateur.events.patience,_surPatience,this);this.setIsTactile(this.isTactile);}
get EcranL(){return document.body.scrollWidth;}
get EcranH(){return document.body.scrollHeight;}
get ClientL(){return document.body.clientWidth;}
get ClientH(){return document.body.clientHeight;}
get isLayoutTactile(){return false;}
ResetCodeTouche(){this.CodeTouche=null;this.ShiftTouche=null;this.AltTouche=null;this.CtrlTouche=null;this.CmdTouche=null;}
setIsTactile(aVal){this.isTactile=aVal;if(aVal){$(document.body).addClass('isTactile');} else{$(document.body).removeClass('isTactile');}}
getBloquerClavier(){return this.nbBlocageClavier>0;}
_surUnload(event){const lNavigateur=event.data.instance;Invocateur.evenement(ObjetInvocateur.events.surRechargementPage);lNavigateur.viderCache();}
_surBeforeUnload(){let lData;if(Invocateur){lData={};Invocateur.evenement(ObjetInvocateur.events.autorisationRechargementPage,lData);if(lData.message){return lData.message;}}
if(window.GApplication){GApplication._unloadEnCours=true;setTimeout(function(){if(window.GApplication){GApplication._unloadEnCours=false;}},500);}}
finChargementPage(event){event.data.instance.chargementTermine=true;}
viderCache(){this.OnEvent=[];if(uTimerPresenceUtilisateur){clearTimeout(uTimerPresenceUtilisateur);}
if(uTimerDeclencherVerifierPresenceUtilisateur){clearTimeout(uTimerDeclencherVerifierPresenceUtilisateur);}}
_surBlurFenetre(aEvent){aEvent.data.instance.ResetCodeTouche();}
getEventInvocateur(aGenreEvent){return'IIE_EventNavigateur_'+aGenreEvent;}
StopperEvenement(AEvenement){AEvenement=_getEvenement(AEvenement);if(AEvenement){AEvenement.cancelBubble=true;if(AEvenement.stopPropagation){AEvenement.stopPropagation();}}}
bloquerValeurEvenement(aEvenement){aEvenement=_getEvenement(aEvenement);if(aEvenement){if(aEvenement.preventDefault){aEvenement.preventDefault();} else{aEvenement.returnValue=false;}}}
declarationEvenements(){try{window.onerror=this.SurError;document.onclick=this.SurClick;document.onkeydown=this.SurKeyDown;document.onkeyup=this.SurKeyUp;document.onkeypress=this.SurKeyPress;document.onmousemove=this.SurMouseMove;document.onmouseup=this.SurMouseUp;document.onmousedown=this.SurMouseDown;document.onselectstart=this.SurSelectStart;$(document).on('click dblclick mousedown mouseup mousemove '+'keydown keyup keypress '+'touchstart touchend touchcancel touchmove '+'pointerdown pointerup pointermove '+'contextmenu '+'ie-pointerdownlong',function(event){if((event.type==='click'||event.type==='dblclick')&&event.which!==1){return;}
Invocateur.evenement(GNavigateur.getEventInvocateur(event.type),event,this);});document.addEventListener('pointerdown',function(aEvent){Invocateur.evenement(`${GNavigateur.getEventInvocateur(aEvent.type)}.capture`,aEvent,this);},{capture:true});document.addEventListener('keydown',function(aEvent){Invocateur.evenement(`${GNavigateur.getEventInvocateur(aEvent.type)}.capture`,aEvent,this);},{capture:true});_verifierPresenceUtilisateur();$(document).on('visibilitychange',function(){switch(document.hidden){case true:_utilisateurNonPresent();break;case false:_verifierPresenceUtilisateur();break;}});const lEventMap={};lEventMap.resize=(aEvent) =>{Invocateur.evenement(ObjetInvocateur.events.resizeNavigateur,aEvent);if(this.SurResize){this.SurResize(aEvent);}};if(this.SurScroll){lEventMap.scroll=this.SurScroll;}
lEventMap.load=this.finChargementPage;lEventMap.unload=this._surUnload;lEventMap.beforeunload=this._surBeforeUnload;lEventMap.blur=this._surBlurFenetre;if(this._surOrientationChange){lEventMap.orientationchange=this._surOrientationChange;}
$(window).on(lEventMap,{instance:this});} catch(ignore){}}}
function _surEventIOAjax(aParametres){if(aParametres.init||aParametres.actualisation||aParametres.ignorerBlocageClavier){return;}
_surPatience.call(this,!!aParametres.emission);}
function _surPatience(aActiver){this.nbBlocageClavier=this.nbBlocageClavier+(aActiver?1:-1);this.nbBlocageClavier=Math.max(0,this.nbBlocageClavier);}
function _utilisateurNonPresent(){if(uTimerPresenceUtilisateur){clearTimeout(uTimerPresenceUtilisateur);uTimerPresenceUtilisateur=null;}
if(GNavigateur.interactionUtilisateur){Invocateur.evenement(ObjetInvocateur.events.modificationPresenceUtilisateur,false);GNavigateur.interactionUtilisateur=false;}}
function _verifierPresenceUtilisateur(){if(!GNavigateur.interactionUtilisateur){Invocateur.evenement(ObjetInvocateur.events.modificationPresenceUtilisateur,true);}
GNavigateur.interactionUtilisateur=true;if(uTimerPresenceUtilisateur){clearTimeout(uTimerPresenceUtilisateur);uTimerPresenceUtilisateur=null;}
uTimerPresenceUtilisateur=setTimeout(_utilisateurNonPresent,c_dureeInteractionUtilisateur);$(document).off('mousedown keydown mousemove pointerdown touchstart',_verifierPresenceUtilisateur);if(uTimerDeclencherVerifierPresenceUtilisateur){clearTimeout(uTimerDeclencherVerifierPresenceUtilisateur);uTimerDeclencherVerifierPresenceUtilisateur=null;}
uTimerDeclencherVerifierPresenceUtilisateur=setTimeout(function(){uTimerDeclencherVerifierPresenceUtilisateur=null;$(document).on('mousedown keydown mousemove pointerdown touchstart',_verifierPresenceUtilisateur);},1000*10);}
function _emulationContextMenu(){const lDelai=500;let uGestionTouch=null;const const_margesDeplacementContextMenu=100;function _touchstart(event){const lPosition=GPosition.getPositionEventJQuery(event);uGestionTouch={x:lPosition.x,y:lPosition.y,timeStart:Date.now()};}
function _toucheend(aEvent){let lGestionTouch=uGestionTouch;uGestionTouch=null;if(lGestionTouch&&(Date.now()-lGestionTouch.timeStart>lDelai)){const lPosition=GPosition.getPositionEventJQuery(aEvent);const lAccepterContextMenu=aEvent.target&&Math.abs(lPosition.x-lGestionTouch.x)<const_margesDeplacementContextMenu&&Math.abs(lPosition.y-lGestionTouch.y)<const_margesDeplacementContextMenu&&(!GPosition||GPosition.positionDansZone(lPosition,aEvent.target));if(!lAccepterContextMenu){return;}
aEvent.stopImmediatePropagation();aEvent.preventDefault();const lEvent=$.Event('contextmenu',{pointerType:'touch',originalEvent:aEvent.originalEvent});setTimeout(function(){$(aEvent.target).trigger(lEvent);},0);}}
$(document).on({touchstart:_touchstart,touchend:_toucheend,touchcancel(){uGestionTouch={};},contextmenu(){uGestionTouch={};}});}
function _uniformisationTouch(){let uLongTouch=null,uLongTouchTimer= -1,uLongTouchTimerFin= -1,const_delaiLongTouch=500,const_delaiLongTouchFin=1500,const_margesDeplacementLongTouch=50;function _stopperLongTouch(){clearTimeout(uLongTouchTimer);clearTimeout(uLongTouchTimerFin);uLongTouch=null;}
function _demarrageLongTouch(aEventOrigine){_stopperLongTouch();uLongTouch={pointerId:aEventOrigine.pointerId,x:aEventOrigine.clientX,y:aEventOrigine.clientY,ok:false};uLongTouchTimer=setTimeout(function(){if(uLongTouch){uLongTouch.ok=true;}},const_delaiLongTouch);uLongTouchTimerFin=setTimeout(function(){if(uLongTouch){_finaliserLongTouch(aEventOrigine,true);}},const_delaiLongTouchFin);}
function _eventDansMargesLongTouch(aEvent){return uLongTouch&&Math.abs(aEvent.clientX-uLongTouch.x)<const_margesDeplacementLongTouch&&Math.abs(aEvent.clientY-uLongTouch.y)<const_margesDeplacementLongTouch;}
function _finaliserLongTouch(aEventOrigine,aSurTimer){clearTimeout(uLongTouchTimer);clearTimeout(uLongTouchTimerFin);if(uLongTouch.ok&&uLongTouch.pointerId===aEventOrigine.pointerId&&_eventDansMargesLongTouch(aEventOrigine)){const lEventSimule=$.Event('ie-pointerdownlong',Object.assign(aEventOrigine,{type:'ie-pointerdownlong'}));if(aSurTimer){lEventSimule.surTimer=true;}
$(aEventOrigine.target).trigger(lEventSimule);}
_stopperLongTouch();}
$(document).on({'pointerdown.pointerdownlong'(aEvent){if(aEvent.target){_demarrageLongTouch(aEvent);}},'pointerup.pointerdownlong'(aEvent){if(aEvent.target&&uLongTouch){_finaliserLongTouch(aEvent);}},'pointermove.pointerdownlong'(aEvent){if(uLongTouch){if(uLongTouch.pointerId!==aEvent.pointerId||!_eventDansMargesLongTouch(aEvent)){_stopperLongTouch();}}},'pointercancel.pointerdownlong'(){if(uLongTouch){_stopperLongTouch();}},'scroll.pointerdownlong'(){if(uLongTouch){_stopperLongTouch();}}});_initSwipeEvent();}
function _initSwipeEvent(){function triggerCustomEvent(obj,eventType,event,bubble){var originalType=event.type;event.type=eventType;if(bubble){$.event.trigger(event,undefined,obj);} else{$.event.dispatch.call(obj,event);}
event.type=originalType;}
const lJDocument=$(document);$.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1000,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(event){var winPageX=window.pageXOffset,winPageY=window.pageYOffset,x=event.clientX,y=event.clientY;if(event.pageY===0&&Math.floor(y)>Math.floor(event.pageY)||
event.pageX===0&&Math.floor(x)>Math.floor(event.pageX)){x=x-winPageX;y=y-winPageY;} else if(y<(event.pageY-winPageY)||x<(event.pageX-winPageX)){x=event.pageX-winPageX;y=event.pageY-winPageY;}
return{x:x,y:y};},start:function(event){var data=event.originalEvent.touches?event.originalEvent.touches[ 0 ]:event,location=$.event.special.swipe.getLocation(data);return{time:(new Date()).getTime(),coords:[ location.x,location.y ],origin:$(event.target)};},stop:function(event){var data=event.originalEvent.touches?event.originalEvent.touches[ 0 ]:event,location=$.event.special.swipe.getLocation(data);return{time:(new Date()).getTime(),coords:[ location.x,location.y ]};},handleSwipe:function(start,stop,thisObject,origTarget){if(stop.time-start.time<$.event.special.swipe.durationThreshold&&
Math.abs(start.coords[ 0 ]-stop.coords[ 0 ])>$.event.special.swipe.horizontalDistanceThreshold&&
Math.abs(start.coords[ 1 ]-stop.coords[ 1 ])<$.event.special.swipe.verticalDistanceThreshold){var direction=start.coords[0]>stop.coords[ 0 ]?"swipeleft":"swiperight";triggerCustomEvent(thisObject,"swipe",$.Event("swipe",{target:origTarget,swipestart:start,swipestop:stop}),true);triggerCustomEvent(thisObject,direction,$.Event(direction,{target:origTarget,swipestart:start,swipestop:stop}),true);return true;}
return false;},eventInProgress:false,setup:function(){var events,thisObject=this,$this=$(thisObject),context={};events=$.data(this,"mobile-events");if(!events){events={length:0};$.data(this,"mobile-events",events);}
events.length++;events.swipe=context;context.start=function(event){if($.event.special.swipe.eventInProgress){return;}
$.event.special.swipe.eventInProgress=true;var stop,start=$.event.special.swipe.start(event),origTarget=event.target,emitted=false;context.move=function(event){if(!start||event.isDefaultPrevented()){return;}
stop=$.event.special.swipe.stop(event);if(!emitted){emitted=$.event.special.swipe.handleSwipe(start,stop,thisObject,origTarget);if(emitted){$.event.special.swipe.eventInProgress=false;}}};context.stop=function(){emitted=true;$.event.special.swipe.eventInProgress=false;lJDocument.off('touchmove',context.move);context.move=null;};lJDocument.on('touchmove',context.move).one('touchend',context.stop);};$this.on('touchstart',context.start);},teardown:function(){var events,context;events=$.data(this,"mobile-events");if(events){context=events.swipe;delete events.swipe;events.length--;if(events.length===0){$.removeData(this,"mobile-events");}}
if(context){if(context.start){$(this).off('touchstart',context.start);}
if(context.move){lJDocument.off('touchmove',context.move);}
if(context.stop){lJDocument.off('touchend',context.stop);}}}};$.each({swipeleft:"swipe.left",swiperight:"swipe.right"},function(event,sourceEvent){$.event.special[ event ]={setup:function(){$(this).bind(sourceEvent,$.noop);},teardown:function(){$(this).unbind(sourceEvent);}};});}
function _getEvenement(aEvenement){return aEvenement||window.event;}
module.exports=_ObjetNavigateur;},fn:"_objetnavigateur.js"});;
IE.fModule({f:function(exports,require,module,global){const _ObjetNavigateur=require('_ObjetNavigateur.js');const GLog=require('IELog.js');class ObjetNavigateur_Mobile extends _ObjetNavigateur{SurError(AMessage,AUrl,ALigne){GLog.addLog('ObjetNavigateur.SurError : '+AMessage+'; '+AUrl+'; Ligne : '+ALigne,'ERROR',GLog.genre.Erreur);}}
global.GNavigateur=new ObjetNavigateur_Mobile()
;GNavigateur.declarationEvenements();module.exports=ObjetNavigateur_Mobile;},fn:"objetnavigateur_mobile.js"});;
IE.fModule({f:function(exports,require,module,global){;},fn:"declarationjournauxcp.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeFormatDureeEnChaine={fdcHeuresMinutes:0,fdcHeuresCentiemes:1,fdcSequences:2,fdcPersonnalise:3};module.exports.TypeFormatDureeEnChaine=TypeFormatDureeEnChaine;},fn:"typeformatdureeenchaine.js"});;
IE.fModule({f:function(exports,require,module,global){
const MethodesObjet=require('MethodesObjet.js');const GTraductions=require('ObjetTraduction.js');const C_HeuresParJour=24,C_MinutesParHeure=60,C_SecondesParMinute=60,C_MilliSecondesParSeconde=1000,C_MinutesParJour=C_MinutesParHeure*C_HeuresParJour,C_SecondesParJour=C_SecondesParMinute*C_MinutesParJour;function TUtilitaireDuree(){}
TUtilitaireDuree.dureeEnHeures=function(aDuree,aSansArrondi){if(MethodesObjet.isNumber(aDuree)){return _get(aDuree*C_HeuresParJour,aSansArrondi);}
return 0;};TUtilitaireDuree.dureeEnHeuresMinutes=function(aDuree){const lResult={heures:0,minutes:0,toString:function(aFormat){let lFormat='%hh:%mm';if(aFormat===true){lFormat='%oh%sh%om%sm';} else if(typeof(aFormat)==='string'){lFormat=aFormat;}
lFormat=lFormat.replace('%hh',(this.heures<10?'0':'')+this.heures);lFormat=lFormat.replace('%xh',this.heures);lFormat=lFormat.replace('%oh%sh',this.heures>0?this.heures+GTraductions.getValeur('date.separateurHeure'):'');lFormat=lFormat.replace('%oh',this.heures>0?this.heures:'');lFormat=lFormat.replace('%sh',GTraductions.getValeur('date.separateurHeure'));lFormat=lFormat.replace('%mm',(this.minutes<10?'0':'')+this.minutes);lFormat=lFormat.replace('%xm',this.minutes);lFormat=lFormat.replace('%om%sm',this.minutes>0?((this.heures>0)&&(this.minutes<10)?'0':'')+this.minutes+GTraductions.getValeur('date.separateurMin'):'');lFormat=lFormat.replace('%om',this.minutes>0?this.minutes:'');lFormat=lFormat.replace('%sm',GTraductions.getValeur('date.separateurMin'));return lFormat;}};if(MethodesObjet.isNumber(aDuree)){let lDureeEnMS=_get(aDuree*C_MilliSecondesParSeconde*C_SecondesParJour);lResult.heures=parseInt(lDureeEnMS/(60*60*1000),10);lDureeEnMS=lDureeEnMS-lResult.heures*(60*60*1000);lResult.minutes=parseInt(lDureeEnMS/(60*1000),10);}
return lResult;};TUtilitaireDuree.heuresEnDuree=function(aVal){if(MethodesObjet.isNumber(aVal)){return aVal/C_HeuresParJour;}
return 0;};TUtilitaireDuree.dureeEnMin=function(aDuree,aSansArrondi){if(MethodesObjet.isNumber(aDuree)){return _get(aDuree*C_MinutesParJour,aSansArrondi);}
return 0;};TUtilitaireDuree.minEnDuree=function(aVal){if(MethodesObjet.isNumber(aVal)){return aVal/C_MinutesParJour;}
return 0;};TUtilitaireDuree.dureeEnMs=function(aDuree,aSansArrondi){if(MethodesObjet.isNumber(aDuree)){return _get(aDuree*C_MilliSecondesParSeconde*C_SecondesParJour,aSansArrondi);}
return 0;};TUtilitaireDuree.msEnDuree=function(aVal){if(MethodesObjet.isNumber(aVal)){return aVal/(C_MilliSecondesParSeconde*C_SecondesParJour);}
return 0;};TUtilitaireDuree.minEnMs=function(aVal){if(MethodesObjet.isNumber(aVal)){return aVal*C_SecondesParMinute*C_MilliSecondesParSeconde;}
return 0;};function _get(aVal,aSansArrondi){return aSansArrondi===true?aVal:Math.round(aVal);}
module.exports=TUtilitaireDuree;},fn:"utilitaireduree.js"});;
IE.fModule({f:function(exports,require,module,global){const GLog=require('IELog.js');const MethodesObjet=require('MethodesObjet.js');const ObjetElement=require('ObjetElement.js');const ObjetListeElements=require('ObjetListeElements.js');const GTraductions=require('ObjetTraduction.js');const ObjetTri=require('ObjetTri.js');const TypeDomaine=require('TypeDomaine.js');const TypeFormatDureeEnChaine=require('TypeFormatDureeEnChaine.js').TypeFormatDureeEnChaine;const TUtilitaireDuree=require('UtilitaireDuree.js');const IEHtml=require('IEHtml.js');let GDate;class ObjetDate{constructor(){this.DureeMillisecondes=1;this.DureeSecondes=1000*this.DureeMillisecondes;this.DureeMinutes=60*this.DureeSecondes;this.DureeHeures=60*this.DureeMinutes;this.DureeJours=24*this.DureeHeures;this.DureeSemaines=7*this.DureeJours;this.semainesParAn=52;this.aujourdhui=new Date();this.demain=new Date();this.demain.setDate(this.demain.getDate()+1);this.hier=new Date();this.hier.setDate(this.hier.getDate()-1);this.parametres={numeroPremiereSemaine:null,formatDureeEnChaine:TypeFormatDureeEnChaine.fdcHeuresMinutes};this._cacheSemainesCalendaires={};}
SetDonnees(APremierLundi,aPremiereDate,aDerniereDate,APlacesParJour,APlacesParHeure,ADureeSequence,APremiereHeure,AListeHeures1,AListeHeures2,aJoursOuvres,aJour){this.PremierLundi=APremierLundi;this.premiereDate=aPremiereDate;this.derniereDate=aDerniereDate;this.PlacesParJour=APlacesParJour;this.PlacesParHeure=APlacesParHeure;this.DureeSequence=ADureeSequence;this.PremiereHeure=APremiereHeure;this.ListeHeures=AListeHeures1||new ObjetListeElements();this.ListeHeuresFin=AListeHeures2;this.joursOuvres=aJoursOuvres||new TypeDomaine(true,7);this.jour=this.GetDateDemiJour(aJour||new Date());}
setParametresDate(aParams){Object.assign(this.parametres,aParams);return this;}
estUnJourOuvre(aDate){return this.joursOuvres.GetValeur(GDate.GetJourDeDate(aDate)+1);}
estDateEgale(ADate1,ADate2){return(ADate1-ADate2)===0;}
estJourEgal(ADate1,ADate2){return ADate1&&ADate2&&(ADate1.getDate()===ADate2.getDate())&&(ADate1.getMonth()===ADate2.getMonth())&&(ADate1.getFullYear()===ADate2.getFullYear());}
estJourSemaineEgal(ADate1,ADate2){return(ADate1.getDay()===ADate2.getDay())&&(ADate1.getMonth()===ADate2.getMonth())&&(ADate1.getFullYear()===ADate2.getFullYear());}
estJourCourant(aDate,aBorner){return this.estJourEgal(aDate,this.getDateCourante(aBorner));}
estAvantJourCourant(aDate,aBorner){return(aDate-this.getDateCourante(aBorner))<0;}
estAvantJour(aDate1,aDate2){return(aDate1-aDate2)<0;}
estDateValide(aDate){return MethodesObjet.isDate(aDate)&&!isNaN(aDate.getTime());}
getDateJour(aDate,aBorner){let lDate=aDate;if(!this.estDateValide(aDate)){lDate=new Date();}
if(aBorner){lDate=this.getDateBornee(lDate);}
return new Date(lDate.getFullYear(),lDate.getMonth(),lDate.getDate());}
getProchainJourOuvre(aDate){let lDate=aDate;do{lDate=this.GetJourSuivant(lDate);}
while(!this.estUnJourOuvre(lDate)&&(lDate<this.derniereDate));return lDate;}
getDateBornee(aDate){if(aDate<this.premiereDate&&!this.estJourEgal(aDate,this.premiereDate)){return new Date(this.premiereDate.getTime());}
if(aDate>this.derniereDate&&!this.estJourEgal(aDate,this.derniereDate)){return new Date(this.derniereDate.getTime());}
return aDate;}
getDateCourante(aBorner){let lDate=new Date();lDate=new Date(lDate.getFullYear(),lDate.getMonth(),lDate.getDate());return aBorner===false?lDate:this.getDateBornee(lDate);}
getDateHeureCourante(){return this.getDateBornee(new Date());}
dateEntreLesDates(aDate,aBorneDateDebut,aBorneDateFin,aComparaisonTime){if(!aDate){return false;}
return(!aBorneDateDebut||aDate>=aBorneDateDebut||(aComparaisonTime!==true&&this.estJourEgal(aDate,aBorneDateDebut)))&&(!aBorneDateFin||aDate<=aBorneDateFin||(aComparaisonTime!==true&&this.estJourEgal(aDate,aBorneDateFin)));}
estDateJourAvant(aDate1,aDate2){return aDate1<aDate2&&
this.estDateValide(aDate1)&&
this.estDateValide(aDate2)&&
!this.estJourEgal(aDate1,aDate2);}
estDateDansAnneeScolaire(aDate){return this.dateEntreLesDates(aDate,this.premiereDate,this.derniereDate);}
GetDateDemiJour(ADate){return new Date(ADate.getFullYear(),ADate.getMonth(),ADate.getDate(),12);}
premierJourOuvreDeLaSemaine(aNrSemaine){return IE.Cycles.datePremierJourOuvreCycle(aNrSemaine);}
dernierJourOuvreDeLaSemaine(aNrSemaine){return IE.Cycles.dateDernierJourOuvreCycle(aNrSemaine);}
GetJour(ADate,N){return new Date(ADate.getFullYear(),ADate.getMonth(),ADate.getDate(),N===null||N===undefined?0:24*N);}
GetJourDeSemaine(ADate,B){return(7+ADate.getDay()-(B?this.PremierLundi.getDay():1))%7;}
GetSemaineSuivante(ADate,N){return new Date(ADate.getTime()+(N===null||N===undefined?1:N)*this.DureeSemaines);}
GetJourSuivant(ADate,N){if(!ADate||!ADate.getTime){return null;}
let lDate=new Date(ADate.getTime()),lNombreJours=MethodesObjet.isNumber(N)?N:1;lDate.setDate(lDate.getDate()+lNombreJours);if(Math.abs(lNombreJours)===1&&ADate.getDate()===lDate.getDate()){const lDateCorrigee=new Date(ADate.getTime());lDateCorrigee.setHours(ADate.getHours()+1);if(lDateCorrigee.getDate()!==ADate.getDate()){lDateCorrigee.setHours(ADate.getHours()-1);}
lDateCorrigee.setDate(lDateCorrigee.getDate()+lNombreJours);lDate=lDateCorrigee;}
return lDate;}
estAnneeBissextile(aAnnee){return(new Date(aAnnee,1,29).getDate()===29);}
EstUnJourDuWE(AAnnee,AMois,AJour){const D=new Date(AAnnee,AMois,AJour).getDay();return(D===0)||(D===6);}
GetNombreJoursDuMois(AAnnee,AMois){AMois=(AMois+1)%12;if(AMois===0){AAnnee++;}
return new Date(AAnnee,AMois,0).getDate();}
GetPremierJourDuMois(AAnnee,AMois){return new Date(AAnnee,AMois,1,12);}
GetPremierLundiDuMois(AAnnee,AMois){const LJour=this.GetPremierJourDuMois(AAnnee,AMois),lJourPremierLundi=this.PremierLundi?GDate.GetJourDeSemaine(this.PremierLundi):0;return this.GetJourSuivant(LJour,(lJourPremierLundi-(7+GDate.GetJourDeSemaine(LJour)))%7);}
GetDernierJourDuMois(AAnnee,AMois){return new Date(AAnnee,AMois,this.GetNombreJoursDuMois(AAnnee,AMois),12);}
EstUnJourDuMois(AAnnee,AMois,AJour){return new Date(AAnnee,AMois,AJour).getMonth()===AMois;}
estHeureIdentique(aDate1,aDate2){return(aDate1.getHours()===aDate2.getHours())&&(aDate1.getMinutes()===aDate2.getMinutes());}
JourEstDansLaPeriode(AAnnee,AMois,AJour,ADateDebut,ADateFin){const LDate=new Date(AAnnee,AMois,AJour);return(LDate>=ADateDebut)&&(LDate<=ADateFin);}
StrMoisCourt(AAnnee,AMois,AAvecAnnee){return GTraductions.getValeur('MoisCourt')[AMois]+(AAvecAnnee?'&nbsp;'+AAnnee:'');}
NombreMoisSurPeriode(ADateDebut,ADateFin){return 12*(ADateFin.getFullYear()-ADateDebut.getFullYear())+(ADateFin.getMonth()-ADateDebut.getMonth())+1;}
nombresSemainesDansLAnnee(aSemaine){let lDate;if(aSemaine>0){lDate=IE.Cycles.dateDebutCycle(aSemaine);} else{lDate=this.PremierLundi;}
return this.getNombresSemainesPourLAnnee(lDate.getFullYear());}
getNombresSemainesPourLAnnee(aAnnee){const lDate=new Date(aAnnee,0,1);const lDay=this.GetJourDeDate(lDate);return(lDay===3)||(lDay===2&&this.estAnneeBissextile(lDate.getFullYear()))?this.semainesParAn+1:this.semainesParAn;}
GetJourDeDate(ADate){return(ADate.getDay()+7-1)%7;}
getFuseau(aDate){return aDate?aDate.getTimezoneOffset()/60:0;}
getEcartFuseau(aDate1,aDate2){return this.getFuseau(aDate1)-this.getFuseau(aDate2);}
GetSemaine(aDate){return IE.Cycles.cycleDeLaDate(aDate||new Date());}
getNbrJoursDepuisPremiereLundi(aDate){return this.getNbrJoursEntreDeuxDates(this.PremierLundi,aDate);}
getNbrJoursEntreDeuxDates(aDateDebut,aDateFin){if(!aDateDebut||!aDateDebut.getFullYear||!aDateFin||!aDateFin.getFullYear){return 0;}
return Date.UTC(aDateFin.getFullYear(),aDateFin.getMonth(),aDateFin.getDate())/this.DureeJours-Date.UTC(aDateDebut.getFullYear(),aDateDebut.getMonth(),aDateDebut.getDate())/this.DureeJours;}
GetSemaineCalendaire(){return 1+Math.round((this.PremierLundi-new Date(this.PremierLundi.getFullYear(),0,1))/this.DureeSemaines);}
semaineToCalendaire(aSemaine,aNumeroPremiereSemaine){let lNumero=aNumeroPremiereSemaine;if(!MethodesObjet.isNumber(lNumero)){lNumero=this.parametres.numeroPremiereSemaine;}
if(!MethodesObjet.isNumber(lNumero)){lNumero=1;}
if(lNumero<0){if(!this._cacheSemainesCalendaires[aSemaine]){const lNbSemaines=this.nombresSemainesDansLAnnee(aSemaine);if(aSemaine<=1){this._cacheSemainesCalendaires[aSemaine]=((aSemaine-1)+(this.GetSemaineCalendaire()-1))%lNbSemaines+1;} else if(aSemaine>0){let lSemaineCalPrec=this._cacheSemainesCalendaires[aSemaine-1];if(!lSemaineCalPrec){lSemaineCalPrec=this.semaineToCalendaire(aSemaine-1,lNumero);}
this._cacheSemainesCalendaires[aSemaine]=lSemaineCalPrec+1>lNbSemaines?1:lSemaineCalPrec+1;}}
return this._cacheSemainesCalendaires[aSemaine];}
return aSemaine+lNumero-1;}
strDateCalendaireDeSemaine(aSemaine,avecDuAu){const lNumeroSemaine=this.semaineToCalendaire(aSemaine);const H=[];H.push(GTraductions.getValeur('Semaine')+' '+lNumeroSemaine);if(avecDuAu===true){const lDateDeb=this.FormatDate(this.premierJourOuvreDeLaSemaine(aSemaine),'%JJ/%MM/%AAAA');const lDateFin=this.FormatDate(this.dernierJourOuvreDeLaSemaine(aSemaine),'%JJ/%MM/%AAAA');H.push(', ');H.push(GTraductions.getValeur('Du')+' '+lDateDeb);H.push(' ');H.push(GTraductions.getValeur('Au')+' '+lDateFin);}
return H.join('');}
GetDifferenceJours(aDate1,aDate2){const lJour1=parseInt(this.GetJour(aDate1)/this.DureeJours,10);const lJour2=parseInt(this.GetJour(aDate2)/this.DureeJours,10);return lJour1-lJour2;}
GetDifferenceJoursPar24h(aDate1,aDate2){const duree_ms=aDate1-aDate2;return parseInt(duree_ms/this.DureeJours,10);}
GetDifferenceTime(aDate1,aDate2){const duree_ms=aDate1-aDate2;const reste_heures=duree_ms-(parseInt(duree_ms/this.DureeJours,10)*this.DureeJours);const nb_heures=parseInt(reste_heures/this.DureeHeures,10);const reste_minutes=duree_ms-(parseInt(duree_ms/this.DureeHeures,10)*this.DureeHeures);const nb_minutes=parseInt(reste_minutes/this.DureeMinutes,10);const reste_secondes=duree_ms-(parseInt(duree_ms/this.DureeMinutes,10)*this.DureeMinutes);const nb_secondes=parseInt(reste_secondes/this.DureeSecondes,10);return(nb_heures<10?'0':'')+nb_heures+':'+(nb_minutes<10?'0':'')+nb_minutes+':'+(nb_secondes<10?'0':'')+nb_secondes;}
FormatDate(ADate,AFormat){if(!ADate||!MethodesObjet.isDate(ADate)){GLog.addLog('ObjetDate.FormatDate, ADate n\'est pas une date : '+ADate);return'';}
if(!AFormat||!MethodesObjet.isString(AFormat)){GLog.addLog('ObjetDate.FormatDate, AFormat n\'est pas format valide : '+AFormat);return'';}
AFormat=AFormat.replace(/\[(.*?)\]/ig,!this.estJourEgal(ADate,this.aujourdhui)?!this.estJourEgal(ADate,this.demain)?!this.estJourEgal(ADate,this.hier)?'$1':GTraductions.getValeur('Hier'):GTraductions.getValeur('Demain'):GTraductions.getValeur('Aujourdhui'));const LHour=ADate.getHours();const LMinute=ADate.getMinutes();const LSecond=ADate.getSeconds();const LDay=this.GetJourDeDate(ADate);const LDate=ADate.getDate();const LMonth=ADate.getMonth()+1;const LYear=ADate.getFullYear();AFormat=AFormat.replace('%hh',(LHour<10?'0':'')+LHour);AFormat=AFormat.replace('%xh',LHour);AFormat=AFormat.replace('%mm',(LMinute<10?'0':'')+LMinute);AFormat=AFormat.replace('%ss',(LSecond<10?'0':'')+LSecond);AFormat=AFormat.replace('%sh',GTraductions.getValeur('date.separateurHeure'));AFormat=AFormat.replace('%JJJJ',GTraductions.getValeur('Jours')[LDay]);AFormat=AFormat.replace('%Jjjj',(GTraductions.getValeur('Jours')[LDay]).ucfirst());AFormat=AFormat.replace('%JJJ',GTraductions.getValeur('JoursCourt')[LDay]);AFormat=AFormat.replace('%Jjj',(GTraductions.getValeur('JoursCourt')[LDay]).ucfirst());AFormat=AFormat.replace('%JJ',(LDate<10?'0':'')+LDate);AFormat=AFormat.replace('%J',LDate);AFormat=AFormat.replace('%MMMM',GTraductions.getValeur('Mois')[LMonth-1]);AFormat=AFormat.replace('%MMM',GTraductions.getValeur('MoisCourt')[LMonth-1]);AFormat=AFormat.replace('%Mmm',(GTraductions.getValeur('MoisCourt')[LMonth-1]).ucfirst());AFormat=AFormat.replace('%MM',(LMonth<10?'0':'')+LMonth);AFormat=AFormat.replace('%AAAA',LYear);AFormat=AFormat.replace('%AA',(LYear%100<10?'0':'')+LYear%100);return AFormat;}
estDateParticulier(ADate){return this.estJourEgal(ADate,this.aujourdhui)||this.estJourEgal(ADate,this.demain)||this.estJourEgal(ADate,this.hier);}
FormatDureeEnMillisecondes(aDureeEnMillisecondes,aFormat,aForcerFormatDuree){if(!MethodesObjet.isNumber(aDureeEnMillisecondes)){return'';}
let lFormatDureeEnChaine=this.parametres.formatDureeEnChaine;if(MethodesObjet.isNumber(aForcerFormatDuree)){lFormatDureeEnChaine=aForcerFormatDuree;}
switch(lFormatDureeEnChaine){case TypeFormatDureeEnChaine.fdcHeuresMinutes:case TypeFormatDureeEnChaine.fdcPersonnalise:{let lFormat=aFormat||'%hh%sh%mm';let LHour=null,LMinute=null;lFormat=lFormat.replace('%sh',GTraductions.getValeur('date.separateurHeure'));if((lFormat.lastIndexOf('%hh')> -1)||(lFormat.lastIndexOf('%xh')> -1)){LHour=parseInt(aDureeEnMillisecondes/this.DureeHeures,10);lFormat=lFormat.replace('%hh',(LHour<10?'0':'')+LHour);lFormat=lFormat.replace('%xh',LHour);aDureeEnMillisecondes=aDureeEnMillisecondes-LHour*this.DureeHeures;}
if(lFormat.lastIndexOf('%mm')> -1||(lFormat.lastIndexOf('%xm')> -1)){LMinute=parseInt(aDureeEnMillisecondes/this.DureeMinutes,10);lFormat=lFormat.replace('%mm',(LMinute<10?'0':'')+LMinute);lFormat=lFormat.replace('%xm',LMinute);aDureeEnMillisecondes=aDureeEnMillisecondes-LMinute*this.DureeMinutes;}
const LSecond=parseInt(aDureeEnMillisecondes/this.DureeSecondes,10);lFormat=lFormat.replace('%ss',(LSecond<10?'0':'')+LSecond);return lFormat;}
case TypeFormatDureeEnChaine.fdcHeuresCentiemes:{const lNbHeures=Math.floor(aDureeEnMillisecondes/GDate.DureeHeures);let lMinutesEnCentiemes=Math.floor((aDureeEnMillisecondes/GDate.DureeHeures-lNbHeures)*100);if(lMinutesEnCentiemes<10){lMinutesEnCentiemes='0'+lMinutesEnCentiemes;}
return lNbHeures+','+lMinutesEnCentiemes;}
case TypeFormatDureeEnChaine.fdcSequences:{const lNbSequences=Math.round10(aDureeEnMillisecondes/TUtilitaireDuree.dureeEnMs(this.DureeSequence),-2);const lPartieEntiere=Math.floor(lNbSequences);let lPartieDecimale=Math.floor((lNbSequences-lPartieEntiere)*100);if(lPartieDecimale<10){lPartieDecimale='0'+lPartieDecimale;}
return lPartieEntiere+','+lPartieDecimale;}
default:;}
return'';}
dureeEnMillisecondesToHMS(aDureeEnMillisecondes){const lResult={heures:0,minutes:0,secondes:0};if(!MethodesObjet.isNumber(aDureeEnMillisecondes)){return lResult;}
lResult.heures=parseInt(aDureeEnMillisecondes/this.DureeHeures,10);aDureeEnMillisecondes=aDureeEnMillisecondes-lResult.heures*this.DureeHeures;lResult.minutes=parseInt(aDureeEnMillisecondes/this.DureeMinutes,10);aDureeEnMillisecondes=aDureeEnMillisecondes-lResult.minutes*this.DureeMinutes;lResult.secondes=parseInt(aDureeEnMillisecondes/this.DureeSecondes,10);return lResult;}
HMSToDureeEnMillisecondes(aHMS){const lHMS={heures:(aHMS&&aHMS.heures)?aHMS.heures:0,minutes:(aHMS&&aHMS.minutes)?aHMS.minutes:0,secondes:(aHMS&&aHMS.secondes)?aHMS.secondes:0};return lHMS.heures*this.DureeHeures+lHMS.minutes*this.DureeMinutes+lHMS.secondes*this.DureeSecondes;}
formatDureeEnPlaces(aPlaces,aFormat,aForcerFormatDuree){if(!MethodesObjet.isNumber(aPlaces)){return'';}
return this.FormatDureeEnMillisecondes(this.nombrePlacesEnMillisecondes(aPlaces),aFormat,aForcerFormatDuree);}
enCentiemeDHeure(aDureeEnMillisecondes){const lDuree=parseInt(aDureeEnMillisecondes,10);if(!MethodesObjet.isNumber(lDuree)){return'';}
const lNbHeures=Math.floor(lDuree/GDate.DureeHeures);let lMinutesEnCentiemes=Math.floor((lDuree/GDate.DureeHeures-lNbHeures)*100);if(lMinutesEnCentiemes<10){lMinutesEnCentiemes='0'+lMinutesEnCentiemes;}
return lNbHeures+','+lMinutesEnCentiemes;}
strSemaine(aNumeroSemaine,aFormatDebut,aFormatFin,aSeparateur1,aSeparateur2,aSeparateur3){const lDateDeb=this.FormatDate(this.premierJourOuvreDeLaSemaine(aNumeroSemaine),aFormatDebut);const lDateFin=this.FormatDate(this.dernierJourOuvreDeLaSemaine(aNumeroSemaine),aFormatFin);return(aSeparateur1||'')+lDateDeb+(aSeparateur2||'')+lDateFin+(aSeparateur3||'');}
strSemaineSelonCycle(aCycle,aNumeroSemaine,aFormatDebut,aFormatFin,aSeparateur1,aSeparateur2,aSeparateur3){const lDateDeb=this.FormatDate(aCycle.datePremierJourOuvreCycle(aNumeroSemaine),aFormatDebut);const lDateFin=this.FormatDate(aCycle.dateDernierJourOuvreCycle(aNumeroSemaine),aFormatFin);return(aSeparateur1||'')+lDateDeb+(aSeparateur2||'')+lDateFin+(aSeparateur3||'');}
strDomaine(aDomaine,aFormatDebut,aFormatFin,aSeparateur1,aSeparateur2,aSeparateur3){const lDateDeb=this.FormatDate(IE.Cycles.datePremierJourOuvreCycle(aDomaine.GetPremierePosition()),aFormatDebut);const lDateFin=this.FormatDate(IE.Cycles.dateDernierJourOuvreCycle(aDomaine.GetDernierePosition()),aFormatFin);return(aSeparateur1||'')+lDateDeb+(aSeparateur2||'')+lDateFin+(aSeparateur3||'');}
strDates(aDateDebut,aDateFin,aParams){const lParams={sansHoraire:false,formatDate:'%J %MMMM'};$.extend(lParams,aParams);const formatHeure=' %hh'+GTraductions.getValeur('date.separateurHeure')+'%mm';const lResult=[];if(GDate.getNbrJoursEntreDeuxDates(aDateDebut,aDateFin)>=1){if(lParams.sansHoraire){lResult.push(this.FormatDate(aDateDebut,GTraductions.getValeur('Du')+' '+lParams.formatDate));lResult.push(' ');lResult.push(this.FormatDate(aDateFin,GTraductions.getValeur('Au')+' '+lParams.formatDate));} else{lResult.push(this.FormatDate(aDateDebut,GTraductions.getValeur('Du')+' '+lParams.formatDate)+' '+(estMinuit.call(this,aDateDebut)?'':GDate.FormatDate(aDateDebut,GTraductions.getValeur('A')+formatHeure)));lResult.push(' ');lResult.push(this.FormatDate(aDateFin,GTraductions.getValeur('Au')+' '+lParams.formatDate)+' '+(estMinuit.call(this,aDateFin)?'':GDate.FormatDate(aDateFin,GTraductions.getValeur('A')+formatHeure)));}} else if(aDateDebut-aDateFin===0){lResult.push(GDate.FormatDate(aDateDebut,'['+GTraductions.getValeur('Le')+' '+lParams.formatDate+']'));lResult.push(' ');lResult.push(lParams.sansHoraire?'':(estMinuit.call(this,aDateFin)?'':GDate.FormatDate(aDateFin,GTraductions.getValeur('A')+formatHeure)));} else{lResult.push(GDate.FormatDate(aDateDebut,'['+GTraductions.getValeur('Le')+' '+lParams.formatDate+']'));lResult.push(' ');lResult.push(lParams.sansHoraire?'':this.FormatDate(aDateDebut,GTraductions.getValeur('De')+formatHeure)+' '+GDate.FormatDate(aDateFin,GTraductions.getValeur('A')+formatHeure));}
return lResult.join('');}
strDatesAvecDemiJournees(aDateDebut,aDateDebutEstMatin,aDateFin,aDateFinEstMatin,aParams){const lParams={formatDate:'%JJ/%MM'};$.extend(lParams,aParams);const lResult=[];if(!aDateFin||GDate.estJourEgal(aDateDebut,aDateFin)){const lEstJourneeComplete=(!!aDateFin&&GDate.estJourEgal(aDateDebut,aDateFin)&&aDateDebutEstMatin!==aDateFinEstMatin);lResult.push(GDate.FormatDate(aDateDebut,'['+GTraductions.getValeur('Le')+' '+lParams.formatDate+']'));if(!lEstJourneeComplete){lResult.push(' ',(aDateDebutEstMatin?GTraductions.getValeur('Matin'):GTraductions.getValeur('ApresMidi')));}} else{lResult.push(this.FormatDate(aDateDebut,GTraductions.getValeur('Du')+' '+lParams.formatDate));if(!aDateDebutEstMatin){lResult.push(' ',GTraductions.getValeur('ApresMidi'));}
lResult.push(' ');lResult.push(this.FormatDate(aDateFin,GTraductions.getValeur('Au')+' '+lParams.formatDate));if(!!aDateFinEstMatin){lResult.push(' ',GTraductions.getValeur('Matin'));}}
return lResult.join('');}
PlaceAnnuelleEnDate(APlace,AEstDateFin){const LJour=this.GetJourSuivant(IE.Cycles.dateDebutPremierCycle(),Math.floor(APlace/this.PlacesParJour));const lHrMin=_getHrMinDeListeHeures.call(this,APlace%this.PlacesParJour,AEstDateFin);return new Date(LJour.getFullYear(),LJour.getMonth(),LJour.getDate(),lHrMin.h,lHrMin.m);}
DateEnPlaceAnnuelle(aDate,aEstDateFin){const lPlaceAnnuelleJour=this.getNbrJoursEntreDeuxDates(IE.Cycles.dateDebutPremierCycle(),aDate)*this.PlacesParJour;if(lPlaceAnnuelleJour<0){return 0;}
return lPlaceAnnuelleJour+_dateEnPlaceJour.call(this,aDate,aEstDateFin);}
PlaceParJourEnDate(APlace){const LJour=this.getDateCourante();const lHrMin=_getHrMinDeListeHeures.call(this,APlace);return new Date(LJour.getFullYear(),LJour.getMonth(),LJour.getDate(),lHrMin.h,lHrMin.m);}
DateEnPlaceHebdomadaire(ADate,AEstDateFin){const lParam={};let lJour=0;if(IE.Cycles.dateEnCycleEtJourCycle(ADate,null,lParam)){lJour=lParam.indice;} else if(IE.Cycles.dateEnCycleEtJourCycle(ADate,IE.Cycles.recherche.autoriserPrecedents,lParam)){return lParam.indice*this.PlacesParJour-1;}
return lJour*this.PlacesParJour+_dateEnPlaceJour.call(this,ADate,AEstDateFin);}
placeEnDate(aNumeroCycle,aPlace,aEstPlaceFin,aInstanceCycles){const lCycles=aInstanceCycles||IE.Cycles,lNumeroJour=Math.floor(aPlace/this.PlacesParJour),lNumeroCycle=Math.max(1,aNumeroCycle),LJour=lCycles.jourCycleEnDate(lNumeroJour,lNumeroCycle);let lPlaceJour=aPlace%this.PlacesParJour;if(lNumeroJour>lCycles.cache.datesAfficheesParCycle[lNumeroCycle].length){lPlaceJour=this.PlacesParJour-1;}
const lHrMin=_getHrMinDeListeHeures.call(this,lPlaceJour,aEstPlaceFin);return lHrMin&&lHrMin.ok?new Date(LJour.getFullYear(),LJour.getMonth(),LJour.getDate(),lHrMin.h,lHrMin.m):new Date(LJour.getFullYear(),LJour.getMonth(),LJour.getDate());}
placeEnDateHeure(aPlace,aEstPlaceFin){return this.placeEnDate(1,aPlace,aEstPlaceFin);}
nombrePlacesEnDuree(aPlaces){if(!MethodesObjet.isNumber(aPlaces)){return 0;}
return aPlaces*this.DureeSequence/this.PlacesParHeure;}
minutesEnNombrePlaces(aDureeEnMinutes){if(!MethodesObjet.isNumber(aDureeEnMinutes)){return 0;}
const lDuree1PlaceEnMinutes=TUtilitaireDuree.dureeEnMin(this.nombrePlacesEnDuree(1));const lResult=aDureeEnMinutes/lDuree1PlaceEnMinutes;if(lResult!==parseInt(lResult,10)){}
return lResult;}
nombrePlacesEnMillisecondes(aPlaces){return TUtilitaireDuree.dureeEnMs(this.nombrePlacesEnDuree(aPlaces));}
getDateDeChaine(aChaine,aDateDebut,aDateFin){aDateDebut=aDateDebut||this.PremierLundi;aDateFin=aDateFin||this.derniereDate;const T=aChaine.split('/');if(T[2]&&(T[2].length===2)){T[2]='20'+T[2];}
const lDate=new Date(T[2],T[1]-1,T[0]);const lEstValide=((lDate.getFullYear()===parseInt(T[2]))||(lDate.getFullYear()===parseInt('20'+T[2],10)))&&(lDate.getMonth()===Number(T[1]-1))&&(lDate.getDate()===parseInt(T[0]))&&(lDate>=aDateDebut)&&(lDate<=aDateFin)
;return lEstValide?lDate:null;}
getListeSemaines(aSemaineDebut,aSemaineFin,aGenreTri){let lLibelle,LDateDeb,LDateFin;const lSemaineCourante=IE.Cycles.cycleDeLaDate(new Date());const lListeSemaines=new ObjetListeElements();const lSemaineDeb=Math.max(0,aSemaineDebut);const lSemaineFin=Math.min(IE.Cycles.nombreCyclesAnneeScolaire(),aSemaineFin);for(let lSemaine=lSemaineDeb;lSemaine<=lSemaineFin;lSemaine++){if(lSemaine===lSemaineCourante){lLibelle=GTraductions.getValeur('SemaineEnCours');} else if(lSemaine===lSemaineCourante+1){lLibelle=GTraductions.getValeur('SemaineSuivante');} else if(lSemaine===lSemaineCourante-1){lLibelle=GTraductions.getValeur('SemainePrecedente');} else{LDateDeb=GDate.FormatDate(IE.Cycles.dateDebutCycle(lSemaine),'%JJ/%MM');LDateFin=GDate.FormatDate(IE.Cycles.dateDernierJourOuvreCycle(lSemaine),'%JJ/%MM');lLibelle=GTraductions.getValeur('Du')+' '+LDateDeb+' '+GTraductions.getValeur('Au')+' '+LDateFin;}
lListeSemaines.AddElement(new ObjetElement(lLibelle,null,lSemaine));}
lListeSemaines.setTri([ObjetTri.init('Genre')]);lListeSemaines.trier(aGenreTri);return lListeSemaines;}
getListeMoisAPartirDeDate(aDateDebut,aDateFin,aFormatMois='%MMMM %AAAA'){const lListeMois=new ObjetListeElements();let lElement,lAnnee,lMois,lDate,lVrai=true;const lPremiereDate=aDateDebut||this.premiereDate,lDerniereDate=aDateFin||this.derniereDate,lAnneeDebut=lPremiereDate.getFullYear(),lMoisDebut=lPremiereDate.getMonth(),lAnneeFin=lDerniereDate.getFullYear(),lMoisFin=lDerniereDate.getMonth();if(lPremiereDate.getTime()<=lDerniereDate.getTime()){lMois=lMoisDebut;lAnnee=lAnneeDebut;while(lVrai){if(lMois>=lMoisFin&&lAnnee>=lAnneeFin||lAnnee>lAnneeFin){lVrai=false;}
lDate=new Date(lAnnee,lMois);lElement=new ObjetElement(GDate.FormatDate(lDate,aFormatMois).ucfirst());lElement.annee=lAnnee;lElement.mois=lMois;lDate=this.GetPremierJourDuMois(lAnnee,lMois);lElement.dateDebut=lDate>=lPremiereDate?lDate:lPremiereDate;lDate=this.GetDernierJourDuMois(lAnnee,lMois);lElement.dateFin=lDate<=lDerniereDate?lDate:lDerniereDate;lListeMois.AddElement(lElement);lMois+=1;if(lMois>11){lAnnee+=1;lMois=0;}}}
return lListeMois;}
parseHeureMinute(aValue,aDureeMinEnMin,aDureeMaxEnMin){function _estUnChiffre(aCar){return/[0-9]/.test(aCar);}
const lResult={heure:0,minute:0,ok:false,erreurMinMax:false};const lDureeMinEnMin=aDureeMinEnMin||0,lDureeMaxEnMin=aDureeMaxEnMin||24*60;if(!MethodesObjet.isString(aValue)){return lResult;}
const lValue=aValue.trim();let lHeure,lMinute=0;let lIndice=0;let lZeroDevant=false;if(!_estUnChiffre(lValue[lIndice])&&lValue[lIndice]!=='+'){return lResult;}
if(lValue[lIndice]==='+'){lIndice+=1;while(lIndice<lValue.length&&lValue[lIndice]===' '){lIndice+=1;}}
lZeroDevant=lValue[lIndice]==='0';lHeure=0;while(lIndice<lValue.length&&_estUnChiffre(lValue[lIndice])){lHeure=lHeure*10+parseInt(lValue[lIndice],10);lIndice+=1;}
while(lIndice<lValue.length&&!_estUnChiffre(lValue[lIndice])){lIndice+=1;}
if(lIndice>=lValue.length){if(lZeroDevant||(lHeure>=100&&lHeure*60>=lDureeMaxEnMin)){lMinute=lHeure%100;lHeure=Math.floor(lHeure/100);} else{lMinute=0;}} else{lMinute=0;while(lIndice<lValue.length&&_estUnChiffre(lValue[lIndice])){lMinute=lMinute*10+parseInt(lValue[lIndice],10);lIndice+=1;}
while(lIndice<lValue.length&&!_estUnChiffre(lValue[lIndice])){lIndice+=1;}
if(lIndice<lValue.length){return lResult;}}
if(lMinute>=60||lMinute<0||lHeure<0){return lResult;}
lResult.heure=lHeure;lResult.minute=lMinute;if((lHeure*60+lMinute)<lDureeMinEnMin||(lHeure*60+lMinute)>=lDureeMaxEnMin){lResult.erreurMinMax=true;return lResult;}
lResult.ok=true;return lResult;}
DateEnPlaceJour(aDate){return _dateEnPlaceJour.call(this,aDate,false);}}
ObjetDate.separateurHeureDelphi='h';function estMinuit(aDate){const lHeure=aDate.getHours();const lMin=aDate.getMinutes();return(lHeure===0&&lMin===0);}
function _dateEnPlaceJour(ADate,AEstDateFin){let I;let lNbMinutesLibelleHeure;const lNbMinutesLibelleHeureDebut=_GetNbrMinutes_LibelleHeure.call(this,0);for(I=this.PlacesParJour-1;I>=0;I--){lNbMinutesLibelleHeure=_GetNbrMinutes_LibelleHeure.call(this,I);if(lNbMinutesLibelleHeure<lNbMinutesLibelleHeureDebut){lNbMinutesLibelleHeure+=24*60;}
if(_GetNbrMinutes.call(this,ADate)-(AEstDateFin?1:0)>=lNbMinutesLibelleHeure){break;}}
return Math.max(I,0);}
function _getHrMinDeListeHeures(aPlace,aEstPlaceFin){const lResult={h:0,m:0,ok:false};let lChaine=null;let lElement=null;if(aEstPlaceFin){lElement=this.ListeHeuresFin?this.ListeHeuresFin.GetElement(aPlace):this.ListeHeures.GetElement(aPlace+1);} else{lElement=this.ListeHeures.GetElement(aPlace);}
if(lElement){lChaine=lElement.GetLibelle();}
if(!lChaine||!lChaine.indexOf||!lChaine.split){return lResult;}
let lTab=lChaine.split(ObjetDate.separateurHeureDelphi);if(lTab.length<2){lTab=lChaine.split(':')
;if(lTab.length<2){return lResult;}}
;lResult.h=parseInt(lTab[0],0)||0;if(lTab.length>1){lResult.m=parseInt(lTab[1],0)||0;}
lResult.ok=true;return lResult;}
function _GetNbrMinutes(ADate){return ADate.getHours()*60+ADate.getMinutes();}
function _GetNbrMinutes_LibelleHeure(I){const lHrMin=_getHrMinDeListeHeures.call(this,I);return lHrMin.h*60+lHrMin.m;}
GDate=new ObjetDate();IEHtml.GDate=GDate;module.exports.ObjetDate=ObjetDate;module.exports.GDate=GDate;},fn:"objetdate.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const{GDate}=require('ObjetDate.js');const ObjetElement=require('ObjetElement.js');const ObjetListeElements=require('ObjetListeElements.js');const TypeDomaine=require('TypeDomaine.js');const TypeDroits={estEnConsultation:1,cours:{domaineConsultationEDT:1,avecReservationCreneauxLibres:1,modifierElevesDetachesSurCoursDeplaceCreneauLibre:1,modifierMatieres:1,modifierMatieresCoursEPIEtAP:1,modifierClasses:1,modifierProfesseurs:1,modifierSalles:1,modifierMateriels:1,creerCours:1,creerCoursPermanenceFeuilleAppel:1,deplacerCours:1,estSemaineModifiable:1,estGestionnaireSalle:1,estGestionnaireMateriel:1,avecMateriel:1,avecFicheCoursConseil:1,masquerPartiesDeClasse:1,afficherElevesDetachesDansCours:1},eleves:{voirTousLesEleves:1,consulterIdentiteEleve:1,consulterFichesResponsables:1,consulterPhotosEleves:1,avecSaisieParcoursPedagogique:1,avecAffectationElevesGroupesNonGAEV:1,avecAffectationElevesGroupesGAEV:1,avecSaisieProjetIndividuel:1,avecSaisieAttestations:1,consulterDonneesAdministrativesAutresEleves:1},communication:{toutesClasses:0,avecDiscussion:1,discussionInterdit:0,avecDiscussionPersonnels:1,avecDiscussionProfesseurs:1,avecDiscussionParents:1,avecDiscussionEleves:1,avecMessageInstantane:1,avecContactVS:1,lancerAlertesPPMS:1,estDestinataireChat:1,avecDiscussionAvancee:1,avecPublicationPageEtablissement:0},absences:{domaineRecapitulatifAbsences:1,avecSaisieAppelEtVS:1,avecSaisieAppel:1,avecSaisieCours:1,avecSaisieAbsenceOuverte:1,avecSaisieHorsCours:1,avecSaisieSurGrille:1,avecSaisieSurGrilleAppelProf:1,avecSaisieAbsence:1,avecSaisieRetard:1,avecSaisiePassageInfirmerie:1,avecSaisieExclusion:1,avecSaisiePunition:1,avecSaisieObservation:1,avecConsultationDefautCarnet:1,avecSaisieDefautCarnet:1,avecSaisieObservationsParents:1,avecSaisieEncouragements:1,avecAccesAuxEvenementsAutresCours:1,avecSaisieAbsencesToutesPermanences:1,listeDatesSaisieAbsence:1,avecAnciennesFeuilleDAppel:1,avecSaisieAbsencesGrilleAbsencesRepas:1,avecSaisieAbsencesGrilleAbsencesInternat:1,avecSuiviAbsenceRetard:1,avecSaisieMotifRetard:1,avecDeclarerUneAbsence:1},competence:{avecSaisieEvaluations:1,avecSaisieItems:1,avecValidationCompetences:1},agenda:{avecSaisieAgenda:1},actualite:{avecSaisieActualite:1},listeDiffusion:{avecPublication:1},casierNumerique:{avecSaisieDocumentsCasiers:1},dossierVS:{creerDossiersVS:1,modifierDossiersVS:1,saisieMotifsDossiersVS:1,publierDossiersVS:1,consulterMemosEleve:1,saisirMemos:1},dispenses:{saisie:1},incidents:{acces:1,uniquementMesIncidentsSignales:1,saisie:1,publier:1},punition:{avecPublicationPunitions:1,acces:1,saisie:1,avecRecapPunitions:1,avecRecapSanctions:1},creerMotifIncidentPunitionSanction:1,stage:{autoriserEditionToutesOffresStages:1},cahierDeTexte:{avecSaisieCahierDeTexte:1,creerCategoriesDeCahierDeTexte:1,avecSaisiePieceJointe:1,tailleMaxPieceJointe:1},notation:{avecSaisieDevoirs:1},compte:{avecSaisieIdentifiant:1,avecSaisieMotDePasse:1,avecSaisieMotDePasseEleve:1,avecInformationsPersonnelles:1,avecSaisieInfosPersoCoordonnees:1,avecSaisieInfosPersoAutorisations:1},intendance:{avecDemandeTravauxIntendance:1,uniquementMesTravauxIntendance:1,avecExecutionTravauxIntendance:1,avecGestionTravauxIntendance:1,avecDemandeTachesSecretariat:1,uniquementMesTachesSecretariat:1,avecExecutionTachesSecretariat:1,avecDemandeTachesInformatique:1,uniquementMesTachesInformatique:1,avecExecutionTachesInformatique:1,avecGestionTachesInformatique:1,avecDemandeCommandes:1,uniquementMesCommandes:1,avecExecutionCommandes:1,avecGestionCommandes:1},services:{avecCreationSousServices:1,avecModificationCoefGeneral:1},trombinoscope:{autoriseAConsulterPhotosDeTousLesEleves:1},forum:{avecCreationSujetForum:1,avecModificationForumAPosteriori:1},autoriserImpression:1,fonctionnalites:{gestionNotation:1,gestionBrevet:1,gestionProgrammesBO:1,gestionStages:1,gestionIPR:1,appelSaisirMotifJustifDAbsence:1,gestionTwitter:1,gestionBulletinClasse:1,gestionNathan:1,gestionPunitions:1,gestionInfirmerie:1,gestionPermanence:1,gestionAbsencesDemiPension:1,gestionAbsencesInternat:1,gestionEtendueEleves:1,gestionEleves:1,gestionPersonnels:1,forcerARInfos:1,gestionSondageAnonyme:1,gestionAbsenceDJParUtilisateur:1,attestationEtendue:1,afficherProjetsAccompagnement:1,saisieEtendueAbsenceDepuisAppel:1,importExportEducationNationale:1,gestionCDT:1,gestionPeriodeNotation:1,gestionARBulletins:1,avecTransformationFluxFichier:1},avecSaisieAppreciationsGenerales:1,assistantSaisieAppreciations:1,tailleMaxDocJointEtablissement:1,tailleMaxRenduTafEleve:1,avecDroitDeconnexionMessagerie:1,tailleMaxUpload:1};MethodesObjet.indenterEnumere(TypeDroits);class ObjetDroitsPN{constructor(){this.init();this.initDroitsSession();}
get(aGenreDroit){const lEstEnConsultation=GApplication.getModeExclusif();switch(aGenreDroit){case TypeDroits.estEnConsultation:return lEstEnConsultation;case TypeDroits.tailleMaxUpload:return 50*1024*1024;case TypeDroits.cours.domaineConsultationEDT:return this._droits.cours.domaineConsultationEDT;case TypeDroits.cours.avecReservationCreneauxLibres:return this._droits.cours.avecReservationCreneauxLibres&&!lEstEnConsultation;case TypeDroits.cours.modifierElevesDetachesSurCoursDeplaceCreneauLibre:return this._droits.cours.modifierElevesDetachesSurCoursDeplaceCreneauLibre&&!lEstEnConsultation;case TypeDroits.cours.modifierMatieres:return this._droits.cours.modifierMatieres&&!lEstEnConsultation;case TypeDroits.cours.modifierMatieresCoursEPIEtAP:return this._droits.cours.modifierMatieresCoursEPIEtAP&&!lEstEnConsultation;case TypeDroits.cours.modifierClasses:return this._droits.cours.modifierClasses&&!lEstEnConsultation;case TypeDroits.cours.modifierProfesseurs:return this._droits.cours.modifierProfesseurs&&!lEstEnConsultation;case TypeDroits.cours.modifierSalles:return this._droits.cours.modifierSalles&&!lEstEnConsultation;case TypeDroits.cours.modifierMateriels:return this._droits.cours.modifierMateriels&&!lEstEnConsultation;case TypeDroits.cours.deplacerCours:return this._droits.cours.deplacerCours&&!lEstEnConsultation;case TypeDroits.cours.creerCours:return this._droits.cours.creerCours&&!lEstEnConsultation;case TypeDroits.cours.creerCoursPermanenceFeuilleAppel:return this._droits.cours.creerCoursPermanenceFeuilleAppel&&!lEstEnConsultation;case TypeDroits.cours.estSemaineModifiable:if(lEstEnConsultation){return false;}
if(this._droits.cours.modificationNonLimiteAuxSemaine){return true;}
if(!this._droits.cours.domaineModificationCours){return false;}
return this._droits.cours.domaineModificationCours.GetValeur(arguments[1]);case TypeDroits.cours.estGestionnaireSalle:return this._droits.cours.estGestionnaireSalle&&!lEstEnConsultation;case TypeDroits.cours.estGestionnaireMateriel:return this._droits.cours.estGestionnaireMateriel&&!lEstEnConsultation;case TypeDroits.cours.avecMateriel:return this._droits.cours.avecMateriel;case TypeDroits.cours.avecFicheCoursConseil:return this._droits.cours.avecFicheCoursConseil;case TypeDroits.cours.masquerPartiesDeClasse:return this._droits.cours.masquerPartiesDeClasse;case TypeDroits.cours.afficherElevesDetachesDansCours:return this._droits.cours.afficherElevesDetachesDansCours;case TypeDroits.eleves.voirTousLesEleves:return this._droits.VoirTousLesEleves;case TypeDroits.eleves.consulterIdentiteEleve:return this._droits.ConsulterIdentiteEleve;case TypeDroits.eleves.consulterFichesResponsables:return this._droits.ConsulterFichesResponsables;case TypeDroits.eleves.consulterPhotosEleves:return this._droits.ConsulterPhotosEleves;case TypeDroits.eleves.avecSaisieParcoursPedagogique:return this._droits.avecSaisieParcoursPedagogique&&!lEstEnConsultation;case TypeDroits.eleves.avecAffectationElevesGroupesNonGAEV:return this._droits.AvecAffectationElevesGroupesNonGAEV&&!lEstEnConsultation;case TypeDroits.eleves.avecAffectationElevesGroupesGAEV:return this._droits.AvecAffectationElevesGroupesGAEV&&!lEstEnConsultation;case TypeDroits.eleves.avecSaisieProjetIndividuel:return this._droits.AvecSaisieProjetIndividuel&&!lEstEnConsultation;case TypeDroits.eleves.avecSaisieAttestations:return this._droits.AvecSaisieAttestations&&!lEstEnConsultation;case TypeDroits.eleves.consulterDonneesAdministrativesAutresEleves:return this._droits.consulterDonneesAdministrativesAutresEleves;case TypeDroits.communication.toutesClasses:return this._droits.AutoriserCommunicationsToutesClasses;case TypeDroits.communication.avecDiscussion:return this._droits.AvecDiscussion;case TypeDroits.communication.discussionInterdit:return this._droits.discussionInterdit;case TypeDroits.communication.avecDiscussionPersonnels:return this._droits.AvecDiscussionPersonnels;case TypeDroits.communication.avecDiscussionProfesseurs:return this._droits.AvecDiscussionProfesseurs;case TypeDroits.communication.avecDiscussionParents:return this._droits.AvecDiscussionParents;case TypeDroits.communication.avecDiscussionEleves:return this._droits.AvecDiscussionEleves;case TypeDroits.communication.avecMessageInstantane:return this._droits.avecMessageInstantane&&!lEstEnConsultation;case TypeDroits.communication.avecContactVS:return this._droits.AvecContactVS&&!lEstEnConsultation;case TypeDroits.communication.lancerAlertesPPMS:return this._droits.lancerAlertesPPMS&&!lEstEnConsultation;case TypeDroits.communication.estDestinataireChat:return this._droits.estDestinataireChat;case TypeDroits.communication.avecDiscussionAvancee:return this._droits.AvecDiscussionAvancee;case TypeDroits.absences.domaineRecapitulatifAbsences:return this._droits.DomaineRecapitulatifAbsences;case TypeDroits.absences.avecSaisieAppelEtVS:return this._droits.AvecSaisieAppelEtVS;case TypeDroits.absences.avecSaisieAppel:return this._droits.AvecSaisieAppel;case TypeDroits.absences.avecSaisieCours:return this._droits.AvecSaisieCours;case TypeDroits.absences.avecSaisieAbsenceOuverte:return this._droits.AvecSaisieAbsenceOuverte;case TypeDroits.absences.avecSaisieHorsCours:return this._droits.AvecSaisieHorsCours;case TypeDroits.absences.avecSaisieSurGrille:return this._droits.AvecSaisieSurGrille;case TypeDroits.absences.avecSaisieSurGrilleAppelProf:return this._droits.AvecSaisieSurGrilleAppelProf;case TypeDroits.absences.avecSaisieAbsence:return this._droits.AvecSaisieAbsence;case TypeDroits.absences.avecSaisieRetard:return this._droits.AvecSaisieRetard;case TypeDroits.absences.avecSaisiePassageInfirmerie:return this._droits.AvecSaisiePassageInfirmerie;case TypeDroits.absences.avecAnciennesFeuilleDAppel:return this._droits.avecAnciennesFeuilleDAppel;case TypeDroits.absences.avecSaisieExclusion:return this._droits.AvecSaisieExclusion;case TypeDroits.absences.avecSaisiePunition:return this._droits.AvecSaisiePunition;case TypeDroits.absences.avecSaisieObservation:return this._droits.AvecSaisieObservation;case TypeDroits.absences.avecConsultationDefautCarnet:return this._droits.AvecConsultationDefautCarnet;case TypeDroits.absences.avecSaisieDefautCarnet:return this._droits.AvecSaisieDefautCarnet;case TypeDroits.absences.avecSaisieObservationsParents:return this._droits.AvecSaisieObservationsParents;case TypeDroits.absences.avecSaisieEncouragements:return this._droits.AvecSaisieEncouragements;case TypeDroits.absences.avecAccesAuxEvenementsAutresCours:return this._droits.AvecAccesAuxEvenementsAutresCours;case TypeDroits.absences.avecSaisieAbsencesToutesPermanences:return this._droits.AvecSaisieAbsencesToutesPermanences;case TypeDroits.absences.listeDatesSaisieAbsence:return MethodesObjet.dupliquer(this._droits.listeDatesSaisieAbsence)||new ObjetListeElements();case TypeDroits.absences.avecSaisieAbsencesGrilleAbsencesRepas:return this._droits.AvecSaisieAbsencesGrilleAbsencesRepas;case TypeDroits.absences.avecSaisieAbsencesGrilleAbsencesInternat:return this._droits.AvecSaisieAbsencesGrilleAbsencesInternat;case TypeDroits.absences.avecSuiviAbsenceRetard:return this._droits.AvecSuiviAbsenceRetard;case TypeDroits.absences.avecSaisieMotifRetard:return this._droits.AvecSaisieMotifRetard;case TypeDroits.absences.avecDeclarerUneAbsence:return this._droits.AvecDeclarerUneAbsence;case TypeDroits.competence.avecSaisieEvaluations:return this._droits.AvecSaisieEvaluations&&!lEstEnConsultation;case TypeDroits.competence.avecSaisieItems:return this._droits.AvecSaisieItems&&!lEstEnConsultation;case TypeDroits.competence.avecValidationCompetences:return this._droits.AvecValidationCompetences&&!lEstEnConsultation;case TypeDroits.agenda.avecSaisieAgenda:return this._droits.AvecSaisieAgenda&&!lEstEnConsultation;case TypeDroits.actualite.avecSaisieActualite:return this._droits.AvecSaisieActualite&&!lEstEnConsultation;case TypeDroits.communication.avecPublicationPageEtablissement:return this._droits.avecPublicationPageEtablissement&&!lEstEnConsultation;case TypeDroits.listeDiffusion.avecPublication:return this._droits.avecPublicationListeDiffusion&&!lEstEnConsultation;case TypeDroits.casierNumerique.avecSaisieDocumentsCasiers:return this._droits.avecSaisieDocumentsCasiers&&!lEstEnConsultation;case TypeDroits.dossierVS.creerDossiersVS:return this._droits.CreerDossiersVS&&!lEstEnConsultation;case TypeDroits.dossierVS.modifierDossiersVS:return this._droits.ModifierDossiersVS&&!lEstEnConsultation;case TypeDroits.dossierVS.saisieMotifsDossiersVS:return this._droits.SaisieMotifsDossiersVS&&!lEstEnConsultation;case TypeDroits.dossierVS.publierDossiersVS:return this._droits.PublierDossiersVS&&!lEstEnConsultation;case TypeDroits.dossierVS.consulterMemosEleve:return this._droits.ConsulterMemosEleve;case TypeDroits.dossierVS.saisirMemos:return this._droits.SaisirMemos&&!lEstEnConsultation;case TypeDroits.dispenses.saisie:return this._droits.avecSaisieDispense&&!lEstEnConsultation;case TypeDroits.incidents.acces:return this._droits.incidents.acces;case TypeDroits.incidents.saisie:return this._droits.incidents.saisie&&!lEstEnConsultation;case TypeDroits.incidents.uniquementMesIncidentsSignales:return this._droits.incidents.uniquementMesIncidentsSignales;case TypeDroits.incidents.publier:return this._droits.incidents.publier&&!lEstEnConsultation;case TypeDroits.incidents:return{acces:this._droits.incidents.acces,uniquementMesIncidentsSignales:this._droits.incidents.uniquementMesIncidentsSignales,saisie:this._droits.incidents.saisie&&!lEstEnConsultation,publier:this._droits.incidents.publier&&!lEstEnConsultation};case TypeDroits.punition.avecPublicationPunitions:return this._droits.AvecPublicationPunitions;case TypeDroits.punition.acces:return this._droits.avecAccesPunitions;case TypeDroits.punition.saisie:return this._droits.avecSaisiePunitions&&!lEstEnConsultation;case TypeDroits.creerMotifIncidentPunitionSanction:return this._droits.avecCreerMotifIncidentPunitionSanction&&!lEstEnConsultation;case TypeDroits.punition.avecRecapPunitions:return this._droits.avecRecapPunitions;case TypeDroits.punition.avecRecapSanctions:return this._droits.avecRecapSanctions;case TypeDroits.punition:return{acces:this._droits.avecAccesPunitions,saisie:this._droits.avecSaisiePunitions&&!lEstEnConsultation,avecPublicationPunitions:this._droits.AvecPublicationPunitions&&!lEstEnConsultation,creerMotifIncidentPunitionSanction:this._droits.avecCreerMotifIncidentPunitionSanction&&!lEstEnConsultation};case TypeDroits.stage.autoriserEditionToutesOffresStages:return this._droits.autoriserEditionToutesOffresStages&&!lEstEnConsultation;case TypeDroits.cahierDeTexte.avecSaisieCahierDeTexte:return this._droits.avecSaisieCahierDeTexte&&!lEstEnConsultation;case TypeDroits.cahierDeTexte.creerCategoriesDeCahierDeTexte:return this._droits.creerCategoriesDeCahierDeTexte&&!lEstEnConsultation;case TypeDroits.cahierDeTexte.avecSaisiePieceJointe:return this._droits.avecSaisiePieceJointeCahierDeTexte&&!lEstEnConsultation;case TypeDroits.cahierDeTexte.tailleMaxPieceJointe:return Math.min(this._droits.tailleMaxPieceJointeCahierDeTexte,this.get(TypeDroits.tailleMaxUpload));case TypeDroits.notation.avecSaisieDevoirs:return this._droits.AvecSaisieDevoirs&&!lEstEnConsultation;case TypeDroits.compte.avecSaisieIdentifiant:return this._droits.compte.avecSaisieIdentifiant&&!lEstEnConsultation;case TypeDroits.compte.avecSaisieMotDePasse:return this._droits.compte.avecSaisieMotDePasse&&!lEstEnConsultation;case TypeDroits.compte.avecSaisieMotDePasseEleve:return this._droits.compte.avecSaisieMotDePasseEleve&&!lEstEnConsultation;case TypeDroits.compte.avecInformationsPersonnelles:return this._droits.compte.avecInformationsPersonnelles;case TypeDroits.compte.avecSaisieInfosPersoCoordonnees:return this._droits.compte.avecSaisieInfosPersoCoordonnees&&!lEstEnConsultation;case TypeDroits.compte.avecSaisieInfosPersoAutorisations:return this._droits.compte.avecSaisieInfosPersoAutorisations&&!lEstEnConsultation;case TypeDroits.intendance.avecDemandeTravauxIntendance:return this._droits.intendance.avecDemandeTravauxIntendance&&!lEstEnConsultation;case TypeDroits.intendance.uniquementMesTravauxIntendance:return this._droits.intendance.uniquementMesTravauxIntendance&&!lEstEnConsultation;case TypeDroits.intendance.avecExecutionTravauxIntendance:return this._droits.intendance.avecExecutionTravauxIntendance&&!lEstEnConsultation;case TypeDroits.intendance.avecGestionTravauxIntendance:return this._droits.intendance.avecGestionTravauxIntendance&&!lEstEnConsultation;case TypeDroits.intendance.avecDemandeTachesSecretariat:return this._droits.intendance.avecDemandeTachesSecretariat&&!lEstEnConsultation;case TypeDroits.intendance.uniquementMesTachesSecretariat:return this._droits.intendance.uniquementMesTachesSecretariat&&!lEstEnConsultation;case TypeDroits.intendance.avecExecutionTachesSecretariat:return this._droits.intendance.avecExecutionTachesSecretariat&&!lEstEnConsultation;case TypeDroits.intendance.avecDemandeTachesInformatique:return this._droits.intendance.avecDemandeTachesInformatique&&!lEstEnConsultation;case TypeDroits.intendance.uniquementMesTachesInformatique:return this._droits.intendance.uniquementMesTachesInformatique&&!lEstEnConsultation;case TypeDroits.intendance.avecExecutionTachesInformatique:return this._droits.intendance.avecExecutionTachesInformatique&&!lEstEnConsultation;case TypeDroits.intendance.avecGestionTachesInformatique:return this._droits.intendance.avecGestionTachesInformatique&&!lEstEnConsultation;case TypeDroits.intendance.avecDemandeCommandes:return this._droits.intendance.avecDemandeCommandes&&!lEstEnConsultation;case TypeDroits.intendance.uniquementMesCommandes:return this._droits.intendance.uniquementMesCommandes&&!lEstEnConsultation;case TypeDroits.intendance.avecExecutionCommandes:return this._droits.intendance.avecExecutionCommandes&&!lEstEnConsultation;case TypeDroits.intendance.avecGestionCommandes:return this._droits.intendance.avecGestionCommandes&&!lEstEnConsultation;case TypeDroits.services.avecCreationSousServices:return this._droits.services.avecCreationSousServices&&!lEstEnConsultation;case TypeDroits.services.avecModificationCoefGeneral:return this._droits.services.avecModificationCoefGeneral&&!lEstEnConsultation;case TypeDroits.trombinoscope.autoriseAConsulterPhotosDeTousLesEleves:return this._droits.autoriseAConsulterPhotosDeTousLesEleves;case TypeDroits.forum.avecCreationSujetForum:return this._droits.avecCreationSujetForum;case TypeDroits.forum.avecModificationForumAPosteriori:return this._droits.avecModificationForumAPosteriori;case TypeDroits.avecSaisieAppreciationsGenerales:return this._droits.avecSaisieAppreciationsGenerales&&!lEstEnConsultation;case TypeDroits.assistantSaisieAppreciations:return this._droits.AssistantSaisieAppreciations&&!lEstEnConsultation;case TypeDroits.tailleMaxDocJointEtablissement:return Math.min(this._droits.tailleMaxDocJointEtablissement,this.get(TypeDroits.tailleMaxUpload));case TypeDroits.tailleMaxRenduTafEleve:return Math.min(this._droits.tailleMaxRenduTafEleve,this.get(TypeDroits.tailleMaxUpload));case TypeDroits.autoriserImpression:return this._droits.autoriserImpression;case TypeDroits.avecDroitDeconnexionMessagerie:return this._droits.avecDroitDeconnexionMessagerie;case TypeDroits.fonctionnalites.gestionNotation:return this._droitsSession.fonctionnalites.gestionNotation;case TypeDroits.fonctionnalites.gestionBrevet:return this._droitsSession.fonctionnalites.gestionBrevet;case TypeDroits.fonctionnalites.gestionProgrammesBO:return this._droitsSession.fonctionnalites.gestionProgrammesBO;case TypeDroits.fonctionnalites.gestionStages:return this._droitsSession.fonctionnalites.gestionStages;case TypeDroits.fonctionnalites.gestionIPR:return this._droitsSession.fonctionnalites.gestionIPR;case TypeDroits.fonctionnalites.appelSaisirMotifJustifDAbsence:return this._droitsSession.fonctionnalites.appelSaisirMotifJustifDAbsence;case TypeDroits.fonctionnalites.saisieEtendueAbsenceDepuisAppel:return this._droitsSession.fonctionnalites.saisieEtendueAbsenceDepuisAppel;case TypeDroits.fonctionnalites.gestionTwitter:return this._droitsSession.fonctionnalites.gestionTwitter;case TypeDroits.fonctionnalites.gestionBulletinClasse:return this._droitsSession.fonctionnalites.gestionBulletinClasse;case TypeDroits.fonctionnalites.gestionNathan:return this._droitsSession.fonctionnalites.gestionNathan;case TypeDroits.fonctionnalites.gestionPunitions:return this._droitsSession.fonctionnalites.gestionPunitions;case TypeDroits.fonctionnalites.gestionCDT:return this._droitsSession.fonctionnalites.gestionCDT;case TypeDroits.fonctionnalites.gestionPeriodeNotation:return this._droitsSession.fonctionnalites.gestionPeriodeNotation;case TypeDroits.fonctionnalites.gestionInfirmerie:return this._droitsSession.fonctionnalites.gestionInfirmerie;case TypeDroits.fonctionnalites.gestionPermanence:return this._droitsSession.fonctionnalites.gestionPermanence;case TypeDroits.fonctionnalites.gestionAbsencesDemiPension:return this._droitsSession.fonctionnalites.gestionAbsencesDemiPension;case TypeDroits.fonctionnalites.gestionAbsencesInternat:return this._droitsSession.fonctionnalites.gestionAbsencesInternat;case TypeDroits.fonctionnalites.gestionEtendueEleves:return this._droitsSession.fonctionnalites.gestionEtendueEleves;case TypeDroits.fonctionnalites.gestionEleves:return this._droitsSession.fonctionnalites.gestionEleves;case TypeDroits.fonctionnalites.gestionPersonnels:return this._droitsSession.fonctionnalites.gestionPersonnels;case TypeDroits.fonctionnalites.forcerARInfos:return this._droitsSession.fonctionnalites.forcerARInfos;case TypeDroits.fonctionnalites.gestionSondageAnonyme:return this._droitsSession.fonctionnalites.gestionSondageAnonyme;case TypeDroits.fonctionnalites.gestionAbsenceDJParUtilisateur:return this._droitsSession.fonctionnalites.gestionAbsenceDJParUtilisateur;case TypeDroits.fonctionnalites.attestationEtendue:return this._droitsSession.fonctionnalites.attestationEtendue;case TypeDroits.fonctionnalites.afficherProjetsAccompagnement:return this._droitsSession.fonctionnalites.afficherProjetsAccompagnement;case TypeDroits.fonctionnalites.gestionARBulletins:return this._droitsSession.fonctionnalites.gestionARBulletins;case TypeDroits.fonctionnalites.importExportEducationNationale:return this._droitsSession.fonctionnalites.importExportEducationNationale;case TypeDroits.fonctionnalites.avecTransformationFluxFichier:return this._droitsSession.fonctionnalites.avecTransformationFluxFichier;default:;return false;}}
init(){this._droits={AssistantSaisieAppreciations:false,VoirTousLesEleves:false,ConsulterIdentiteEleve:false,ConsulterFichesResponsables:false,ConsulterPhotosEleves:false,avecSaisieParcoursPedagogique:false,AvecAffectationElevesGroupesNonGAEV:false,AvecAffectationElevesGroupesGAEV:false,AvecSaisieProjetIndividuel:false,AvecSaisieAttestations:false,consulterDonneesAdministrativesAutresEleves:true,AutoriserCommunicationsToutesClasses:false,AvecDiscussion:false,discussionInterdit:false,AvecDiscussionPersonnels:false,AvecDiscussionProfesseurs:false,AvecDiscussionParents:false,AvecDiscussionEleves:false,avecMessageInstantane:false,AvecContactVS:false,lancerAlertesPPMS:false,estDestinataireChat:false,AvecDiscussionAvancee:false,DomaineRecapitulatifAbsences:new TypeDomaine(),AvecSaisieAppelEtVS:false,AvecSaisieAppel:false,AvecSaisieCours:false,AvecSaisieAbsenceOuverte:false,AvecSaisieHorsCours:false,AvecSaisieSurGrille:false,AvecSaisieSurGrilleAppelProf:false,AvecSaisieAbsence:false,AvecSaisieRetard:false,AvecSaisiePassageInfirmerie:false,avecAnciennesFeuilleDAppel:false,AvecSaisieExclusion:false,AvecSaisiePunition:false,AvecSaisieObservation:false,AvecConsultationDefautCarnet:false,AvecSaisieDefautCarnet:false,AvecSaisieObservationsParents:false,AvecSaisieEncouragements:false,AvecAccesAuxEvenementsAutresCours:false,AvecSaisieAbsencesToutesPermanences:false,DateSaisieAbsence:null,AvecDeclarerUneAbsence:false,AvecSaisieAbsencesGrilleAbsencesRepas:false,AvecSaisieAbsencesGrilleAbsencesInternat:false,AvecSuiviAbsenceRetard:false,AvecSaisieEvaluations:false,AvecSaisieItems:false,AvecValidationCompetences:false,AvecSaisieAgenda:false,AvecSaisieActualite:false,avecPublicationPageEtablissement:false,avecPublicationListeDiffusion:false,avecSaisieDocumentsCasiers:false,CreerDossiersVS:false,ModifierDossiersVS:false,SaisieMotifsDossiersVS:false,PublierDossiersVS:false,ConsulterMemosEleve:false,SaisirMemos:false,avecSaisieDispense:false,incidents:{acces:false,saisie:false,publier:false},AvecPublicationPunitions:false,avecAccesPunitions:false,avecSaisiePunitions:false,avecRecapPunitions:false,avecRecapSanctions:false,avecCreerMotifIncidentPunitionSanction:false,avecSaisieAppreciationsGenerales:false,cours:{domaineConsultationEDT:new TypeDomaine(),avecReservationCreneauxLibres:false,modifierElevesDetachesSurCoursDeplaceCreneauLibre:false,modifierMatieres:false,modifierMatieresCoursEPIEtAP:false,modifierClasses:false,modifierProfesseurs:false,modifierSalles:false,modifierMateriels:false,creerCours:false,creerCoursPermanenceFeuilleAppel:false,deplacerCours:false,modificationNonLimiteAuxSemaine:false,domaineModificationCours:new TypeDomaine(),estGestionnaireSalle:false,estGestionnaireMateriel:false,avecMateriel:false,avecFicheCoursConseil:false,masquerPartiesDeClasse:false,afficherElevesDetachesDansCours:false},autoriserEditionToutesOffresStages:false,avecSaisieCahierDeTexte:false,creerCategoriesDeCahierDeTexte:false,avecSaisiePieceJointeCahierDeTexte:false,tailleMaxPieceJointeCahierDeTexte:0,AvecSaisieDevoirs:false,tailleMaxDocJointEtablissement:0,tailleMaxRenduTafEleve:0,compte:{avecSaisieIdentifiant:false,avecSaisieMotDePasse:false,avecSaisieMotDePasseEleve:false,avecInformationsPersonnelles:false,avecSaisieInfosPersoCoordonnees:false,avecSaisieInfosPersoAutorisations:false},intendance:{avecDemandeTravauxIntendance:false,uniquementMesTravauxIntendance:false,avecExecutionTravauxIntendance:false,avecGestionTravauxIntendance:false,avecDemandeTachesSecretariat:false,uniquementMesTachesSecretariat:false,avecExecutionTachesSecretariat:false,avecDemandeTachesInformatique:false,uniquementMesTachesInformatique:false,avecExecutionTachesInformatique:false,avecGestionTachesInformatique:false,avecDemandeCommandes:false,uniquementMesCommandes:false,avecExecutionCommandes:false,avecGestionCommandes:false},services:{avecCreationSousServices:false,avecModificationCoefGeneral:false},autoriseAConsulterPhotosDeTousLesEleves:false,avecCreationSujetForum:false,avecModificationForumAPosteriori:false,autoriserImpression:false,avecDroitDeconnexionMessagerie:false};}
initDroitsSession(){this._droitsSession={fonctionnalites:{gestionNotation:true,gestionBrevet:true,gestionProgrammesBO:true,gestionStages:true,gestionIPR:true,appelSaisirMotifJustifDAbsence:false,gestionTwitter:false,gestionBulletinClasse:true,gestionNathan:true,gestionPunitions:true,gestionInfirmerie:true,gestionPermanence:true,gestionAbsencesDemiPension:true,gestionAbsencesInternat:true,gestionEtendueEleves:true,gestionEleves:true,gestionPersonnels:true,forcerARInfos:false,gestionSondageAnonyme:true,gestionAbsenceDJParUtilisateur:false,attestationEtendue:true,afficherProjetsAccompagnement:true,saisieEtendueAbsenceDepuisAppel:false,importExportEducationNationale:true,gestionCDT:true,gestionPeriodeNotation:true,gestionARBulletins:false,avecTransformationFluxFichier:false}};}
chargerJSON(aJSON){if(aJSON&&aJSON.autorisationsSession){this.initDroitsSession();$.extend(true ,this._droitsSession,aJSON.autorisationsSession);}
if(aJSON&&aJSON.autorisations){this._autorisationsChargees=true;this.init();$.extend(true ,this._droits,aJSON.autorisations);this._droits.listeDatesSaisieAbsence=new ObjetListeElements();for(let I=0;this._droits.DateSaisieAbsence&&(I<this._droits.DateSaisieAbsence.length);I++){const lDate=new ObjetElement();lDate.Date=aJSON.autorisations.DateSaisieAbsence[I];lDate.Libelle=GDate.FormatDate(lDate.Date,'%JJJJ %JJ %MMM');this._droits.listeDatesSaisieAbsence.AddElement(lDate);}}}}
module.exports.ObjetDroitsPN=ObjetDroitsPN;module.exports.TypeDroits=TypeDroits;},fn:"objetdroitspn.js"});;
IE.fModule({f:function(exports,require,module,global){class Callback{constructor(aPere,aEvenement,aIdentifiant){this.pere=aPere;this.evenement=aEvenement;this.identifiant=aIdentifiant;}
appel(...aParams){return this.executerEvenement.apply(this,aParams);}
executerEvenement(...aParams){if(this.pere&&this.evenement){return this.evenement.apply(this.pere,aParams);}}}
module.exports=Callback;},fn:"callback.js"});;
IE.fModule({f:function(exports,require,module,global){require('divers.js');const Callback=require('Callback.js');const GLog=require('IELog.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const GTraductions=require('ObjetTraduction.js');const c_constantesJSON={noeudJSON:'D',Signature:'_Signature_',SignatureAttente:'_SignatureAttente_',Donnees:'donnees'};module.exports.c_constantesJSON=c_constantesJSON;const EGenreReponseSaisie={erreur:'reponseSaisie_erreur',annulation:'reponseSaisie_annulation',succes:'reponseSaisie_succes'};module.exports.EGenreReponseSaisie=EGenreReponseSaisie;module.exports.utils={getIdentNotification:function(aIdent){return'notificationsRequete_'+aIdent;}};Invocateur.abonner('deserialisation_notificationsPolling',function(aJSONRacine){const lJSON=aJSONRacine[c_constantesJSON.Signature];if(lJSON){if(lJSON.ModeExclusif!==undefined){Invocateur.evenement(ObjetInvocateur.events.modificationModeExclusif,lJSON.ModeExclusif);}
if(ObjetRequeteJSON.modules.deserialiserPolling){ObjetRequeteJSON.modules.deserialiserPolling(lJSON,aJSONRacine);}
Invocateur.evenement(ObjetInvocateur.events.refreshIEHtml);}});class ObjetRequeteJSON{constructor(aPere,aEvenementSurReussite,aEvenementSurEchec){this.setOptions();const lSelf=this;this.callbackReussite=new Callback(aPere,function(...aParams){if(aPere&&aPere.isDestroyed&&aPere.isDestroyed()){GLog.addLog('callbackReussite avec un pere detruit');return;}
const lResult=aEvenementSurReussite?aEvenementSurReussite.apply(this,aParams):null,lResultPromesse=_executionFonctionPromesse(lSelf.reussitePromesse,aParams);_refreshHTML(lSelf,aEvenementSurReussite);return aEvenementSurReussite?lResult:lResultPromesse;});if(!this.estUneSaisie){this.callbackEchec=new Callback(aPere,function(...aParams){if(aPere&&aPere.isDestroyed&&aPere.isDestroyed()){GLog.addLog('callbackEchec avec un pere detruit');return;}
const lResult=aEvenementSurEchec?aEvenementSurEchec.apply(this,aParams):null,lResultPromesse=_executionFonctionPromesse(lSelf.echecPromesse,aParams);_refreshHTML(lSelf,aEvenementSurReussite);return aEvenementSurEchec?lResult:lResultPromesse;});}
this.reussitePromesse=null;this.echecPromesse=null;this._jsonRacineParametres={};this.JSON={};if(ObjetRequeteJSON.modules.extend){Object.assign(this,ObjetRequeteJSON.modules.extend);}
if(ObjetRequeteJSON.modules.initialiser){ObjetRequeteJSON.modules.initialiser.call(this);}
if(ObjetRequeteJSON.modules.factoryModuleUploadCloud){this.moduleUploadCloud=ObjetRequeteJSON.modules.factoryModuleUploadCloud(this);}}
static declarerModules(aModules){ObjetRequeteJSON.modules=Object.assign({initialiser:null,deserialiserSignatureConsultation:null,deserialiserSignatureSaisie:null,factoryModuleUploadCloud:null,extend:null,deserialiserPolling:null},aModules);}
setOptions(aOptions){if(!this.options){this.options={avecRefreshHTML:true,avecControleModeExclusif:false,messageDetail:'',gererMessageErreur:null,sansBlocageInterface:false,titreEchecModeExclusif:GTraductions.getValeur('ModeExclusif.UsageExclusif'),messageEchecModeExclusif:GTraductions.getValeur('ModeExclusif.SaisieImpossibleConsultation')};}
$.extend(this.options,aOptions);return this;}
actionApresRequete(){}
_reponseRequete(aJSONRacine,aEnEchec){this._jsonRacine=aJSONRacine||{};this.JSONReponse={};this.JSONSignature={}
;if(this._jsonRacine[c_constantesJSON.Donnees]){this.JSONReponse=this._jsonRacine[c_constantesJSON.Donnees];}
if(this._jsonRacine[c_constantesJSON.Signature]){this.JSONSignature=this._jsonRacine[c_constantesJSON.Signature];}
this.traiterReponseRequete(aEnEchec);this.apresReponseRequete();}
apresReponseRequete(){}
serialiserJSON(){if(this._jsonRacineParametres){if(this.JSON&&!$.isEmptyObject(this.JSON)){this._jsonRacineParametres[c_constantesJSON.Donnees]=this.JSON;}}}
appelAsynchrone(aParams){if(this.options.avecControleModeExclusif&&GApplication.getModeExclusif()){const lPromiseMessage=GApplication.getMessage().afficher({titre:this.options.titreEchecModeExclusif,message:this.options.messageEchecModeExclusif});return Promise.reject({modeExclusif:true,promiseMessage:lPromiseMessage});}
if(!this._jsonRacineParametres){GLog.addLog("La requete n'a pas de json definit !",null,GLog.genre.Avertissement);}
if(this.moduleUploadCloud&&this.moduleUploadCloud.actif()){return this.moduleUploadCloud.lancer().then(function(){return _serialisationJSONEtEnvoieRequeteSaisie.call(this,aParams);}.bind(this));}
return _serialisationJSONEtEnvoieRequeteSaisie.call(this,aParams);}
lancerRequete(aParametres){Object.assign(this.JSON,aParametres);return this.appelAsynchrone();}
addUpload(aParams){this.paramsUpload=aParams;if(aParams&&aParams.listeDJCloud){if(this.moduleUploadCloud&&this.moduleUploadCloud.setListePJs){this.moduleUploadCloud.setListePJs(aParams.listeDJCloud);} else{}}
return this;}}
ObjetRequeteJSON.modules={};function _refreshHTML(aRequete,aEvenementSurReussite){if(aRequete.options.avecRefreshHTML){Invocateur.evenement(ObjetInvocateur.events.refreshIEHtml);if(!aEvenementSurReussite){setTimeout(function(){Invocateur.evenement(ObjetInvocateur.events.refreshIEHtml);},0);}}}
function _executionFonctionPromesse(aMethodes,aArguments){let lResult;if(aMethodes){if(aArguments.length===0){lResult=aMethodes();} else if(aArguments.length===1){lResult=aMethodes(aArguments[0]);} else{lResult=aMethodes(Array.prototype.slice.call(aArguments));}}
return lResult;}
function _serialisationJSONEtEnvoieRequeteSaisie(aParams){return new Promise(function(aResolve,aReject){this.reussitePromesse=aResolve;this.echecPromesse=aReject;this.serialiserJSON();const lParams={nom:this.nom,json:this._jsonRacineParametres,callbackPere:this,callbackEvenement:this._reponseRequete,numeroRequete:undefined,messageDetail:this.options.messageDetail,requetePrioritaire:this.options.requetePrioritaire,sansBlocageInterface:!!this.options.sansBlocageInterface,paramsUpload:this.paramsUpload};$.extend(lParams,aParams);this.paramsUpload=null;GApplication.getCommunication().appel_fonction_asynchrone_xml(lParams);}.bind(this));}
class ObjetRequeteSaisie extends ObjetRequeteJSON{constructor(...aParams){super(...aParams)
;this.setOptions({avecControleModeExclusif:true,messageDetail:GTraductions.getValeur('requete.validationEnCours'),titreEchecValidation:GTraductions.getValeur('requete.validationEchec'),titreAnnulationValidation:'',afficherMessageErreur:true});}
actionApresRequete(aXml,aGenreReponse){this.callbackReussite.appel({JSONRapportSaisie:this.JSONRapportSaisie,JSONReponse:this.JSONReponse,genreReponse:aGenreReponse,messageErreur:this.messageErreur,promiseMessage:this.promiseMessage});}
traiterReponseRequete(aEnEchec){this.actionApresRequete(null,this.traiterReponseSaisie(null,aEnEchec));}
deserialiserSignatureSaisie(){if(ObjetRequeteJSON.modules.deserialiserSignatureSaisie){ObjetRequeteJSON.modules.deserialiserSignatureSaisie.call(this);}}
_getMessageErreurSaisie(aMessagesErreurRapportSaisie,aReponse,aTitre){let lDetails='';if(aMessagesErreurRapportSaisie&&aMessagesErreurRapportSaisie.join){lDetails=aMessagesErreurRapportSaisie.join('\n');}
let lTitre=aTitre||'';if(!lTitre){switch(aReponse){case EGenreReponseSaisie.erreur:lTitre=this.options.titreEchecValidation||'';break;case EGenreReponseSaisie.annulation:lTitre=this.options.titreAnnulationValidation||'';break;}}
if(lTitre||lDetails){this.messageErreur={titre:lTitre,message:lDetails||''};}}
traiterReponseSaisieMessage(aMessagesErreurRapportSaisie,aReponse,aTitre){this._getMessageErreurSaisie(aMessagesErreurRapportSaisie,aReponse,aTitre);if(this.messageErreur&&this.options.afficherMessageErreur){this.promiseMessage=GApplication.getMessage().afficher(this.messageErreur);}}
traiterReponseSaisie(aXml,aEnEchec){let lReponse=aEnEchec?EGenreReponseSaisie.erreur:EGenreReponseSaisie.succes;if(!this.JSONRapportSaisie){this.JSONRapportSaisie=this._jsonRacine&&this._jsonRacine.RapportSaisie?this._jsonRacine.RapportSaisie:{};}
let lMessagesErreurRapportSaisie=!this.JSONRapportSaisie?null:this.JSONRapportSaisie._messagesErreur_?this.JSONRapportSaisie._messagesErreur_:this.JSONRapportSaisie._erreurSaisie_?[]:null;if(!lMessagesErreurRapportSaisie){lMessagesErreurRapportSaisie=this.JSONSignature&&this.JSONSignature.Erreur?this.JSONSignature.MessageErreur?[this.JSONSignature.MessageErreur]:[]:null;}
const lTitreErreur=!this.JSONRapportSaisie?null:this.JSONRapportSaisie.titre_Messages_Erreur||'';if(this.reponseEnErreur()){lReponse=EGenreReponseSaisie.erreur;} else if(lMessagesErreurRapportSaisie){lReponse=EGenreReponseSaisie.annulation;}
if(lMessagesErreurRapportSaisie){this.traiterReponseSaisieMessage(lMessagesErreurRapportSaisie,lReponse,lTitreErreur);}
this.deserialiserSignatureSaisie();if(!lMessagesErreurRapportSaisie&&this.options.avecControleModeExclusif&&GApplication.getModeExclusif()){lReponse=EGenreReponseSaisie.annulation;this.messageErreur={titre:this.options.titreEchecModeExclusif,message:this.options.messageEchecModeExclusif};if(this.options.afficherMessageErreur){this.promiseMessage=GApplication.getMessage().afficher(this.messageErreur);}}
return lReponse;}
reponseEnErreur(){return(this.JSONRapportSaisie&&this.JSONRapportSaisie._erreurSaisie_)||(this.JSONSignature&&this.JSONSignature.Erreur);}}
ObjetRequeteSaisie.prototype.estUneSaisie=true;class ObjetRequeteConsultation extends ObjetRequeteJSON{constructor(aPere,aEvenementSurReussite,aEvenementSurEchec){let lEvenementEchec=(aEvenementSurEchec===false?null:aEvenementSurEchec);super(aPere,aEvenementSurReussite,lEvenementEchec);this._evenementEchec=lEvenementEchec;this.setOptions({gererMessageErreur:function(aMessage){const lMessage=aMessage&&(aMessage.length>0)?aMessage:GTraductions.getValeur('requete.erreur');try{return GApplication.getMessage().afficher({message:lMessage});} catch(e){}}});}
traiterReponseRequete(){if(ObjetRequeteJSON.modules.deserialiserSignatureConsultation){ObjetRequeteJSON.modules.deserialiserSignatureConsultation.call(this);}
if(this.callbackEchec.evenement&&this.JSONSignature&&this.JSONSignature.Erreur){this.traiterReponseEchecConsultation();} else{this.actionApresRequete();}}
traiterReponseEchecConsultation(){const lMessage=this.JSONSignature&&this.JSONSignature.MessageErreur?this.JSONSignature.MessageErreur:'';GLog.addLog('Erreur de consultation controlé avec le message : '+lMessage,null,GLog.genre.Avertissement);let lParametresEchec=lMessage;if(!this._evenementEchec){if(this.options.gererMessageErreur){lParametresEchec={promiseMessage:this.options.gererMessageErreur(lMessage),message:lMessage};}}
if(this.callbackEchec.appel(lParametresEchec)){this.actionApresRequete();}}
actionApresRequete(){this.callbackReussite.appel(this.JSONReponse);}}
module.exports.ObjetRequeteJSON=ObjetRequeteJSON;module.exports.ObjetRequeteSaisie=ObjetRequeteSaisie;module.exports.ObjetRequeteConsultation=ObjetRequeteConsultation;},fn:"objetrequetejson.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteConsultation,ObjetRequeteSaisie}=require('ObjetRequeteJSON.js');const Requetes=(function(){const lCollectionRequetes={};let lRequetes;lRequetes=function(aIdentRequete,...aParams){let lClasseRequete;let lInstanceRequete;lClasseRequete=lCollectionRequetes[aIdentRequete];if(!lClasseRequete){return{lancerRequete:function(){}};}
lInstanceRequete=new lClasseRequete(...aParams);lInstanceRequete.nom=aIdentRequete;return lInstanceRequete;};lRequetes.inscrire=function(aIdentRequete,aClasse){if(!aIdentRequete){return this;}
if(!aClasse){return this;}
if(lCollectionRequetes[aIdentRequete]){if(lCollectionRequetes[aIdentRequete]!==aClasse){}
return this;}
if(!(aClasse===ObjetRequeteConsultation||aClasse===ObjetRequeteSaisie)){aClasse.prototype.nom=aIdentRequete;}
lCollectionRequetes[aIdentRequete]=aClasse;};lRequetes.collection=lCollectionRequetes;return lRequetes;}());module.exports=Requetes;},fn:"collectionrequetes.js"});;
IE.fModule({f:function(exports,require,module,global){const localStorage=(function(){let lLocalStorage=null;try{lLocalStorage=window.localStorage||(window.globalStorage?window.globalStorage[window.location.hostname]:null);if(lLocalStorage.setItem){lLocalStorage.setItem('_bidon_',1);lLocalStorage.removeItem('_bidon_');}} catch(e){lLocalStorage=null
;}
return{actif:!!lLocalStorage,getItem:function(aCle){if(lLocalStorage){try{return lLocalStorage.getItem?lLocalStorage.getItem(aCle):lLocalStorage[aCle];} catch(e){}}
return null;},getItemJSON:function(aCle){const lResult=this.getItem(aCle);let lJSON=null;try{lJSON=lResult?JSON.parse(lResult):null;} catch(e){lJSON=null;}
return lJSON;},setItem:function(aCle,aValeur){if(lLocalStorage){try{if(lLocalStorage.setItem){lLocalStorage.setItem(aCle,aValeur);} else{lLocalStorage[aCle]=aValeur;}} catch(e){}}},setItemJSON:function(aCle,aJSON){let lChaineJSON='';try{lChaineJSON=JSON.stringify(aJSON);} catch(e){}
this.setItem(aCle,lChaineJSON||'');},removeItem:function(aCle){if(lLocalStorage){try{if(lLocalStorage.removeItem){lLocalStorage.removeItem(aCle);} else{lLocalStorage[aCle]=null;}} catch(e){}}}};}());module.exports=localStorage;},fn:"localstorage.js"});;
IE.fModule({f:function(exports,require,module,global){const localStorage=require('localStorage.js');const c_marqueur='_idNavIndex_';module.exports={get:function(){try{return localStorage.getItem(c_marqueur);} catch(e){return'';}},set:function(aValue){try{localStorage.setItem(c_marqueur,aValue);} catch(e){}}};},fn:"utilitaireidentifiantnavigateur.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const Requetes=require('CollectionRequetes.js');const UtilitaireIdentifiantNavigateur=require('UtilitaireIdentifiantNavigateur.js');class ObjetRequeteFonctionParametres extends ObjetRequeteConsultation{constructor(...aParams){super(...aParams);}
lancerRequete(aObjet){this.JSON={Uuid:aObjet.uuidRSA,identifiantNav:UtilitaireIdentifiantNavigateur.get()};return this.appelAsynchrone();}
actionApresRequete(){if(this.JSONReponse.identifiantNav){UtilitaireIdentifiantNavigateur.set(this.JSONReponse.identifiantNav);}
this.callbackReussite.appel(this.JSONReponse);}}
Requetes.inscrire('FonctionParametres',ObjetRequeteFonctionParametres);module.exports=ObjetRequeteFonctionParametres;},fn:"objetrequetefonctionparametres.js"});;
IE.fModule({f:function(exports,require,module,global){const lModuleChaine=require('_ObjetChaine.js')
;const GChaine=new(lModuleChaine._ObjetChaine)();lModuleChaine.GChaine=GChaine;Object.assign(module.exports,{ObjetChaine_Mobile:lModuleChaine._ObjetChaine,GChaine:GChaine});},fn:"objetchaine_mobile.js"});;
IE.fModule({f:function(exports,require,module,global){if(IE.estMobile){module.exports=require('ObjetChaine_Mobile.js').GChaine;} else{module.exports=require('ObjetChaine_Espace.js').GChaine;}},fn:"gchaine.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const TypeDomaine=require('TypeDomaine.js');const TypeEnsembleNombre=require('TypeEnsembleNombre.js');const C_JourCycleHorsGrille= -1;const C_MaxJoursParSemaine=7;const C_MaxDomaineCycle=TypeDomaine.C_MaxDomaineCycle;const C_NbJoursCaches=C_MaxDomaineCycle*7+21;class ObjetCycles{constructor(){this.donneesCycles={premiereDate:null,derniereDate:null,dateDebutPremierCycle:null,joursOuvresParCycle:null,premierJourSemaine:2,joursOuvres:null,joursFeries:new TypeEnsembleNombre(),cyclesSansFeries:false,cyclesHebdomadaire:true};this.cache={datePremierJourOuvre:null,cycleEtIndiceParDate:[],datesAfficheesParCycle:[],bornesCycles:[],nombreCyclesAnneeScolaire:null,domaineFerie:null,indicesJoursOuvres:null};this.recherche=ObjetCycles.recherche;}
init(aParametres){$.extend(this.donneesCycles,aParametres);_calculer.bind(this)();return this;}
nombreJoursOuvresParCycle(){return this.donneesCycles.joursOuvresParCycle;}
dateDebutPremierCycle(){return new Date(this.cache.bornesCycles[1].DateDebut);}
dateFinDernierCycle(){return new Date(this.cache.bornesCycles[this.cache.nombreCyclesAnneeScolaire].DateFin);}
dateEnCycleEtJourCycle(aDate,aTypeRecherche,aParamOut){let LCycleEtIndice,LDate;LCycleEtIndice={cycle:-1,indice:C_JourCycleHorsGrille};try{LDate=aDate;if(LDate<this.dateDebutPremierCycle()){if(aTypeRecherche!==ObjetCycles.recherche.autoriserSuivants){return false;}
LDate=this.dateDebutPremierCycle();}
if(LDate>this.dateFinDernierCycle()){if(aTypeRecherche!==ObjetCycles.recherche.autoriserPrecedents){return false;}
LDate=this.dateFinDernierCycle();}
while(LCycleEtIndice.indice===C_JourCycleHorsGrille&&LDate>=this.dateDebutPremierCycle()&&LDate<=this.dateFinDernierCycle()){LCycleEtIndice=_CycleEtIndiceCycleDeDate.bind(this)(LDate);if(LCycleEtIndice.indice===C_JourCycleHorsGrille){switch(aTypeRecherche){case ObjetCycles.recherche.autoriserSuivants:LDate=_GDate().GetJourSuivant(LDate,1);break;case ObjetCycles.recherche.autoriserPrecedents:LDate=_GDate().GetJourSuivant(LDate,-1);break;default:return false;}}}} finally{aParamOut.cycle=LCycleEtIndice.cycle;aParamOut.indice=LCycleEtIndice.indice;}
return aParamOut.indice!==C_JourCycleHorsGrille;}
nombreCyclesAnneeScolaire(){return this.cache.nombreCyclesAnneeScolaire;}
cycleDeLaDate(aDate){const LDate=_getDateBornee.call(this,aDate),lObj=_CycleEtIndiceCycleDeDate.bind(this)(LDate)
;return lObj?lObj.cycle:0;}
dateEnJourCycle(aDate){const lTimeJour=new Date(aDate.getFullYear(),aDate.getMonth(),aDate.getDate()).getTime();if(!this._cacheDateEnJourCycle){this._cacheDateEnJourCycle={};}
if(!this._cacheDateEnJourCycle[lTimeJour]&&this._cacheDateEnJourCycle[lTimeJour]!==0){const lParam={};if(this.dateEnCycleEtJourCycle(aDate,ObjetCycles.recherche.autoriserPrecedents,lParam)){this._cacheDateEnJourCycle[lTimeJour]=lParam.indice;}}
const lJourCycle=this._cacheDateEnJourCycle[lTimeJour];return lJourCycle===undefined?0:lJourCycle;}
cycleCourant(){return this.cycleDeLaDate(new Date());}
dateDebutCycle(aCycle){const lDate=this.cache.bornesCycles[Math.borner(aCycle,1,this.nombreCyclesAnneeScolaire())].DateDebut;return MethodesObjet.isDate(lDate)?new Date(lDate):lDate;}
dateFinCycle(aCycle){const lDate=this.cache.bornesCycles[Math.borner(aCycle,1,this.nombreCyclesAnneeScolaire())].DateFin;return MethodesObjet.isDate(lDate)?new Date(lDate):lDate;}
datePremierJourOuvreCycle(aCycle){const lCycle=Math.borner(aCycle,1,this.nombreCyclesAnneeScolaire());let lIndice;let lResult=0;for(lIndice=0;lIndice<this.donneesCycles.joursOuvresParCycle;lIndice++){lResult=this.cache.datesAfficheesParCycle[lCycle][lIndice]||0;if(lResult>0){break;}}
return MethodesObjet.isDate(lResult)?new Date(lResult):lResult;}
dateDernierJourOuvreCycle(aCycle){const lCycle=Math.borner(aCycle,1,this.nombreCyclesAnneeScolaire());let lIndice=this.donneesCycles.joursOuvresParCycle;let lResult=0;while(lResult===0&&lIndice>=0){lResult=this.cache.datesAfficheesParCycle[lCycle][lIndice]||0;lIndice+= -1;}
return MethodesObjet.isDate(lResult)?new Date(lResult):lResult;}
jourCycleEnDate(AJourCycle,ACycle){if(ACycle<1){return this.dateDebutPremierCycle();}
if(ACycle>this.cache.nombreCyclesAnneeScolaire){return this.dateFinCycle(this.cache.nombreCyclesAnneeScolaire);}
if(AJourCycle<0){return this.dateDebutCycle(ACycle);}
if(!this.cache.datesAfficheesParCycle[ACycle]){return this.dateDebutPremierCycle();}
if(AJourCycle>=this.cache.datesAfficheesParCycle[ACycle].length){return this.dateFinCycle(ACycle);}
const lDate=this.cache.datesAfficheesParCycle[ACycle][AJourCycle];return MethodesObjet.isDate(lDate)?new Date(lDate):lDate;}
estDateFerie(aDate){if(this.donneesCycles.joursFeries){const lJourAnnuel=_GDate().getNbrJoursEntreDeuxDates(this.dateDebutPremierCycle(),aDate);return this.donneesCycles.joursFeries.contains(lJourAnnuel+1);}
return false;}
getDomaineFerie(){if(!this.cache.domaineFerie){this.cache.domaineFerie=new TypeDomaine();let lJourCycle,LSemaineFeriee,lNombreCycles=this.nombreCyclesAnneeScolaire(),lNombreJoursCycle=this.nombreJoursOuvresParCycle(),lDate;for(let lCycle=1;lCycle<=lNombreCycles;lCycle+=1){LSemaineFeriee=true;for(lJourCycle=0;lJourCycle<lNombreJoursCycle&&LSemaineFeriee;lJourCycle+=1){lDate=this.jourCycleEnDate(lJourCycle,lCycle);LSemaineFeriee=this.estDateFerie(lDate)||!_dateDansBorne.call(this,lDate);}
this.cache.domaineFerie.SetValeur(LSemaineFeriee,lCycle);}}
return this.cache.domaineFerie;}
cycleDansAnnee(aCycle){return Math.max(1,Math.min(this.nombreCyclesAnneeScolaire(),aCycle));}
indicesJoursOuvres(){if(!this.cache.indicesJoursOuvres){this.cache.indicesJoursOuvres=[];if(this.donneesCycles.cyclesHebdomadaire){for(let i=0;i<7;i++){if(this.donneesCycles.joursOuvres.contains(i)){let lJour=(i+this.donneesCycles.premierJourSemaine-2)%7;if(lJour<0){lJour=6;}
this.cache.indicesJoursOuvres.push(lJour);}}} else{for(let i=0;i<this.donneesCycles.joursOuvresParCycle;i++){this.cache.indicesJoursOuvres.push(i);}}}
return this.cache.indicesJoursOuvres;}}
let lDate=null;function _GDate(){if(!lDate){lDate=require('ObjetDate.js').GDate;}
return lDate;}
ObjetCycles.C_IndicePremierJourCycle=0;ObjetCycles.C_IndiceDernierJourCycle=Number.MAX_VALUE;ObjetCycles.C_IndiceDernierJourOuvreCycle=Number.MAX_VALUE-1;ObjetCycles.C_MaxDomaineCycle=C_MaxDomaineCycle;ObjetCycles.recherche={strict:0,autoriserSuivants:1,autoriserPrecedents:2};function _DateEnJourHebdo(ADate,APremierJourSemaine){let LPremierJour=APremierJourSemaine;if(LPremierJour>C_MaxJoursParSemaine){LPremierJour=LPremierJour-C_MaxJoursParSemaine;}
let LJourTt=ADate.getDay()+1;if(LJourTt>=LPremierJour){return LJourTt-LPremierJour;}
return LJourTt+C_MaxJoursParSemaine-LPremierJour;}
function _IncJourHebdo(aJourHebdo){return(aJourHebdo+1)%C_MaxJoursParSemaine;}
function _calculer(){let lDatesAIgnorer=new TypeEnsembleNombre(),lEnSemaine,lJourSemaine,iJour,iCycle,lIndiceCycle,lJourHebdo,LCycle,IDate,LIndiceJourAnnee,LPasToutRempli,lTab,i;this._cacheDateEnJourCycle=null;if(!this.donneesCycles.joursOuvres||
this.donneesCycles.joursOuvres.count()===0){return;}
if(this.donneesCycles.cyclesSansFeries&&this.donneesCycles.joursFeries){lTab=this.donneesCycles.joursFeries.items();for(i in lTab){lDatesAIgnorer.add(_GDate().GetJourSuivant(this.donneesCycles.dateDebutPremierCycle,lTab[i]-1).getTime());}}
this.cache.datePremierJourOuvre=this.donneesCycles.premiereDate;lEnSemaine=lDatesAIgnorer.count()===0&&(this.donneesCycles.joursOuvresParCycle%this.donneesCycles.joursOuvres.count()===0);if(lEnSemaine){lJourSemaine=this.cache.datePremierJourOuvre.getDay()+1;while(lJourSemaine!==this.donneesCycles.premierJourSemaine){this.cache.datePremierJourOuvre=_GDate().GetJourSuivant(this.cache.datePremierJourOuvre,-1);lJourSemaine=this.cache.datePremierJourOuvre.getDay()+1;}}
for(iJour=0;iJour<=C_NbJoursCaches;iJour++){this.cache.cycleEtIndiceParDate[iJour]={cycle:1,indice:C_JourCycleHorsGrille};}
for(iCycle=0;iCycle<=ObjetCycles.C_MaxDomaineCycle;iCycle+=1){this.cache.datesAfficheesParCycle[iCycle]=[];this.cache.bornesCycles[iCycle]={DateDebut:new Date(0),DateFin:new Date(0)};}
this.cache.bornesCycles[1].DateDebut=this.cache.datePremierJourOuvre;lIndiceCycle= -1;lJourHebdo=_DateEnJourHebdo(this.cache.datePremierJourOuvre,this.donneesCycles.premierJourSemaine)-1;LCycle=0;let lIncDate=0;this.cache.nombreCyclesAnneeScolaire=0;LIndiceJourAnnee=0;LPasToutRempli=true;while(LPasToutRempli){IDate=_GDate().GetJourSuivant(this.cache.datePremierJourOuvre,lIncDate);lIncDate++;lJourHebdo=_IncJourHebdo(lJourHebdo);if(lDatesAIgnorer.contains(IDate.getTime())||((!lEnSemaine)&&(IDate.getTime()<this.donneesCycles.premiereDate.getTime()))||!(this.donneesCycles.joursOuvres.contains(lJourHebdo))){if(LIndiceJourAnnee<=C_NbJoursCaches){this.cache.cycleEtIndiceParDate[LIndiceJourAnnee]={cycle:Math.max(1,LCycle),indice:C_JourCycleHorsGrille};}} else{lIndiceCycle=(lIndiceCycle+1)%this.donneesCycles.joursOuvresParCycle;if(lIndiceCycle===0){LCycle+=1;}
if(LIndiceJourAnnee<=C_NbJoursCaches){this.cache.cycleEtIndiceParDate[LIndiceJourAnnee]={cycle:LCycle,indice:lIndiceCycle};}
if(LCycle<=ObjetCycles.C_MaxDomaineCycle){this.cache.datesAfficheesParCycle[LCycle][lIndiceCycle]=IDate;}
if((lIndiceCycle===0)&&(LCycle>1)){if(LCycle<=ObjetCycles.C_MaxDomaineCycle){this.cache.bornesCycles[LCycle].DateDebut=new Date(IDate.getTime());}
if(LCycle-1<=ObjetCycles.C_MaxDomaineCycle){this.cache.bornesCycles[LCycle-1].DateFin=_GDate().GetJourSuivant(IDate,-1);}}}
if(_GDate().estJourEgal(IDate,this.donneesCycles.derniereDate)){this.cache.nombreCyclesAnneeScolaire=LCycle;}
LIndiceJourAnnee+=1;LPasToutRempli=(LCycle<=ObjetCycles.C_MaxDomaineCycle)||(LIndiceJourAnnee<=C_NbJoursCaches);}}
function _CycleEtIndiceCycleDeDate(aDate){const lDate=_GDate().GetJour(aDate);const LDateRef=this.cache.bornesCycles[1].DateDebut;let lResult={cycle:-1,indice:C_JourCycleHorsGrille};if((lDate.getTime()>=LDateRef.getTime())&&(lDate.getTime()<=this.cache.bornesCycles[this.cache.nombreCyclesAnneeScolaire].DateFin)){lResult=this.cache.cycleEtIndiceParDate[ _GDate().getNbrJoursEntreDeuxDates(LDateRef,lDate) ];}
return lResult;}
function _getDateBornee(aDate){if(aDate<this.donneesCycles.premiereDate){return new Date(this.donneesCycles.premiereDate.getTime());}
if(aDate>this.donneesCycles.derniereDate){return new Date(this.donneesCycles.derniereDate.getTime());} else{return aDate;}}
function _dateDansBorne(aDate){return(aDate>=this.donneesCycles.premiereDate||_GDate().estJourEgal(aDate,this.donneesCycles.premiereDate))&&(aDate<=this.donneesCycles.derniereDate||_GDate().estJourEgal(aDate,this.donneesCycles.derniereDate));}
module.exports=ObjetCycles;},fn:"objetcycles.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeThemeCouleur={Personnalise:0,Framboise:1,Fraise:2,Citrouille:3,Mandarine:4,Mure:5,Lavande:6,Prune:7,Bleu:8,BleuOcean:9,BleuCanard:10,Emeraude:11,Feuille:12,Taupe:13,Chocolat:14,Gris:15};module.exports.TypeThemeCouleur=TypeThemeCouleur;TypeThemeCouleur.MobilePN=1000;TypeThemeCouleur.MobileHP=1001;TypeThemeCouleur.MobileEDT=1002;const lCouleurThemes={neutre:{light:'#F8F8F8',legere:'#F6F6F6',legere2:'#EDEDED',claire:'#E2E2E2',moyen1:'#D9DBDC',moyen2:'#C5C5C5',foncee:'#6B6E77',sombre:'#4B4B4B'},1:{nom:'Framboise',genre:1,claire:'#EDD5DB',moyen1:'#F8C2CD',foncee:'#B9335F',sombre:'#911C42'},2:{nom:'Fraise',genre:2,claire:'#F1D7D9',moyen1:'#FFB5B9',foncee:'#C23B44',sombre:'#972028'},3:{nom:'Citrouille',genre:3,claire:'#EED7CC',moyen1:'#FAB99D',foncee:'#D05722',sombre:'#AC4011'},4:{nom:'Mandarine',genre:4,claire:'#F1DBBD',moyen1:'#FFCA80',foncee:'#E18400',sombre:'#B96103'},5:{nom:'Mure',genre:5,claire:'#EAD7E3',moyen1:'#E4C1D8',foncee:'#9D447F',sombre:'#6B174E'},6:{nom:'Lavande',genre:6,claire:'#E9DFEE',moyen1:'#DCC5F7',foncee:'#8855A3',sombre:'#6A3288'},7:{nom:'Prune',genre:7,claire:'#DCD9ED',moyen1:'#C8BAF6',foncee:'#705CB1',sombre:'#49358C'},8:{nom:'Bleu',genre:8,claire:'#DAE5F2',moyen1:'#B5D6F9',foncee:'#3273B5',sombre:'#114B88'},9:{nom:'BleuOcean',genre:9,claire:'#DAE5F2',moyen1:'#AAE0F0',foncee:'#0281A6',sombre:'#045F79'},10:{nom:'BleuCanard',genre:10,claire:'#D4E9E9',moyen1:'#9EDEDC',foncee:'#158786',sombre:'#096665'},11:{nom:'Emeraude',genre:11,claire:'#D1E9DA',moyen1:'#A1E5C6',foncee:'#0A9B6A',sombre:'#057C54'},12:{nom:'Feuille',genre:12,claire:'#DBE4C8',moyen1:'#CDE893',foncee:'#699A00',sombre:'#547A04'},13:{nom:'Taupe',genre:13,claire:'#E4DADD',moyen1:'#CCBEC2',foncee:'#877379',sombre:'#6F5960'},14:{nom:'Chocolat',genre:14,claire:'#E2DCCD',moyen1:'#DECB95',foncee:'#937A33',sombre:'#7A6321'}};module.exports.couleurThemes=lCouleurThemes;module.exports.couleurNonEditable='#EFEFEF';TypeThemeCouleur.Pronote=1006;Object.assign(TypeThemeCouleur,{ProduitPN:1003,ProduitEDT:1004,ProduitHP:1005,Pronote:1006});TypeThemeCouleur.estThemePrincipal=function(aTheme){return aTheme!==TypeThemeCouleur.MobilePN&&aTheme!==TypeThemeCouleur.MobileHP&&aTheme!==TypeThemeCouleur.MobileEDT&&aTheme!==TypeThemeCouleur.ProduitPN&&aTheme!==TypeThemeCouleur.ProduitEDT&&aTheme!==TypeThemeCouleur.ProduitHP&&aTheme!==TypeThemeCouleur.Pronote;};lCouleurThemes[TypeThemeCouleur.Pronote]={nom:'Pronote',genre:TypeThemeCouleur.Pronote,claire:'#caefe1',moyen1:'#008655',foncee:'#00643c',sombre:'#003e25'};lCouleurThemes[TypeThemeCouleur.MobilePN]={nom:'MobilePN',genre:TypeThemeCouleur.MobilePN,claire:'#caefe1',moyen1:'#65b782',foncee:'#00643c',sombre:'#00462a'};lCouleurThemes[TypeThemeCouleur.MobileEDT]={nom:'MobileEDT',genre:TypeThemeCouleur.MobileEDT,claire:'#C7E7FC',moyen1:'#0E78D5',foncee:'#004b7b',sombre:'#003354'};lCouleurThemes[TypeThemeCouleur.MobileHP]={nom:'MobileHP',genre:TypeThemeCouleur.MobileHP,claire:'#F4C5DD',moyen1:'#C03079',foncee:'#800041',sombre:'#60183D'};Object.assign(lCouleurThemes,{[TypeThemeCouleur.ProduitPN]:{nom:'ProduitPN',genre:TypeThemeCouleur.ProduitPN,claire:'#c2e3d6',moyen1:'#73cba8',foncee:'#339970',sombre:'#1e7751'},[TypeThemeCouleur.ProduitEDT]:{nom:'ProduitEDT',genre:TypeThemeCouleur.ProduitEDT,claire:'#acdde8',moyen1:'#63bbce',foncee:'#008caa',sombre:'#126b7f'},[TypeThemeCouleur.ProduitHP]:{nom:'ProduitHP',genre:TypeThemeCouleur.ProduitHP,cclaire:'#edd5d8',moyen1:'#f8c2cd',foncee:'#b9335f',sombre:'#932c54'}});},fn:"typethemecouleur.js"});;
IE.fModule({f:function(exports,require,module,global){const ObjetTheme=require('TypeThemeCouleur.js');const ObjetListeElements=require('ObjetListeElements.js');const ObjetElement=require('ObjetElement.js');const MethodesObjet=require('MethodesObjet.js');const GTraductions=require('ObjetTraduction.js');const{Invocateur}=require('Invocateur.js');const TypeThemeCouleur=require('TypeThemeCouleur.js').TypeThemeCouleur;class ObjetThemesCouleurs{constructor(){this.themeNeutre=_themeToArray(ObjetTheme.couleurThemes.neutre);this.nonEditable=ObjetTheme.couleurNonEditable;this.listeThemes=new ObjetListeElements();Object.keys(ObjetTheme.TypeThemeCouleur).forEach(function(aKey){const lTheme=ObjetTheme.couleurThemes[ObjetTheme.TypeThemeCouleur[aKey]];if(lTheme){const lElement=new ObjetElement(!TypeThemeCouleur.estThemePrincipal(lTheme.genre)?'':GTraductions.getValeur('theme.'+lTheme.genre),null,lTheme.genre);lElement.nom=lTheme.nom;lElement.themeCouleur=_themeToArray(lTheme);this.listeThemes.AddElement(lElement);}}.bind(this));this.setTheme(null,true);this.elementZoneFenetre=null;Invocateur.abonner('creationZoneFenetre',function(aElement){this.elementZoneFenetre=aElement;$(this.elementZoneFenetre).addClass(_getClassThemeCourant.call(this));}.bind(this));}
getThemeNeutre(){return Object.assign({},ObjetTheme.couleurThemes.neutre);}
getThemeCouleur(){return{claire:'var(--theme-claire)',moyen1:'var(--theme-moyen1)',foncee:'var(--theme-foncee)',sombre:'var(--theme-sombre)'};}
getTheme(){return this.themeNeutre;}
getCouleurDuTheme(aCouleurDeTheme,aAvecCouleur,aGenreThemeCouleur){let lGenre=aGenreThemeCouleur;if(!aGenreThemeCouleur&&aGenreThemeCouleur!==0){lGenre=this.genreTheme;}
const lTheme=this.listeThemes&&lGenre>=0?this.listeThemes.GetElementParGenre(lGenre):null;const lThemeCouleur=lTheme?lTheme.themeCouleur:this.themeNeutre;const lJeuDeCouleurs=aAvecCouleur&&lThemeCouleur?lThemeCouleur:this.themeNeutre;return lJeuDeCouleurs[aCouleurDeTheme];}
setTheme(aGenreTheme,aModeAccessible){this.genreTheme=aGenreTheme;this.avecCouleur=!aModeAccessible;if(document.body&&global.GApplication){const lThemeCourant=_getClassThemeCourant.call(this);const lTabRemove=['ThemeNeutre'];this.listeThemes.parcourir(function(aElement){lTabRemove.push('Theme'+aElement.nom);});if(this.avecCouleur){$(document.body).removeClass('ThemeAccessible');} else{$(document.body).addClass('ThemeAccessible');}
$('#'+GApplication.getIdConteneur().escapeJQ()).removeClass(lTabRemove.join(' ')).addClass(lThemeCourant);if(this.elementZoneFenetre){$(this.elementZoneFenetre).removeClass(lTabRemove.join(' ')).addClass(lThemeCourant);}}}
getClassThemeCourant(){return _getClassThemeCourant.call(this);}}
function _themeToArray(aTheme){if(!aTheme){return[];}
return[
aTheme.light||'',aTheme.legere||'',aTheme.legere2||'',aTheme.claire||'',aTheme.moyen1||'',aTheme.moyen2||'',aTheme.foncee||'',aTheme.sombre||''
];}
function _getClassThemeCourant(){if(this.avecCouleur){const lElementTheme=this.listeThemes.GetElementParGenre(this.genreTheme);if(lElementTheme&&this.genreTheme>=0&&MethodesObjet.isNumber(this.genreTheme)){return'Theme'+lElementTheme.nom;} else{return'ThemeNeutre';}}
return'ThemeNeutre';}
module.exports.GThemesCouleurs=new ObjetThemesCouleurs();},fn:"themescouleurs.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreDomaineFrequence={H:0,QZ1:1,QZ2:2};EGenreDomaineFrequence.getCouleur=function(aGenre){switch(aGenre){case EGenreDomaineFrequence.H:return'white';case EGenreDomaineFrequence.QZ1:return GCouleur.fenetre.cumul;case EGenreDomaineFrequence.QZ2:return GCouleur.fenetre.intermediaire;}
return'white';};module.exports=EGenreDomaineFrequence;},fn:"enumere_domainefrequence.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreEspace={Commun:0,Professeur:1,Parent:2,Eleve:3,Entreprise:4,Academie:5,Mobile_Eleve:6,Mobile_Parent:7,Mobile_Professeur:8,Mobile_Commun:9,Etablissement:13,Mobile_Etablissement:14,Gestion_SSO:15,Administrateur:16,Mobile_Administrateur:17,Inscription:18,PrimProfesseur:19,PrimParent:20,Mobile_PrimProfesseur:21,Mobile_PrimParent:22,PrimEleve:23,Mobile_PrimEleve:24,Accompagnant:25,Mobile_Accompagnant:26,PrimAccompagnant:27,Mobile_PrimAccompagnant:28,Tuteur:29,Mobile_Tuteur:30,PrimPeriscolaire:31,Mobile_PrimPeriscolaire:32,PagePubliqueEtablissement:33,Mobile_PagePubliqueEtablissement:34};module.exports=EGenreEspace;},fn:"enumere_espace.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesTableau=require('MethodesTableau.js');const EGenrePeriodeDeNotation={Trimestre1:0,Trimestre2:1,Trimestre3:2,Semestre1:3,Semestre2:4,Annuelle:5,Utilisateur:6};EGenrePeriodeDeNotation.estTrimestrielle=function(aGenrePeriodeDeNotation){return MethodesTableau.existe(aGenrePeriodeDeNotation,[this.Trimestre1,this.Trimestre2,this.Trimestre3]);};EGenrePeriodeDeNotation.estSemestrielle=function(aGenrePeriodeDeNotation){return MethodesTableau.existe(aGenrePeriodeDeNotation,[this.Semestre1,this.Semestre2]);};EGenrePeriodeDeNotation.estAnnuelle=function(aGenrePeriodeDeNotation){return MethodesTableau.existe(aGenrePeriodeDeNotation,[this.Annuelle]);};EGenrePeriodeDeNotation.estOfficielle=function(aGenrePeriodeDeNotation){return this.estTrimestrielle(aGenrePeriodeDeNotation)||this.estSemestrielle(aGenrePeriodeDeNotation)||this.estAnnuelle(aGenrePeriodeDeNotation);};module.exports=EGenrePeriodeDeNotation;},fn:"enumere_periodedenotation.js"});;
IE.fModule({f:function(exports,require,module,global){const UtilitaireCouleur={hslDelphiMax:240,CouleurToRGB:function(aHex){if(!aHex||!aHex.substr||aHex[0]!=='#'||(aHex.length!==4&&aHex.length<7)){return{r:0,g:0,b:0};}
if(aHex.length===4){const lRGBHex={r:aHex.substr(1,1),g:aHex.substr(2,1),b:aHex.substr(3,1)};return{r:parseInt(lRGBHex.r+lRGBHex.r,16),g:parseInt(lRGBHex.g+lRGBHex.g,16),b:parseInt(lRGBHex.b+lRGBHex.b,16)};}
return{r:parseInt(aHex.substr(1,2),16),g:parseInt(aHex.substr(3,2),16),b:parseInt(aHex.substr(5,2),16)};},CouleurToHSV:function(hex){return this.RGBToHSV(this.CouleurToRGB(hex));},RGBToCouleur:function(aRGB){const hex=[
parseInt(aRGB.r).toString(16),parseInt(aRGB.g).toString(16),parseInt(aRGB.b).toString(16)
];$.each(hex,function(nr,val){if(val.length===1){hex[nr]='0'+val;}});return'#'+hex.join('');},RGBToHSV:function(rgb){let rr,gg,bb;const r=rgb.r/255,g=rgb.g/255,b=rgb.b/255;let h,s;const v=Math.max(r,g,b),diff=v-Math.min(r,g,b),diffc=function(c){return(v-c)/6/diff+1/2;};if(diff===0){h=s=0;} else{s=diff/v;rr=diffc(r);gg=diffc(g);bb=diffc(b);if(r===v){h=bb-gg;} else if(g===v){h=(1/3)+rr-bb;} else if(b===v){h=(2/3)+gg-rr;}
if(h<0){h+=1;} else if(h>1){h-=1;}}
return{h:Math.round(h*360),s:Math.round(s*100),l:Math.round(v*100)};},HSVToCouleur:function(hsl){return this.RGBToCouleur(this.HSVToRGB(hsl));},HSVToRGB:function(hsl){const rgb={};let h=Math.round(hsl.h);const s=Math.round(hsl.s*255/100);const v=Math.round(hsl.l*255/100);if(s===0){rgb.r=rgb.g=rgb.b=v;} else{const t1=v;const t2=(255-s)*v/255;const t3=(t1-t2)*(h%60)/60;if(h===360){h=0;}
if(h<60){rgb.r=t1;rgb.b=t2;rgb.g=t2+t3;} else if(h<120){rgb.g=t1;rgb.b=t2;rgb.r=t1-t3;} else if(h<180){rgb.g=t1;rgb.r=t2;rgb.b=t2+t3;} else if(h<240){rgb.b=t1;rgb.r=t2;rgb.g=t1-t3;} else if(h<300){rgb.b=t1;rgb.g=t2;rgb.r=t2+t3;} else if(h<360){rgb.r=t1;rgb.g=t2;rgb.b=t1-t3;} else{rgb.r=0;rgb.g=0;rgb.b=0;}}
return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)};},HSVToHSLDelphi:function(hsv){const lLuminance=(200-hsv.s)*hsv.l/200,lHSL={h:hsv.h*this.hslDelphiMax/360,s:0,l:lLuminance*this.hslDelphiMax/100};lHSL.s=(hsv.l>0?hsv.s*hsv.l/(lLuminance<50?lLuminance*2:200-lLuminance*2):hsv.s)*this.hslDelphiMax/100;if(isNaN(lHSL.s)){lHSL.s=0;}
return lHSL;},HSLDelphiToHSV:function(hsl){const lHSV={h:hsl.h*360/this.hslDelphiMax,s:hsl.s*100/this.hslDelphiMax,l:hsl.l*100/this.hslDelphiMax};const t=lHSV.s*(lHSV.l<50?lHSV.l:100-lHSV.l)/100;lHSV.s=lHSV.l>0?200*t/(lHSV.l+t):lHSV.s;if(isNaN(lHSV.s)){lHSV.s=0;}
lHSV.l=t+lHSV.l;return lHSV;}};module.exports=UtilitaireCouleur;},fn:"utilitairecouleur.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const GThemesCouleurs=require('ThemesCouleurs.js').GThemesCouleurs;const UtilitaireCouleur=require('UtilitaireCouleur.js');if(!global.GCouleur){global.GCouleur=null;}
class _ObjetCouleur{constructor(aGenreThemeCouleur,aEstAccessible,aAvecNonEditable){this.blanc='white';this.noir='black';this.eleve={garcon:'#2D24F0',fille:'#EE01F6'};this.themeNeutre=GThemesCouleurs.getThemeNeutre();this.themeCouleur=GThemesCouleurs.getThemeCouleur(aGenreThemeCouleur);this.fond='#ffffff';this.texte=this.noir;this.bordure=this.trait=this.themeNeutre.moyen2;this.cumul=this.themeNeutre.moyen2;this.nonEditable={fond:GThemesCouleurs.nonEditable,texte:this.themeNeutre.foncee,bordure:this.themeNeutre.moyen2};this.intermediaire=this.themeNeutre.claire;this.avecNonEditable=aAvecNonEditable===null||aAvecNonEditable===undefined?true:aAvecNonEditable;this.texteListeCreation='#444444';this.fenetre={fond:this.fond,bordure:this.bordure,bandeau:{fond:this.blanc,texte:this.noir},nonEditable:this.nonEditable,cumul:this.cumul,texte:this.themeNeutre.foncee,intermediaire:this.themeNeutre.claire};this.rouge=aEstAccessible?'#666666':'#CC3300';this.rougeClair=aEstAccessible?'#666666':'#FF0000';this.vert=aEstAccessible?'#666666':'#228B22';this.grisTresClair=this.fenetre.nonEditable;this.grisClair=this.fenetre.intermediaire;this.grisFonce=this.fenetre.cumul;this.grisTresFonce=this.fenetre.texte;this.standard=new ObjectCouleurCellule(this.blanc,this.noir);this.selection=new ObjectCouleurCellule(aEstAccessible?'#7b7b7b':'#3399ff',this.blanc);this.selection.fondClair=aEstAccessible?'#b3b3b3':'#6699FF';this.inactif=new ObjectCouleurCellule('#F0F0F0','#AAAAAA');this.grille={fond:this.themeNeutre.moyen1,bordure:'#848484',texte:'black',gabarit:aEstAccessible?'#606060':'#00BF00',fondCoursSuperpose:'#f9f4f0',selectionCours:this.selection.fond};this.bandeau={fond:this.themeNeutre.moyen1,texte:this.noir,bordure:this.themeNeutre.light,separateur:this.themeCouleur.foncee};this.liste=new ObjectCouleurCellule();this.liste.bordure=this.bordure;this.liste.titre=new ObjectCouleurCellule(this.themeNeutre.light,this.themeCouleur.foncee,this.bordure);this.liste.cellule=new ObjectCouleurCellule(this.fond,this.texte,this.bordure);this.liste.editable=new ObjectCouleurCellule(this.blanc,this.noir,this.bordure);this.liste.editableAlternee1=new ObjectCouleurCellule(this.themeNeutre.light,this.noir,this.bordure);this.liste.editableAlternee2=new ObjectCouleurCellule(this.blanc,this.noir,this.bordure);this.liste.nonEditable=new ObjectCouleurCellule(this.avecNonEditable?this.themeNeutre.legere2:this.blanc,this.noir,this.bordure);this.liste.nonEditableAlternee1=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.liste.nonEditableAlternee2=new ObjectCouleurCellule(this.themeNeutre.legere2,this.noir,this.bordure);this.liste.nonApplicable=new ObjectCouleurCellule(this.themeNeutre.moyen1,this.noir,this.bordure);this.liste.colonneFixe=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.liste.colonneFixeAlternee1=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.liste.colonneFixeAlternee2=new ObjectCouleurCellule(this.themeNeutre.legere2,this.noir,this.bordure);this.liste.moyenne=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.liste.moyenneAlternee1=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.liste.moyenneAlternee2=new ObjectCouleurCellule(this.themeNeutre.legere2,this.noir,this.bordure);this.liste.total=new ObjectCouleurCellule(this.themeNeutre.foncee,this.blanc,this.bordure);this.liste.totalAlternee1=new ObjectCouleurCellule(this.themeNeutre.sombre,this.blanc,this.bordure);this.liste.totalAlternee2=new ObjectCouleurCellule(this.themeNeutre.foncee,this.blanc,this.bordure);this.liste.cumul=new ObjectCouleurCellule(this.themeCouleur.claire,this.noir,this.bordure);this.liste.cumul[0]=new ObjectCouleurCellule(this.themeCouleur.moyen1,this.blanc,this.bordure);this.liste.cumul[1]=new ObjectCouleurCellule(this.themeCouleur.claire,this.noir,this.bordure);this.liste.cumul[2]=new ObjectCouleurCellule(this.themeNeutre.moyen1,this.noir,this.bordure);this.liste.cumul[3]=new ObjectCouleurCellule(this.themeNeutre.claire,this.noir,this.bordure);this.listeNeutre=MethodesObjet.dupliquer(this.liste);this.listeNeutre.titre.fond=this.themeNeutre.light;this.listeNeutre.titre.texte=this.themeNeutre.foncee;this.listeNeutre.cumul.fond=this.themeNeutre.claire;this.listeNeutre.cumul[0].fond=this.themeNeutre.claire;this.listeNeutre.cumul[1].fond=this.themeNeutre.claire;this.listeNeutre.cumul[2].fond=this.themeNeutre.claire;this.listeNeutre.cumul[3].fond=this.themeNeutre.claire;this.correspondance={};this.accessible={};this.devoir={commeUnBonus:'#00FF00',commeUneNote:'darkorange',commeUnSeuil:'#9933FF'};this.surlignageTexte='#99cde4';}
getCouleurCellule(aEditable,aSelectionne,aEstTitre){if(aSelectionne){return this.selection;}
if(aEstTitre){return this.liste.titre;}
return aEditable?this.liste.editable:this.liste.nonEditable;}
CouleurToRGB(aHex){return UtilitaireCouleur.CouleurToRGB(aHex);}
CouleurToHSV(hex){return UtilitaireCouleur.CouleurToHSV(hex);}
RGBToCouleur(aRGB){return UtilitaireCouleur.RGBToCouleur(aRGB);}
RGBToHSV(rgb){return UtilitaireCouleur.RGBToHSV(rgb);}
HSVToCouleur(hsl){return UtilitaireCouleur.HSVToCouleur(hsl);}
HSVToRGB(hsl){return UtilitaireCouleur.HSVToRGB(hsl);}
HSVToHSLDelphi(hsv){return UtilitaireCouleur.HSVToHSLDelphi(hsv);}
HSLDelphiToHSV(hsl){return UtilitaireCouleur.HSLDelphiToHSV(hsl);}
getCouleurCorrespondance(aCouleur){if(!aCouleur){return aCouleur;}
if(this.correspondance[aCouleur]!==undefined){return this.correspondance[aCouleur];}
const lCouleurHSL=this.HSVToHSLDelphi(this.CouleurToHSV(aCouleur));if(Math.round(lCouleurHSL.l)<=95){this.correspondance[aCouleur]='#FFFFFF';} else if(Math.round(lCouleurHSL.l)>160){this.correspondance[aCouleur]='#000000';} else if(Math.round(lCouleurHSL.h)<=120){this.correspondance[aCouleur]='#000000';} else{this.correspondance[aCouleur]='#FFFFFF';}
return this.correspondance[aCouleur];}
getCouleurAccessible(aCouleur){if(!aCouleur||!aCouleur.substr){return aCouleur;}
if(this.accessible[aCouleur]!==undefined){return this.accessible[aCouleur];}
let r=parseInt(aCouleur.substr(1,2),16)/255;let g=parseInt(aCouleur.substr(3,2),16)/255;let b=parseInt(aCouleur.substr(5,2),16)/255;const max=Math.max(r,g,b),min=Math.min(r,g,b);const l=(max+min)/2;r=g=b=Math.round(l*255);this.accessible[aCouleur]='#'+(r<16?'0':'')+r.toString(16)+(g<16?'0':'')+g.toString(16)+(b<16?'0':'')+b.toString(16);return this.accessible[aCouleur];}
getCouleurTransparente(aColor,aOpacity,aBackground,aBackOpa){if(!aColor||!aColor.substr){return false;}
if(aOpacity<0||aOpacity>1){return false;}
if(!aBackOpa||aBackOpa<0||aBackOpa>1){aBackOpa=1;}
const lDest=[];const lFond=[255,255,255];const lOrig=[];if(aBackground&&aBackground.substr){lFond[0]=parseInt(aBackground.substr(1,2),16);lFond[1]=parseInt(aBackground.substr(3,2),16);lFond[2]=parseInt(aBackground.substr(5,2),16);}
lDest[0]=parseInt(aColor.substr(1,2),16);lDest[1]=parseInt(aColor.substr(3,2),16);lDest[2]=parseInt(aColor.substr(5,2),16);for(let i=0;i<3;i++){lOrig[i]=Math.floor(((lDest[i]*(aOpacity+aBackOpa*(1-aOpacity)))-((lFond[i]*aBackOpa)*(1-aOpacity)))/aOpacity);if(lOrig[i]>255||lOrig[i]<0){return false;}}
return'#'+(lOrig[0]<16?'0':'')+lOrig[0].toString(16)+(lOrig[1]<16?'0':'')+lOrig[1].toString(16)+(lOrig[2]<16?'0':'')+lOrig[2].toString(16);}
getCouleurTransformationCours(aCouleur){const lRGB=this.CouleurToRGB(aCouleur),lHSL=this.HSVToHSLDelphi(this.RGBToHSV(lRGB));let lEstProcheDuGris=(Math.abs(lRGB.r-lRGB.g)<10)&&(Math.abs(lRGB.r-lRGB.b)<10)&&(Math.abs(lRGB.g-lRGB.b)<10);if(!lEstProcheDuGris){lEstProcheDuGris=lHSL.s<8;}
if(lEstProcheDuGris){lRGB.r=Math.borner(lRGB.r+50,180,255);lRGB.g=Math.borner(lRGB.g+50,180,255);lRGB.b=Math.borner(lRGB.b+50,180,255);return this.RGBToCouleur(lRGB);} else{lHSL.s=Math.max(lHSL.s-100,60);if(lHSL.l<140){lHSL.l=160;} else if(lHSL.l<160){lHSL.l=200;} else{lHSL.l=220;}
return this.HSVToCouleur(this.HSLDelphiToHSV(lHSL));}}
getCouleurContrastee(aCouleur,aCouleurFond,aParametresContraste){if(!aCouleur||!aCouleurFond){return aCouleur||'#000';}
if(!aParametresContraste){aParametresContraste={};}
if(aParametresContraste.ponderationFoncee===undefined){aParametresContraste.ponderationFoncee=1;}
if(aParametresContraste.ponderationClaire===undefined){aParametresContraste.ponderationClaire=1;}
const lHSL=UtilitaireCouleur.HSVToHSLDelphi(UtilitaireCouleur.CouleurToHSV(aCouleur));const lHSLFond=UtilitaireCouleur.HSVToHSLDelphi(UtilitaireCouleur.CouleurToHSV(aCouleurFond))
;const lDeltaInitial=30;const lDeltaRenduPlusFoncee=lDeltaInitial*aParametresContraste.ponderationFoncee;const lDeltaRenduPlusClair=lDeltaInitial*aParametresContraste.ponderationClaire;if(lHSLFond.l>75){if(lHSL.l>=lDeltaRenduPlusFoncee){lHSL.l+=(-1*lDeltaRenduPlusFoncee);} else{lHSL.l=0;}} else{lHSL.l=UtilitaireCouleur.hslDelphiMax-lDeltaRenduPlusClair;}
return UtilitaireCouleur.HSVToCouleur(UtilitaireCouleur.HSLDelphiToHSV(lHSL));}}
_ObjetCouleur.hslDelphiMax=240;class ObjectCouleurCellule{constructor(aFond,aTexte,aBordure){this.fond=aFond;this.texte=aTexte;this.bordure=aBordure;}
getFond(aPourImpression){return aPourImpression?global.GCouleur.blanc:this.fond;}
getTexte(aPourImpression){return aPourImpression?global.GCouleur.noir:this.texte;}
getBordure(aPourImpression){return aPourImpression?global.GCouleur.noir:this.bordure;}}
module.exports._ObjetCouleur=_ObjetCouleur;module.exports.ObjectCouleurCellule=ObjectCouleurCellule;},fn:"_objetcouleur.js"});;
IE.fModule({f:function(exports,require,module,global){const{_ObjetCouleur}=require('_ObjetCouleur.js');const GStyle=require('GStyle.js');class ObjetCouleur extends _ObjetCouleur{constructor(aThemeEspace,aEstAccessible,aAvecNonEditable){super(aThemeEspace,aEstAccessible,aAvecNonEditable);this.service=this.intermediaire;this.note='#FFFFCC';this.periodesFonce=new Array('','#CC33CC','#399361','#3399FF','#CC33CC','#399361','#CC33CC');this.periodesClair=new Array('','#EBA2D5','#8CE4A3','#A9D4E9','#EBA2D5','#8CE4A3','#EBA2D5');$.extend(this.grille,{indisponibilite:'#F18280',indisponibiliteSouple:'#f9d059',voeu:'#8acb63',priorite1:'#f000f0',priorite2:'#990099',priorite3:'#500070',demiPensionActive:'#52E252',demiPensionInactive:'#B54095',indisponibiliteSession:'#0066CC',indisponibiliteSessionPlanning:'#326699',horsPlageSessionRencontre:'#F0F0F0',recreations:'#F4D217'});this.grilleOccupation={fond:'#808080',placeLibre:'#FFFFFF',bordure:'#f9f4f0'};this.grilleSlider={fond:'#D8D8D8',fondBouton:'#F0F0F0',fondBoutonSurvol:'#D0D0D0',fondBoutonSelectionne:'#FFFFFF',boutonBordureFonce:'#A0A0A0',boutonBordureClaire:'#FFFFFF'};this.voeuxRencontres=["#FFFFFF","#F7B95D","#7EECAA","#F95959"];this.diagnostic={placeLibre:'white',occupation:'red',occupationPermanence:'#FFBF3A',demiPension:'#884605',site:'#FF00CC',absenceRessource:'#CC0033',indisponibilite:'#d5818a',gaev:'#CC0033',recreation:'#784c1e'};}
composeCouleurSelection(){return GStyle.composeCouleur(this.selection.fond,this.selection.texte);}
setCouleurSelection(aId){GStyle.setCouleur(aId,this.selection.fond,this.selection.texte);}}
module.exports=ObjetCouleur;},fn:"objetcouleur.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const MethodesTableau=require('MethodesTableau.js');const GChaine=require('GChaine.js');const ObjetCycles=require('ObjetCycles.js');const{GDate}=require('ObjetDate.js');const ObjetListeElements=require('ObjetListeElements.js');const GThemesCouleurs=require('ThemesCouleurs.js').GThemesCouleurs;const TypeDomaine=require('TypeDomaine.js');const TypeNote=require('TypeNote.js');const EGenreDomaineFrequence=require('Enumere_DomaineFrequence.js');const EGenreEspace=require('Enumere_Espace.js');const EGenrePeriodeDeNotation=require('Enumere_PeriodeDeNotation.js');const{TypeThemeCouleur}=require('TypeThemeCouleur.js');global.GParametres=null;class ObjetParametres{constructor(aJSON){GApplication.initDateServeur(aJSON.DateServeurHttp);GApplication.setDateDemo(aJSON.DateDemo);if(aJSON.urlLogout){GApplication.urlLogout=aJSON.urlLogout;}
this.avecMembre=aJSON.avecMembre;this.pourNouvelleCaledonie=aJSON.pourNouvelleCaledonie;this.genreImageConnexion=aJSON.genreImageConnexion;this.urlImageConnexion=aJSON.urlImageConnexion;this.urlFondEcran=aJSON.urlFondEcran;this.avecAccesMobile=aJSON.AvecEspaceMobile;this.URLMobile=aJSON.URLMobile;this.URLEspace=aJSON.URLEspace;this.logoProduitCss=aJSON.logoProduitCss;this.listeCivilites=aJSON.listeCivilites;this.listePays=aJSON.listePays;this.listeLienParente=aJSON.listeLienParente;this.listeMatieres=aJSON.listeMatieres;this.listeOrientations=aJSON.listeOrientations;this.listeVilles=aJSON.listeVilles;this.listeRegimes=aJSON.listeRegimes;this.listeEtablissements=aJSON.listeEtablissements;this.listeSituations=aJSON.listeSituations;this.listeProfessions=aJSON.listeProfessions;this.listeSessionsInscriptions=aJSON.listeSessionsInscriptions;this.listePolices=aJSON.listePolices;this.PageEtablissement=aJSON.PageEtablissement;const lJGeneral=this.general=aJSON.General;this.version=lJGeneral.version;this.versionPN=lJGeneral.versionPN;this.millesime=lJGeneral.millesime;this.langue=lJGeneral.langue;this.langID=lJGeneral.langID;this.listeLangues=lJGeneral.listeLangues;this.publierMentions=lJGeneral.publierMentions;this.avecForum=lJGeneral.avecForum;this.estHebergeEnFrance=lJGeneral.estHebergeEnFrance;this.urlSiteIndexEducation=lJGeneral.urlSiteIndexEducation;this.urlInfosHebergement=lJGeneral.urlSiteInfosHebergement;this.urlAide=lJGeneral.UrlAide;this.urlAccesVideos=lJGeneral.urlAccesVideos;this.urlAccesTwitter=lJGeneral.urlAccesTwitter;this.urlFAQEnregistrementDoubleAuth=lJGeneral.urlFAQEnregistrementDoubleAuth;this.urlCanope=lJGeneral.urlCanope;this.urlStopCovid=lJGeneral.urlStopCovid;this.urlDeclarationAccessibilite=lJGeneral.urlDeclarationAccessibilite;this.labelLienProduit=aJSON.labelLienProduit;this.urlLogo=lJGeneral.urlLogo;this.logoDepartementImage=lJGeneral.logoDepartementImage;this.logoDepartementLien=lJGeneral.logoDepartementLien;this.avecChoixConnexion=lJGeneral.AvecChoixConnexion;this.numeroPremiereSemaine=lJGeneral.numeroPremiereSemaine;this.anneeScolaire=lJGeneral.anneeScolaire;this.dateDebutPremierCycle=lJGeneral.dateDebutPremierCycle;this.PremierLundi=lJGeneral.PremierLundi;this.PremiereDate=lJGeneral.PremiereDate;this.DerniereDate=lJGeneral.DerniereDate;this.PremierJourSemaine=GDate.GetJourDeDate(this.PremierLundi);this.DernierJourSemaine=(this.PremierJourSemaine+6)%7;this.listeJoursFeries=lJGeneral.listeJoursFeries;this.JourOuvre=lJGeneral.JourOuvre;this.JoursOuvres=lJGeneral.JoursOuvres;this.DemiJourneesOuvrees=lJGeneral.DemiJourneesOuvrees;this.joursDemiPension=lJGeneral.JoursDemiPension;this.JoursFeries=this.getJoursFeries();this.PlacesParJour=lJGeneral.PlacesParJour;this.PlacesParHeure=lJGeneral.PlacesParHeure;this.DureeSequence=lJGeneral.DureeSequence;this.PlaceDemiJournee=lJGeneral.PlaceDemiJourneeAbsence;this.joursOuvresParCycle=lJGeneral.joursOuvresParCycle;this.premierJourSemaine=lJGeneral.premierJourSemaine;this.grillesEDTEnCycle=lJGeneral.grillesEDTEnCycle;this.setOfJoursCycleOuvre=lJGeneral.setOfJoursCycleOuvre;this.activationDemiPension=lJGeneral.activationDemiPension;this.debutDemiPension=lJGeneral.debutDemiPension;this.finDemiPension=lJGeneral.finDemiPension;this.recreations=lJGeneral.recreations;this.AvecHeuresPleinesApresMidi=lJGeneral.AvecHeuresPleinesApresMidi;this.LibellesHeures=lJGeneral.ListeHeures;this.LibellesHeuresFin=lJGeneral.ListeHeuresFin;this.PremiereHeure=lJGeneral.PremiereHeure;this.afficherSequences=lJGeneral.afficherSequences;this.sequences=lJGeneral.sequences;this.ActivationMessagerieEntreParents=lJGeneral.ActivationMessagerieEntreParents;this.GestionParcoursExcellence=lJGeneral.GestionParcoursExcellence;this.NomEtablissement=lJGeneral.NomEtablissement;this.NomEtablissementConnexion=lJGeneral.NomEtablissementConnexion;this.NomEspace=aJSON.Nom;this.listeComboPeriodes=lJGeneral.listeComboPeriodes;this.listeAnneesPrecedentes=lJGeneral.listeAnneesPrecedentes;this.tailleMaxAppreciation=lJGeneral.TailleMaxAppreciation;this.baremeNotation=lJGeneral.BaremeNotation;if(TypeNote){TypeNote.baremeNotation=this.baremeNotation;}
this.baremeMaxDevoirs=lJGeneral.BaremeMaxDevoirs;this.nbJDecalageDatePublicationParDefautDevoirEval=lJGeneral.NbJDecalageDatePublicationParDefaut||0;this.nbJDecalagePublicationAuxParents=lJGeneral.NbJDecalagePublicationAuxParents||0;this.avecAffichageDecalagePublicationNotesAuxParents=!!lJGeneral.AvecAffichageDecalagePublicationNotesAuxParents;this.avecAffichageDecalagePublicationEvalsAuxParents=!!lJGeneral.AvecAffichageDecalagePublicationEvalsAuxParents;if(TypeNote){TypeNote.listeAnnotationsAutorisees=lJGeneral.listeAnnotationsAutorisees;}
this.minBaremeQuestionQCM=lJGeneral.minBaremeQuestionQCM;this.maxBaremeQuestionQCM=lJGeneral.maxBaremeQuestionQCM;this.maxNombrePointsQCM=lJGeneral.maxNbPointQCM;this.maxNiveauQCM=lJGeneral.maxNiveauQCM;this.tailleLibelleElementGrilleCompetence=lJGeneral.tailleLibelleElementGrilleCompetence;this.tailleCommentaireDevoir=lJGeneral.tailleCommentaireDevoir;this.tailleMaxLibelleUrlCours=lJGeneral.tailleLibelleUrlCours;this.tailleMaxCommentaireUrlCours=lJGeneral.tailleCommentaireUrlCours;this.listeNiveauxDAcquisitions=lJGeneral.ListeNiveauxDAcquisitions;this.afficherAbbreviationNiveauDAcquisition=lJGeneral.AfficherAbbreviationNiveauDAcquisition;this.avecEvaluationHistorique=lJGeneral.AvecEvaluationHistorique;this.avecRecuperationInfosConnexion=lJGeneral.AvecRecuperationInfosConnexion;this.avecElevesRattaches=lJGeneral.AvecElevesRattaches;this.police=lJGeneral.Police;this.taillePolice=lJGeneral.TaillePolice+'px';this.publicationSuiviStageParDefaut=lJGeneral.publicationSuiviStage;if(lJGeneral.maskTelephone){GChaine.maskTelephone=lJGeneral.maskTelephone;}
const lDomainesFrequences=lJGeneral.DomainesFrequences;const lLibellesFrequences=lJGeneral.LibellesFrequences;this.frequences=null;if(!GEtatUtilisateur.pourPrimaire()){this.frequences=[];for(let lNumeroSemaine=1;lNumeroSemaine<=ObjetCycles.C_MaxDomaineCycle;lNumeroSemaine++){this.frequences[lNumeroSemaine]={};for(const I in EGenreDomaineFrequence){const lGenre=EGenreDomaineFrequence[I];if((lGenre===EGenreDomaineFrequence.QZ1)||(lGenre===EGenreDomaineFrequence.QZ2)){if(lDomainesFrequences[lGenre].GetValeur(lNumeroSemaine)){this.frequences[lNumeroSemaine].genre=lGenre;this.frequences[lNumeroSemaine].libelle=lLibellesFrequences[lGenre];}}}}}
this.themeParDefaut=GApplication.estEDT?TypeThemeCouleur.MobileEDT:TypeThemeCouleur.Pronote;GThemesCouleurs.setTheme(this.themeParDefaut);this.initialiserCouleur();this.listePeriodes=new ObjetListeElements().fromJSON(lJGeneral.ListePeriodes,this._ajouterPeriode);this.nomCookieAppli=lJGeneral.nomCookieAppli;if((GEtatUtilisateur.GenreEspace===EGenreEspace.Inscription)&&aJSON.infosInscription){this.infosInscription=aJSON.infosInscription;}
this.mentionsPagesPubliques=aJSON.mentionsPagesPubliques;this.aideContextuelle=false;if(lJGeneral.aideContextuelle){this.aideContextuelle=lJGeneral.aideContextuelle;this.aideContextuelle.getNombreDeGenreOnglet=function(aGenre){let lResult=0;let lAccessor;if(MethodesObjet.isNumber(aGenre)){lAccessor=aGenre.toString();} else if(MethodesObjet.isString(aGenre)){lAccessor=aGenre;}
if(lAccessor!==undefined){lResult=this[lAccessor];if(lResult===undefined){lResult=0;}}
return lResult;};}}
getLibelleHeure(aPlace){try{return this.LibellesHeures.GetLibelle(aPlace);} catch(e){return'';}}
getCookieValidationAppli(){return this.nomCookieAppli;}
initAuthentification(aParam){this.domaineVerrou=aParam.domaineVerrou?aParam.domaineVerrou:new TypeDomaine();}
getThemeCourant(){const lThemeSauvegarde=GApplication&&GApplication.parametresUtilisateur&&GApplication.parametresUtilisateur.get&&GApplication.parametresUtilisateur.get('theme');const lTheme=GThemesCouleurs.getThemeCourant({genreEspace:GEtatUtilisateur.GenreEspace,themeParDefaut:this.themeParDefaut,theme:lThemeSauvegarde});return lTheme;}
initialiserCouleur(aTheme){let lTheme=aTheme!==undefined?aTheme:null;if(!lTheme){lTheme={theme:GThemesCouleurs.genreTheme};}
GThemesCouleurs.setTheme(lTheme.theme,GEtatUtilisateur.estAvecThemeAccessible());const ObjetCouleur=require('ObjetCouleur.js');global.GCouleur=new ObjetCouleur(lTheme.theme,GEtatUtilisateur.estAvecThemeAccessible(),!MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Parent,EGenreEspace.Inscription,EGenreEspace.Eleve,EGenreEspace.PrimParent,EGenreEspace.PrimEleve,EGenreEspace.Accompagnant,EGenreEspace.PrimAccompagnant,EGenreEspace.Tuteur]));}
GetNomEspace(){return this.NomEspace;}
getJoursFeries(){const lJoursFeries=new TypeDomaine(null,GDate.getNbrJoursEntreDeuxDates(this.dateDebutPremierCycle,this.DerniereDate)+1);for(let I=0;I<this.listeJoursFeries.GetNbrElements();I++){const lJourFerie=this.listeJoursFeries.GetElement(I);lJoursFeries.SetValeur(true,GDate.getNbrJoursEntreDeuxDates(this.dateDebutPremierCycle,lJourFerie.dateDebut)+1,GDate.getNbrJoursEntreDeuxDates(this.dateDebutPremierCycle,lJourFerie.dateFin)+1);}
return lJoursFeries;}
getDomaineCycleFerie(){if(!this.domaineCycleFerie){this.domaineCycleFerie=new TypeDomaine();let LSemaineFeriee;const lNombreCycles=IE.Cycles.nombreCyclesAnneeScolaire();const lNombreJoursCycle=IE.Cycles.nombreJoursOuvresParCycle();for(let lCycle=1;lCycle<=lNombreCycles;lCycle+=1){LSemaineFeriee=true;for(let lJourCycle=0;lJourCycle<lNombreJoursCycle&&LSemaineFeriee;lJourCycle+=1){const lJourAnnuel=GDate.getNbrJoursEntreDeuxDates(this.dateDebutPremierCycle,IE.Cycles.jourCycleEnDate(lJourCycle,lCycle));LSemaineFeriee=this.JoursFeries.GetValeur(lJourAnnuel+1);}
this.domaineCycleFerie.SetValeur(LSemaineFeriee,lCycle);}}
return this.domaineCycleFerie;}
getTailleMaxAppreciationParEnumere(aGenre){let lTailleMaxAppreciation=255;if(aGenre!==null){lTailleMaxAppreciation=this.tailleMaxAppreciation[aGenre];}
return lTailleMaxAppreciation?lTailleMaxAppreciation:1000000;}
_ajouterPeriode(aJSON,aElement){aElement.periodeNotation=aJSON.periodeNotation;aElement.dates={};aElement.dates.debut=aJSON.dateDebut;aElement.dates.fin=aJSON.dateFin;}
getDatesPeriodeDeNotation(aNumeroPeriode){const lPeriode=this.listePeriodes.GetElementParNumero(aNumeroPeriode);return lPeriode?lPeriode.dates:null;}
getDateDansPeriodeDeNotation(aDate,aNumeroPeriode){const lDates=this.getDatesPeriodeDeNotation(aNumeroPeriode);const lDate=aDate?aDate:GDate.getDateCourante();if(lDates&&(lDate>lDates.fin)){return lDates.fin;}
if(lDates&&(lDate<lDates.debut)){return lDates.debut;}
return lDate;}
getPeriodeDeNotation(aNumeroPeriode){const lPeriode=this.listePeriodes.GetElementParNumero(aNumeroPeriode);return lPeriode?lPeriode.periodeNotation:null;}
getPeriodeDeNotationParGenre(aGenrePeriodeDeNotation){for(let i=0;i<this.listePeriodes.GetNbrElements();i++){const lPeriode=this.listePeriodes.GetElement(i);if(aGenrePeriodeDeNotation===lPeriode.periodeNotation){return lPeriode;}}}
estPeriodeTrimestrielle(aNumeroPeriode){return EGenrePeriodeDeNotation.estTrimestrielle(this.getPeriodeDeNotation(aNumeroPeriode));}
estPeriodeSemestrielle(aNumeroPeriode){return EGenrePeriodeDeNotation.estSemestrielle(this.getPeriodeDeNotation(aNumeroPeriode));}
estPeriodeAnnuelle(aNumeroPeriode){return EGenrePeriodeDeNotation.estAnnuelle(this.getPeriodeDeNotation(aNumeroPeriode));}
estPeriodeOfficielle(aNumeroPeriode){return EGenrePeriodeDeNotation.estOfficielle(this.getPeriodeDeNotation(aNumeroPeriode));}
getListeComboPeriodes(aGenres){if(!aGenres){return this.listeComboPeriodes;}
const lListePeriodes=new ObjetListeElements();for(let I=0;I<this.listeComboPeriodes.GetNbrElements();I++){const lPeriode=this.listeComboPeriodes.GetElement(I);if(MethodesTableau.existe(lPeriode.GetGenre(),aGenres)){lListePeriodes.AddElement(lPeriode);}}
return lListePeriodes;}}
module.exports=ObjetParametres;},fn:"parametres.js"});;
IE.fModule({f:function(exports,require,module,global){class Chronometre{constructor(){this.reset();this.actif=true;}
start(){this.dateChrono=Date.now();this.actif=true;}
stop(){this.valeur+=Date.now()-this.dateChrono;this.actif=false;}
reset(){this.dateChrono=Date.now();this.valeur=0;}
toString(){const lValeur=this.valeur+(this.actif?(Date.now()-this.dateChrono):0);if(lValeur>1000){return(lValeur/1000)+' s';}
return lValeur+' ms';}}
module.exports=Chronometre;},fn:"chronometre.js"});;
IE.fModule({f:function(exports,require,module,global){require('NamespaceIE.js');require('divers.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const MethodesObjet=require('MethodesObjet.js');const deferLoadingScript=(function(){const lModules={},isOpera=typeof window.opera!=='undefined'&&window.opera.toString()==='[object Opera]',lUrlsDone={},options={done:null,fail:null,messageChargement:''};let lModuleEnCours=null,lSupportASync,lHead=null;function createNode(config){const node=config.xhtml?document.createElementNS('http://www.w3.org/1999/xhtml','html:script'):document.createElement('script');node.type=config.scriptType||'text/javascript';node.async=false;return node;}
function removeListener(node,func,name,ieName){if(node.detachEvent&&!isOpera){if(ieName){node.detachEvent(ieName,func);}} else{node.removeEventListener(name,func,false);}}
function _getHead(){if(!lHead){lHead=document.getElementsByTagName('head')[0];}
return lHead;}
function createLoaderScript(aUrl,aCallback,aParams){let lLoader=null;function finScript(evt){const node=evt.currentTarget||evt.srcElement;removeListener(node,onScriptLoad,'load','onreadystatechange');removeListener(node,onScriptError,'error');return node;}
function onScriptLoad(evt){if(evt.type==='load'||(/^(complete|loaded)$/.test((evt.currentTarget||evt.srcElement).readyState))){finScript(evt);lLoader.loaded=true;lLoader.finChargement();}}
lLoader={url:aUrl,loaded:false,loadedFail:false,chrono:null,supportASync:false,timerFail:-1,params:aParams,load:function(){if(this.loaded){this.finChargement();return;}
this.chrono=new(require('Chronometre.js'))();const node=createNode({});if(lSupportASync===undefined){if(!document.addEventListener){lSupportASync=false;} else{lSupportASync='async' in node;}}
if(node.attachEvent&&
!(node.attachEvent.toString&&node.attachEvent.toString().indexOf('[native code')<0)&&
!isOpera){node.attachEvent('onreadystatechange',onScriptLoad);lSupportASync=false;} else{node.addEventListener('load',onScriptLoad,false);node.addEventListener('error',onScriptError,false);}
node.src=this.url;if(lSupportASync&&this.params.accepteASync){node.async=false;}
_getHead().appendChild(node);const lSelf=this;this.timerFail=setTimeout(() =>{lSelf.loadedTimeoutFail=true;onScriptError({currentTarget:node});},aParams.timeoutFailScript);if(lSupportASync&&this.params.accepteASync&&this.next){this.params._compteurTimeout+=1;if(this.params.timeoutLoad>=0&&this.params._compteurTimeout>=this.params.nbPourDelaiTimeout){this.params._compteurTimeout=0;setTimeout(() =>{lSelf.next.load();},this.params.timeoutLoad);} else{Promise.resolve().then(() =>{this.next.load();});}}},finChargement:function(){clearTimeout(this.timerFail);aCallback(this);if(this.next&&!(lSupportASync&&this.params.accepteASync)){this.next.load();}}};function onScriptError(evt){finScript(evt);lLoader.loadedFail=true;lLoader.finChargement();}
return lLoader;}
function _loadSingletonModule(aNom,aParams){const lNom=aNom.toLowerCase(),lModule=lModules[lNom];lModule.nom=aNom;lModule.params=aParams;function _callbackFin(aEchec){if(aEchec){if(options.fail){options.fail(aNom,lModule);}
if(aParams.fail){aParams.fail(aNom,lModule);}} else{if(options.done){options.done(aNom,lModule);}
aParams.done(aNom,lModule);}}
if(!aParams||!aParams.done){return this;}
if(!lModule){_callbackFin();return this;}
if(lModuleEnCours===lNom){return this;}
lModuleEnCours=lNom;let lUrl,i,lScript,LPrevScript;function _callback(aLoader){if(lModule.interrupt){return;}
if(aLoader.loadedFail){aLoader.next=null;lModule.interrupt=true;_callbackFin(true);return;}
lUrlsDone[aLoader.url]=true;if(!aLoader.next){_callbackFin();}}
lModule.first=null;for(i=0;i<lModule.urls.length;i++){lUrl=lModule.urls[i];if(!lUrlsDone[lUrl]){lScript=createLoaderScript(lUrl,_callback,aParams);if(LPrevScript){LPrevScript.next=lScript;}
if(!lModule.first){lModule.first=lScript;}
LPrevScript=lScript;}}
if(lModule.first){lModule.first.load(lModule);} else{_callbackFin();}}
return{add:function(aNom,aUrls){const lNom=aNom.toLowerCase(),lModule={urls:[],count:0};let lUrl,i;lModules[lNom]=lModule;for(i=0;i<aUrls.length;i++){lUrl=aUrls[i];lModule.urls.push(lUrl);}
return this;},contains:function(aNom){return!!lModules[aNom.toLowerCase()];},setOptions:function(aOptions){Object.assign(options,aOptions);return this;},load:function(aNom,aParam){if(MethodesObjet.isString(aNom)){this.load([aNom],aParam);return;}
function _loadSingletonDeTableau(aDefer,aNomsTraites,aParam,aDone,aFail){if(aNomsTraites.length===0){lModuleEnCours=null;if(aParam.eventIO!==false){Invocateur.evenement(ObjetInvocateur.events.patience,false);}
aDone();return;}
aParam.done=function(){aNomsTraites.shift();if(aParam.timeoutLoadGroupe>=0){setTimeout(() =>{_loadSingletonDeTableau(aDefer,aNomsTraites,aParam,aDone,aFail);},aParam.timeoutLoadGroupe);} else{Promise.resolve().then(() =>{_loadSingletonDeTableau(aDefer,aNomsTraites,aParam,aDone,aFail);});}};aParam.fail=function(aNom){aNomsTraites=[];if(aParam.eventIO!==false){Invocateur.evenement(ObjetInvocateur.events.patience,false);}
if(aFail){aFail(aNom);}};aParam._compteurTimeout=0;if(aDefer.contains(aNomsTraites[0])){if(aParam.eventIOExt){Invocateur.evenement(ObjetInvocateur.events.patience,false);}
if(aParam.eventIO!==false){Invocateur.evenement(ObjetInvocateur.events.patience,true,{actualisation:true,message:(options.messageChargement+' '+aNomsTraites[0]).trim()});}
_loadSingletonModule.call(aDefer,aNomsTraites[0],aParam);} else{aParam.done();}}
const lParams=Object.assign({done:null,fail:null,eventIO:false,timeoutLoadGroupe:-1,timeoutLoad:-1,nbPourDelaiTimeout:1,accepteASync:true,timeoutFailScript:3*60*1000},aParam);if(Array.isArray(aNom)){const lDone=lParams.done,lFail=lParams.fail;if(lParams.eventIO!==false){Invocateur.evenement(ObjetInvocateur.events.patience,true,{message:options.messageChargement});}
_loadSingletonDeTableau(this,aNom,lParams,lDone,lFail);return this;} else{return this;}},loadPromise:function(aNom,aParam){return new Promise((aResolve,aReject) =>{const lParams=Object.assign(aParam||{},{done:function(aParam){aResolve(aParam);},fail:function(aParam){aReject(aParam);}});deferLoadingScript.load(aNom,lParams);});},afficherPatience:function(){if(!lModuleEnCours){return false;}
const lModule=lModules[lModuleEnCours.toLowerCase()];if(!lModule||!lModule.nom||!lModule.params){return false;}
lModule.params.eventIO=true;lModule.params.eventIOExt=true;Invocateur.evenement(ObjetInvocateur.events.patience,true,{message:(options.messageChargement+' '+lModule.nom).trim()});return true;}};}());module.exports=deferLoadingScript;},fn:"deferloadingscript.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreCryptage={Aucun:0,Unicode:1,AES:2,RSA:3};module.exports=EGenreCryptage;},fn:"enumere_cryptage.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreIdsRequeteAjax={SignatureAttente:'_SignatureAttente_',numeroSession:'session',numeroOrdre:'numeroOrdre',donneesSecurisee:'donneesSec',donneesNonSecurisee:'donneesNonSec',nomFonction:'nom',echecReseau:'echecReseau'};module.exports=EGenreIdsRequeteAjax;},fn:"enumere_idsrequeteajax.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationForge.js');class ObjetCryptageAES{Decrypter(aChaine,aCle,aIv){try{aCle=forge.md.md5.create().update(aCle.bytes()).digest();aIv=aIv.length()?forge.md.md5.create().update(aIv.bytes()).digest():new forge.util.ByteBuffer('\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0');aChaine=new forge.util.ByteBuffer(forge.util.hexToBytes(aChaine));const lChiffreur=forge.cipher.createDecipher('AES-CBC',aCle);lChiffreur.start({iv:aIv});lChiffreur.update(aChaine);return lChiffreur.finish()&&lChiffreur.output.bytes();} catch(e){return false;}}
Encrypter(aChaine,aCle,aIv){try{aCle=forge.md.md5.create().update(aCle.bytes()).digest();aIv=aIv.length()?forge.md.md5.create().update(aIv.bytes()).digest():new forge.util.ByteBuffer('\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0');aChaine=new forge.util.ByteBuffer(aChaine);const lChiffreur=forge.cipher.createCipher('AES-CBC',aCle);lChiffreur.start({iv:aIv});lChiffreur.update(aChaine);return lChiffreur.finish()&&lChiffreur.output.toHex();} catch(e){return false;}}}
module.exports=ObjetCryptageAES;},fn:"objetcryptageaes.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationForge.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');class ObjetCryptageRSA{constructor(aModulo,aExposant){this.modulo=aModulo;this.exposant=aExposant;Invocateur.abonner(ObjetInvocateur.events.initChiffrement,function(aParam){this.setClePublique(aParam.MR,aParam.ER);},this);}
encrypter(aChaine){const lRSA=forge.pki.rsa.setPublicKey(new forge.jsbn.BigInteger(this.modulo,16),new forge.jsbn.BigInteger(this.exposant,16));const lResult=forge.util.encode64(lRSA.encrypt(aChaine.bytes()),64);return lResult;}
setClePublique(aModulo,aExposant){this.modulo=aModulo;this.exposant=aExposant;}}
module.exports=ObjetCryptageRSA;},fn:"objetcryptagersa.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationForge.js');require('DeclarationPako.js');const EGenreCryptage=require('Enumere_Cryptage.js');const ObjetCryptageAES=require('ObjetCryptageAES.js');const ObjetCryptageRSA=require('ObjetCryptageRSA.js');class ObjetCryptage{constructor(){this.Minuscules='abcdefghijklmnopkrstuvwxyz';this.Majuscules='ABCDEFGHIJKLMNOPQRSTUVWXYZ';this.Nombres='0123456789';this.Caracteres='&#|^@£$µ?!%ù§~°()[]{}+-*/=.,;';this.CryptageAES=new ObjetCryptageAES();try{this.cryptageRSA=new ObjetCryptageRSA('','');} catch(e){}}
GenererTexteAleatoire(ALongueur){const LListeCaracteres=this.Minuscules+this.Majuscules+this.Nombres;const N=LListeCaracteres.length;let LChaine='';while(LChaine.length<ALongueur){LChaine+=LListeCaracteres.charAt(Math.floor(N*Math.random()));}
return LChaine;}
getBuffer(aChaine){return new forge.util.ByteBuffer(forge.util.encodeUtf8(aChaine));}
encrypter(aOptions){const lDefault={genreCryptage:EGenreCryptage.Aucun,chaine:'',cle:'',iv:'',avecAlea:false,avecCompression:false};const lOptions={};$.extend(lOptions,lDefault,aOptions);lOptions.chaine=''+lOptions.chaine;lOptions.chaine=forge.util.encodeUtf8(lOptions.chaine);if(lOptions.avecAlea){lOptions.chaine=this.ajouterAlea(lOptions.chaine);}
if(lOptions.avecCompression){lOptions.chaine=new forge.util.ByteBuffer(lOptions.chaine).toHex();lOptions.chaine=window.pako.deflateRaw(lOptions.chaine,{level:6,to:'string'});}
let lChaineEncrypte='';switch(lOptions.genreCryptage){case EGenreCryptage.Aucun:lChaineEncrypte=lOptions.chaine;break;case EGenreCryptage.Unicode:lChaineEncrypte=lOptions.chaine;break;case EGenreCryptage.AES:lChaineEncrypte=this.CryptageAES.Encrypter(lOptions.chaine,lOptions.cle,lOptions.iv);break;case EGenreCryptage.RSA:lChaineEncrypte=this.cryptageRSA.encrypter(lOptions.chaine);break;default:;break;}
return lChaineEncrypte;}
decrypter(aOptions){const lDefault={genreCryptage:EGenreCryptage.Aucun,chaine:'',cle:'',iv:'',avecAlea:false,enBytes:false,avecCompression:false};const lOptions={};$.extend(lOptions,lDefault,aOptions);let lChaineEncrypte=lOptions.chaine;let lChaineDecrypte='';switch(lOptions.genreCryptage){case EGenreCryptage.Aucun:lChaineDecrypte=lChaineEncrypte;break;case EGenreCryptage.Unicode:lChaineDecrypte=lChaineEncrypte;break;case EGenreCryptage.AES:lChaineDecrypte=this.CryptageAES.Decrypter(lChaineEncrypte,lOptions.cle,lOptions.iv,lOptions.enBytes);break;default:;break;}
if(lChaineDecrypte!==''&&lOptions.avecCompression){lChaineDecrypte=window.pako.inflateRaw(lChaineDecrypte,{to:'string'});}
if(lChaineDecrypte!==''){try{lChaineDecrypte=forge.util.decodeUtf8(lChaineDecrypte);} catch(e){lChaineDecrypte='';}}
if(lChaineDecrypte!==''&&lOptions.avecAlea){lChaineDecrypte=this.enleverAlea(lChaineDecrypte);}
if(lOptions.enBytes){const lBuff=new forge.util.ByteBuffer();const lArrInt=lChaineDecrypte.split(',');for(let i=0;i<lArrInt.length;i++){lBuff.putInt(parseInt(lArrInt[i]),8);}
lChaineDecrypte=lBuff;}
return lChaineDecrypte;}
ajouterAlea(AChaine){const N=AChaine.length;const LTableauAvecAlea=[];const LListeCaracteres=this.Minuscules+this.Majuscules+this.Nombres;const C=LListeCaracteres.length;for(let I=0;I<N;I++){LTableauAvecAlea.push(LListeCaracteres.charAt(Math.floor(C*Math.random())));LTableauAvecAlea.push(String(AChaine).charAt(I));}
return LTableauAvecAlea.join('');}
enleverAlea(AChaine){const N=AChaine.length;const LTableauSansAlea=new Array(N);for(let I=0;I<N;I+=1){if(I%2===0){LTableauSansAlea.push(AChaine.charAt(I));}}
return LTableauSansAlea.join('');}
ChiffrementUrl(LChemin,LNomFichier,ACle,ANumeroSession){const LUrlChiffree=this.encrypter({genreCryptage:EGenreCryptage.AES,chaine:LChemin,cle:ACle});return'cheminsecurise'+LUrlChiffree+'/'+LNomFichier+'?Session='+ANumeroSession;}}
module.exports=new ObjetCryptage();},fn:"objetcryptage.js"});;
IE.fModule({f:function(exports,require,module,global){try{window.Document.prototype.loadXML=function(S){const LDocument=(new DOMParser()).parseFromString(S,"text/xml");while(this.hasChildNodes()){this.removeChild(this.lastChild);}
for(let I=0;I<LDocument.childNodes.length;I++){this.appendChild(this.importNode(LDocument.childNodes[I],true));}};} catch(e){}
try{window.Document.prototype.__defineGetter__("xml",function(){return(new XMLSerializer()).serializeToString(this);});} catch(e){}
function getXmlHttp(){try{if(window.XMLHttpRequest){return new XMLHttpRequest();}
if(window.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP");} catch(e){return new ActiveXObject("Microsoft.XMLHTTP");}}} catch(e){throw new Error('XmlHttp> '+e);}}
module.exports=getXmlHttp;},fn:"xmlhttp.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeEtatRequeteAjax={initial:0,preparationEnvoi:1,envoye:2,recu:3,termine:4};module.exports=TypeEtatRequeteAjax;},fn:"typeetatrequeteajax.js"});;
IE.fModule({f:function(exports,require,module,global){const GLog=require('IELog.js');const EGenreIdsRequeteAjax=require('enumere_idsrequeteajax.js');const getXmlHttp=require('XmlHttp.js');const TypeEtatRequeteAjax=require('TypeEtatRequeteAjax.js');class ObjetRequete{constructor(aParametres){this.Parametres={numeroSession:0,asynchrone:true,post:true,nomRequete:'',genreEspace:'',sansBlocageInterface:false,nomDeFonction:'',parametres:'',jsonNonSecurise:null,fichiers:null,callBackReadyStateChange:null,pereReponse:null,evenementReponse:null,messageDetail:'',jsonOrigine:null,echecReseau:false,estBackup:false,dataPOST:null,log:{},numeroRequete:0};$.extend(this.Parametres,aParametres);this.estUneRequete=true;this.etat=TypeEtatRequeteAjax.initial;}
enAttente(){return this.etat===TypeEtatRequeteAjax.preparationEnvoi||this.etat===TypeEtatRequeteAjax.envoye||this.etat===TypeEtatRequeteAjax.recu;}
EnvoieRequete(aParametres){const lParametres=$.extend({numeroOrdre:0,numeroOrdreChiffre:''},aParametres);const lCheminSecurise=this.Parametres.nomRequete+'/'+(this.Parametres.genreEspace||0).toString()+'/'+
this.Parametres.numeroSession+'/'+
lParametres.numeroOrdreChiffre;this.Requete=getXmlHttp();this.Requete.open(this.Parametres.post?'Post':'Get',lCheminSecurise,this.Parametres.asynchrone);this.Requete.onreadystatechange=_OnReadyStateChange.bind(this);this.Requete.setRequestHeader('Content-Type','application/json');let lDataPost=null;if(this.Parametres.post){lDataPost=this.Parametres.estBackup?this.Parametres.dataPOST:_getData.call(this,lParametres.numeroOrdreChiffre);}
this.backupDataJSON=lDataPost;this.Requete.send(lDataPost);this.etat=TypeEtatRequeteAjax.envoye;try{if(GLog.getActifRequete()){let lEstAttente=false;GLog.addRequete({nomRequete:this.Parametres.nomDeFonction,numeroRequete:this.Parametres.numeroRequete,numeroOrdre:lParametres.numeroOrdre,chrono:{xml:'',traitement:this.Parametres.log.tempsChiffre},estReponse:false,estBackup:this.Parametres.estBackup,lgcontenu:this.Parametres.log.tailleDonnees,estPolling:this.Parametres.estPolling,estAttente:lEstAttente});}} catch(e){}}
toString(){return this.Parametres.nomDeFonction;}}
function _getData(aNumeroOrdreChiffre){const lJSON={};lJSON[EGenreIdsRequeteAjax.numeroSession]=parseInt(this.Parametres.numeroSession,10);lJSON[EGenreIdsRequeteAjax.numeroOrdre]=aNumeroOrdreChiffre;lJSON[EGenreIdsRequeteAjax.nomFonction]=this.Parametres.nomDeFonction;lJSON[EGenreIdsRequeteAjax.donneesSecurisee]=this.Parametres.parametres;if(this.Parametres.jsonNonSecurise){lJSON[EGenreIdsRequeteAjax.donneesNonSecurisee]=this.Parametres.jsonNonSecurise;}
if(this.Parametres.echecReseau){lJSON[EGenreIdsRequeteAjax.echecReseau]=true;}
return JSON.stringify(lJSON);}
function _OnReadyStateChange(){if(this.Requete.readyState===4){this.etat=TypeEtatRequeteAjax.recu;if(this.Parametres.callBackReadyStateChange){const lRequeteXmlHttp=this.Requete;delete this.Requete;this.Parametres.callBackReadyStateChange(this,lRequeteXmlHttp.responseText,lRequeteXmlHttp.status);lRequeteXmlHttp.onreadystatechange=null;}}}
module.exports=ObjetRequete;},fn:"objetrequete.js"});;
IE.fModule({f:function(exports,require,module,global){const lHtml=require('_ObjetHtml.js')
;class ObjetHtml_Mobile extends lHtml._ObjetHtml{getPositionElement(aElement){let x=0;let y=0;while(true){x+=aElement.offsetLeft;y+=aElement.offsetTop;if(aElement.offsetParent===null){break;}
aElement=aElement.offsetParent;}
return[x,y];}
composeFondAucuneDonnee(aHtml){return'<div style="width:1px;height:1px;"></div><div class="message-vide card card-nodata"><div class="card-content">'+aHtml+'</div><div class="Image_No_Data"></div></div>';}}
const GHtml=new ObjetHtml_Mobile();lHtml.GHtml=GHtml;Object.assign(module.exports,{ObjetHtml_Mobile:ObjetHtml_Mobile,GHtml:GHtml});},fn:"objethtml_mobile.js"});;
IE.fModule({f:function(exports,require,module,global){if(IE.estMobile){module.exports=require('ObjetHtml_Mobile.js').GHtml;} else{module.exports=require('ObjetHtml_Espace.js').GHtml;}},fn:"ghtml.js"});;
IE.fModule({f:function(exports,require,module,global){require('produit/css/Wai.css');const GUID=require('GUID.js');const GLog=require('IELog.js');const GTraductions=require('ObjetTraduction.js');const EGenreObjet={Aide:1,Tableau:2,AvecValidation:3,BarreOnglets:4,NavigationHorizontal:5,NavigationVertical:6,NavigationHorizontalAvecValidation:7,NavigationVerticalAvecValidation:8,CalendrierNavigation:9,CalendrierPrecedent:10,CalendrierSuivant:11,DetailEvenement:12,TitreDetailEvenement:13,AvecMenuContextuel:16,ItemDesactiver:17,AvecEdition:18,Tabulation:19,Supprimer:20,Fenetre:21,NouvelElement:22,BarreOngletsPrincipal:23,SousOnglets:24,ValidezEvenement:25,RetourDebutFenetre:26,FenetreChoix:27,ObjetSaisieVide:28};const EGenreRole={Application:1,Window:2,Textbox:3,Link:5,Combobox:6,Option:7,Checkbox:8,Radio:10,Radiogroup:11,Button:12,Progressbar:13,Tree:17,Treeitem:19,Presentation:20,Group:21,Grid:22,Tab:24,Tabpanel:25,Tablist:26,Rowheader:30,Columnheader:31,List:32,Listitem:33,Menu:34,Menubar:35,Menuitem:36,Alert:37,Alertdialog:38,Dialog:39,Gridcell:40,Log:41,Marquee:42,Menuitemcheckbox:43,Menuitemradio:44,Scrollbar:45,Slider:46,Spinbutton:47,Status:48,Timer:49,Tooltip:50,Listbox:51,Treegrid:52,Article:53,Definition:54,Directory:55,Document:56,Heading:57,Img:58,Math:59,Note:60,Region:61,Row:62,Separator:63,Toolbar:64,Banner:65,Complementary:66,Contentinfo:67,Form:68,Main:69,Navigation:70,Search:71,Cell:72};const EGenreAttribut={activedescendant:0,atomic:1,autocomplete:2,busy:3,checked:4,controls:5,describedby:6,disabled:7,dropeffect:8,expanded:9,flowto:10,grabbed:11,haspopup:12,hidden:13,invalid:14,label:15,labelledby:16,level:17,live:18,multiline:19,multiselectable:20,orientation:21,owns:22,posinset:23,pressed:24,readonly:25,relevant:26,required:27,selected:28,setsize:29,sort:30,valuemax:31,valuemin:32,valuenow:33,valuetext:34,colindex:35,colspan:36,rowindex:37,rowspan:38};class ObjetWAI{constructor(){this.idMessagesAide=GUID.getId();this.InfoWai=[];this.InfoWai[EGenreObjet.Aide]=GTraductions.getValeur('Navigation.Aide');this.InfoWai[EGenreObjet.Tableau]=GTraductions.getValeur('Navigation.Tableau');this.InfoWai[EGenreObjet.AvecValidation]=GTraductions.getValeur('Navigation.AvecValidation');this.InfoWai[EGenreObjet.BarreOnglets]=GTraductions.getValeur('Navigation.BarreOnglets');this.InfoWai[EGenreObjet.NavigationHorizontal]=GTraductions.getValeur('Navigation.NavigationHorizontal');this.InfoWai[EGenreObjet.NavigationVertical]=GTraductions.getValeur('Navigation.NavigationVertical');this.InfoWai[EGenreObjet.NavigationHorizontalAvecValidation]=GTraductions.getValeur('Navigation.NavigationHorizontalAvecValidation');this.InfoWai[EGenreObjet.NavigationVerticalAvecValidation]=GTraductions.getValeur('Navigation.NavigationVerticalAvecValidation');this.InfoWai[EGenreObjet.CalendrierNavigation]=GTraductions.getValeur('Navigation.CalendrierNavigation');this.InfoWai[EGenreObjet.CalendrierPrecedent]=GTraductions.getValeur('Navigation.CalendrierPrecedent');this.InfoWai[EGenreObjet.CalendrierSuivant]=GTraductions.getValeur('Navigation.CalendrierSuivant');this.InfoWai[EGenreObjet.ValidezEvenement]=GTraductions.getValeur('Navigation.ValidezEvenement');this.InfoWai[EGenreObjet.TitreDetailEvenement]=GTraductions.getValeur('Navigation.TitreDetailEvenement');this.InfoWai[EGenreObjet.ItemDesactiver]=GTraductions.getValeur('Navigation.ItemDesactiver');this.InfoWai[EGenreObjet.AvecEdition]=GTraductions.getValeur('Navigation.AvecEdition');this.InfoWai[EGenreObjet.Tabulation]=GTraductions.getValeur('Navigation.Tabulation');this.InfoWai[EGenreObjet.Supprimer]=GTraductions.getValeur('Navigation.Supprimer');this.InfoWai[EGenreObjet.Fenetre]=GTraductions.getValeur('Navigation.Fenetre');this.InfoWai[EGenreObjet.NouvelElement]=GTraductions.getValeur('Navigation.NouvelElement');this.InfoWai[EGenreObjet.BarreOngletsPrincipal]=GTraductions.getValeur('Navigation.BarreOngletsPrincipal');this.InfoWai[EGenreObjet.SousOnglets]=GTraductions.getValeur('Navigation.SousOnglets');this.InfoWai[EGenreObjet.RetourDebutFenetre]=GTraductions.getValeur('Navigation.RetourDebutFenetre');this.InfoWai[EGenreObjet.FenetreChoix]=GTraductions.getValeur('Navigation.FenetreChoix');this.InfoWai[EGenreObjet.ObjetSaisieVide]=GTraductions.getValeur('Navigation.ObjetSaisieVide');this.WaiRole=[];this.WaiRole[EGenreRole.Window]='window';this.WaiRole[EGenreRole.Alert]='alert';this.WaiRole[EGenreRole.Alertdialog]='alertdialog';this.WaiRole[EGenreRole.Button]='button';this.WaiRole[EGenreRole.Checkbox]='checkbox';this.WaiRole[EGenreRole.Cell]='cell';this.WaiRole[EGenreRole.Dialog]='dialog';this.WaiRole[EGenreRole.Gridcell]='gridcell';this.WaiRole[EGenreRole.Link]='link';this.WaiRole[EGenreRole.Log]='log';this.WaiRole[EGenreRole.Marquee]='marquee';this.WaiRole[EGenreRole.Menuitem]='menuitem';this.WaiRole[EGenreRole.Menuitemcheckbox]='menuitemcheckbox';this.WaiRole[EGenreRole.Menuitemradio]='menuitemradio';this.WaiRole[EGenreRole.Option]='option';this.WaiRole[EGenreRole.Progressbar]='progressbar';this.WaiRole[EGenreRole.Radio]='radio';this.WaiRole[EGenreRole.Scrollbar]='scrollbar';this.WaiRole[EGenreRole.Slider]='slider';this.WaiRole[EGenreRole.Spinbutton]='spinbutton';this.WaiRole[EGenreRole.Status]='status';this.WaiRole[EGenreRole.Tab]='tab';this.WaiRole[EGenreRole.Tabpanel]='tabpanel';this.WaiRole[EGenreRole.Textbox]='textbox';this.WaiRole[EGenreRole.Timer]='timer';this.WaiRole[EGenreRole.Tooltip]='tooltip';this.WaiRole[EGenreRole.Treeitem]='treeitem';this.WaiRole[EGenreRole.Combobox]='combobox';this.WaiRole[EGenreRole.Grid]='grid';this.WaiRole[EGenreRole.Listbox]='listbox';this.WaiRole[EGenreRole.Menu]='menu';this.WaiRole[EGenreRole.Menubar]='menubar';this.WaiRole[EGenreRole.Radiogroup]='radiogroup';this.WaiRole[EGenreRole.Tablist]='tablist';this.WaiRole[EGenreRole.Tree]='tree';this.WaiRole[EGenreRole.Treegrid]='treegrid';this.WaiRole[EGenreRole.Article]='article';this.WaiRole[EGenreRole.Columnheader]='columnheader';this.WaiRole[EGenreRole.Definition]='definition';this.WaiRole[EGenreRole.Directory]='directory';this.WaiRole[EGenreRole.Document]='document';this.WaiRole[EGenreRole.Group]='group';this.WaiRole[EGenreRole.Heading]='heading';this.WaiRole[EGenreRole.Img]='img';this.WaiRole[EGenreRole.List]='list';this.WaiRole[EGenreRole.Listitem]='listitem';this.WaiRole[EGenreRole.Math]='math';this.WaiRole[EGenreRole.Note]='note';this.WaiRole[EGenreRole.Presentation]='presentation';this.WaiRole[EGenreRole.Region]='region';this.WaiRole[EGenreRole.Row]='row';this.WaiRole[EGenreRole.Rowheader]='rowheader';this.WaiRole[EGenreRole.Separator]='separator';this.WaiRole[EGenreRole.Toolbar]='toolbar';this.WaiRole[EGenreRole.Application]='application';this.WaiRole[EGenreRole.Banner]='banner';this.WaiRole[EGenreRole.Complementary]='complementary';this.WaiRole[EGenreRole.Contentinfo]='contentinfo';this.WaiRole[EGenreRole.Form]='form';this.WaiRole[EGenreRole.Main]='main';this.WaiRole[EGenreRole.Navigation]='navigation';this.WaiRole[EGenreRole.Search]='search';this.WaiAttribut=[];this.WaiAttribut[EGenreAttribut.activedescendant]='aria-activedescendant';this.WaiAttribut[EGenreAttribut.atomic]='aria-atomic';this.WaiAttribut[EGenreAttribut.autocomplete]='aria-autocomplete';this.WaiAttribut[EGenreAttribut.busy]='aria-busy';this.WaiAttribut[EGenreAttribut.checked]='aria-checked';this.WaiAttribut[EGenreAttribut.controls]='aria-controls';this.WaiAttribut[EGenreAttribut.describedby]='aria-describedby';this.WaiAttribut[EGenreAttribut.disabled]='aria-disabled';this.WaiAttribut[EGenreAttribut.dropeffect]='aria-dropeffect';this.WaiAttribut[EGenreAttribut.expanded]='aria-expanded';this.WaiAttribut[EGenreAttribut.flowto]='aria-flowto';this.WaiAttribut[EGenreAttribut.grabbed]='aria-grabbed';this.WaiAttribut[EGenreAttribut.haspopup]='aria-haspopup';this.WaiAttribut[EGenreAttribut.hidden]='aria-hidden';this.WaiAttribut[EGenreAttribut.invalid]='aria-invalid';this.WaiAttribut[EGenreAttribut.label]='aria-label';this.WaiAttribut[EGenreAttribut.labelledby]='aria-labelledby';this.WaiAttribut[EGenreAttribut.level]='	aria-level';this.WaiAttribut[EGenreAttribut.live]='aria-live';this.WaiAttribut[EGenreAttribut.multiline]='aria-multiline';this.WaiAttribut[EGenreAttribut.multiselectable]='aria-multiselectable';this.WaiAttribut[EGenreAttribut.orientation]='aria-orientation';this.WaiAttribut[EGenreAttribut.owns]='aria-owns';this.WaiAttribut[EGenreAttribut.posinset]='aria-posinset';this.WaiAttribut[EGenreAttribut.pressed]='aria-pressed';this.WaiAttribut[EGenreAttribut.readonly]='aria-readonly';this.WaiAttribut[EGenreAttribut.relevant]='aria-relevant';this.WaiAttribut[EGenreAttribut.required]='aria-required';this.WaiAttribut[EGenreAttribut.selected]='aria-selected';this.WaiAttribut[EGenreAttribut.setsize]='aria-setsize';this.WaiAttribut[EGenreAttribut.sort]='aria-sort';this.WaiAttribut[EGenreAttribut.valuemax]='aria-valuemax';this.WaiAttribut[EGenreAttribut.valuemin]='aria-valuemin';this.WaiAttribut[EGenreAttribut.valuenow]='aria-valuenow';this.WaiAttribut[EGenreAttribut.valuetext]='aria-valuetext';this.WaiAttribut[EGenreAttribut.colindex]='aria-colindex';this.WaiAttribut[EGenreAttribut.colspan]='aria-colspan';this.WaiAttribut[EGenreAttribut.rowindex]='aria-rowindex';this.WaiAttribut[EGenreAttribut.rowspan]='aria-rowspan';}
getInfo(AEnum){return this.InfoWai[AEnum];}
getRole(AEnum){return'role="'+this.WaiRole[AEnum]+'"';}
getAttribut(aEnum){return this.WaiAttribut[aEnum];}
composeSpanRetour(aId){return'<span tabindex="0" class="wai_hidden" onfocus="'+aId+'.FocusSurPremierElement ()">'+this.getInfo(EGenreObjet.RetourDebutFenetre)+'</span>';}
composeSpan(AParametre,AId){const LId=AId?'id="'+AId+'" tabIndex="-1" ':'';return typeof(AParametre)==='string'?'<span '+LId+'class="wai_hidden">'+AParametre+'</span>':'<span '+LId+'class="wai_hidden">'+this.getInfo(AParametre)+'</span>';}
composeRole(AParametre){return typeof(AParametre)==='string'?'':this.getRole(AParametre);}
composeAttribut(aParametre){if(aParametre.valeur&&typeof(aParametre.valeur)!=='string'){GLog.addLog('ObjetWAI.composeAttribut: mauvais type de parametre '+aParametre.genre+' => '+aParametre.valeur);}
if(!aParametre.valeur||typeof(aParametre.valeur)!=='string'){return'';}
let lValeur=aParametre.valeur.split("'").join("");lValeur=lValeur.split('"').join("");const lAttribute=this.getAttribut(aParametre.genre);return typeof(aParametre.genre)==='string'&&lAttribute?'':' '+lAttribute+'="'+lValeur+'"';}
remplace(AChaine,ACherche,ARemplace){return AChaine.replace(ACherche,ARemplace);}
ajoutePoint(AChaine){return AChaine.trim().substring(AChaine.length-1,AChaine.length)==='.'?AChaine:AChaine+'. ';}
formatHeure(AChaine){let result=AChaine;if(typeof(AChaine)==='string'){const LTemp=AChaine.split(GTraductions.getValeur('date.separateurHeure'));const LHeure=parseInt(LTemp[0]);const LMin=LTemp[1]?parseInt(LTemp[1]):0;result=LHeure+' '+((LHeure===1)?GTraductions.getValeur('WAI.heure'):GTraductions.getValeur('WAI.heures'));if(LMin!==0){result+=' '+(LMin+' '+(LMin===1)?GTraductions.getValeur('WAI.minute'):GTraductions.getValeur('WAI.minutes'));}}
return result;}}
const GObjetWAI=new ObjetWAI();module.exports={GObjetWAI:GObjetWAI,ObjetWAI:ObjetWAI,EGenreObjet:EGenreObjet,EGenreRole:EGenreRole,EGenreAttribut:EGenreAttribut};},fn:"objetwai.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeThemeBouton={primaire:'themeBoutonPrimaire',secondaire:'themeBoutonSecondaire',neutre:'themeBoutonNeutre'};module.exports=TypeThemeBouton;},fn:"type_themebouton.js"});;
IE.fModule({f:function(exports,require,module,global){require('Produit/css/IEHtml.Bouton.css');const IEHtml=require('IEHtml.js');const GLog=require('IELog.js');const GHtml=require('GHtml.js');const ControleSaisieEvenement=require('ControleSaisieEvenement.js');const{GObjetWAI,EGenreRole}=require('ObjetWAI.js');const ToucheClavier=require('ToucheClavier.js');const TypeThemeBouton=require('Type_ThemeBouton.js');const MethodesObjet=require('MethodesObjet.js');const tag=require('tag.js');const u_Dots='...';IEHtml.addBalise('ie-bouton',function(aContexteCourant,aOutils){let lOptions={disabled:false,theme:TypeThemeBouton.secondaire,tailleBordure:null,fontWeight:'',hasDots:false};function _getCss(aSurvol){const lStyle={};let lColor=(lOptions.disabled?lOptions.couleurTexteInactif:aSurvol?lOptions.couleurTexteSurvol:lOptions.couleurTexte)||'';if(lColor){lStyle.color=lColor;}
lColor=(lOptions.disabled?lOptions.couleurFondInactif:aSurvol?lOptions.couleurFondSurvol:lOptions.couleurFond)||'';if(lColor){lStyle.backgroundColor=lColor;}
if(lOptions.tailleBordure>=0&&MethodesObjet.isNumber(lOptions.tailleBordure)){lStyle.borderWidth=lOptions.tailleBordure+'px';}
lColor=(lOptions.disabled?lOptions.couleurBordureInactif:aSurvol?lOptions.couleurBordureSurvol:lOptions.couleurBordure)||'';if(lColor){lStyle.borderColor=lColor;}
return lStyle;}
function _estToucheValider(aNumeroTouche){return aNumeroTouche===ToucheClavier.Espace||aNumeroTouche===ToucheClavier.RetourChariot;}
let lInnerHtml=aContexteCourant.node.innerHTML;const lInnerHtmlInitial=lInnerHtml;const lBouton=GHtml.htmlToDOM('<button '+GObjetWAI.composeRole(EGenreRole.Button)+'>'+'</button>');const lJBouton=$(lBouton);if(lInnerHtml===u_Dots){lOptions.hasDots=true;}
if($(aContexteCourant.node).hasClass(TypeThemeBouton.primaire)){lOptions.theme=TypeThemeBouton.primaire;}
const lImage=aContexteCourant.node.getAttribute('ie-image')||'';if(lImage){aContexteCourant.node.removeAttribute('ie-image');}
const lImageIcon=aContexteCourant.node.getAttribute('ie-icon')||'';if(lImageIcon){aContexteCourant.node.removeAttribute('ie-icon');}
const lIconSize=aContexteCourant.node.getAttribute('ie-iconsize')||'';if(lIconSize){aContexteCourant.node.removeAttribute('ie-iconsize');}
const lEstBoutonCarre=$(aContexteCourant.node).hasClass('bouton-carre');if(lEstBoutonCarre){let lWidthDefaut=0;if(aContexteCourant.node.style.width){const lWidth=Math.round($(aContexteCourant.node).innerWidth());if(lWidth>0){lWidthDefaut=Math.max(10,lWidth-2-2);}}
lOptions=Object.assign(lOptions,{theme:TypeThemeBouton.neutre,widthBoutonImage:lWidthDefaut,heightTexteBoutonImage:0,heightImageBoutonImage:0});}
let lDisabled=false;const lModele=aOutils.getModel(aContexteCourant);let lInfosGetLibelle;if(lModele&&aContexteCourant.data.$modeleParsed){const lInfosEvent=aOutils.getAccesParametresModel('event',aContexteCourant),lInfosGetDisabled=aOutils.getAccesParametresModel('getDisabled',aContexteCourant),lInfosGetOptions=aOutils.getAccesParametresModel('getOptions',aContexteCourant);lInfosGetLibelle=aOutils.getAccesParametresModel('getLibelle',aContexteCourant);const lAvecControleSaisie=aOutils.getControleSaisieEvent(aContexteCourant);let lKeyUpValiderAIgnorer=false;if(lInfosEvent.estFonction){const lRefresh=aContexteCourant.contexte.refresh;lJBouton.eventValidation(function(aEvent){if(lOptions.disabled){return;}
if(aEvent.type==='keyup'){if(lKeyUpValiderAIgnorer){lKeyUpValiderAIgnorer=false;return;}}
const lAction=function(){const lResult=lInfosEvent.callback([aEvent,this,aContexteCourant.data]);lRefresh();return lResult;};if(lAvecControleSaisie){ControleSaisieEvenement(lAction);} else{return lAction();}}).on({'focusin':function(){if(window.GNavigateur&&
window.GNavigateur.ShiftTouche!==null){lKeyUpValiderAIgnorer=_estToucheValider(window.GNavigateur.CodeTouche);if(lKeyUpValiderAIgnorer){$(window).off('keydown.IEHTMLBoutonKeyupAIgnorer').one('keydown.IEHTMLBoutonKeyupAIgnorer',function(){lKeyUpValiderAIgnorer=false;});}}},'focusout':function(){lKeyUpValiderAIgnorer=false;}});}
if(lInfosGetDisabled.valide){const lGetter=function(){return!!lInfosGetDisabled.callback([lBouton,aContexteCourant.data]);};if(lInfosGetDisabled.estFonction||!lGetter()||lGetter()===true){lDisabled=!!lGetter();aOutils.abonnerRefresh(function(){const lDisabled=!!lGetter();if(lDisabled!==lOptions.disabled){lOptions.disabled=lDisabled;$(lBouton).inputDisabled(lDisabled);}},lBouton,aContexteCourant);} else{GLog.addLog('echec getDisabled de ie-bouton, propriété incorrecte du model "'+lModele+'"');}}
if(lInfosGetOptions.estFonction){const lOptionsPerso=lInfosGetOptions.callback([lBouton,aContexteCourant.data]);if(lOptionsPerso){Object.assign(lOptions,lOptionsPerso);}}
aOutils.surNodeEtNodeAfter(aContexteCourant);aContexteCourant.invocateurNode.abonner(aOutils.nomInvocRefresh,function(aParams){if(aParams.refreshHtml){const lHasDots=aParams.html===u_Dots;if(lOptions.hasDots!==lHasDots){lOptions.hasDots=lHasDots;if(lOptions.hasDots){lJBouton.addClass('has-dots');} else{lJBouton.removeClass('has-dots');}}}});}
aOutils.copyAttributs(aContexteCourant.node,lBouton,function(aName){switch(aName){case'disabled':lDisabled=true;break;}});let lClassDefaut='';if(!lBouton.style.height&&!lImage&&!lImageIcon){lClassDefaut=' ieBoutonDefautSansImage';}
switch(lOptions.theme){case TypeThemeBouton.primaire:if(!lJBouton.hasClass(TypeThemeBouton.secondaire)&&!lJBouton.hasClass(TypeThemeBouton.neutre)){lJBouton.addClass(TypeThemeBouton.primaire);}
break;case TypeThemeBouton.neutre:if(!lJBouton.hasClass(TypeThemeBouton.secondaire)&&!lJBouton.hasClass(TypeThemeBouton.primaire)){lJBouton.addClass(TypeThemeBouton.neutre);}
break;}
if(!lDisabled&&lOptions.disabled){lJBouton.attr('disabled','');} else if(lDisabled){$(lBouton).inputDisabled(true);}
lOptions.disabled=lDisabled;const lCss={'font-weight':lOptions.fontWeight};let lWrapperHtml;if(lImage||lImageIcon){lWrapperHtml=function(aHtml){return'<div ie-ellipsis-multiline>'+aHtml+'</div>';};const lHtmlImage=lImage?'<div class="'+lImage+'"'+(lOptions.disabled?' disabled="disabled"':'')+'></div>':'<i class="ieBoutonIcon '+lImageIcon+'"'+(lOptions.disabled?' disabled="disabled"':'')+(lIconSize?' style="font-size:'+lIconSize+'"':'')+'></i>';if(lEstBoutonCarre){lInnerHtml=['<div class="ieBtnContImg-img">',lHtmlImage,'</div>','<div class="ieBtnContImg-texte">',lWrapperHtml(lInnerHtml),'</div>'
].join('');lCss.padding=1;} else{lInnerHtml=tag('div',{class:'ieBtnContImg-img'},lHtmlImage+tag('div',{'ie-ellipsis':aContexteCourant.node.hasAttribute('ie-ellipsis')},lInnerHtml));}}
if(lOptions.minWidth>0){lCss['min-width']=lOptions.minWidth+'px';}
let lClasse='ieBouton ';if(!IE.optionsDebug||!IE.optionsDebug.design2021){lClasse=(lOptions.hasDots?'has-dots ':'')+lClasse;}
if(IE.estMobile){lClasse+=' waves-effect waves-light ';} else{if(IE.optionsDebug&&IE.optionsDebug.design2021){lClasse+='Texte10 OmbreFocus';}}
lJBouton.css(Object.assign(lCss,_getCss())).addClass(lClasse+' NoWrap'+lClassDefaut).on({mouseout:function(){if(window.GNavigateur&&window.GNavigateur.isTactile){return;}
if(lOptions.disabled){return;}
$(this).css(_getCss(false));},mouseover:function(){if(window.GNavigateur&&window.GNavigateur.isTactile){return;}
if(lOptions.disabled){return;}
$(this).css(_getCss(true));},IEDisabled:function(){const lJThis=$(this);lOptions.disabled=lJThis.is(':disabled');if(lOptions.disabled){lJThis.removeClass('AvecMain');} else{lJThis.addClass('AvecMain');}
lJThis.css(_getCss());}});const lRacine=lJBouton.get(0);aOutils.replaceNode(aContexteCourant.node,lRacine);aContexteCourant.node=lJBouton.get(0);if(lInnerHtml){aOutils.injectHTML({element:lRacine,html:lInnerHtml,controleur:aContexteCourant.controleur,ignorerScroll:true,contexte:aContexteCourant.contexte});}
if(lImage||lImageIcon){if(lEstBoutonCarre){aContexteCourant.nodeTransfertContenuDynamique=$(aContexteCourant.node).find('>.ieBtnContImg-texte').get(0);} else{aContexteCourant.nodeTransfertContenuDynamique=$(aContexteCourant.node).find('>.ieBtnContImg-img>:not(:first-child)').get(0);}}
if(lInfosGetLibelle&&lInfosGetLibelle.estFonction){aOutils.addGetterHtml(aContexteCourant,lInfosGetLibelle,lWrapperHtml);}
aOutils.addCommentaireDebug(lRacine,'ie-bouton'+(lImage?' ie-image="'+lImage+'"':'')+(lImageIcon?' ie-icon="'+lImageIcon+'"':'')+(lIconSize?' ie-iconsize="'+lIconSize+'"':''));return{node:aContexteCourant.node,avecCompileFils:false};});module.exports=IEHtml;},fn:"iehtml.bouton.js"});;
IE.fModule({f:function(exports,require,module,global){const UtilitaireMenuContextuelNatif={desactiverSurElement(aJElement){if(IE.estMobile||!aJElement||!aJElement.length){return;}
return aJElement.off('contextmenu.AvecMenuContextuel1 contextmenu.AvecMenuContextuel2').on('contextmenu.AvecMenuContextuel1',UtilitaireMenuContextuelNatif.accepter).on({'contextmenu.AvecMenuContextuel2':function(event){event.originalEvent.__marqueurAutoriserMenuContextuel=true;return true;}},'.AvecMenuContextuel');},accepter(aEvent){if(aEvent.type!=='contextmenu'){return false;}
const lName=aEvent.target&&aEvent.target.tagName?aEvent.target.tagName.toLowerCase():'';let lType=aEvent.target.type||'';lType=lType.toLowerCase();const lInputConcerne=(lName==='input'&&lType!=='checkbox'&&lType!=='radio'&&lType!=='button')||(lName==='textarea');return(lInputConcerne&&!$(aEvent.target).hasClass('SansMenuContextuel'))||(aEvent.originalEvent&&aEvent.originalEvent.__marqueurAutoriserMenuContextuel===true)||$(aEvent.target).hasClass('AvecMenuContextuel');}};module.exports=UtilitaireMenuContextuelNatif;},fn:"utilitairemenucontextuelnatif.js"});;
IE.fModule({f:function(exports,require,module,global){const GLog=require('IELog.js');const GHtml=require('_ObjetHtml.js').GHtml;const{Invocateur}=require('Invocateur.js');const UtilitaireMenuContextuelNatif=require('UtilitaireMenuContextuelNatif.js');const ZoneFenetre={idZoneFenetre:"zone_fenetre"};ZoneFenetre.getElementZoneFenetre=function(){const lId=ZoneFenetre.idZoneFenetre;let lElement=GHtml.getElement(lId);if(!GHtml.estElement(lElement)){lElement=GHtml.htmlToDOM('<div id="'+lId+'" class="NePasImprimer"></div>');const lDivFrere=window.GApplication&&window.GApplication.getIdConteneur?GHtml.getElement(GApplication.getIdConteneur()):null;if(lDivFrere&&lDivFrere.parentNode){lDivFrere.parentNode.insertBefore(lElement,lDivFrere);} else{document.body.appendChild(lElement);}
Invocateur.evenement('creationZoneFenetre',lElement);UtilitaireMenuContextuelNatif.desactiverSurElement($(lElement));}
return lElement;};ZoneFenetre.ajouterFenetre=function(aId,aZIndex){if(GHtml.elementExiste(aId)){ZoneFenetre.enleverFenetre(aId);GLog.addLog('ZoneFenetre.ajouterFenetre : la fenetre '+aId+' existe déjà!');}
const lZIndex=aZIndex===0?0:(aZIndex||1100);GHtml.addHtml(ZoneFenetre.getElementZoneFenetre(),'<div class="zone-fenetre" id="'+aId+'" style="display:none;'+(lZIndex?'z-index:'+lZIndex:'')+'"></div>');};ZoneFenetre.enleverFenetre=function(aId){const lElement=GHtml.getElement(aId);if(GHtml.estElement(lElement)&&lElement.parentNode&&(lElement.parentNode.id===ZoneFenetre.idZoneFenetre)){$(lElement).remove();} else{GLog.addLog('erreur enleverFenetre de '+aId);}};ZoneFenetre.etendreEnFenetre=function(aClass,aParam){if(!aClass||!aClass.prototype){return;}
const lParam=Object.assign({zIndex:1000},aParam);aClass.prototype.__estFenetreVolante=true;aClass.prototype.getZIndex=function(){return lParam.zIndex;};aClass.prototype.avecEventResizeNavigateur=function(){return false;};};module.exports=ZoneFenetre;},fn:"iezonefenetre.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeEtatUpload={TEU_Inconnu:0,TEU_Reussi:1,TEU_Erreur:2,TEU_EnCours:3};module.exports.TypeEtatUpload=TypeEtatUpload;},fn:"typeetatupload.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationJQueryFileUpload.js');const IEHtml=require('IEHtml.js');const GUID=require('GUID.js');const GLog=require('IELog.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');require('IEHtml.Bouton.js');const ZoneFenetre=require('IEZoneFenetre.js');const ObjetListeElements=require('ObjetListeElements.js');const GTraductions=require('ObjetTraduction.js');const TypeEtatUpload=require('TypeEtatUpload.js').TypeEtatUpload;const TypeEtatRequeteAjax=require('TypeEtatRequeteAjax.js');const uIdInputFile=GUID.getId();let uIdFichier=0;class ObjetRequeteUploadFile{constructor(aParametres){this.estUneRequete=false;this.estUploadFile=true;this.etat=TypeEtatRequeteAjax.initial;this.donnees=Object.assign({listeFichiers:null,maxChunkSize:100*1024,messageEchec:GTraductions.getValeur('inputFile.echecEnvoi'),callbackDone:null,callback:null,callbackEach:null,getFormData:null,getUrl:null,callbackInterrupt:null,moduleMD5:null},aParametres);this.progression={requete:this,listeFichiersEnAttente:this.donnees.listeFichiers.getListeElements(),nbReussi:0,error:null};}
estVide(){return!this.donnees||!this.donnees.listeFichiers||!this.donnees.listeFichiers.GetNbrElements||this.donnees.listeFichiers.GetNbrElements()===0;}
envoiRequete(aParams){this.etat=TypeEtatRequeteAjax.envoye;Object.assign(this.donnees,aParams);ZoneFenetre.ajouterFenetre(uIdInputFile,-1);const lSelf=this;let lParams=null;if(this.donnees.callbackInterrupt){lParams={htmlPied:'<ie-bouton ie-model="btnInterrupt">'+GTraductions.getValeur('inputFile.AnnulerLEnvoi')+'</ie-bouton>',controleur:{btnInterrupt:{event:function(){if(lSelf.progression.jqXHR){lSelf.progression.jqXHR.abort();}},getDisabled:function(){return!(lSelf.progression&&lSelf.progression.jqXHR);}}}};}
Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{emission:true,upload:true,nombreFichiers:this.donnees.listeFichiers.GetNbrElementsExistes(),init:true,params:lParams});_sendNextFile.call(this);}
enAttente(){return this.etat===TypeEtatRequeteAjax.preparationEnvoi||this.etat===TypeEtatRequeteAjax.envoye||this.etat===TypeEtatRequeteAjax.recu;}}
function _eventAjaxIOProgression(aParams){Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{emission:true,upload:true,message:aParams.message||GTraductions.getValeur('requete.transfertPJ'),nombreFichiers:this.donnees.listeFichiers.GetNbrElementsExistes(),ignorerBlocageClavier:true,progress:{personnalise:true,actualFile:this.progression.nbReussi+1,percent:aParams.pourcent||0,md5:aParams.md5||false}});}
function _send(aFichier,aMD5){return new Promise(function(aResolve){_eventAjaxIOProgression.call(this,{});if(!aFichier.idFichier){uIdFichier+=1;aFichier.idFichier='reqUpl_'+uIdFichier+'_'+Date.now()
;}
this.progression.json=null;const lJFile=$('#'+uIdInputFile);const lFormData=this.donnees.getFormData(aFichier)||{};if(aMD5){lFormData.MD5=aMD5;}
lJFile.append('<input type="file" style="position:absolute;top:-100px;left:-100px;width:0px;height:0px;opacity:0;" />').fileupload({url:this.donnees.getUrl(),dataType:'json',formData:lFormData,autoUpload:true,maxChunkSize:this.donnees.maxChunkSize,done:function(aEvent,aData){if(aData.result&&$.isNumeric(aData.result.etat)){this.progression.json=aData.result;if(aData.result.etat===TypeEtatUpload.TEU_Reussi){aData.reussite=true;this.progression.nbReussi+=1;} else{this.progression.error={message:aData.result.message};}} else{this.progression.error={};}}.bind(this),fail:function(aEvent,aData){if(aData.jqXHR&&aData.jqXHR.statusText==='abort'&&aData.jqXHR.status===0){this.progression.error={abort:true,message:GTraductions.getValeur('inputFile.msgEnvoiFichierAnnule')};} else{this.progression.error={fail:true};}
const lResponse=aData.response();if(lResponse&&lResponse.jqXHR&&lResponse.jqXHR.responseJSON){this.progression.json=lResponse.jqXHR.responseJSON;if(this.progression.json&&this.progression.json.message){this.progression.error.message=this.progression.json.message;}}}.bind(this),always:function(){aResolve(aFichier);}.bind(this),progressall:function(e,aData){const lProgressBar=Math.round(aData.loaded/aData.total*100);_eventAjaxIOProgression.call(this,{pourcent:lProgressBar});}.bind(this)});this.progression.jqXHR=lJFile.fileupload('send',{files:aFichier.file});IEHtml.refresh();}.bind(this));}
function _debloquerPatience(){Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{emission:false,upload:true,debloquerForcer:true});}
function _doneFile(aFichier){this.progression.jqXHR=null;IEHtml.refresh();let lErreurSession=null;const lSurAnnulationUpload=this.progression.error&&this.progression.error.abort;if(!lSurAnnulationUpload&&this.donnees.callbackEach){lErreurSession=this.donnees.callbackEach(this.progression.json);}
if(lErreurSession){this.progression.error={};}
if(this.progression.error){this.progression.listeFichiersEnAttente=new ObjetListeElements();_debloquerPatience();if(lSurAnnulationUpload&&!lErreurSession&&this.donnees.callbackInterrupt){this.donnees.callbackInterrupt();}
Promise.resolve().then(function(){if(!lErreurSession){return GApplication.getMessage().afficher({titre:this.progression.error.titre||'',message:this.progression.error.message||this.donnees.messageEchec});}}.bind(this)).then(function(){_doneAll.call(this,lErreurSession);}.bind(this));} else{_sendNextFile.call(this);}}
function _doneAll(aErreurSession){ZoneFenetre.enleverFenetre(uIdInputFile);this.etat=TypeEtatRequeteAjax.recu;_debloquerPatience();let lErreurSession=aErreurSession;if(this.progression&&
this.progression.error&&
this.progression.json&&
this.progression.json.Erreur){lErreurSession=this.progression.json.Erreur;}
if(this.donnees.callbackDone){this.donnees.callbackDone({requete:this,progression:this.progression,erreurSession:lErreurSession,callback:this.donnees.callback});}
if(this.donnees.callback){this.donnees.callback(this.progression);}
IEHtml.refresh();}
function _sendNextFile(){if(this.progression.listeFichiersEnAttente.GetNbrElements()>0){const lFichier=this.progression.listeFichiersEnAttente.GetElement(0);this.progression.listeFichiersEnAttente.remove(0);let lPromise=null;if(this.donnees.moduleMD5&&this.donnees.moduleMD5.calculMD5){lPromise=this.donnees.moduleMD5.calculMD5({instance:this,fichier:lFichier,eventAjaxIOProgression:_eventAjaxIOProgression});}
return Promise.resolve(lPromise).then(function(aMD5){return _send.call(this,lFichier,aMD5);}.bind(this),function(){GLog.addLog('Echec calcul md5 (erreur ou fichier trop gros)');return _send.call(this,lFichier,'');}.bind(this)).catch(function(aErreur){this.progression.error={abort:true,message:GTraductions.getValeur('inputFile.msgEnvoiFichierAnnule')};}.bind(this)).then(function(){return _doneFile.call(this,lFichier);}.bind(this));} else{_doneAll.call(this);}}
module.exports=ObjetRequeteUploadFile;},fn:"objetrequeteuploadfile.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationForge.js');const GLog=require('IELog.js');const GTraductions=require('ObjetTraduction.js');function _toBinaryString(aParams){return new Promise(function(aResolve){const lChunk=100*1024;if(aParams.start>=aParams.bytes.length){aParams.done=true;} else{aParams.tabResult.push(String.fromCharCode.apply(null,aParams.bytes.slice(aParams.start,aParams.start+lChunk)));}
aParams.eventAjaxIOProgression.call(aParams.instance,{message:GTraductions.getValeur('inputFile.msgPreparationFichier'),pourcent:Math.round((aParams.compteur*lChunk)/(aParams.bytes.length*100*1024)),md5:true});aParams.start+=lChunk;aParams.compteur+=1;setTimeout(function(){aResolve(aParams);},0);});}
function _toBinaryStringPromise(aParams){return _toBinaryString(aParams).then(function(){if(!aParams.done){return _toBinaryStringPromise(aParams);}});}
module.exports={calculMD5:function(aParams){const lParams=Object.assign({instance:null,fichier:null,eventAjaxIOProgression:null,maxSizePourMD5:30*1024*1024},aParams);return new Promise(function(aResolve,aReject){if(!window.FileReader||!window.Uint8Array){GLog.addLog('FileReader ou Uint8Array non supporté => pas de controle de MD5');aReject();return;}
if(lParams.fichier.file.size>lParams.maxSizePourMD5){GLog.addLog('Fichier trop gros pur calculer le MD5');aReject();return;}
try{lParams.eventAjaxIOProgression.call(lParams.instance,{message:GTraductions.getValeur('inputFile.msgPreparationFichier')});const lReader=new FileReader();lReader.onload=function(){try{const lParamsReader=Object.assign({bytes:new Uint8Array(lReader.result),tabResult:[],start:0,compteur:0},lParams);if(!lParamsReader.bytes.slice){lParamsReader.bytes=Array.from(lParamsReader.bytes);}
_toBinaryStringPromise(lParamsReader).then(function(){let lMd5='';if(lParamsReader.done){lMd5=forge.md.md5.create().update(lParamsReader.tabResult.join('')).digest().toHex();}
aResolve(lMd5);},function(){aReject();});} catch(e){}}.bind(lParams.instance);lReader.onError=function(){aReject();}.bind(lParams.instance);lReader.readAsArrayBuffer(lParams.fichier.file);} catch(e){aReject();}}.bind(lParams.instance));}};},fn:"modulemd5_requeteuploadfile.js"});;
IE.fModule({f:function(exports,require,module,global){require('divers.js');require('DeclarationForge.js');const GLog=require('IELog.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const MethodesObjet=require('MethodesObjet.js');const GChaine=require('GChaine.js');const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const EGenreCryptage=require('Enumere_Cryptage.js');const EGenreIdsRequeteAjax=require('enumere_idsrequeteajax.js');const GCryptage=require('ObjetCryptage.js');const ObjetRequete=require('ObjetRequete.js');const GTraductions=require('ObjetTraduction.js');const ObjetJSON=require('ObjetJSON.js');const Requetes=require('CollectionRequetes.js');const ObjetRequeteUploadFile=require('ObjetRequeteUploadFile.js');const EGenreEtat=require('Enumere_Etat.js');const ObjetListeElements=require('ObjetListeElements.js');const TypeEtatRequeteAjax=require('TypeEtatRequeteAjax.js');const ModuleMD5_RequeteUploadFile=require('ModuleMD5_RequeteUploadFile.js');Requetes.inscrire('annulation',ObjetRequeteConsultation);class _ObjetCommunication{constructor(AGenreEspace,aNumeroSession){this._attenteEnCours=false;this.FDureeEnCours=1000*0.5;this._dureeTimerPresence=_ObjetCommunication.cDureeTimerPresence;this.GenreEspace=AGenreEspace;this.NomRequete='appelfonction';this.pileRequetes=[];this.compteurRequete=0;this.NumeroDeSession=aNumeroSession?aNumeroSession:0;this.NumeroOrdreCommunication=1;this.cleAES=new forge.util.ByteBuffer();this.ivAES=new forge.util.ByteBuffer();this.ivAESTemp=new forge.util.ByteBuffer(forge.random.generate(16));let lNom='GCommunication';this.getNom=function(){return lNom;};this.setNom=function(aNom){lNom=aNom;};this.backupAjax={nbBackupEchec:20,delaiTimeoutEchecReseau:30*60*1000,delaiRepetitionEchecReseau:3*1000};this.polling={nbRequetes:0,numeroOrdre:1,nbRepetitionEchecReseau:15,delaiRepetitionEchecReseau:3000,delaiTimeoutEchecReseau:30*60*1000,delaiTimeoutRequete:10*60*1000};Invocateur.abonner(ObjetInvocateur.events.modificationPresenceUtilisateur,_modificationPresenceUtilisateur,this);Invocateur.abonner(ObjetInvocateur.events.interruption_Requete,_eventInterruptionRequete,this);Invocateur.abonner(ObjetInvocateur.events.modification_RequeteAttente,_eventModificationRequeteAttente,this);window.addEventListener('unload',_requeteBeaconDeconnexion.bind(this));}
arreter(){_requeteBeaconDeconnexion.call(this);clearTimeout(this._timeoutRequeteBackup);this.estArrete=true;Invocateur.desabonner(this);this.desactiverPresence();delete this.ivAES;delete this.cleAES;delete this.NumeroOrdreCommunication;}
setIvAES(){this.ivAES=this.ivAESTemp;delete(this.ivAESTemp);}
appel_fonction_asynchrone_xml(aParametres){if(this.estArrete){return;}
const lParametresAppel={nom:'',json:{},callbackPere:null,callbackEvenement:null,requetePrioritaire:false,sansBlocageInterface:false,messageDetail:'',estBackup:false,backupDataJSON:null};$.extend(lParametresAppel,aParametres)
;let lRequeteUpload=null;const lParamsRequete={numeroSession:this.NumeroDeSession,numeroRequete:this.compteurRequete,nomRequete:this.NomRequete,genreEspace:this.GenreEspace,sansBlocageInterface:lParametresAppel.sansBlocageInterface===true,nomDeFonction:lParametresAppel.nom,callBackReadyStateChange:_evenementSurReponseRequete.bind(this,lParametresAppel),pereReponse:lParametresAppel.callbackPere,evenementReponse:lParametresAppel.callbackEvenement,messageDetail:lParametresAppel.messageDetail,log:{tailleDonnees:'',tempsChiffre:''}};if(!lParametresAppel.estBackup){const lJSONCollection={};lParametresAppel.json=ObjetJSON.preparerJSON(lParametresAppel.json,{JSONCollection:lJSONCollection});if(lParametresAppel.paramsUpload&&lParametresAppel.paramsUpload.listeFichiers){lRequeteUpload=_factoryRequeteUploadFile.call(this,Object.assign({nomRequete:lParametresAppel.nom},lParametresAppel.paramsUpload));if(!lRequeteUpload.estVide()){this.pileRequetes.push(lRequeteUpload);_envoieRequete.call(this);} else{lRequeteUpload=null;}}
const lResultJSON=_traiterJSONEnvoi.call(this,lParametresAppel.json);Object.assign(lParamsRequete,{parametres:lResultJSON.JSON,jsonOrigine:lParametresAppel.json,jsonNonSecurise:$.isEmptyObject(lJSONCollection)?null:lJSONCollection,log:{tailleDonnees:lResultJSON.JSONStr_clair.length,tempsChiffre:lResultJSON.chronoStr}});} else{Object.assign(lParamsRequete,{estBackup:true,dataPOST:lParametresAppel.backupDataJSON});}
const lRequete=new ObjetRequete(lParamsRequete)
;if(lParametresAppel.estBackup){this.pileRequetes.splice(0,0,lRequete);} else if(lParametresAppel.requetePrioritaire&&!lRequeteUpload){this.pileRequetes.splice(1,0,lRequete);} else{this.pileRequetes.push(lRequete)
;}
this.compteurRequete+=1;if(lRequeteUpload){lRequeteUpload.requeteSaisieApresUpload=lRequete;}
_envoieRequete.call(this);return lRequete;}
setMAJServeurEnCours(aMAJEnCours){this._MAJServeurEnCours=aMAJEnCours;if(this._requetePresenceActive){_requetePresenceDelai.call(this);}}
activerPresence(){this._requetePresenceActive=true;_requetePresenceDelai.bind(this)();_envoiRequetePolling.call(this);}
desactiverPresence(){this._requetePresenceActive=false;window.clearTimeout(this.timerPresence);}
setDureeTimerPresence(aDureeMs){this._dureeTimerPresence=aDureeMs;if(this._requetePresenceActive){_requetePresenceDelai.call(this);}}
requeteEnCours(){return(this.pileRequetes[0]&&this.pileRequetes[0].enAttente())||this._attenteEnCours;}
composeUrlFichier(aPrefix,aNomFichier,aParam){let lResult='';if(aPrefix!==''){lResult+=aPrefix+'/';}
lResult+=this.getChaineChiffreeAES(JSON.stringify(aParam&&aParam.toJSONAll?aParam.toJSONAll():aParam));lResult+='/'+aNomFichier;lResult+='?Session='+this.NumeroDeSession;if((aParam.miniature!==null)&&(aParam.miniature!==undefined)){lResult+='&miniature='+aParam.miniature;}
return lResult;}
composeUrlFichierExterne(aNomFichier,aParam){return this.composeUrlFichier('FichiersExternes',GChaine.enleverEntites(aNomFichier),aParam);}
getChaineChiffreeAES(aChaine){return GCryptage.encrypter({genreCryptage:EGenreCryptage.AES,chaine:aChaine,cle:this.cleAES,iv:this.ivAES});}
sendLogClient(aMessage){if(aMessage&&navigator&&navigator.sendBeacon){try{navigator.sendBeacon('LogClientLeger',ObjetJSON.toJSON({ns:parseInt(this.NumeroDeSession,10),msg:aMessage}));} catch(e){}}}
startPolling(){_envoiRequetePolling.call(this);}}
Invocateur.abonner(ObjetInvocateur.events.initChiffrement,(aParam) =>{const lOptionsSecurite={};if(aParam.sCrA){lOptionsSecurite.sansCryptageAES=true;}
if(aParam.sCoA){lOptionsSecurite.sansCompressionAES=true;}
if(aParam.poll){lOptionsSecurite.avecPollingActif=true;}
_ObjetCommunication.optionsSecurite=lOptionsSecurite;});_ObjetCommunication.optionsSecurite={};_ObjetCommunication.cDureeTimerPresence=2*60*1000;_ObjetCommunication.cDureeTimerPresenceMAJServeurEnCours=20*1000;const _pileTimerEnAttente={};function _traiterJSONEnvoi(aJSON){const lResult={JSON:aJSON,JSONStr_clair:'',chronoStr:''};if(!aJSON){return lResult;}
const lSecurise=!_ObjetCommunication.optionsSecurite.sansCryptageAES;let lChrono;if(lSecurise){if(GLog&&GLog.getActifRequete&&GLog.getActifRequete()){lChrono=new(require('Chronometre.js'))();}
lResult.JSONStr_clair=JSON.stringify(lResult.JSON)||'';lResult.JSON=GCryptage.encrypter({genreCryptage:lSecurise?EGenreCryptage.AES:EGenreCryptage.Unicode,chaine:lResult.JSONStr_clair,cle:this.cleAES,iv:lSecurise?this.ivAES:null,avecCompression:lSecurise&&!_ObjetCommunication.optionsSecurite.sansCompressionAES});if(lChrono){lResult.chronoStr=lChrono.toString();}}
return lResult;}
function _factoryRequeteUploadFile(aDonnees){const lDonnees=Object.assign({listeFichiers:null,moduleMD5:ModuleMD5_RequeteUploadFile,filtreFichiers:function(D){return!!D&&((D.Etat===EGenreEtat.Creation)||(D.Etat===EGenreEtat.Modification))&&D.Existe()&&D.idFichier!== -1&&D.idFichier!==undefined&&D.file;},getFormData:function(aFichier){return{'numeroOrdre':this.getChaineChiffreeAES(this.NumeroOrdreCommunication),'numeroSession':this.NumeroDeSession,'nomRequete':lDonnees.nomRequete,'idFichier':aFichier.idFichier};}.bind(this),getUrl:function(){return GChaine.Format('%s/%s/%s',['uploadfilesession',this.GenreEspace,this.NumeroDeSession]);}.bind(this),callbackInterrupt:function(){Requetes('annulation',{}).setOptions({requetePrioritaire:true}).lancerRequete({annulationUpload:true});},callbackEach:function(aJSON){let lNumeroOrdre=null;try{if(aJSON&&aJSON.numeroOrdre){lNumeroOrdre=parseInt(GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:aJSON.numeroOrdre,cle:this.cleAES,iv:this.ivAES}),10);}} catch(e){}
if(lNumeroOrdre!==this.NumeroOrdreCommunication+1){return _getErreurConnexionInterrompue();} else{this.NumeroOrdreCommunication+=2;}
return null;}.bind(this),callbackDone:function(aParams){if(aParams.erreurSession){_composePageErreur.call(this,aParams.erreurSession);return;}
if(aParams.requete&&aParams.requete.requeteSaisieApresUpload&&aParams.requete.requeteSaisieApresUpload.etat===TypeEtatRequeteAjax.initial&&aParams.progression.error&&(aParams.requete.donnees.annulerSurErreurUpload||(aParams.progression.error.abort&&aParams.requete.donnees.annulerSurAbortUpload))){aParams.requete.requeteSaisieApresUpload.estRequeteAnnulee=true;}
if(aParams.requete.estUploadFile&&aParams.requete.enAttente()){_setRequeteEtatTermine.call(this,aParams.requete);} else{}
if(!_ObjetCommunication.optionsSecurite.avecPollingActif){this.activerPresence();}
_envoieRequete.call(this);}.bind(this)},aDonnees);const lListe=new ObjetListeElements();if(lDonnees.listeFichiers&&lDonnees.listeFichiers.parcourir){lDonnees.listeFichiers.parcourir((D) =>{if(lDonnees.filtreFichiers&&lDonnees.filtreFichiers(D)){const lElement=MethodesObjet.dupliquer(D);lElement.file=D.file;lListe.AddElement(lElement);D.idFichier= -1;}});}
lDonnees.listeFichiers=lListe;return new ObjetRequeteUploadFile(lDonnees);}
function _envoieRequete(){clearTimeout(this._timeoutRequeteBackup);const lRequete=this.pileRequetes[0];if(!lRequete){return;}
if(lRequete.estRequeteAnnulee&&!lRequete.enAttente()){_surReception.call(this,lRequete,null,true);return;}
if(!lRequete.enAttente()){lRequete.etat=TypeEtatRequeteAjax.preparationEnvoi;if(!this._attenteEnCours&&(!lRequete.Parametres||!lRequete.Parametres.sansBlocageInterface)){Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{emission:true,upload:!lRequete.estUneRequete,message:lRequete.estUneRequete?lRequete.Parametres.messageDetail:null,delai:this.pileRequetes.length>1||(lRequete.Parametres&&lRequete.Parametres.estBackup)?0:null});}
if(lRequete.estUneRequete){lRequete.EnvoieRequete({numeroOrdre:this.NumeroOrdreCommunication,numeroOrdreChiffre:this.getChaineChiffreeAES(this.NumeroOrdreCommunication)});} else if(lRequete.estUploadFile){if(!_ObjetCommunication.optionsSecurite.avecPollingActif){this.desactiverPresence();}
lRequete.envoiRequete();} else{}} else{if(lRequete&&lRequete.etat===TypeEtatRequeteAjax.envoye&&!this._attenteEnCours&&lRequete.Parametres&&lRequete.Parametres.sansBlocageInterface){let lAvecBlocageEnAttente=false;this.pileRequetes.every((aRequete,aIndex) =>{if(aRequete&&(!aRequete.Parametres||!aRequete.Parametres.sansBlocageInterface)){lAvecBlocageEnAttente=true;this.pileRequetes.every((aRequete,aIndex2) =>{if(aRequete&&aRequete.Parametres&&aRequete.Parametres.sansBlocageInterface){aRequete.Parametres.sansBlocageInterface=false;}
return aIndex2<aIndex;});return false;}
return true;});if(lAvecBlocageEnAttente){Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{emission:true,upload:lRequete.estUploadFile,delai:0});}}}}
function _getErreurConnexionInterrompue(){return{Titre:'',Message:GTraductions.getValeur('connexion.ErreurConnexionInterrompue')};}
function _getXmlReponseStatut200(ARequete,AReponse,aJSON,aSurPolling){const lNumeroSession=aJSON[EGenreIdsRequeteAjax.numeroSession];const lNumeroOrdre=aJSON[EGenreIdsRequeteAjax.numeroOrdre];const lDonneesSecurisees=aJSON[EGenreIdsRequeteAjax.donneesSecurisee];const lSecurise=!_ObjetCommunication.optionsSecurite.sansCryptageAES;let lNomRequete=aJSON[EGenreIdsRequeteAjax.nomFonction]+'Reponse';const lErreur=_getErreurConnexionInterrompue();if(aSurPolling){lNomRequete='pollingReponse';}
if(parseInt(this.NumeroDeSession,10)!==lNumeroSession&&lNumeroSession!==0){if(!aJSON.Erreur){aJSON.Erreur=lErreur;}
return null;}
const lNumOrdreServeur=parseInt(GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:lNumeroOrdre,cle:this.cleAES,iv:this.ivAES}),10);let lEstErreurNumeroOrdre=false;if(aSurPolling){lEstErreurNumeroOrdre=lNumOrdreServeur!==this.polling.numeroOrdre-1;} else{lEstErreurNumeroOrdre=lNumOrdreServeur!==this.NumeroOrdreCommunication+1;}
if(lEstErreurNumeroOrdre){if(!aJSON.Erreur){aJSON.Erreur=lErreur;}
return null;}
if(!aSurPolling){this.NumeroOrdreCommunication+=2;}
let lChrono;let lChronoTrait='';if(lSecurise){if(GLog&&GLog.getActifRequete&&GLog.getActifRequete()){lChrono=new(require('Chronometre.js'))();}
const lReponse=GCryptage.decrypter({genreCryptage:_ObjetCommunication.optionsSecurite.sansCryptageAES?EGenreCryptage.Unicode:EGenreCryptage.AES,chaine:lDonneesSecurisees,cle:this.cleAES,iv:this.ivAES,avecCompression:!_ObjetCommunication.optionsSecurite.sansCompressionAES});aJSON.donnees=ObjetJSON.parseJSON(lReponse);if(lChrono&&GLog.getActifRequete()){lChronoTrait=lChrono.toString();}} else{aJSON.donnees=lDonneesSecurisees;}
delete aJSON[EGenreIdsRequeteAjax.donneesSecurisee];if(!aJSON.donnees){aJSON.Erreur=lErreur;return null;}
aJSON.donnees=ObjetJSON.parseVariables(aJSON.donnees,{JSONCollection:aJSON[EGenreIdsRequeteAjax.donneesNonSecurisee]});try{if(GLog.getActifRequete()){let lChronoServeur=null;let lChronoSaisieMs;let lEstAttente=false;GLog.addRequete({nomRequete:lNomRequete,numeroRequete:ARequete.Parametres.numeroRequete,numeroOrdre:aSurPolling?this.polling.numeroOrdre:this.NumeroOrdreCommunication-1,chrono:{requeteServeurtickMs:lChronoServeur,traitement:lChronoTrait,saisieMS:lChronoSaisieMs},estReponse:true,lgcontenu:AReponse.length,estPolling:ARequete.Parametres.estPolling,estAttente:lEstAttente});}} catch(e){}}
function _evenementSurReponseRequete(aParametresAppel ,ARequete,AReponse,AStatut){_traiterPileAttenteSurReponseRequete(ARequete);clearTimeout(this._timeoutRequeteBackup);const lStatut=parseInt(AStatut,10);switch(lStatut){case 200:{if(aParametresAppel.estRequeteDeconnexion){this._requeteDeconnexionEnvoyee=true;}
const lJSONReseau=ObjetJSON.parseJSON(AReponse);if(!lJSONReseau){_composePageErreur.call(this,_getErreurConnexionInterrompue());return;} else{_getXmlReponseStatut200.call(this,ARequete,AReponse,lJSONReseau);}
if(lJSONReseau.Erreur||(lJSONReseau.donnees&&lJSONReseau.donnees.Erreur)){_composePageErreur.call(this,lJSONReseau.Erreur?lJSONReseau.Erreur:lJSONReseau.donnees.Erreur);} else{const lJSONAttente=lJSONReseau.donnees[EGenreIdsRequeteAjax.SignatureAttente];const lParametresAttente=lJSONAttente?_recupererParametresAttente.bind(this)(lJSONAttente.Parametres):{};if(lJSONAttente){if(!lParametresAttente.sansBlocageInterface){this._attenteEnCours=lJSONAttente?true:false;}} else{this._attenteEnCours=false;}
if(this._attenteEnCours){if(ARequete.Parametres.sansBlocageInterface){Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{emission:true,upload:false,message:ARequete.Parametres.messageDetail});delete ARequete.Parametres.sansBlocageInterface;}
_declencherAttente.bind(this)({JSONAttente:lJSONAttente,requeteModele:ARequete,parametresAttente:lParametresAttente});} else{if(!ARequete.Parametres.sansBlocageInterface){Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{emission:false});}
if(lJSONAttente&&lParametresAttente.sansBlocageInterface){_declencherAttente.bind(this)({JSONAttente:lJSONAttente,requeteModele:ARequete,parametresAttente:lParametresAttente});if(lParametresAttente.deserialisation){_surReception.call(this,ARequete,lJSONReseau);} else{_setRequeteEtatTermine.call(this,ARequete);_envoieRequete.call(this);}} else{_surReception.call(this,ARequete,lJSONReseau);}}}
break;}
default:{GLog.addLog('échec requête ajax. requête = '+ARequete+'. statut = '+AStatut);if(_renvoyerRequeteSurErreur.call(this,ARequete,lStatut)){return;}
if(!window.GApplication||!GApplication._unloadEnCours){let lMessage=`erreur ajax - requete : ${ARequete} - statut : ${AStatut}`;if(ARequete.Parametres&&ARequete.Parametres.estBackup){lMessage+=' (backup)';}
this.sendLogClient(lMessage);}
_composePageErreur.call(this,null,AStatut);break;}}}
function _renvoyerRequeteSurErreur(aRequete,aStatut){clearTimeout(this._timeoutRequeteBackup);if(this.estArrete||
!aRequete||
!aRequete.backupDataJSON||
!aRequete.Parametres){return false;}
if(aStatut!==0&&!aRequete.Parametres.DEBUG_decoSimule){return false;}
if(aRequete.nbBackup>this.backupAjax.nbBackupEchec){return false;}
if(aRequete.nbBackup>=4&&
aRequete.timeDebutBackup&&(Date.now()-aRequete.timeDebutBackup)>this.backupAjax.delaiTimeoutEchecReseau){return false;}
this._timeoutRequeteBackup=setTimeout(() =>{if(!aRequete.Parametres.sansBlocageInterface){Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{emission:false});}
if(this.estArrete){return;}
_setRequeteEtatTermine.call(this,aRequete);const lRequeteBackup=this.appel_fonction_asynchrone_xml({estBackup:true,backupDataJSON:aRequete.backupDataJSON,nom:aRequete.Parametres.nomDeFonction,callbackPere:aRequete.Parametres.pereReponse,callbackEvenement:aRequete.Parametres.evenementReponse,messageDetail:aRequete.nbBackup>3?GTraductions.getValeur('requete.ConnexionPerdue'):aRequete.Parametres.messageDetail,sansBlocageInterface:false});if(!aRequete.timeDebutBackup){lRequeteBackup.nbBackup=1;lRequeteBackup.timeDebutBackup=Date.now();} else{lRequeteBackup.nbBackup=aRequete.nbBackup+1;lRequeteBackup.timeDebutBackup=aRequete.timeDebutBackup;}},this.backupAjax.delaiRepetitionEchecReseau);return true;}
function _declencherAttente(aParametres){const lParametres={JSONAttente:null,requeteModele:null,parametresAttente:{}};$.extend(lParametres,aParametres);if(!lParametres.parametresAttente.sansBlocageInterface){window.clearTimeout(this.Timer);this.Timer=setTimeout(_repeterRequeteAttente.bind(this,lParametres),lParametres.parametresAttente.delai);} else{const lNomFunction=lParametres.requeteModele.Parametres.nomDeFonction;if(_pileTimerEnAttente[lNomFunction]){if(_pileTimerEnAttente[lNomFunction].timer){clearTimeout(_pileTimerEnAttente[lNomFunction].timer);}
delete _pileTimerEnAttente[lNomFunction];}
if(lParametres.requeteModele.__interruptionReponse){delete lParametres.requeteModele.__interruptionReponse;return;}
const lTimer=setTimeout(_repeterRequeteAttente.bind(this,lParametres),lParametres.parametresAttente.delai);_pileTimerEnAttente[lNomFunction]={timer:lTimer};}}
function _repeterRequeteAttente(aParametres){let lJSON;const lNomRequete=aParametres.requeteModele.Parametres.nomDeFonction;if(aParametres.parametresAttente.repeterRequete){lJSON=aParametres.requeteModele.Parametres.jsonOrigine;if(!(lJSON&&lJSON[EGenreIdsRequeteAjax.SignatureAttente])&&aParametres.JSONAttente){lJSON[EGenreIdsRequeteAjax.SignatureAttente]=MethodesObjet.dupliquer(aParametres.JSONAttente);}} else{lJSON={};if(aParametres.JSONAttente){lJSON[EGenreIdsRequeteAjax.SignatureAttente]=MethodesObjet.dupliquer(aParametres.JSONAttente);}}
;_setRequeteEtatTermine.call(this,aParametres.requeteModele);const lRequete=this.appel_fonction_asynchrone_xml({nom:lNomRequete,json:lJSON,callbackPere:aParametres.requeteModele.Parametres.pereReponse,callbackEvenement:aParametres.requeteModele.Parametres.evenementReponse,requetePrioritaire:!aParametres.parametresAttente.sansBlocageInterface,sansBlocageInterface:aParametres.parametresAttente.sansBlocageInterface});if(aParametres.parametresAttente.sansBlocageInterface){lRequete.__estUneAttenteNonBloquante=true;_pileTimerEnAttente[lRequete.Parametres.nomDeFonction].requete=lRequete;}}
function _traiterPileAttenteSurReponseRequete(aRequete){if(aRequete&&aRequete.__estUneAttenteNonBloquante){const lNomRequete=aRequete.Parametres.nomDeFonction;if(_pileTimerEnAttente[lNomRequete]){if(_pileTimerEnAttente[lNomRequete].timer){clearTimeout(_pileTimerEnAttente[lNomRequete].timer);}
delete _pileTimerEnAttente[lNomRequete];}
delete aRequete.__estUneAttenteNonBloquante;}}
function _eventInterruptionRequete(aParametres){const lParametres={nomRequete:''};$.extend(lParametres,aParametres);if(lParametres.nomRequete&&_pileTimerEnAttente[lParametres.nomRequete]){if(_pileTimerEnAttente[lParametres.nomRequete].timer){clearTimeout(_pileTimerEnAttente[lParametres.nomRequete].timer);delete _pileTimerEnAttente[lParametres.nomRequete].timer;}
if(_pileTimerEnAttente[lParametres.nomRequete].requete){_pileTimerEnAttente[lParametres.nomRequete].requete.__interruptionReponse=true;} else{delete _pileTimerEnAttente[lParametres.nomRequete];}
GLog.addLog('requete en attente : ['+lParametres.nomRequete+'] interrompu');}}
function _eventModificationRequeteAttente(aParametres){const lParametres={nomRequete:''};$.extend(lParametres,aParametres);let lRequeteExiste=false;if(lParametres.nomRequete&&lParametres.donnees){for(let i=0,nb=this.pileRequetes.length;i<nb;i++){if(this.pileRequetes[i]&&this.pileRequetes[i].Parametres.nomDeFonction){lRequeteExiste=i;break;}}
if(lRequeteExiste!==false){$.extend(this.pileRequetes[lRequeteExiste].Parametres.jsonOrigine.donnees,lParametres.donnees);}}}
function _recupererParametresAttente(aParametres){const lParametres={sansBlocageInterface:false,delai:this.FDureeEnCours,repeterRequete:false,deserialisation:false};if(aParametres){if(aParametres.sansBlocageInterface){lParametres.sansBlocageInterface=true;}
if(aParametres.delai&&aParametres.delai>0){lParametres.delai=aParametres.delai*1000;}
if(aParametres.repeterRequete){lParametres.repeterRequete=true;}
if(aParametres.date){lParametres.date=aParametres.date;}
if(aParametres.deserialisation){lParametres.deserialisation=aParametres.deserialisation;}}
return lParametres;}
function _setRequeteEtatTermine(aRequete){if(aRequete){aRequete.etat=TypeEtatRequeteAjax.termine;this.pileRequetes=this.pileRequetes.filter((aRequete,aIndex) =>{return!!aRequete&&aRequete.etat!==TypeEtatRequeteAjax.termine;});}
_requetePresenceDelai.call(this);}
function _surReception(aRequete,aJSON,aEnEchec){_setRequeteEtatTermine.call(this,aRequete);_envoieRequete.call(this);if(aRequete.Parametres.pereReponse&&aRequete.Parametres.evenementReponse){aRequete.Parametres.evenementReponse.call(aRequete.Parametres.pereReponse,aJSON?aJSON.donnees:{},aEnEchec);}}
function _composePageErreur(aJSONErreur,aStatut){const lParametres={constructionPage:true,statut:aStatut,jsonErreur:aJSONErreur};Invocateur.evenement(ObjetInvocateur.events.erreurCommunication,lParametres);Invocateur.evenement(ObjetInvocateur.events.fermerFenetres,true);}
function _requeteBeaconDeconnexion(){if(navigator&&navigator.sendBeacon&&!this.estArrete&&this.NumeroOrdreCommunication>0&&!this._requeteDeconnexionEnvoyee){this._requeteDeconnexionEnvoyee=true;const lNumeroOrdre=this.getChaineChiffreeAES(this.NumeroOrdreCommunication);if(lNumeroOrdre){try{navigator.sendBeacon('appeldeconnexion/'+lNumeroOrdre+'/'+new Date().getTime(),ObjetJSON.toJSON({ns:parseInt(this.NumeroDeSession,10),no:lNumeroOrdre}));} catch(e){}}}}
function _requetePresenceDelai(){window.clearTimeout(this.timerPresence);this.timerPresence=setTimeout(_requeteDePresence.bind(this),_getDureeTimerPresence.call(this));}
function _getDureeTimerPresence(){return this._MAJServeurEnCours?Math.min(_ObjetCommunication.cDureeTimerPresenceMAJServeurEnCours,this._dureeTimerPresence):this._dureeTimerPresence;}
function _requeteDePresence(){if(_ObjetCommunication.optionsSecurite.avecPollingActif){return;}
if(!this.requeteEnCours()&&this._requetePresenceActive&&this._requetePresenceEnPause!==true){Requetes('Presence').lancerRequete();}
_requetePresenceDelai.bind(this)();}
function _modificationPresenceUtilisateur(aPresenceUtilisateur){let lNomRequete;if(aPresenceUtilisateur){delete this._requetePresenceEnPause;_requeteDePresence.bind(this)();_envoiRequetePolling.call(this,{presence:true});} else{this._requetePresenceEnPause=true;window.clearTimeout(this.timerPresence);for(lNomRequete in _pileTimerEnAttente){if(_pileTimerEnAttente[lNomRequete]){_eventInterruptionRequete.call(this,{nomrequete:lNomRequete});}}}}
function _arretTimeoutsPolling(aInstance){if(aInstance.polling.timeoutEchec){clearTimeout(aInstance.polling.timeoutEchec);aInstance.polling.timeoutEchec=null;}
if(aInstance.polling.timeoutExpirationRequete){clearTimeout(aInstance.polling.timeoutExpirationRequete);aInstance.polling.timeoutExpirationRequete=null;}}
function _envoiRequetePolling(aParams){if(!_ObjetCommunication.optionsSecurite.avecPollingActif){return;}
if(this.estArrete){return;}
const lParams=Object.assign({presence:false},aParams);_arretTimeoutsPolling(this);if(this.polling.requeteEnCours){if(!lParams.presence){GLog.addLog('Double envoi Polling')
;}
return;}
if(!this.polling.echecReseau&&(this._requetePresenceEnPause||!this._requetePresenceActive)){if(this.polling.messageDecoEnCours){this.polling.messageDecoEnCours=false;Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{blocageDeconnexion:false});}
return;}
let lJSONEnvoi={};if(this.polling.echecReseau){Object.assign(lJSONEnvoi,{nbEchecs:this.polling.echecReseau.nb,strEchec:this.polling.echecReseau.log});}
lJSONEnvoi=ObjetJSON.preparerJSON(lJSONEnvoi,{JSONCollection:{}});const lResultJSON=_traiterJSONEnvoi.call(this,lJSONEnvoi);this.polling.requeteEnCours=new ObjetRequete({numeroSession:this.NumeroDeSession,numeroRequete:this.polling.nbRequetes,nomRequete:'appelpolling',genreEspace:this.GenreEspace,nomDeFonction:'polling',estPolling:true,parametres:lResultJSON.JSON,echecReseau:this.polling.echecReseau,callBackReadyStateChange:(aRequete,aReponse,aStatut) =>{this.polling.requeteEnCours=null;_arretTimeoutsPolling(this);if(this.estArrete){return;}
this.polling.nbRequetes+=1;const lStatut=parseInt(aStatut,10);switch(lStatut){case 200:{this.polling.numeroOrdre+=1;delete this.polling.echecReseau;if(this.polling.messageDecoEnCours){this.polling.messageDecoEnCours=false;Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{blocageDeconnexion:false});}
const lJSONReseau=aReponse?ObjetJSON.parseJSON(aReponse):null;if(lJSONReseau){_getXmlReponseStatut200.call(this,aRequete,aReponse,lJSONReseau,true);if(lJSONReseau.Erreur||(lJSONReseau.donnees&&lJSONReseau.donnees.Erreur)){_composePageErreur.call(this,lJSONReseau.Erreur?lJSONReseau.Erreur:lJSONReseau.donnees.Erreur);return;}
if(lJSONReseau.donnees){Invocateur.evenement('deserialisation_notificationsPolling',lJSONReseau.donnees);}}
_envoiRequetePolling.call(this);break;}
default:{if(!this.polling.echecReseau){this.polling.echecReseau={nb:0,timeDebut:Date.now(),log:''};}
this.polling.echecReseau.nb+=1;if(this.polling.echecReseau.nb>=this.polling.nbRepetitionEchecReseau||(this.polling.echecReseau.timeDebut&&this.polling.echecReseau.nb>2&&((Date.now()-this.polling.echecReseau.timeDebut)>this.polling.delaiTimeoutEchecReseau))){if(!global.GApplication||!global.GApplication._unloadEnCours){this.sendLogClient(`erreur polling - statut : ${aStatut}`);}
GLog.addLog('FIN SESSION : Echec requête polling. statut = '+aStatut);_composePageErreur.call(this,null,aStatut);return;}
const lDateEchec=new Date();this.polling.echecReseau.log+=(this.polling.echecReseau.log?' / ':'')+lDateEchec.getHours()+':'+lDateEchec.getMinutes()+':'+lDateEchec.getSeconds()+':'+lDateEchec.getMilliseconds()+' -statut:'+aStatut;if(!this.polling.messageDecoEnCours&&(this.polling.echecReseau.nb===3||lParams.presence)){this.polling.messageDecoEnCours=true;Invocateur.evenement(ObjetInvocateur.events.eventIOAjax,{blocageDeconnexion:true,message:GTraductions.getValeur('requete.ConnexionPerdue')});}
GLog.addLog('Echec polling => rejeu requête polling. Statut = '+aStatut+' - nb:'+this.polling.echecReseau.nb);this.polling.timeoutEchec=setTimeout(() =>{_envoiRequetePolling.call(this);},this.polling.delaiRepetitionEchecReseau);}}},log:{tailleDonnees:lResultJSON.JSONStr_clair.length,tempsChiffre:''}});this.polling.requeteEnCours.EnvoieRequete({numeroOrdre:this.polling.numeroOrdre,numeroOrdreChiffre:this.getChaineChiffreeAES(this.polling.numeroOrdre)});this.polling.timeoutExpirationRequete=setTimeout(() =>{this.polling.timeoutExpirationRequete=null;GLog.addLog('Timeout Polling');if(this.polling.requeteEnCours&&this.polling.requeteEnCours.Requete&&this.polling.requeteEnCours.Requete.abort){this.sendLogClient(`Timeout polling => abort`);return this.polling.requeteEnCours.Requete.abort();}},this.polling.delaiTimeoutRequete);}
module.exports=_ObjetCommunication;},fn:"_objetcommunication.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreBoiteMessage={Information:0,Confirmation:1,MrFiche:2};module.exports=EGenreBoiteMessage;},fn:"enumere_boitemessage.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeHttpAcces={HttpAcces_Espace:0,HttpAcces_ConnexionEspace:1,HttpAcces_ConnexionDirect:2,HttpAcces_ConnexionJetonEspace:3,HttpAcces_ConnexionJetonDirect:4,HttpAcces_ConnexionCookie:5};module.exports.TypeHttpAcces=TypeHttpAcces;},fn:"enumere_acces.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeHttpAcces=require('Enumere_Acces.js').TypeHttpAcces;class ObjetAcces{constructor(aGenreAcces,aGenreEspace,aGenreOnglet,aGenreSousOnglet,aNumeroRessource,aNumeroRessourceSecondaire){this.genre=aGenreAcces;this.genreEspace=aGenreEspace;this.genreOnglet=aGenreOnglet;this.genreSousOnglet=aGenreSousOnglet;this.numeroRessource=aNumeroRessource;this.numeroRessourceSecondaire=aNumeroRessourceSecondaire;this.avecRecherche=false;this.initialisation();}
initialisation(){this.utilisateur={};this.utilisateur.nom='';this.utilisateur.libelleRecherche='';this.utilisateur.identifiant='';this.utilisateur.password='';}
setNom(aNom,aLibelleRecherche){this.utilisateur.nom=aNom;this.utilisateur.libelleRecherche=aLibelleRecherche;}
getNom(){return this.utilisateur.nom;}
setIdentification(aIdentifiant,aPassword){this.utilisateur.identifiant=aIdentifiant;this.utilisateur.password=aPassword?aPassword:'@direct';}
estConnexionCAS(){return(this.genre===TypeHttpAcces.HttpAcces_ConnexionJetonEspace||this.genre===TypeHttpAcces.HttpAcces_ConnexionJetonDirect);}
estConnexionCookie(){return this.genre===TypeHttpAcces.HttpAcces_ConnexionCookie;}
estConnexionDirect(){if(this.genre===TypeHttpAcces.HttpAcces_ConnexionDirect){}
const lResult=(this.genre===TypeHttpAcces.HttpAcces_ConnexionJetonDirect);return lResult;}
estConnexionEspaceEtudiant(){if(this.genre===TypeHttpAcces.HttpAcces_ConnexionEspace){}
const lResult=(this.genre===TypeHttpAcces.HttpAcces_ConnexionJetonEspace);return lResult;}}
module.exports=ObjetAcces;},fn:"objetacces.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeHttpAcces=require('Enumere_Acces.js').TypeHttpAcces;const ObjetAcces=require('ObjetAcces.js');const EGenreEspace=require('Enumere_Espace.js');class ObjetAccesPN extends ObjetAcces{constructor(aGenreAcces,aGenreEspace,aGenreOnglet,aGenreSousOnglet,aNumeroRessource,aNumeroRessourceSecondaire){super(aGenreAcces,aGenreEspace,aGenreOnglet,aGenreSousOnglet,aNumeroRessource,aNumeroRessourceSecondaire);}
estConnexionEspaceEtudiant(){if(this.genre===TypeHttpAcces.HttpAcces_Espace){}
let lResult=(this.genre===TypeHttpAcces.HttpAcces_ConnexionJetonEspace);lResult=(lResult&&this.genreEspace===EGenreEspace.Eleve);return lResult;}}
module.exports=ObjetAccesPN;},fn:"objetaccespn.js"});;
IE.fModule({f:function(exports,require,module,global){const IELocalStorage=require('LocalStorage.js');class ObjetOptionsEspaceLocal{constructor(aOptions){this.options=$.extend({racine:'OPTIONS_ESPACE_',nomProduit:'',espace:''},aOptions);}
getOptionsJSON(){let lJSON=IELocalStorage.getItemJSON(this.options.racine+(this.options.nomProduit||''));if(!lJSON){lJSON={};}
return lJSON;}
setOptionsJSON(aJSON){IELocalStorage.setItemJSON(this.options.racine+(this.options.nomProduit||''),aJSON);return this;}
getOptionEspace(aNomOption){return this.getOptionsJSON()[aNomOption+'_'+this.options.espace];}
setOptionEspace(aNomOption,aValeur){const lJSON=this.getOptionsJSON();if(aValeur){lJSON[aNomOption+'_'+this.options.espace]=aValeur;} else if(aValeur===undefined||aValeur===null||aValeur===false){delete lJSON[aNomOption+'_'+this.options.espace];}
this.setOptionsJSON(lJSON);return this;}
getModeAccessible(){return!!this.getOptionEspace('modeA');}
setModeAccessible(aModeAccessible){this.setOptionEspace('modeA',aModeAccessible);return this;}
getAvecCodeCompetences(){return!!this.getOptionEspace('avecCC');}
setAvecCodeCompetences(aModeAccessible){this.setOptionEspace('avecCC',aModeAccessible);return this;}
getAvecThemeAccessible(){return!!this.getOptionEspace('themeA');}
setAvecThemeAccessible(aThemeAccessible){this.setOptionEspace('themeA',aThemeAccessible);return this;}}
module.exports=ObjetOptionsEspaceLocal;},fn:"objetoptionsespacelocal.js"});;
IE.fModule({f:function(exports,require,module,global){const ObjetOptionsEspaceLocal=require('ObjetOptionsEspaceLocal.js');class ObjetOptionsEspaceLocalPN extends ObjetOptionsEspaceLocal{getGenreConnexion(){return this.getOptionsJSON().genreConnexion;}
setGenreConnexion(aGenreConnexion){const lJSON=this.getOptionsJSON();lJSON.genreConnexion=aGenreConnexion;this.setOptionsJSON(lJSON);}}
module.exports=ObjetOptionsEspaceLocalPN;},fn:"objetoptionsespacelocalpn.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeModeGrillesEDT={TMG_CycleHebdomadaire:0,TMG_CycleAvecferies:1,TMG_CycleSansFeries:2};module.exports.TypeModeGrillesEDT=TypeModeGrillesEDT;},fn:"typemodegrillesedt.js"});;
IE.fModule({f:function(exports,require,module,global){const GUID=require('GUID.js');const GLog=require('IELog.js');const{Invocateur}=require('Invocateur.js');const MethodesObjet=require('MethodesObjet.js');const MethodesTableau=require('MethodesTableau.js');const GHtml=require('GHtml.js');const GPosition=require('GPosition.js');const GStyle=require('GStyle.js');const Support=require('ObjetSupport.js');function ObjetHint(){}
let uTimeoutFondu=null;const uIdConteneur=GUID.getId();const uIdScroll=uIdConteneur+'_scroll';let uHintsEnAttente=[];let uHintEnCoursChargement=null;let uHintAffiche=null;let uHintInitialise=false;const uConteneurEventInvocateur={};ObjetHint.getDisabled=function(){return!global.GNavigateur;};ObjetHint.start=function(aContenu,aOptions){if(ObjetHint.getDisabled()){GLog.addLog('ObjetHint.start => disabled sur espaces mobiles');return;}
if(!uHintInitialise){uHintInitialise=true;$(document).off('pointerdown.Hint keyup.Hint').on('pointerdown.Hint keyup.Hint',(aEvent) =>{_stopAll(aEvent);});$(window).off('resize.Hint').on('resize.Hint',function(event){if(uHintAffiche&&uHintAffiche.hintTouch){return;}
_stopAll(event);});}
const lHint=Object.assign({sansDelai:false,position:null,couleurFond:'white',maxHeight:500,maxWidth:550,delaiFondu:200,delaiTimer:400,delaiFermeture:0,event:null,elementDOM:null},aOptions);lHint.actif=false;if(!aContenu||(aContenu==='')){return lHint;}
if(lHint.elementDOM&&lHint.elementDOM.setAttribute){lHint.elementDOM.setAttribute('title','');}
lHint.actif=true;uHintsEnAttente.push(lHint);if(lHint.sansDelai){_afficher(aContenu,lHint);} else{lHint.promiseTimerDelai=new Promise(function(aResolve){lHint.timer=setTimeout(function(){_afficher.call(this,aContenu,lHint);if(lHint.pomiseAfficher){lHint.pomiseAfficher.then(function(){aResolve();});} else{aResolve();}}.bind(this),lHint.delaiTimer);});}
return lHint;};ObjetHint.stop=function(aHint){if(aHint&&aHint===uHintEnCoursChargement){return false;}
if(aHint){const lARetirer=!aHint.estAffiche;_stopHint(aHint);if(lARetirer){setTimeout(function(){_retirerHintPileAttente(aHint);},0);}} else{_stopAll();}};ObjetHint.attach=function(aParam){if(ObjetHint.getDisabled()){GLog.addLog('ObjetHint.attach > disabled sur espaces mobiles');return;}
const lNamespace=aParam.namespace?aParam.namespace='.'+aParam.namespace:'.IEHint',lContenu=aParam.contenu,lInterrupt=aParam.interrupt,lMargeDeplacementTouch=50,lIdentEventsTouch=GNavigateur.getEventInvocateur('pointermove');let lHint;let lTimeoutTouch;const lStop=function(){if(lTimeoutTouch){clearTimeout(lTimeoutTouch);lTimeoutTouch=null;}
Invocateur.desabonner(lIdentEventsTouch,uConteneurEventInvocateur);if(ObjetHint.stop(lHint)!==false){lHint=null;}};if(!aParam.$Element){return false;}
if(aParam.off!==false){aParam.$Element.off(' pointerover'+lNamespace+' pointerleave'+lNamespace+' pointerout'+lNamespace+' destroyed'+lNamespace+' pointerdown'+lNamespace);}
const lElementDOM=aParam.$Element.get(0);const lMap={};lMap['pointerover'+lNamespace]=function(event){if(event.pointerType==='touch'){return;}
if(uHintEnCoursChargement){return;}
if(lInterrupt&&lInterrupt.call(this,event)){return;}
const lContenuAAfficher=lContenu;lHint=ObjetHint.start(lContenuAAfficher,{event:event,elementDOM:lElementDOM});};lMap['destroyed'+lNamespace+' pointerleave'+lNamespace+' pointerout'+lNamespace]=function(){lStop();};lMap['pointerdown'+lNamespace]=function(event){if(event.pointerType!=='touch'){return;}
if(lInterrupt&&lInterrupt.call(this,event)){return;}
if(event.originalEvent.__hintSurEventPointerDown__){return;}
event.originalEvent.hintTouch=true;const lPositionEvent=GPosition.getPositionEventJQuery(event);lHint=ObjetHint.start(lContenu,{delaiTimer:500,event:event,position:{x:lPositionEvent.x+5,y:lPositionEvent.y+5},elementDOM:lElementDOM});if(!lHint||!lHint.promiseTimerDelai){return;}
const lTestDeplacement=function(aEvent){if(lHint&&lHint.actif&&lHint.position){const lPositionEvent=GPosition.getPositionEventJQuery(aEvent);if(Math.abs(lPositionEvent.x-lHint.position.x)>lMargeDeplacementTouch||Math.abs(lPositionEvent.y-lHint.position.y)>lMargeDeplacementTouch){lStop();}}};Invocateur.desabonner(lIdentEventsTouch,uConteneurEventInvocateur);Invocateur.abonner(lIdentEventsTouch,lTestDeplacement,uConteneurEventInvocateur);lHint.promiseTimerDelai.then(function(){if(!lHint.estAffiche){return;}
event.originalEvent.__hintSurEventPointerDown__=true;lHint.hintTouch=true;if(lTimeoutTouch){clearTimeout(lTimeoutTouch);}
lTimeoutTouch=setTimeout(function(){lTimeoutTouch=null;if(lHint&&lHint.actif&&lHint.estAffiche){lStop();}},1500);});};aParam.$Element.on(lMap);aParam.$Element=null;};function _stopHint(aHint){if(!aHint||aHint===uHintEnCoursChargement){return;}
if(aHint.elementDOM&&aHint.elementDOM.removeAttribute){aHint.elementDOM.removeAttribute('title');}
if(aHint.estAffiche){uHintAffiche=null;if(Support.avecSupportTransitions){$('#'+uIdConteneur.escapeJQ()).css('opacity',0);clearTimeout(uTimeoutFondu);uTimeoutFondu=setTimeout(function(){GHtml.supprimerElementDOM(uIdConteneur);uTimeoutFondu=null;},aHint.delaiFondu);} else{GHtml.supprimerElementDOM(uIdConteneur);}}
if(aHint.timerFermeture){clearTimeout(aHint.timerFermeture);aHint.timerFermeture=null;}
if(aHint.timer){clearTimeout(aHint.timer);aHint.timer=null;}
aHint.estAffiche=false;aHint.actif=false;}
function _stopEnAttente(){let lHintEnAttente;for(let i=0,lNb=uHintsEnAttente.length;i<lNb;i++){lHintEnAttente=uHintsEnAttente[i];if(lHintEnAttente){lHintEnAttente.actif=false;if(lHintEnAttente.timer){clearTimeout(lHintEnAttente.timer);lHintEnAttente.timer=null;}}}
uHintsEnAttente=[];}
function _stopAll(event,aConserverHintEnCours){if(event&&event.originalEvent&&event.originalEvent.hintTouch){return;}
if(uHintEnCoursChargement){return;}
if(uHintAffiche&&!aConserverHintEnCours){_stopHint(uHintAffiche);}
_stopEnAttente();}
function _getContenu(aContenu,aHint){let lContenu=aContenu;if(MethodesObjet.isFunction(aContenu)){lContenu=aContenu(aHint);if(lContenu&&lContenu.then){uHintEnCoursChargement=aHint;return lContenu.finally(function(){setTimeout(function(){if(aHint===uHintEnCoursChargement){uHintEnCoursChargement=null;}},50);});}}
return lContenu;}
function _retirerHintPileAttente(aHint){const lIndice=uHintsEnAttente.indexOf(aHint);if(lIndice>=0){MethodesTableau.supprimerElement(uHintsEnAttente,lIndice);}}
function _loopAnimateScroll(aId,aHauteurAScroller){const lDuree=aHauteurAScroller*1000/100;$(aId).delay(1000).animate({scrollTop:aHauteurAScroller},{duration:lDuree,easing:'linear'}).delay(1000).animate({scrollTop:0},{duration:300,done:function(){_loopAnimateScroll(aId,aHauteurAScroller);}});}
function _afficher(aContenu,aHint){if(uHintEnCoursChargement){return;}
aHint.pomiseAfficher=Promise.resolve().then(function(){return _getContenu(aContenu,aHint);}).then(function(aContenu){const lContenu=aContenu;if(!aHint.actif||!lContenu||(lContenu==='')){aHint.timer=null;aHint.actif=false;return;}
_retirerHintPileAttente(aHint);_stopAll();uHintAffiche=aHint;uHintAffiche.contenu=lContenu;clearTimeout(uTimeoutFondu);aHint.estAffiche=true;aHint.timer=null;if(aHint.delaiFermeture>0){aHint.timerFermeture=setTimeout(function(){_stopHint(aHint);},aHint.delaiFermeture);}
let lConteneur=GHtml.getElement(uIdConteneur);if(!GHtml.elementExiste(lConteneur)){lConteneur=GHtml.htmlToDOM('<div id="'+uIdConteneur+'" style="position:absolute; z-index:10000;pointer-events:none;'+(Support.avecSupportTransitions?GStyle.composeTransitions('opacity',(aHint.delaiFondu/1000)+'s')+'opacity:0;':'')+'"></div>');GHtml.insererElementDOM(GHtml.getElement(GApplication.getIdConteneur()),lConteneur);}
GHtml.setHtml(lConteneur,compose(lContenu,aHint));let lPositionEvent={};if(!aHint.position&&aHint.event&&IE.estMobile){lPositionEvent=GPosition.getPositionEventJQuery(aHint.event);}
const lPosition=Object.assign({y:GNavigateur.pointerY,x:GNavigateur.pointerX},lPositionEvent,aHint.position),lDecalage=aHint.position?{x:0,y:0}:{x:0,y:20};const lJScroll=$('#'+uIdScroll.escapeJQ()),lHeightScroll=lJScroll.height(),lHeightContenu=lJScroll.children().height(),lAvecScroll=lHeightScroll<lHeightContenu;lJScroll.css('width',lJScroll.outerWidth());GPosition.placerFicheSource(uIdConteneur,lPosition.x,lPosition.x,lPosition.y,lPosition.y,false,lDecalage);$(lConteneur).css('opacity',1);if(lAvecScroll){_loopAnimateScroll('#'+uIdScroll.escapeJQ(),lHeightContenu-lHeightScroll);}});}
function compose(aContenu,aHint){const lHtml=[];lHtml.push('<div id="',uIdScroll,'" tabindex="-1" class="SansOutline"',' style="width:auto; height:auto; max-height:',Math.min(aHint.maxHeight,GNavigateur.EcranL),'px; max-width:',Math.min(aHint.maxWidth,GNavigateur.EcranH),'px;','cursor:default; overflow-y:auto; overflow-x:hidden;',GStyle.composeCouleur(aHint.couleurFond,GCouleur.texte,GCouleur.bordure),GStyle.composeBoxShadow(),'">','<div class="PetitEspace" style="word-wrap: break-word;">',aContenu,'</div>','</div>');return lHtml.join('');}
ObjetHint.nodeDansHint=function(aNode){return $(aNode).parents('#'+uIdConteneur.escapeJQ()).length>0;};module.exports=ObjetHint;},fn:"objethint.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');const MethodesObjet=require('MethodesObjet.js');const ObjetHint=require('objethint.js');const GStyle=require('GStyle.js');const c_PPP='…';function _reductionTextMultiline(aNode,aNodeText,aChaine,aOptions){let lAvecModif=false;try{const lConteneur=$(aNode).parent();let lHeight=0;const lWidth=Math.round(lConteneur.innerWidth());let lLineHeight=0;if(aOptions.nbLignesMax>0&&MethodesObjet.isNumber(aOptions.nbLignesMax)){try{lLineHeight=GStyle.getComputedValue(aNode,'line-height');if(lLineHeight==='normal'){lLineHeight=Math.ceil(GStyle.getFloatComputedValue(aNode,'font-size'))*1.2;} else{lLineHeight=Math.ceil(parseFloat(lLineHeight,10));}} catch(e){return true;}
lHeight=lLineHeight*(aOptions.nbLignesMax>0&&MethodesObjet.isNumber(aOptions.nbLignesMax)?aOptions.nbLignesMax:1);if(!MethodesObjet.isNumber(lHeight)){return true;}} else{lHeight=Math.floor(lConteneur.innerHeight());}
const lEnOverflowHeight=function(){return lHeight>0&&aNode.clientHeight-1>lHeight;};const lEnOverflow=function(){return lHeight>0&&lWidth>0&&(lEnOverflowHeight()||aNode.scrollWidth-1>lWidth);};if(lEnOverflow()){lAvecModif=true;const cMinNbCar=1;const lMinIndex=cMinNbCar;let lMaxIndex=aChaine.length;while(lMaxIndex>lMinIndex&&lEnOverflow()){const lMaxTemp=Math.floor((lMaxIndex+lMinIndex)/2 | 0);if(lMaxTemp>lMinIndex){if(lEnOverflowHeight()){aNodeText.nodeValue=aChaine.slice(0,lMaxTemp)+c_PPP;if(lEnOverflowHeight()){lMaxIndex=lMaxTemp;}} else{const lClientHeight=aNode.clientHeight;aNodeText.nodeValue=aChaine.slice(0,lMaxTemp)+c_PPP;if(lEnOverflow()&&aNode.clientHeight===lClientHeight){lMaxIndex=lMaxTemp;}}}
lMaxIndex=lMaxIndex-1;aNodeText.nodeValue=aChaine.slice(0,lMaxIndex)+c_PPP;}}} catch(e){}
if(lAvecModif&&aOptions.avecHint&&!ObjetHint.getDisabled()&&!ObjetHint.nodeDansHint(aNode)){ObjetHint.attach({$Element:MethodesObjet.isFunction(aOptions.getJNodeHint)?$(aOptions.getJNodeHint(aNode)):$(aNode),namespace:'ieellipsismultiline',contenu:aChaine,off:false});}
return true;}
IEHtml.addAttribut('ie-ellipsis-multiline',function(aContexteCourant,aNodeName,aAttributValue,aOutils){const lOptions={nbLignesMax:aAttributValue||'',avecHint:true,getJNodeHint:null};if(lOptions.nbLignesMax){const lGetOptions=aOutils.getAccesParametres(aAttributValue,aContexteCourant);if(lGetOptions.estFonction){Object.assign(lOptions,lGetOptions.callback());} else{lOptions.nbLignesMax=parseInt(lOptions.nbLignesMax,10);}
if(!MethodesObjet.isNumber(lOptions.nbLignesMax)){lOptions.nbLignesMax=''
;}}
if(!aContexteCourant.node.childNodes||aContexteCourant.node.childNodes.length>1){return true;}
if(aContexteCourant.node.childNodes.length===0){return true;}
const lNodeText=aContexteCourant.node.childNodes[0];if(!lNodeText||lNodeText.nodeType!==3){return true;}
const lValueText=lNodeText.nodeValue;if(!lValueText||!MethodesObjet.isString(lValueText)||lValueText.length<3){return true;}
let lTraite=false;aOutils.surInjectionHtml(aContexteCourant,function(){if(!lTraite&&aContexteCourant.node.clientHeight>0&&aContexteCourant.node.clientWidth>0){lTraite=_reductionTextMultiline(aContexteCourant.node,lNodeText,lValueText,lOptions);}});aOutils.abonnerRefresh(function(){if(!lTraite&&aContexteCourant.node.scrollHeight>0&&aContexteCourant.node.clientWidth>0){lTraite=_reductionTextMultiline(aContexteCourant.node,lNodeText,lValueText,lOptions);}},aContexteCourant.node,aContexteCourant);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-ellipsis-multiline="'+lOptions.nbLignesMax+'"');return true;});module.exports=IEHtml;},fn:"iehtml.ellipisismultiline.js"});;
IE.fModule({f:function(exports,require,module,global){const deferLoadingScript=require('deferLoadingScript.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const UtilitaireTraitementImage={browserAutoRotate:false,fileToDataUrlPromise:function(aFile){return new Promise(function(aResolve,aReject){if(!aFile){aReject();}
const lReader=new FileReader();lReader.onloadend=function(e){if(e.target.readyState===FileReader.DONE){aResolve(e.target.result);}};lReader.onerror=function(){aReject();};lReader.onabort=function(){aReject();};lReader.readAsDataURL(aFile);});},loadImageDataUrlPromise:function(aDataUrl,aImage){return new Promise(function(aResolve,aReject){const lImg=aImage||new Image();lImg.onload=function(){aResolve(lImg);};lImg.onerror=function(){aReject();};lImg.src=aDataUrl;});},fileToImgPromise:function(aFile,aImage){return UtilitaireTraitementImage.fileToDataUrlPromise(aFile).then(function(aDataUrl){return UtilitaireTraitementImage.loadImageDataUrlPromise(aDataUrl,aImage);}).then(function(aImg){let lOrientation= -2;return Promise.resolve().then(function(){if(UtilitaireTraitementImage.avecOrientationPossible(aFile)){return UtilitaireTraitementImage.getOrientationPromise(aFile).then(function(aOrientation){lOrientation=aOrientation;},function(){});}}).then(function(){return{img:aImg,orientation:lOrientation};});});},getOrientationPromise:function(file){return new Promise(function(aResolve,aReject){const reader=new FileReader();reader.onload=function(e){try{const view=new DataView(e.target.result);if(view.getUint16(0,false)!=0xFFD8){return aResolve(-2);}
const length=view.byteLength;let offset=2;while(offset<length){if(view.getUint16(offset+2,false)<=8){return aResolve(-1);}
const marker=view.getUint16(offset,false);offset+=2;if(marker==0xFFE1){if(view.getUint32(offset+=2,false)!=0x45786966){return aResolve(-1);}
const little=view.getUint16(offset+=6,false)==0x4949;offset+=view.getUint32(offset+4,little);const tags=view.getUint16(offset,little);offset+=2;for(let i=0;i<tags;i++){if(view.getUint16(offset+(i*12),little)==0x0112){return aResolve(view.getUint16(offset+(i*12)+8,little));}}} else if((marker&0xFF00)!=0xFF00){break;} else{offset+=view.getUint16(offset,false);}}
return aResolve(-1);} catch(e){aReject(e);}};reader.onerror=function(e){aReject(e);};reader.readAsArrayBuffer(file);});},avecOrientationPossible:function(aFile){return!!(aFile&&aFile.type==='image/jpeg')&&!this.browserAutoRotate;},resizeEtOrientationImgToCanvas:function(aParams){const lParams=Object.assign({img:null,width:0,height:0,widthResize:0,heightResize:0,orientation:-1},aParams);const lWidth=lParams.widthResize||lParams.width;const lHeight=lParams.heightResize||lParams.height;const lCanvasResult=document.createElement('canvas');const lCtxDest=lCanvasResult.getContext('2d');lCanvasResult.width=lWidth;lCanvasResult.height=lHeight;if(lParams.orientation>0){const lCanvas=document.createElement('canvas');const lCtx=lCanvas.getContext('2d');lCanvas.width=lParams.width;lCanvas.height=lParams.height;lCtx.drawImage(lParams.img,0,0,lCanvas.width,lCanvas.height);if(4<lParams.orientation&&lParams.orientation<9){lCanvasResult.width=lHeight;lCanvasResult.height=lWidth;}
switch(lParams.orientation){case 2:lCtxDest.transform(-1,0,0,1,lWidth,0);break;case 3:lCtxDest.transform(-1,0,0,-1,lWidth,lHeight);break;case 4:lCtxDest.transform(1,0,0,-1,0,lHeight);break;case 5:lCtxDest.transform(0,1,1,0,0,0);break;case 6:lCtxDest.transform(0,1,-1,0,lHeight,0);break;case 7:lCtxDest.transform(0,-1,-1,0,lHeight,lWidth);break;case 8:lCtxDest.transform(0,-1,1,0,0,lWidth);break;default:break;}
lCtxDest.drawImage(lCanvas,0,0,lWidth,lHeight);} else{lCtxDest.drawImage(lParams.img,0,0,lWidth,lHeight);}
return lCanvasResult;},resizeImgToCanvas:function(aImg,aMaxWidth,aMaxHeight,aOrientation){const lWidthOriginal=aImg.width;const lHeightOriginal=aImg.height;const lMAX_WIDTH=aMaxWidth||1500;const lMAX_HEIGHT=aMaxHeight||1500;let lWidth=lWidthOriginal;let lHeight=lHeightOriginal;if(lWidth>lHeight){if(lWidth>lMAX_WIDTH){lHeight*=lMAX_WIDTH/lWidth;lWidth=lMAX_WIDTH;}} else{if(lHeight>lMAX_HEIGHT){lWidth*=lMAX_HEIGHT/lHeight;lHeight=lMAX_HEIGHT;}}
let lCanvasResult=null;const lAvecResize=lHeightOriginal!==lHeight||lWidthOriginal!==lWidth;if(lAvecResize){lCanvasResult=UtilitaireTraitementImage.resizeEtOrientationImgToCanvas({img:aImg,width:lWidthOriginal,height:lHeightOriginal,widthResize:lWidth,heightResize:lHeight,orientation:aOrientation});}
return{avecResize:lAvecResize,canvas:lCanvasResult,img:aImg,width:lWidth,height:lHeight,widthOriginal:lWidthOriginal,heightOriginal:lHeightOriginal};},canvasToBlobPromise:function(aCanvas,aType,aName,aCompression){return new Promise(function(aResolve){aCanvas.toBlob(function(aBlob){aBlob.name=aName;aResolve(aBlob);},aType,aCompression);});},resizeFilePromise:function(aFile,aMaxWidth,aMaxHeight,aCompression){return UtilitaireTraitementImage.fileToImgPromise(aFile).then(function(aParamsFileToPromise){const lResult=UtilitaireTraitementImage.resizeImgToCanvas(aParamsFileToPromise.img,aMaxWidth,aMaxHeight,aParamsFileToPromise.orientation);if(lResult.avecResize&&lResult.canvas){return UtilitaireTraitementImage.canvasToBlobPromise(lResult.canvas,aFile.type,aFile.name,aCompression).then(function(aBlob){lResult.file=aBlob;return lResult;});}
lResult.file=aFile;return lResult;}).catch(function(e){return null;});},avecResizePossible:function(aFile){return!!(aFile&&aFile.type&&['image/jpeg','image/jpg','image/png','image/bmp','image/webp'].indexOf(aFile.type)>=0);},genererPdfPromise:function(aListeFichiers){const lGetJsPDF=function(){return require('jspdf.min.js');};return Promise.resolve().then(function(){return deferLoadingScript.loadPromise('jspdf').catch(function(){return Promise.reject({erreurLib:true});});}).then(function(){Invocateur.evenement(ObjetInvocateur.events.patience,true,{delai:100});const lPromises=[];if(aListeFichiers){aListeFichiers.parcourir(function(aFichier){if(!aFichier.estResize&&UtilitaireTraitementImage.avecOrientationPossible(aFichier.file)){lPromises.push(UtilitaireTraitementImage.fileToImgPromise(aFichier.file).then(function(aParamsFileToPromise){if(aParamsFileToPromise.orientation>=2){const lCanvasResult=UtilitaireTraitementImage.resizeEtOrientationImgToCanvas({img:aParamsFileToPromise.img,width:aParamsFileToPromise.img.width,height:aParamsFileToPromise.img.height,orientation:aParamsFileToPromise.orientation});return UtilitaireTraitementImage.canvasToBlobPromise(lCanvasResult,aFichier.file.type,aFichier.file.name).then(function(aBlob){aFichier.file=aBlob;});}}).catch(function(){return Promise.reject({nom:aFichier.Libelle});}));}});}
return Promise.all(lPromises);}).then(function(){return new Promise(function(aResolve,aReject){const lNbFichiers=aListeFichiers?aListeFichiers.GetNbrElements():0;if(aListeFichiers&&lNbFichiers>0){let lNb=0;const lFilesDataUrl=[];aListeFichiers.parcourir(function(aFichier,aIndex){const lFichier=aFichier;UtilitaireTraitementImage.fileToDataUrlPromise(lFichier.file).then(function(aIndex,aDataUrl){lNb+=1;lFilesDataUrl[aIndex]={dataUrl:aDataUrl,fichier:aFichier,type:lFichier.file.type};if(lNb>=lNbFichiers){aResolve(lFilesDataUrl);}}.bind(this,aIndex),function(aLibelle){aReject({nom:aLibelle});}.bind(this,lFichier.Libelle));});} else{aResolve();}});}).then(function(aFilesDataUrl){if(aFilesDataUrl&&aFilesDataUrl.length>0){const jsPDF=lGetJsPDF();const lPDF=new jsPDF();const lPromisesErreursJsPDF=[];aFilesDataUrl.forEach(function(aFile){try{aFile.imageProp=lPDF.getImageProperties(aFile.dataUrl);} catch(e){lPromisesErreursJsPDF.push(new Promise(function(aResolve,aReject){let lTypePDF='';switch(aFile.type){case'image/jpeg':lTypePDF='JPEG';break;case'image/png':lTypePDF='PNG';break;default:aReject({nom:aFile.fichier.Libelle});return;}
UtilitaireTraitementImage.loadImageDataUrlPromise(aFile.dataUrl).then(function(aFile,aTypePDF ,aImage){aFile.imageProp={width:aImage.width,height:aImage.height,fileType:aTypePDF};aResolve();}.bind(this,aFile,lTypePDF),function(aFile){return Promise.reject({nom:aFile.fichier.Libelle});}.bind(this,aFile));}));}});return Promise.all(lPromisesErreursJsPDF).then(function(){return aFilesDataUrl;});}}).then(function(aFilesDataUrl){if(aFilesDataUrl&&aFilesDataUrl.length>0){return new Promise(function(aResolve,aReject){const jsPDF=lGetJsPDF();let lPDF=new jsPDF();aFilesDataUrl.every(function(aFile,aIndex){try{const lImageProp=aFile.imageProp;if(aIndex!==0){lPDF.addPage([lImageProp.width,lImageProp.height]);} else{lPDF=new jsPDF({format:[lImageProp.width,lImageProp.height],unit:'px',orientation:lImageProp.width>=lImageProp.height?'l':'p',compress:true});}
lPDF.addImage(aFile.dataUrl,lImageProp.fileType,0,0,lImageProp.width/lPDF.internal.scaleFactor,lImageProp.height/lPDF.internal.scaleFactor,NaN,'SLOW');return true;} catch(e){aReject({nom:aFile.fichier.Libelle});return false;}});const lFile=lPDF.output('blob');lFile.name='file.pdf';aResolve({file:lFile});});}}).finally(function(){Invocateur.evenement(ObjetInvocateur.events.patience,false);});},getTabMIME_PDFImage:function(){return['image/jpeg','image/jpg','image/png','image/bmp','image/gif'];}};function _browserAutoRotates_promise(){return new Promise(function(resolve,reject){const image=new Image();image.onload=function(){resolve(image.naturalWidth===1);};image.onerror=reject;image.src='data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z';});}
_browserAutoRotates_promise().then(function(aVal){UtilitaireTraitementImage.browserAutoRotate=!!aVal;});if(!HTMLCanvasElement.prototype.toBlob){Object.defineProperty(HTMLCanvasElement.prototype,'toBlob',{value:function(callback,type,quality){const canvas=this;setTimeout(function(){const binStr=atob(canvas.toDataURL(type,quality).split(',')[1]),len=binStr.length,arr=new Uint8Array(len);for(let i=0;i<len;i++){arr[i]=binStr.charCodeAt(i);}
callback(new Blob([arr],{type:type||'image/png'}));});}});}
module.exports=UtilitaireTraitementImage;},fn:"utilitairetraitementimage.js"});;
IE.fModule({f:function(exports,require,module,global){const UtilitaireTraitementImage=require('UtilitaireTraitementImage.js');const GUID=require('GUID.js');const c_pilesImages={enCours:[],enAttente:[],nbMax:2,timeoutEchec:60*1000};let UtilitaireLoaderImage={loadImage:function(aNodeImage,aUrl){if(c_pilesImages.enCours.length>=c_pilesImages.nbMax){c_pilesImages.enAttente.push({node:aNodeImage,url:aUrl});} else{_loadImage(aNodeImage,aUrl);}}};const uGenerateurGUID=new GUID.generateur();function _loadImage(aNodeImage,aUrl){if(!aNodeImage||!document.body.contains(aNodeImage)){_depiler();return;}
const lId=uGenerateurGUID.get();c_pilesImages.enCours.push(lId);return Promise.race([
UtilitaireTraitementImage.loadImageDataUrlPromise(aUrl,aNodeImage).catch(function(){}),new Promise(function(aResolve){setTimeout(function(){aResolve();},c_pilesImages.timeoutEchec);})
]).then(function(){const lIndex=c_pilesImages.enCours.indexOf(lId);if(lIndex>=0){c_pilesImages.enCours.splice(lIndex,1);}
_depiler();});}
function _depiler(){if(c_pilesImages.enAttente.length>0&&c_pilesImages.enCours.length<c_pilesImages.nbMax){const lAttente=c_pilesImages.enAttente.shift();_loadImage(lAttente.node,lAttente.url);}}
module.exports=UtilitaireLoaderImage;},fn:"utilitaireloaderimage.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');const UtilitaireLoaderImage=require('UtilitaireLoaderImage.js');let uObserverImgSrc=null;IEHtml.addAttribut('ie-load-src',function(aContexteCourant,aNodeName,aAttributValue,aOutils){const lUrl=aAttributValue||'';if(lUrl){const lJNode=$(aContexteCourant.node);aContexteCourant.node.setAttribute('data-src',lUrl);if(lJNode.hasClass('img-portrait')){lJNode.on('error',function(){aContexteCourant.node.removeAttribute('src');aContexteCourant.node.classList.remove('ie-imgviewer');});} else{}
aOutils.surInjectionHtml(aContexteCourant,function(){if(uObserverImgSrc){uObserverImgSrc.observe(aContexteCourant.node);} else{UtilitaireLoaderImage.loadImage(aContexteCourant.node,lUrl);}});}
aOutils.addCommentaireDebug(aContexteCourant.node,`ie-load-src="${lUrl}"`);return true;});try{uObserverImgSrc=new IntersectionObserver(function(aObservables){aObservables.forEach(function(aObservable){if(aObservable.intersectionRatio>0||aObservable.isIntersecting){const lNode=aObservable.target;if(lNode){const lUrl=lNode.dataset.src;UtilitaireLoaderImage.loadImage(lNode,lUrl);uObserverImgSrc.unobserve(lNode);}}});});} catch(e){uObserverImgSrc=null;}},fn:"iehtml.load.src.js"});;
IE.fModule({f:function(exports,require,module,global){require('Produit/css/IEHtml.ImgViewer.css');const IEHtml=require('IEHtml.js');const{Invocateur}=require('Invocateur.js');const ZoneFenetre=require('IEZoneFenetre.js');const tag=require('tag.js');const ToucheClavier=require('ToucheClavier.js');const GUID=require('GUID.js');const GHtml=require('GHtml.js');const uSingleton_IdViewer=`id-imgviewer-${GUID.getId()}`;let uSingleton_ViewerIsVisible=false;IEHtml.addAttribut('ie-imgviewer',function(aContexteCourant,aNodeName,aAttributValue,aOutils){$(aContexteCourant.node).addClass('ie-imgviewer');$(aContexteCourant.node).on('click',function(aEvent){if(aNodeName!=='img'){return true;}
if(!aContexteCourant.node.classList.contains('ie-imgviewer')){return;}
_ouvrirViewer(aContexteCourant.node,aEvent,true);});aOutils.addCommentaireDebug(aContexteCourant.node,`ie-imgviewer`);return true;});function _ouvrirViewer(aNode,aEvent,aAvecAnimationOuverture){const lUrl=_getUrlImg(aNode);if(lUrl){if(aEvent){aEvent.stopPropagation();}
_fermer();let lIndicePrec= -1;let lIndiceSuiv= -1;let lJImgsNav;const lNodeDiapos=aNode.closest('.ie-imgviewer-container');if(lNodeDiapos){lJImgsNav=$(lNodeDiapos).find('img.ie-imgviewer');if(lJImgsNav.length>1){const lIndexImageCourante=lJImgsNav.index(aNode);lIndicePrec=lIndexImageCourante===0?lJImgsNav.length-1:lIndexImageCourante-1;lIndiceSuiv=lIndexImageCourante>=lJImgsNav.length-1?0:lIndexImageCourante+1;if(!_getUrlImg(lJImgsNav.get(lIndicePrec))){lIndicePrec= -1;}
if(!_getUrlImg(lJImgsNav.get(lIndiceSuiv))){lIndiceSuiv= -1;}}}
uSingleton_ViewerIsVisible=true;const lControleur={getNode(){$(this.node).on('click',() =>{_fermerTransition();});$(this.node).find('>div').on('pointerdown',(aEvent) =>{if(aEvent.pointerType!=='touch'&&(lIndicePrec>=0||lIndiceSuiv>=0)){_fermerTransition();}});if(lIndicePrec>=0){$(this.node).on('swiperight',() =>{_ouvrirViewer(lJImgsNav.get(lIndicePrec));});}
if(lIndiceSuiv>=0){$(this.node).on('swipeleft',() =>{_ouvrirViewer(lJImgsNav.get(lIndiceSuiv));});}},nodeImg(){$(this.node).on('load',function(){this.classList.remove('loading');const lNatHeight=this.naturalHeight;const lNatWidth=this.naturalWidth;const lPourcentEcran=0.9;let lRatio=0;const lClientL=GNavigateur.ClientL-(lIndicePrec>=0||lIndiceSuiv>=0?35*2:0);const lRatioImage=lNatHeight/lNatWidth;const lRatioEcran=GNavigateur.ClientH/lClientL;if(lRatioEcran>lRatioImage){lRatio=lClientL*lPourcentEcran/lNatWidth;} else{lRatio=GNavigateur.ClientH*lPourcentEcran/lNatHeight;}
lRatio=Math.min(lRatio,2);$(this).css({height:lNatHeight*lRatio,width:lNatWidth*lRatio});});},btnNav:{event(aIndiceNode,aEvent){_ouvrirViewer(lJImgsNav.get(aIndiceNode),aEvent);}}};IEHtml.injectHTMLParams({element:ZoneFenetre.getElementZoneFenetre(),html:tag('div',{id:uSingleton_IdViewer,class:['ie-imgviewer-popup',aAvecAnimationOuverture?'':'active'],'ie-node':'getNode'},tag('div'),lIndicePrec>=0?tag('ie-btnicon',{'ie-model':tag.funcAttr('btnNav',[lIndicePrec]),class:'icon_angle_left btn-carr-viewer prec bt-activable bt-large'}):'',lIndiceSuiv>=0?tag('ie-btnicon',{'ie-model':tag.funcAttr('btnNav',[lIndiceSuiv]),class:'icon_angle_right btn-carr-viewer suiv bt-activable bt-large'}):'',tag('img',{src:lUrl,class:['AvecMenuContextuel','loading'],'ie-node':'nodeImg'})),controleur:lControleur});if(aAvecAnimationOuverture){const lElement=GHtml.getElement(uSingleton_IdViewer);lElement.offsetWidth;lElement.classList.add('active');}}}
function _getUrlImg(aNode){if(aNode&&aNode.getAttribute){let lStrUrl=aNode.getAttribute('src')||aNode.getAttribute('data-src');if(lStrUrl){try{let lUrl=new URL(lStrUrl,location);lUrl.searchParams.delete('miniature');return lUrl.toString();} catch(e){return lStrUrl;}}}}
function _fermer(){if(uSingleton_ViewerIsVisible){uSingleton_ViewerIsVisible=false;$(`#${uSingleton_IdViewer}`).remove();}}
function _fermerTransition(){if(uSingleton_ViewerIsVisible){$(`#${uSingleton_IdViewer}`).removeClass('active').on('transitionend',() =>{_fermer();});}}
$(document).ready(() =>{$(document).on('keydown.imgviewer',(aEvent) =>{if(uSingleton_ViewerIsVisible&&[ToucheClavier.Espace,ToucheClavier.RetourChariot,ToucheClavier.Echap].includes(aEvent.which)){_fermerTransition();}});$(window).on('scroll.imgviewer resize.imgviewer',() =>{_fermerTransition();});});Invocateur.abonner('surAffichageFenetre',() =>{_fermerTransition();});},fn:"iehtml.imgviewer.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');IEHtml.addAttribut('ie-autoresize',function(aContexteCourant,aNodeName,aAttributValue,aOutils){if(aNodeName==='ie-textareamax'){return true;}
if(aNodeName!=='textarea'){return true;}
let lEstTextAreaMaxWrapper=false;let lJNode=$(aContexteCourant.node);let lInitBesoinObserveur=true;const lCalcul=function(){const lEstVisible=aContexteCourant.node.scrollHeight>0;if(!lEstVisible){if(lInitBesoinObserveur){lInitBesoinObserveur=false;let lObserver;try{lObserver=new IntersectionObserver(function(aObservables){if(aObservables[0]&&(aObservables[0].intersectionRatio>0||aObservables[0].isIntersecting)){lObserver.disconnect();lCalcul();}});lObserver.observe(aContexteCourant.node);} catch(e){lObserver=null;}}
return;}
lInitBesoinObserveur=false;aContexteCourant.node.style.height="5px";const lComputedStyle=global.getComputedStyle(aContexteCourant.node);const lTaille=aContexteCourant.node.scrollHeight+parseFloat(lComputedStyle.getPropertyValue('border-top-width'),10)+parseFloat(lComputedStyle.getPropertyValue('border-bottom-width'),10);aContexteCourant.node.style.height=lTaille+'px';if(lEstTextAreaMaxWrapper){const lNodeWrapper=aContexteCourant.node.closest('.textareamax-wrapper');if(!lNodeWrapper){return;}
const lHeightParent=$(lNodeWrapper).height();if(Math.ceil(lTaille)>lHeightParent){aContexteCourant.node.style.height=lHeightParent+'px';} else if(Math.ceil(lTaille)<lHeightParent){aContexteCourant.node.style.height='100%';}}};let lVal=lJNode.val();let lValPlaceHolder=lJNode.attr('placeholder');lJNode.on('input',function(){const lNewVal=lJNode.val();if(lVal!==lNewVal){lVal=lNewVal;lCalcul();}});aOutils.abonnerRefresh(function(){const lNewVal=lJNode.val();const lNewValPlaceHolder=lJNode.attr('placeholder');if(lVal!==lNewVal||lValPlaceHolder!==lNewValPlaceHolder){lVal=lNewVal;lValPlaceHolder=lNewValPlaceHolder;lCalcul();}},aContexteCourant.node,aContexteCourant);aOutils.surInjectionHtml(aContexteCourant,function(){lEstTextAreaMaxWrapper=lJNode.hasClass('textareamax')&&!!aContexteCourant.node.closest('.textareamax-wrapper');lCalcul();});aOutils.addCommentaireDebug(aContexteCourant.node,'ie-autoresize');});},fn:"iehtml.autoresize.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');const ToucheClavier=require('ToucheClavier.js');IEHtml.addClass('collapsible',function(aContexteCourant){_refresh(aContexteCourant);const lObserver=new MutationObserver((aMutations) =>{if(aMutations[0]&&aMutations[0].type==='childList'){_refresh(aContexteCourant);}});lObserver.observe(aContexteCourant.node,{childList:true});return true;});function _refresh(aContexteCourant){const lJNode=$(aContexteCourant.node);const lJHeaders=lJNode.children('li').children('.collapsible-header:not([data-iecollapsibleinit])');if(lJHeaders.length===0){return;}
lJHeaders.attr({'tabindex':0,'data-iecollapsibleinit':true});const lEstAccordeon=!aContexteCourant.node.classList.contains('collapsible-not-accordeon');const lJActiveBodies=lJNode.children('li.active').children('.collapsible-body');if(lEstAccordeon){lJActiveBodies.first().css('display','block');} else{lJActiveBodies.css('display','block');}
lJHeaders.each(function(aIndex,aElement){$(aElement).attr('aria-expanded',$(aElement).parent().hasClass('active')?'true':'false');});const lAction=(aEvent) =>{const $header=$(aEvent.target).closest('.collapsible-header');if(aEvent.target&&$header.length){const $collapsible=$header.closest('.collapsible');if($collapsible[0]===aContexteCourant.node){const $collapsibleLi=$header.closest('li');const $collapsibleLis=$collapsible.children('li');const isActive=$collapsibleLi[0].classList.contains('active');const index=$collapsibleLis.index($collapsibleLi);if(isActive){close(index);} else{open(index);}}}};lJHeaders.off('click.collapsible keydown.collapsible').on({'click.collapsible'(aEvent){lAction(aEvent);},'keydown.collapsible'(aEvent){if([ToucheClavier.Espace,ToucheClavier.RetourChariot,ToucheClavier.Echap].includes(aEvent.which)){lAction(aEvent);}}});function open(index){const $collapsibleLi=lJNode.children('li').eq(index);if($collapsibleLi.length&&!$collapsibleLi[0].classList.contains('active')){if(lEstAccordeon){const $collapsibleLis=lJNode.children('li');const $activeLis=lJNode.children('li.active');$activeLis.each(function(aIndex,aEl){const index=$collapsibleLis.index($(aEl));close(index);});}
$collapsibleLi[0].classList.add('active');const lJBody=$collapsibleLi.children('.collapsible-body');$collapsibleLi.children('.collapsible-header').attr('aria-expanded','true');lJBody.css({display:'block',height:0,overflow:'hidden'});const lHeight=lJBody[0].scrollHeight;const lPTop=lJBody.css('padding-top');const lPBottom=lJBody.css('padding-bottom');lJBody.css({paddingTop:0,paddingBottom:0});lJBody.css({height:lHeight+'px',paddingTop:lPTop,paddingBottom:lPBottom}).off('transitionend.collapsible').one('transitionend.collapsible',() =>{lJBody.css({height:'',paddingTop:'',paddingBottom:'',overflow:''});});}}
function close(index){const $collapsibleLi=lJNode.children('li').eq(index);if($collapsibleLi.length&&$collapsibleLi[0].classList.contains('active')){$collapsibleLi[0].classList.remove('active');const lJBody=$collapsibleLi.eq(0).children('.collapsible-body');$collapsibleLi.children('.collapsible-header').attr('aria-expanded','false');const lHeight=lJBody[0].scrollHeight;const lPTop=lJBody.css('padding-top');const lPBottom=lJBody.css('padding-bottom');lJBody.css({display:'block',height:lHeight+'px',paddingTop:lPTop,paddingBottom:lPBottom,overflow:'hidden'});lJBody.off('transitionend.collapsible');lJBody.get(0).offsetWidth;lJBody.css({height:'0',paddingTop:0,paddingBottom:0}).one('transitionend.collapsible',() =>{lJBody.css({display:'',overflow:'',height:'',paddingTop:'',paddingBottom:''});});}}}},fn:"iehtml.collapsible.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');const Support=require('ObjetSupport.js');IEHtml.addAttribut('ie-synthesevocale',function(aContexteCourant,aNodeName,aAttributValue,aOutils){if(!Support.speechSynthesis){return true;}
let lJNode=$(aContexteCourant.node);let lJNodeSpeaker=$('<div role="presentation" class="tam_speech textarea-counter"><i class="icon_smile"></i></div>');lJNodeSpeaker.on('click',function(){if(speechSynthesis.speaking){speechSynthesis.cancel();} else if(lJNode.text()||lJNode.val()){let lVoices=speechSynthesis.getVoices();let lUtterance=new SpeechSynthesisUtterance(lJNode.text()||lJNode.val());for(var i=0;i<lVoices.length;i++){if(lVoices[i].lang.substring(0,2)===GParametres.langue){lUtterance.voice=lVoices[i];break;}}
speechSynthesis.speak(lUtterance);}});aOutils.abonnerRefresh(function(){lJNodeSpeaker.css('display',lJNode.text()||lJNode.val());},aContexteCourant.node,aContexteCourant);aOutils.surInjectionHtml(aContexteCourant,function(){lJNode.after(lJNodeSpeaker);});aOutils.addCommentaireDebug(aContexteCourant.node,'ie-synthesevocale');});},fn:"iehtml.synthesevocale.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');const c_id_attribut_nodeVisibility='ie-visibility-observer';let uObserver_ie_node_visibility=null;try{uObserver_ie_node_visibility=new IntersectionObserver((aObservables) =>{for(const lObservable of aObservables){if(lObservable&&lObservable.target){const lCallbackChange=$(lObservable.target).data(c_id_attribut_nodeVisibility);if(lCallbackChange){const lVisible=lObservable.intersectionRatio>0||lObservable.isIntersecting;lCallbackChange(lVisible);}}}});} catch(e){uObserver_ie_node_visibility=null;}
IEHtml.addAttribut(c_id_attribut_nodeVisibility,(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.estFonction){return true;}
aOutils.surInjectionHtml(aContexteCourant,(...aParams) =>{const lCallback=(aVisible) =>{if(lInfos.callback([aVisible,...aParams])===false){$(aContexteCourant.node).data(c_id_attribut_nodeVisibility,null);uObserver_ie_node_visibility.unobserve(aContexteCourant.node);}};if(uObserver_ie_node_visibility){$(aContexteCourant.node).data(c_id_attribut_nodeVisibility,lCallback);uObserver_ie_node_visibility.observe(aContexteCourant.node);$(aContexteCourant.node).on(`destroyed.${c_id_attribut_nodeVisibility}`,() =>{uObserver_ie_node_visibility.unobserve(aContexteCourant.node);});} else{lCallback(true);}});aOutils.addCommentaireDebug(aContexteCourant.node,`${c_id_attribut_nodeVisibility}="${lValue}"`);return true;});},fn:"iehtml.visibilityobserver.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');const c_id_attribut_resizeObserver='ie-resize-observer';IEHtml.addAttribut(c_id_attribut_resizeObserver,(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.estFonction){return true;}
aOutils.surInjectionHtml(aContexteCourant,(...aParams) =>{try{let lResizeObserver=new ResizeObserver((aObservers) =>{const lObserver=aObservers[0];if(lObserver&&lObserver.contentRect){let lResult=false;try{lResult=lInfos.callback([{node:aContexteCourant.node,observer:lObserver,contentRect:lObserver.contentRect},...aParams]);} catch(e){lResult=false
;}
if(lResult===false&&lResizeObserver){lResizeObserver.disconnect();lResizeObserver=null;}}});lResizeObserver.observe(aContexteCourant.node);$(aContexteCourant.node).on(`destroyed.${c_id_attribut_resizeObserver}`,() =>{if(lResizeObserver){lResizeObserver.disconnect();lResizeObserver=null;}});} catch(e){}});aOutils.addCommentaireDebug(aContexteCourant.node,`${c_id_attribut_resizeObserver}="${lValue}"`);return true;});},fn:"iehtml.resizeobserver.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');const MethodesObjet=require('MethodesObjet.js');const GChaine=require('GChaine.js');const GHtml=require('GHtml.js');const ObjetHint=require('objethint.js');require('IEHtml.EllipisisMultiline.js');require('IEHtml.Load.Src.js');require('IEHtml.ImgViewer.js');require('IEHtml.AutoResize.js');require('IEHtml.Collapsible.js');require('IEHtml.SyntheseVocale.js');require('IEHtml.VisibilityObserver.js');require('IEHtml.ResizeObserver.js');IEHtml.addAttribut('ie-node',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.estFonction){return true;}
aOutils.surInjectionHtml(aContexteCourant,(...aParams) =>{lInfos.callback(aParams);});aOutils.addCommentaireDebug(aContexteCourant.node,'ie-node="'+lValue+'"');return true;});IEHtml.addAttribut('ie-nodeafter',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.estFonction){return true;}
aOutils.surInjectionHtml(aContexteCourant,(...aParams) =>{lInfos.callback(aParams);},true);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-nodeafter="'+lValue+'"');return true;});IEHtml.addAttribut('ie-event',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lValue=aAttributValue||'';if(!aContexteCourant.controleur){return;}
let lTab=lValue.split('->');if(lTab.length<2){return;}
let lMethode;const lEvents=lTab[0].trim().split('-');let lSelecteur=null;lTab.shift();lMethode=lTab.join('->');if(lMethode.length>2&&lMethode.charAt(0)==='{'){lTab=lMethode.split('}');if(lTab.length<2){return;}
const lNomSelecteur=lTab[0].slice(1);lTab.shift();lMethode=lTab.join('}');if(aContexteCourant.data&&aContexteCourant.data[lNomSelecteur]){lSelecteur=aContexteCourant.data[lNomSelecteur];} else{lSelecteur=lNomSelecteur;}}
const lInfos=aOutils.getAccesParametres(lMethode,aContexteCourant);if(!lInfos.valide||!lInfos.estFonction){return;}
if(lInfos){const lCallbackEvent=function(event){return lInfos.callback([event,this,aContexteCourant.node,aContexteCourant.data]);};if(lSelecteur){$(aContexteCourant.node).on(lEvents.join(' '),lSelecteur,{controleur:aContexteCourant.controleur},lCallbackEvent);} else{$(aContexteCourant.node).on(lEvents.join(' '),{controleur:aContexteCourant.controleur},lCallbackEvent);}
aOutils.addCommentaireDebug(aContexteCourant.node,'ie-event="'+lValue+'"');return true;} else{aOutils.addCommentaireDebug(aContexteCourant.node,'[ECHEC] ie-event="'+lValue+'"');}
return true;});IEHtml.addAttribut('ie-eventout',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.estFonction){return true;}
aOutils.surInjectionHtml(aContexteCourant,() =>{const lSelec='pointerdown.eventout keydown.eventout';function _event(aEvent,...aParams){if(aContexteCourant.node!==aEvent.target&&(aEvent.isTrigger||!GHtml.estDocument(aEvent.target))&&!$.contains(aContexteCourant.node,aEvent.target)){const lResult=lInfos.callback([aEvent,...aParams]);if(lResult&&lResult.nodesExclus&&lResult.callback){if(!lResult.nodesExclus.every||lResult.nodesExclus.every((aNode) =>{return!aNode||(aNode!==aEvent.target&&!$.contains(aNode,aEvent.target));})){lResult.callback();}}}}
$(aContexteCourant.node).on('destroyed',() =>{$(document).off(lSelec,_event);});$(document).on(lSelec,_event);});aOutils.addCommentaireDebug(aContexteCourant.node,'ie-eventout="'+lValue+'"');return true;});IEHtml.addAttribut('ie-title',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lNom=aAttributValue||'';let lGetter;let lOldValue=lNom;if(lNom&&aContexteCourant.controleur){const lInfos=aOutils.getAccesParametres(lNom,aContexteCourant,true);if(lInfos.estFonction){lGetter=function(){const lResult=(lInfos.callback([aContexteCourant.node,aContexteCourant.data])||'')+'';return lResult.replace&&GChaine&&GChaine.enleverEntites?GChaine.enleverEntites(lResult):'';};}}
if(lGetter){lOldValue=lGetter();} else if(lOldValue==='undefined'||lOldValue==='null'){return false;} else{}
$(aContexteCourant.node).attr('title',lOldValue);if(lGetter){aOutils.abonnerRefresh(() =>{const lValue=lGetter().toString();if(lOldValue!==lValue){lOldValue=lValue;$(aContexteCourant.node).attr('title',lOldValue);}},aContexteCourant.node,aContexteCourant);}
aOutils.addCommentaireDebug(aContexteCourant.node,'ie-title'+(lNom?'="'+lNom+'"':''));return true;});IEHtml.addAttribut('ie-hint',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{if(ObjetHint.getDisabled()){aOutils.addCommentaireDebug(aContexteCourant.node,'ie-hint (désactivé sur mobile !)');return true;}
const lNom=aAttributValue||'';let lValue=lNom;if(lValue&&lValue.length>2&&lValue.charAt(0)==='\''&&lValue.charAt(lValue.length-1)==='\''){lValue=lValue.slice(1,lValue.length-1);} else if(lNom&&aContexteCourant.controleur){const lInfos=aOutils.getAccesParametres(lNom,aContexteCourant,true);if(lInfos.estFonction){lValue=function(aHint){const lResult=lInfos.callback([aHint,aContexteCourant.node,aContexteCourant.data]);if(lResult&&lResult.then){return lResult;}
return(lResult||'')+'';};}}
if(!lValue&&aContexteCourant.data&&aContexteCourant.data.$hint){lValue=aContexteCourant.data.$hint;}
if(!lValue){return true;}
ObjetHint.attach({$Element:$(aContexteCourant.node),namespace:'iehint',contenu:lValue,off:false});$(aContexteCourant.node).addClass('jiehint');aOutils.addCommentaireDebug(aContexteCourant.node,'ie-hint'+(lNom?'="'+lNom+'"':''));return true;});IEHtml.addAttribut('ie-html',(aContexteCourant,aNodeName,aAttributValue,aOutils,aParametresCompile) =>{let lValue=aAttributValue||'';if(!lValue){lValue=aContexteCourant.data?aContexteCourant.data.$html:'';}
if(!lValue){return true;}
if(!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.valide){return true;}
const lNodeDestination=aOutils.addGetterHtml(aContexteCourant,lInfos);if(!lNodeDestination){return;}
aOutils.addCommentaireDebug(lNodeDestination,'ie-html="'+lValue+'"');aParametresCompile.avecCompileFils=false;return true;});IEHtml.addAttribut('ie-texte',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lValue=aAttributValue||'';if(!lValue){return true;}
if(!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.valide){return true;}
const lNodeDestination=aContexteCourant.nodeTransfertContenuDynamique||aContexteCourant.node;const lGetter=function(){const lResult=lInfos.callback([lNodeDestination,aContexteCourant.data]);if(MethodesObjet.isNumber(lResult)){return lResult+'';}
return(lResult||'')+'';};let lOldTexte=lGetter();$(lNodeDestination).IEHtml('');lNodeDestination.appendChild(document.createTextNode(lOldTexte));aOutils.abonnerRefresh(() =>{const lTexte=lGetter();if(lTexte!==lOldTexte){lOldTexte=lTexte;$(lNodeDestination).IEHtml('');lNodeDestination.appendChild(document.createTextNode(lTexte));}},lNodeDestination,aContexteCourant);aOutils.addCommentaireDebug(lNodeDestination,'ie-texte="'+lValue+'"');return true;});IEHtml.addAttribut('ie-style',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{let lValue=aAttributValue||'';if(!lValue){lValue=aContexteCourant.data?aContexteCourant.data.$style:'';}
if(!lValue){return true;}
if(!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.valide){return true;}
const lGetter=function(){const lStyle=lInfos.callback([aContexteCourant.node,aContexteCourant.data])||null;return lStyle||{};};let lObjetCss=lGetter(aContexteCourant.node);const lJNode=$(aContexteCourant.node);if(!lInfos.estFonction||!lObjetCss){return;}
lJNode.css(lObjetCss);aOutils.abonnerRefresh(() =>{const lNewStyleCss=lGetter(aContexteCourant.node);if(!MethodesObjet.objetsIdentiques(lNewStyleCss,lObjetCss)){lObjetCss=lNewStyleCss;$(aContexteCourant.node).css(lObjetCss);}},aContexteCourant.node,aContexteCourant);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-style="'+lValue+'"');return true;});(function(){IEHtml.addAttribut('ie-class',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.valide){return true;}
let lClassCss=lInfos.callback()||'';if(lClassCss.length>0){$(aContexteCourant.node).addClass(lClassCss);}
aOutils.abonnerRefresh(() =>{const lNewClassCss=lInfos.callback()||'';if(lNewClassCss!==lClassCss){$(aContexteCourant.node).removeClass(lClassCss).addClass(lNewClassCss);lClassCss=lNewClassCss;}},aContexteCourant.node,aContexteCourant);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-class="'+lValue+'"');return true;});}());(function(){IEHtml.addAttribut('ie-display',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.valide){return true;}
const lGetter=function(){return!!lInfos.callback([aContexteCourant.node,aContexteCourant.data]);};const lDisplay=lGetter(aContexteCourant.node);GHtml.setDisplay(aContexteCourant.node,lDisplay);let lOldDisplayValue=lDisplay;aOutils.abonnerRefresh(() =>{const lDisplay=lGetter(aContexteCourant.node);if(lDisplay!==lOldDisplayValue){lOldDisplayValue=lDisplay;GHtml.setDisplay(aContexteCourant.node,lDisplay);}},aContexteCourant.node,aContexteCourant);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-display="'+lValue+'"');return true;});}());IEHtml.addAttribut('ie-attr',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{const lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){return true;}
const lInfos=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lInfos.estFonction){return true;}
const lGetter=function(){return lInfos.callback([]);};let lAttr=MethodesObjet.dupliquer(lGetter());if(lAttr){$(aContexteCourant.node).attr(lAttr);}
aOutils.abonnerRefresh(() =>{const lNewAttr=lGetter();if(!MethodesObjet.objetsIdentiques(lNewAttr,lAttr)){lAttr=MethodesObjet.dupliquer(lNewAttr);$(aContexteCourant.node).attr(lAttr);}},aContexteCourant.node,aContexteCourant);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-attr="'+lValue+'"');return true;});function _initEllipsis(aContexteCourant,aOutils,aAttributValue){const lOptions={getJNodeHint:null,avecHint:true};if(aAttributValue){const lGetOptions=aOutils.getAccesParametres(aAttributValue,aContexteCourant);if(lGetOptions.estFonction){Object.assign(lOptions,lGetOptions.callback());} else{}}
$(aContexteCourant.node).addClass('ie-ellipsis');if(lOptions.avecHint&&!ObjetHint.getDisabled()){aOutils.surInjectionHtml(aContexteCourant,(aParams) =>{if(ObjetHint.nodeDansHint(aContexteCourant.node)){return;}
aParams.addMutate(() =>{ObjetHint.attach({$Element:MethodesObjet.isFunction(lOptions.getJNodeHint)?lOptions.getJNodeHint(aContexteCourant.node):$(aContexteCourant.node),namespace:'ellipsis',contenu:function(){return $(aContexteCourant.node).html();},interrupt:function(){const lJThis=$(aContexteCourant.node);if(lJThis.hasClass('jiehint')){return true;}
if(lJThis.prop('title').length>0){return true;}
if(Math.ceil(lJThis.outerWidth())>=lJThis.prop('scrollWidth')){return true;}}});});},true);}}
IEHtml.addAttribut('ie-ellipsis',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{_initEllipsis(aContexteCourant,aOutils,aAttributValue);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-ellipsis');return true;});IEHtml.addAttribut('ie-ellipsis-fixe',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{_initEllipsis(aContexteCourant,aOutils,aAttributValue);aOutils.surInjectionHtml(aContexteCourant,(aParams) =>{let lWidth=null;aParams.addMeasure(() =>{if(!aContexteCourant.node.style.width){lWidth=$(aContexteCourant.node).width();}});aParams.addMutate(() =>{if(lWidth!==null){$(aContexteCourant.node).width(Math.ceil(lWidth));}});},true);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-ellipsis-fixe');return true;});IEHtml.addAttribut('ie-hintoverflow',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{aOutils.surInjectionHtml(aContexteCourant,(aParams) =>{aParams.addMutate(() =>{ObjetHint.attach({$Element:$(aContexteCourant.node),namespace:'ie-hintoverflow',contenu:function(){return $(aContexteCourant.node).html();},interrupt:function(){const lJThis=$(this);if(lJThis.hasClass('jiehint')){return true;}
if(lJThis.prop('title').length>0){return true;}
const lScrollH=lJThis.prop('scrollHeight')-1;const lScrollW=lJThis.prop('scrollWidth')-1;if(lScrollH<5||lScrollW<5){return true;}
if(Math.ceil(lJThis.outerHeight())>=lScrollH&&Math.ceil(lJThis.outerWidth())>=lScrollW){return true;}}});});},true);aOutils.addCommentaireDebug(aContexteCourant.node,'ie-hintoverflow');return true;});IEHtml.addAttribut('ie-selecttextfocus',(aContexteCourant,aNodeName,aAttributValue,aOutils) =>{if(aNodeName!=='input'&&aNodeName!=='textarea'){return true;}
$(aContexteCourant.node).on({'focus':function(){if(this.select){this.select();}},'mouseup':function(e){e.preventDefault();}});aOutils.addCommentaireDebug(aContexteCourant.node,'ie-selecttextfocus');return true;});module.exports=IEHtml;},fn:"iehtmlcomposants.js"});;
IE.fModule({f:function(exports,require,module,global){require('produit/css/IEHtml.BtnImage.css');const IEHtml=require('IEHtml.js');const GLog=require('IELog.js');const{Invocateur}=require('Invocateur.js');const GHtml=require('GHtml.js');const ControleSaisieEvenement=require('ControleSaisieEvenement.js');const{GObjetWAI,EGenreRole,EGenreAttribut}=require('ObjetWAI.js');const TypeEtatBtnImage={NonSelectionne:0,Inactif:1,ClicNonSelectionne:2,Selectionne:3,SurvolNonSelectionne:4,SurvolSelectionne:5};IEHtml.addBalise('ie-btnimage',function(aContexteCourant,aOutils){return _ieBtn(false,aContexteCourant,aOutils);});IEHtml.addBalise('ie-btnicon',function(aContexteCourant,aOutils){return _ieBtn(true,aContexteCourant,aOutils);});function _ieBtn(aForcerIcone,aContexteCourant,aOutils){let lEstIcone;let lEstSVG;function _actualiser(aJBouton,aData,aEtat){if(lEstIcone){if(aData.$selection){aJBouton.addClass('btnImageSelection');} else{aJBouton.removeClass('btnImageSelection');}}
if(lEstIcone||lEstSVG){return;}
if(!aData.$disabled){if(aData.$selection){aData.$genre=aEtat.survol?TypeEtatBtnImage.SurvolSelectionne:TypeEtatBtnImage.Selectionne;} else if(aEtat.clique){aData.$genre=TypeEtatBtnImage.ClicNonSelectionne;} else{aData.$genre=aEtat.survol?TypeEtatBtnImage.SurvolNonSelectionne:TypeEtatBtnImage.NonSelectionne;}} else{aData.$genre=TypeEtatBtnImage.Inactif;}
aJBouton.css('background-position',(-aData.$width*aData.$genre)+'px 0');}
const lEtat={clique:false,survole:false};Object.assign(aContexteCourant.data,{$width:20,$selection:false,$genre:TypeEtatBtnImage.NonSelectionne,$disabled:false});const lInnerHtml=aContexteCourant.node.innerHTML;lEstSVG=!!lInnerHtml&&$(aContexteCourant.node).find('svg').length>0;const lEstIconeStandard=aForcerIcone||$(aContexteCourant.node).hasClass('btnImageIcon');lEstIcone=lEstIconeStandard||$(aContexteCourant.node).hasClass('ObjetBoutonBandeau_icone')||$(aContexteCourant.node).hasClass('ObjetBoutonMenu_icone');const lBouton=lEstIcone?GHtml.htmlToDOM('<i '+GObjetWAI.composeRole(EGenreRole.Button)+' tabindex="0">'+'</i>'):GHtml.htmlToDOM('<div '+GObjetWAI.composeRole(EGenreRole.Button)+' tabindex="0">'+'</div>');const lJBouton=$(lBouton);lJBouton.IEData(aContexteCourant.data);let lInfosEvent,lInfosGetSelection,lInfosGetDisabled,lInfosGetTitle,lRefresh,lAvecControleSaisie,lDisabled=false,lModele=aOutils.getModel(aContexteCourant),lAvecLabelAccessible=aContexteCourant.node.hasAttribute(GObjetWAI.WaiAttribut[EGenreAttribut.label]),lLabelWAIManquant=!lAvecLabelAccessible,lSetTitle=function(aTitle){aContexteCourant.data.$oldTitle=aTitle;lJBouton.attr('title',aTitle);if(!lAvecLabelAccessible){lJBouton.attr(GObjetWAI.WaiAttribut[EGenreAttribut.label],aTitle);}};let lSetDisabled;if(lModele&&aContexteCourant.data.$modeleParsed){lInfosEvent=aOutils.getAccesParametresModel('event',aContexteCourant);lInfosGetSelection=aOutils.getAccesParametresModel('getSelection',aContexteCourant);lInfosGetDisabled=aOutils.getAccesParametresModel('getDisabled',aContexteCourant);lInfosGetTitle=aOutils.getAccesParametresModel('getTitle',aContexteCourant);lRefresh=aContexteCourant.contexte.refresh;lAvecControleSaisie=aOutils.getControleSaisieEvent(aContexteCourant);if(lInfosEvent.estFonction){lJBouton.eventValidation(function(event){if(aContexteCourant.data.$disabled){return;}
const lAction=function(){const lResult=lInfosEvent.callback([event,this,aContexteCourant.data]);lRefresh();return lResult;};if(lAvecControleSaisie){ControleSaisieEvenement(lAction);} else{return lAction();}});}
let lGetSelection,lGetterDisabled,lGetterTitle;if(lInfosGetSelection.valide){lGetSelection=function(){return!!lInfosGetSelection.callback([aContexteCourant.node,aContexteCourant.data]);};aContexteCourant.data.$selection=lGetSelection();}
if(lInfosGetDisabled.valide){lGetterDisabled=function(){return!!lInfosGetDisabled.callback([lBouton,aContexteCourant.data]);};if(lInfosGetDisabled.estFonction||!lGetterDisabled()||lGetterDisabled()===true){lDisabled=!!lGetterDisabled();} else{lGetterDisabled=null;GLog.addLog('echec getDisabled de ie-bouton, propriété incorrecte du model "'+lModele+'"');}}
if(lInfosGetTitle.estFonction){lGetterTitle=function(){return lInfosGetTitle.callback([lBouton,aContexteCourant.data])||'';};lSetTitle(lGetterTitle());lLabelWAIManquant=false;}
lSetDisabled=function(aDisabled){if(aDisabled){lJBouton.attr(GObjetWAI.WaiAttribut[EGenreAttribut.disabled],'true');lJBouton.addClass('btnImageDisable');} else{lJBouton.get(0).removeAttribute(GObjetWAI.WaiAttribut[EGenreAttribut.disabled]);lJBouton.removeClass('btnImageDisable');}};if(lGetSelection||lGetterDisabled||lGetterTitle){aOutils.abonnerRefresh(function(){let lActualiser=false;if(lGetSelection){const lSelection=lGetSelection();if(lSelection!==aContexteCourant.data.$selection){aContexteCourant.data.$selection=lSelection;lActualiser=true;}}
if(lGetterDisabled){const lDisabled=!!lGetterDisabled();if(lDisabled!==aContexteCourant.data.$disabled){aContexteCourant.data.$disabled=lDisabled;lSetDisabled(lDisabled);lActualiser=true;}}
if(lActualiser){_actualiser(lJBouton,aContexteCourant.data,lEtat);}
if(lGetterTitle){const lTitle=lGetterTitle();if(lTitle!==aContexteCourant.data.$oldTitle){lSetTitle(lTitle);}}},lBouton,aContexteCourant);}}
aOutils.copyAttributs(aContexteCourant.node,lBouton,function(aName,aValue){if(aName==='title'&&aValue&&(!lInfosGetTitle||!lInfosGetTitle.estFonction)){lJBouton.attr(GObjetWAI.WaiAttribut[EGenreAttribut.label],aValue);lLabelWAIManquant=false;}});if(!lBouton.style.width){if(!lEstSVG&&!lEstIconeStandard){lBouton.style.width=aContexteCourant.data.$width+'px';}} else{aContexteCourant.data.$width=parseInt(lBouton.style.width,10)||aContexteCourant.data.$width;}
aContexteCourant.data.$disabled=lDisabled;_actualiser(lJBouton,aContexteCourant.data,lEtat);if(lDisabled){lSetDisabled(lDisabled);}
lJBouton.addClass('btnImage OmbreFocus').on('focusin mouseover',function(){lEtat.survol=true;_actualiser(lJBouton,aContexteCourant.data,lEtat);}).on('focusout mouseout',function(){lEtat.survol=false;_actualiser(lJBouton,aContexteCourant.data,lEtat);}).on('pointerdown',function(){lEtat.clique=true;_actualiser(lJBouton,aContexteCourant.data,lEtat);Invocateur.abonnerUnique(GNavigateur.getEventInvocateur('pointerup'),function(){lEtat.clique=false;_actualiser(lJBouton,aContexteCourant.data,lEtat);});});const lRacine=lJBouton.get(0);aOutils.replaceNode(aContexteCourant.node,lRacine);if(lModele&&aContexteCourant.data.$modeleParsed){aOutils.surNodeEtNodeAfter(aContexteCourant);}
aOutils.addCommentaireDebug(lRacine,aForcerIcone?'ie-btnicon':'ie-btnimage');if(lInnerHtml){aOutils.injectHTML({element:lRacine,html:lInnerHtml,controleur:aContexteCourant.controleur,ignorerScroll:true,contexte:aContexteCourant.contexte});}
return{node:lRacine,avecCompileFils:false};}
module.exports=IEHtml;},fn:"iehtml.btnimage.js"});;
IE.fModule({f:function(exports,require,module,global){require('Espace/css/IESwitch.css');require('Produit/css/IEHtml.CheckboxRadio.css');const IEHtml=require('IEHtml.js');const TypeCBRadio={checkbox:'checkbox',radio:'radio',switch:'switch'};function _creerCBEtRB(aContexteCourant,aType,aOutils){const lInnerHTML=aContexteCourant.node.innerHTML;const lNomModele=aOutils.getModel(aContexteCourant);const lAvecIEHtml=aContexteCourant.node.hasAttribute('ie-html');const lAvecIETexte=aContexteCourant.node.hasAttribute('ie-texte');const lInfosGetLibelle=lNomModele?aOutils.getAccesParametresModel('getLibelle',aContexteCourant):null;const lAvecGetLibelle=lInfosGetLibelle&&lInfosGetLibelle.estFonction;const lAvecLibelle=lInnerHTML.length>0||lAvecIEHtml||lAvecIETexte||lAvecGetLibelle;let lJModele;let lJInput;let lRacine;let llName;let lContexteCourant;const lMap=aOutils.getMapDeNode(aContexteCourant.node);let lEventMap;let lEtatIndetermine=false;let lSubstitution=true;let lEstGauche=!IE.estMobile;let lEstDroite=IE.estMobile;if(!lEstGauche&&aContexteCourant.node.hasAttribute('ie-textright')){lEstGauche=true;lEstDroite=false;}
if(!lEstDroite&&aContexteCourant.node.hasAttribute('ie-textleft')){lEstGauche=false;lEstDroite=true;}
aContexteCourant.data.estRadioBouton=aType===TypeCBRadio.radio;let lClassCss;let lClassSpan='';let lSpanGauche='';let lSpanDroite='';if(aType===TypeCBRadio.switch){if(!lAvecIEHtml&&!lAvecIETexte&&!lAvecGetLibelle&&lInnerHTML&&aContexteCourant.node.childNodes.length===2&&aContexteCourant.node.childNodes[0].nodeName.toLowerCase()==='span'&&aContexteCourant.node.childNodes[1].nodeName.toLowerCase()==='span'){lSpanGauche=aContexteCourant.node.childNodes[0][IE.estMobile?'innerHTML':'outerHTML'];lSpanDroite=aContexteCourant.node.childNodes[1].outerHTML;lEstGauche=true;lEstDroite=false;}
lClassCss='ieswitch '+(lEstDroite?'iecbrbdroite':'iecbrbgauche');lClassSpan='lever';} else{lClassCss='iecb '+(lEstDroite?'iecbrbdroite':'iecbrbgauche');}
if($(aContexteCourant.node).hasClass('as-chips')){let lImageIconChips=aContexteCourant.node.getAttribute('ie-icon')||'';if(lImageIconChips){aContexteCourant.node.removeAttribute('ie-icon');}
lClassCss+=' '+lImageIconChips;}
if(aContexteCourant.node.nodeName.toLowerCase()==='input'){lSubstitution=false;lJInput=$(aContexteCourant.node);lJInput.wrap('<label class="'+lClassCss+'">');lJInput.parent().append('<span'+(lClassSpan?' class="'+lClassSpan+'"':'')+'  aria-hidden="true"></span>');if(!lInnerHTML&&lAvecLibelle){lJInput.parent().append('<span></span>');}
lJModele=lJInput.parent();if(!lMap.type){lJInput.attr('type',aType!==TypeCBRadio.radio?'checkbox':'radio');}
lJInput.removeAttr('class').removeAttr('style');} else{lJModele=$((aType===TypeCBRadio.switch?'<div class="switch">':'')+'<label class="'+lClassCss+'">'+'<input type="'+(aType!==TypeCBRadio.radio?'checkbox':'radio')+'" />'+'<span'+(lClassSpan?' class="'+lClassSpan+'"':'')+' aria-hidden="true"></span>'+(!lInnerHTML&&lAvecLibelle&&!lSpanDroite?'<span></span>':'')+'</label>'+(aType===TypeCBRadio.switch?'</div>':''));lJInput=lJModele.find('input');}
lRacine=lJModele.get(0);lJModele.IEData(aContexteCourant.data);Object.assign(aContexteCourant.data,{$couleurActif:'',$couleurInactif:GCouleur.nonEditable.texte,$AvecMain:true});for(llName in lMap){if(llName!=='type'&&llName!=='ie-textright'&&llName!=='ie-textleft'){try{if(llName==='style'||llName==='title'||aOutils.composantsAttributs[llName]){lJModele.attr(llName,lMap[llName]);if(!lSubstitution&&llName!=='style'){lJInput.removeAttr(llName);}} else if(llName==='class'){lJModele.addClass(lMap[llName]);} else{if(lSubstitution){lJInput.attr(llName,lMap[llName]);}}} catch(e){}}}
if(aType===TypeCBRadio.radio&&!lMap.name&&lNomModele&&aContexteCourant.data.$modeleParsed&&aContexteCourant.controleur){lJInput.attr('name',aContexteCourant.controleur.$GUID+'_'+aContexteCourant.data.$modeleParsed.nom);}
if(aType===TypeCBRadio.checkbox){lEtatIndetermine=$(aContexteCourant.node).cbIndeterminate();if(lNomModele&&aContexteCourant.data.$modeleParsed){const lInfosGetIndeterminate=aOutils.getAccesParametresModel('getIndeterminate',aContexteCourant);if(lInfosGetIndeterminate.estFonction){lEtatIndetermine=!!lInfosGetIndeterminate.callback();aOutils.abonnerRefresh(function(){const lEtat=!!lInfosGetIndeterminate.callback();if(lEtat!==lEtatIndetermine){lEtatIndetermine=lEtat;lJInput.prop('indeterminate',lEtatIndetermine);}},lJInput.get(0),aContexteCourant);}}}
lEventMap={};lEventMap.focus=function(){$(this).parent().triggerHandler('focusin');};lEventMap.blur=function(){$(this).parent().triggerHandler('focusout');};lJInput.on(lEventMap);if(aContexteCourant.data.$modeleValue){lContexteCourant=Object.assign({},aContexteCourant);lContexteCourant.node=lJInput.get(0);aOutils.gererInputCB(lContexteCourant,lMap.type);} else{lJInput.on(IEHtml.C_eventsModifyCheckbox,function(){aContexteCourant.contexte.refresh();});}
if(lEtatIndetermine){lJInput.prop('indeterminate',lEtatIndetermine);}
const lJLabelParent=lJInput.closest('label');const lGetDisabled=function(){return lJInput.is(':disabled');};let lEstDisabled=lGetDisabled();if(lEstDisabled){lJLabelParent.addClass('is-disabled');}
const lGetChecked=function(){return lJInput.is(':checked');};let lEstChecked=lGetChecked();if(lEstChecked){lJLabelParent.addClass('is-checked');}
aOutils.abonnerRefresh(function(){const lNewEstDisabled=lGetDisabled();if(lNewEstDisabled!==lEstDisabled){if(lNewEstDisabled){lJLabelParent.addClass('is-disabled');} else{lJLabelParent.removeClass('is-disabled');}
lEstDisabled=lNewEstDisabled;}
const lNewEstChecked=lGetChecked();if(lNewEstChecked!==lEstChecked){if(lNewEstChecked){lJLabelParent.addClass('is-checked');} else{lJLabelParent.removeClass('is-checked');}
lEstChecked=lNewEstChecked;}},lJInput.get(0),aContexteCourant);if(lSubstitution){aOutils.replaceNode(aContexteCourant.node,lRacine);}
aOutils.addCommentaireDebug(lRacine,('ie-'+aType));if(lAvecLibelle){let lDest=lRacine;if(aType===TypeCBRadio.switch){lDest=lRacine.firstChild;}
if(lSpanGauche){aOutils.injectHTML({element:lDest,insererAvantLeNode:lJModele.find('span.lever').get(0),html:lSpanGauche,controleur:aContexteCourant.controleur,ignorerScroll:true,contexte:aContexteCourant.contexte});}
if(lInnerHTML){aOutils.injectHTML({element:lDest,html:lSpanDroite||'<span>'+lInnerHTML+'</span>',controleur:aContexteCourant.controleur,ignorerScroll:true,contexte:aContexteCourant.contexte});}
aContexteCourant.nodeTransfertContenuDynamique=lDest.lastChild;if(lAvecGetLibelle){aOutils.addGetterHtml(aContexteCourant,lInfosGetLibelle);}}
aContexteCourant.node=lRacine;return{node:aContexteCourant.node,avecCompileFils:false};}
IEHtml.addBalise('ie-checkbox',function(aContexteCourant,aOutils){return _creerCBEtRB(aContexteCourant,TypeCBRadio.checkbox,aOutils);});IEHtml.addBalise('ie-radio',function(aContexteCourant,aOutils){return _creerCBEtRB(aContexteCourant,TypeCBRadio.radio,aOutils);});IEHtml.addBalise('ie-switch',function(aContexteCourant,aOutils){return _creerCBEtRB(aContexteCourant,TypeCBRadio.switch,aOutils);});module.exports=IEHtml;},fn:"iehtml.checkboxradio.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');const MethodesObjet=require('MethodesObjet.js');IEHtml.addAttribut('ie-identite',function(aContexteCourant,aNodeName,aAttributValue,aOutils){const lNode=aContexteCourant.node;if(lNode.id){return true;}
const lValue=aAttributValue||'';if(!lValue||!aContexteCourant.controleur){return true;}
const lCallbackParams=aOutils.getAccesParametres(lValue,aContexteCourant);if(!lCallbackParams.estFonction){return true;}
const lValueCallback=lCallbackParams.callback([]);if(!lValueCallback||!lValueCallback.class||!lValueCallback.pere){return true;}
const lInfosInstance=aOutils.creerInstanceIdentite(lValueCallback.class,{pere:lValueCallback.pere,evenement:lValueCallback.evenement});lNode.id=lInfosInstance.instance.GetNom();$(lNode).on('destroyed',function(){if(MethodesObjet.isFunction(lValueCallback.destroy)){lValueCallback.destroy(lInfosInstance.instance);}
lInfosInstance.callbackDestruction();lInfosInstance.instance.free();lInfosInstance.instance=null;});if(MethodesObjet.isFunction(lValueCallback.init)){lValueCallback.init(lInfosInstance.instance);}
aOutils.surInjectionHtml(aContexteCourant,function(){if(MethodesObjet.isFunction(lInfosInstance.instance.Initialiser)){lInfosInstance.instance.Initialiser();}
if(MethodesObjet.isFunction(lValueCallback.start)){lValueCallback.start(lInfosInstance.instance);}});aOutils.addCommentaireDebug(aContexteCourant.node,'ie-identite="'+lValue+'"');return true;});module.exports=IEHtml;},fn:"iehtml.identite.js"});;
IE.fModule({f:function(exports,require,module,global){require('Produit/Css/IEHtml.Chips.css');const IEHtml=require('IEHtml.js');const GHtml=require('GHtml.js');const{GObjetWAI,EGenreRole,EGenreAttribut}=require('ObjetWAI.js');const GTraductions=require('ObjetTraduction.js');const ToucheClavier=require('ToucheClavier.js');IEHtml.addBalise('ie-chips',function(aContexteCourant,aOutils){const lModele=aOutils.getModel(aContexteCourant);const lInnerHtml=aContexteCourant.node.innerHTML;const lHref=aContexteCourant.node.getAttribute('href');const lOptions={avecBtn:true,classIconeBtn:'icon_fermeture_widget ',titleBtn:GTraductions.getValeur('Supprimer'),disabled:false};const lHtmlInterneChips='<div class="text" ie-ellipsis>'+lInnerHtml+'</div>';const lElementChips=GHtml.htmlToDOM(lHref?'<a href="'+lHref+'" target="_blank">'+lHtmlInterneChips+'</a>':'<div tabindex="0">'+lHtmlInterneChips+'</div>');const lJChips=$(lElementChips);let lJBtn=null;let lInfosEvent;let lInfosEventBtn;let lInfosGetDisabled;let lInfosGetOptions;let lInfosGetLibelle;const lRefresh=aContexteCourant.contexte.refresh;if(lModele&&aContexteCourant.data.$modeleParsed){lInfosEvent=aOutils.getAccesParametresModel('event',aContexteCourant);lInfosEventBtn=aOutils.getAccesParametresModel('eventBtn',aContexteCourant);lInfosGetDisabled=aOutils.getAccesParametresModel('getDisabled',aContexteCourant);lInfosGetOptions=aOutils.getAccesParametresModel('getOptions',aContexteCourant);lInfosGetLibelle=aOutils.getAccesParametresModel('getLibelle',aContexteCourant);if(lInfosGetOptions.estFonction){Object.assign(lOptions,lInfosGetOptions.callback([lElementChips]));}
let lGetterDisabled;if(lInfosGetDisabled.estFonction){lGetterDisabled=function(){return!!lInfosGetDisabled.callback([]);};lOptions.disabled=lGetterDisabled();}
const lSetDisabled=function(){if(lOptions.disabled){lJChips.attr(GObjetWAI.WaiAttribut[EGenreAttribut.disabled],'true');lJChips.addClass('disabled');} else{lElementChips.removeAttribute(GObjetWAI.WaiAttribut[EGenreAttribut.disabled]);lJChips.removeClass('disabled');}};if(lOptions.disabled){lSetDisabled();}
if(lGetterDisabled){aOutils.abonnerRefresh(function(){if(lGetterDisabled){const lDisabled=!!lGetterDisabled();if(lDisabled!==lOptions.disabled){lOptions.disabled=lDisabled;lSetDisabled();}}},lElementChips,aContexteCourant);}}
if(lOptions.avecBtn&&lOptions.classIconeBtn&&lInfosEventBtn&&lInfosEventBtn.estFonction){lJChips.append('<i class="btn OmbreFocus '+lOptions.classIconeBtn+'" '+GObjetWAI.composeRole(EGenreRole.Button)+' tabindex="0"'+GHtml.composeAttr('title',lOptions.titleBtn)+'>');lJBtn=lJChips.find('>i');}
if(!lHref&&lInfosEvent&&lInfosEvent.estFonction){lElementChips.setAttribute('role','button');}
aOutils.copyAttributs(aContexteCourant.node,lElementChips);let lClass='ie-chips OmbreFocus'+(lHref?' AvecMenuContextuel':'');if((lInfosEvent&&lInfosEvent.estFonction)||lHref){lJChips.eventValidation(function(aEvent){if(aEvent.originalEvent&&aEvent.originalEvent.__eventBtn__){return;}
if(lOptions.disabled){if(lHref){return false;}
return;}
if((lInfosEvent&&lInfosEvent.estFonction)){const lResult=lInfosEvent.callback([aEvent]);lRefresh();return lResult;}});lClass+=' avec-event'+(IE.estMobile?' waves-effect waves-light':'');}
if(lJBtn){lJBtn.eventValidation(function(aEvent){if(lOptions.disabled){return;}
if(aEvent.originalEvent){aEvent.originalEvent.__eventBtn__=true;}
let lResult=lInfosEventBtn.callback([aEvent]);lRefresh();if(lHref){lResult=false;}
return lResult;});lJChips.on('keyup',function(aEvent){if(lOptions.disabled){return;}
if(aEvent.which===ToucheClavier.Supprimer){const lResult=lInfosEventBtn.callback([aEvent]);lRefresh();return lResult;}});}
lJChips.addClass(lClass);const lRacine=lElementChips;aOutils.replaceNode(aContexteCourant.node,lRacine);aContexteCourant.node=lRacine;if(lModele&&aContexteCourant.data.$modeleParsed){aOutils.surNodeEtNodeAfter(aContexteCourant);}
aContexteCourant.nodeTransfertContenuDynamique=lJChips.find('.text').get(0);if(lInfosGetLibelle&&lInfosGetLibelle.estFonction){if(aContexteCourant.nodeTransfertContenuDynamique){aOutils.addGetterHtml(aContexteCourant,lInfosGetLibelle);}}
aOutils.addCommentaireDebug(lRacine,'ie-chips');return{node:lRacine,avecCompileFils:true};});module.exports=IEHtml;},fn:"iehtml.chips.js"});;
IE.fModule({f:function(exports,require,module,global){;require('espace/css/montserrat_font.css');},fn:"declarationfontmontserrat.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationJQuery.js');const GStyle=require('GStyle.js');$.fn.jIEDraggable=function(aOptions){let lOptions,lRestore,lStart,lStop;if($.fn.draggable){lRestore=null;lStart=function(){GStyle.setTransitions(this,'opacity','0.2s');lRestore=null;if(this&&this.style){lRestore={};if(lOptions.axis!=="y"&&$(this).css("right")!=="auto"){lRestore.width=this.style.width;lRestore.right=this.style.right;}
if(lOptions.axis!=="x"&&$(this).css("bottom")!=="auto"){lRestore.height=this.style.height;lRestore.bottom=this.style.bottom;}}};lStop=function(){$(this).css('opacity',1);if(lRestore){try{if(lRestore.width!==undefined){this.style.width=lRestore.width;}
if(lRestore.right!==undefined){this.style.right=lRestore.right;}
if(lRestore.height!==undefined){this.style.height=lRestore.height;}
if(lRestore.bottom!==undefined){this.style.bottom=lRestore.bottom;}} catch(e){}
lRestore=null;}};lOptions={containment:'document',opacity:0.5,start:lStart,stop:lStop};$.extend(lOptions,aOptions);if(lOptions.handle){$(lOptions.handle).addClass('IE_draggable');} else{this.addClass('IE_draggable');}
if(aOptions.start){lOptions.start=function(){lStart.call(this);aOptions.start.call(this);};}
if(aOptions.stop){lOptions.stop=function(){lStop.call(this);aOptions.stop.call(this);};}
return this.draggable(lOptions);}
;return this;};module.exports={};},fn:"jiedraggable.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreAction={Valider:0,NePasValider:1,Annuler:2};module.exports=EGenreAction;},fn:"enumere_action.js"});;
IE.fModule({f:function(exports,require,module,global){const EEvent={SurError:1,SurResize:2,SurPreResize:3,SurPostResize:4,SurClick:5,SurScroll:6,SurKeyDown:7,SurKeyUp:8,SurKeyPress:9,SurMouseMove:10,SurMouseDown:11,SurSelectStart:12,SurMouseUp:13,SurFinDeplacement:14,SurBlur:15,SurChange:16,SurDblClick:17,SurFocus:18,SurFocusIn:19,SurFocusOut:20,SurLoad:21,SurUnload:22,SurMouseOut:23,SurMouseOver:24,SurFinResize:25};module.exports=EEvent;},fn:"enumere_event.js"});;
IE.fModule({f:function(exports,require,module,global){const EStructureAffichage={Verticale:1,Autre:3};module.exports=EStructureAffichage;},fn:"enumere_structureaffichage.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreDirection={SensInverse:-1,DeuxSenses:0,SensNormal:1};module.exports=EGenreDirection;},fn:"enumere_direction.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreOrientationAffichage={Vertical:0,Horizontal:1};module.exports=EGenreOrientationAffichage;},fn:"enumere_orientationaffichage.js"});;
IE.fModule({f:function(exports,require,module,global){require('Divers.js');const IEHtml=require('IEHtml.js');const Callback=require('Callback.js');const GUID=require('GUID.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const MethodesObjet=require('MethodesObjet.js');const MethodesTableau=require('MethodesTableau.js');const GHtml=require('GHtml.js');const GStyle=require('GStyle.js');const EGenreDirection=require('Enumere_Direction.js');const EGenreOrientationAffichage=require('enumere_orientationaffichage.js');const ZoneFenetre=require('IEZoneFenetre.js');const{GObjetWAI,EGenreRole,EGenreAttribut}=require('ObjetWAI.js');require('IEHtmlComposants.js');const lGenerateurGUID=new GUID.generateur();class Identite{constructor(ANom,AIdent,APere,AEvenement){if(MethodesObjet.isObject(ANom)){const lParametres={nomComplet:'',nomObjet:null,pere:null,evenement:null};$.extend(lParametres,ANom);this.Pere=lParametres.pere;this.Evenement=lParametres.evenement;if(lParametres.nomObjet&&lParametres.pere){this.Nom=lParametres.pere.Nom+'.'+lParametres.nomObjet;} else{this.Nom=lParametres.nomComplet;}} else{this.Nom=this.ConstruireNom(ANom,AIdent);this.Pere=APere;this.Evenement=AEvenement;}
this.callback=new Callback(this.Pere,this.Evenement);this._callbacksSurDestruction=[];if(this.Pere&&this.Pere.ajouterInstanceADetruire){this.Pere.ajouterInstanceADetruire(this);}
this.options={};this.Actif=true;this.Visible=true;this.TableauGauche=[];this.TableauDroite=[];this.TableauHaut=[];this.TableauBas=[];this.focusable=true;this.IdPremierElement='';this.idMessageActionRequise=GUID.getId();this.tabIndex=0;this.pileEvenementGlobaux=[];this.instancesADetruire=[];this.controleur=IEHtml.initControleur(this.getControleur(this)||{});if(this.controleur){this.controleur.instance=this;}}
setOptions(aOptions){Object.assign(this.options,aOptions);return this;}
SetParametres(){}
setAvecTabulation(AAvecTabIndex){this.tabIndex=(AAvecTabIndex===null||AAvecTabIndex===undefined||AAvecTabIndex)?0:-1;}
SetDonnees(){}
RecupererDonnees(){}
ConstruireAffichage(){return'&nbsp;';}
SetGenre(AGenre){this.Genre=AGenre;}
SetActif(AActif){this.Actif=AActif;}
getActif(){return this.Actif;}
SetVisible(AVisible){GStyle.setDisplay(this.Nom,this.Visible=AVisible);}
EstUneInteractionUtilisateur(){return this.InteractionUtilisateur!==false;}
SetEtatSaisie(aEtatSaisie){if(this.Pere&&this.Pere.SetEtatSaisie){this.Pere.SetEtatSaisie(aEtatSaisie);} else{Invocateur.evenement(ObjetInvocateur.events.etatSaisie,aEtatSaisie);}}
SetControleNavigation(AControleNavigation){this.ControleNavigation=AControleNavigation;}
getEtatSaisie(){if(this.Pere){return this.Pere.getEtatSaisie();}}
$refresh(){return this.controleur.$refresh();}
$refreshSelf(){return this.controleur.$refreshSelf();}
getControleur(){return{};}
avecEventResizeNavigateur(){return this.Pere&&this.Pere.avecEventResizeNavigateur?this.Pere.avecEventResizeNavigateur():true;}
setEvenement(aEvenement){this.callback=new Callback(this.Pere,aEvenement);this.Evenement=aEvenement;}
ConstruireNom(ANom,AIdent){return(AIdent===null||AIdent===undefined?ANom:ANom+'['+AIdent+']');}
GetNom(){return this.Nom;}
effacer(aMessage){if(aMessage===null||aMessage===undefined){aMessage='&nbsp;';}
GHtml.setHtml(this.Nom,aMessage);}
Afficher(H){if(H===null||H===undefined){H=this.ConstruireAffichage();}
if(H){GHtml.setHtml(this.Nom,H,{instance:this});}}
activerFocusable(){this.focusable=true;$('#'+this.Nom.escapeJQ()).attr('tabIndex','0').off('focus').on('focus',this.FocusSurPremierElement.bind(this));}
desactiverFocusable(){this.focusable=false;$('#'+this.Nom.escapeJQ()).attr('tabIndex','').off('focus');}
Initialiser(){const H=this.ConstruireAffichage();if(H){GHtml.setHtml(this.Nom,H,{instance:this});}
this.RecupererDonnees();}
composeMessage(aMessage){const H=[];H.push('<div class="message-conteneur" ',GObjetWAI?GObjetWAI.composeAttribut({genre:EGenreAttribut.labelledby,valeur:this.idMessageActionRequise})+' ':'',GObjetWAI?GObjetWAI.composeRole(EGenreRole.Note):'','tabIndex="0">','<span id="',this.idMessageActionRequise,'" class="flex-contain cols">',aMessage,'</span>','</div>');return H.join('');}
NavigationClavier(AId){if(GNavigateur.IsToucheFleche()){this.FocusSuivant(AId,(GNavigateur.IsToucheFlecheGauche()||GNavigateur.IsToucheFlecheDroite())?(EGenreOrientationAffichage.Horizontal):(EGenreOrientationAffichage.Vertical),(GNavigateur.IsToucheFlecheGauche()||GNavigateur.IsToucheFlecheHaut())?EGenreDirection.SensInverse:EGenreDirection.SensNormal);}
if(GNavigateur.IsToucheSelection()){this._evenementSelectionElmNavigation(AId);}}
_evenementSelectionElmNavigation(){}
FocusSuivant(AId,AOrientation,ADirection){const LIdSuivant=this.getIdNavigationSuivant(AId,AOrientation,ADirection);if(LIdSuivant){GHtml.setFocus(LIdSuivant);}}
getIdNavigationSuivant(aId,aOrientation,aDirection){return(aOrientation===EGenreOrientationAffichage.Horizontal)?((aDirection===EGenreDirection.SensNormal)?this.TableauDroite[aId]:this.TableauGauche[aId]):((aDirection===EGenreDirection.SensNormal)?this.TableauBas[aId]:this.TableauHaut[aId]);}
AjouterAuTableaux(APremierId,ADeuxiemeId,AHorizontal,AVertical){switch(AHorizontal){case EGenreDirection.DeuxSenses:this.TableauDroite[APremierId]=ADeuxiemeId;this.TableauGauche[ADeuxiemeId]=APremierId;break;case EGenreDirection.SensNormal:this.TableauDroite[APremierId]=ADeuxiemeId;break;case EGenreDirection.SensInverse:this.TableauGauche[ADeuxiemeId]=APremierId;break;}
switch(AVertical){case EGenreDirection.DeuxSenses:this.TableauBas[APremierId]=ADeuxiemeId;this.TableauHaut[ADeuxiemeId]=APremierId;break;case EGenreDirection.SensNormal:this.TableauBas[APremierId]=ADeuxiemeId;break;case EGenreDirection.SensInverse:this.TableauHaut[ADeuxiemeId]=APremierId;break;}}
ResetTableauxNavigation(){this.TableauGauche=[];this.TableauDroite=[];this.TableauHaut=[];this.TableauBas=[];}
ComposeElementNavigation(aID,aContenu,aRole,aOnKeyUp,aOnClick,aOnFocus,aOnBlur,aStyle,aWaiHidden,aWaiLabelId,aWaiLabel){const lRole=aRole?GObjetWAI.composeRole(aRole):'';let lOnClick='';if(aOnClick){if(typeof aOnClick==='string'){lOnClick='onclick="'+aOnClick+'"';} else if(aOnClick.length===2){lOnClick=aOnClick[0]+'="'+aOnClick[1]+'"';}}
const lOnKeyUp=aOnKeyUp||this.Nom+'.NavigationClavier (id); if (GNavigateur.IsToucheFleche () || GNavigateur.IsToucheSelection ()) GNavigateur.StopperEvenement (event);';const lOnFocus=aOnFocus||this.Nom+'.ActiverBordureNavigation (id, true);';const lOnBlur=aOnBlur||this.Nom+'.ActiverBordureNavigation (id, false);';const lClass=aWaiHidden?'wai_hidden':'BordureNavigationInactive';const lStyle=aStyle?' style="'+aStyle+'"':'';const lWaiLabelId=aWaiLabelId?' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:aWaiLabelId}):'';const lWaiLabel=aWaiLabel?' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:aWaiLabel}):'';const lHTML=[];lHTML.push('<div id="',aID,'" ',lRole,lStyle,' onkeyup="',lOnKeyUp,'" tabIndex="-1" class="libelle ',lClass,'" onblur="',lOnBlur,'" onfocus="',lOnFocus,'" ',lOnClick,' ',lWaiLabelId,' ',lWaiLabel,'>',aContenu,'</div>');return lHTML.join('');}
ActiverBordureNavigation(aID,aBool){const lClass=aBool?'BordureNavigationActive':'BordureNavigationInactive';GHtml.setClass(aID,lClass);}
SetTabId(ATabId){this.TabId=ATabId;}
GetIdSuivant(AId){const LNbElt=this.TabId.length;if(LNbElt>0){for(let I=0;I<LNbElt;I++){if(AId===this.TabId[I]){if(I<LNbElt-1){return this.TabId[I+1];}
return this.TabId[0];}}
return this.TabId[LNbElt-1];}}
GetId(APositionId){if(APositionId<this.TabId.length){return this.TabId[APositionId];}}
FocusSurSuivant(AIdElement,AAvecTestRetourChariot){const LAvecTestRetourChariot=AAvecTestRetourChariot||true;if((LAvecTestRetourChariot&&GNavigateur.IsToucheRetourChariot())||GNavigateur.IsToucheTab()){GHtml.setFocus(this.GetIdSuivant(AIdElement));}}
FocusSurPremierElement(){GHtml.setFocus(this.IdPremierElement);}
SetPremierElement(AElement){this.IdPremierElement=AElement;}
getPremierElement(){return this.IdPremierElement;}
GetPremierElement(){return this.IdPremierElement;}
ajouterInstanceADetruire(aInstance){if(aInstance&&aInstance.Nom){this.instancesADetruire[aInstance.Nom]=aInstance;}}
enleverInstanceADetruire(aInstance){if(aInstance&&aInstance.Nom){this.instancesADetruire[aInstance.Nom]=null;}}
ajouterEvenementGlobal(aEvenement,aMethode){if(!GNavigateur.AddEvent){return;}
if(!aMethode){return;}
GNavigateur.AddEvent(aEvenement,this,aMethode);this.pileEvenementGlobaux.push({evenement:aEvenement,methode:aMethode});return this.pileEvenementGlobaux.length-1;}
viderEvenementGlobaux(){for(let i=0;i<this.pileEvenementGlobaux.length;i++){GNavigateur.DelEvent(this.pileEvenementGlobaux[i].evenement,this);}
this.pileEvenementGlobaux=[];}
free(){if(this.isDestroyed()){return;}
this.__enCoursDeDestruction=true;try{_viderEvenements.bind(this)();this.DetruireInstancesFils();if(this.DetruireInstances){this.DetruireInstances();}
if(this.__estFenetreVolante){if(GHtml.elementExiste(this.Nom)){ZoneFenetre.enleverFenetre(this.Nom);}} else if(!this.Pere||!this.Pere.__enCoursDeDestruction){GHtml.setHtml(this.Nom,'',true);}
if(this.Pere&&this.Pere.enleverInstanceADetruire){this.Pere.enleverInstanceADetruire(this);}
if(this._callbacksSurDestruction.length>0){MethodesTableau.parcourir(this._callbacksSurDestruction,(aCallback) =>{aCallback();});}} catch(e){} finally{delete this.__enCoursDeDestruction;this._estDetruite=true;}}
DetruireInstancesFils(){let lNom,lInstance;for(lNom in this.instancesADetruire){if(this.instancesADetruire.hasOwnProperty(lNom)){lInstance=this.instancesADetruire[lNom];if(lInstance&&!lInstance._estDetruite&&lInstance.free){lInstance.free();}
this.instancesADetruire[lNom]=null;}}}
ajouterCallbackSurDestruction(aCallback){this._callbacksSurDestruction.push(aCallback);return this;}
isDestroyed(){return this._estDetruite||this.__enCoursDeDestruction;}
static creerInstance(aConstructeur,aParametres){if(!aConstructeur){return null;}
const lNom=lGenerateurGUID.get(),lNomComplet='IE.Identite.collection.'+lNom;$.extend(aParametres,{nomComplet:lNomComplet});const lInstance=new aConstructeur(aParametres);if(aParametres.options){lInstance.setOptions(aParametres.options);}
lInstance.ajouterCallbackSurDestruction(() =>{if(IE.Identite.collection[lNom]){delete IE.Identite.collection[lNom];}});IE.Identite.collection[lNom]=lInstance;return lInstance;}}
function _viderEvenements(){Invocateur.desabonner(this);this.viderEvenementGlobaux();}
module.exports=Identite;},fn:"objetidentite.js"});;
IE.fModule({f:function(exports,require,module,global){require('script/css/ObjetInterface.css');const GLog=require('IELog.js');const MethodesObjet=require('MethodesObjet.js');const GHtml=require('GHtml.js');const GStyle=require('GStyle.js');const EEvent=require('Enumere_Event.js');const EStructureAffichage=require('Enumere_StructureAffichage.js');const ZoneFenetre=require('IEZoneFenetre.js');const Identite=require('ObjetIdentite.js');const{GObjetWAI,EGenreRole}=require('ObjetWAI.js');class ObjetAbstraitInterface extends Identite{constructor(...aParams){super(...aParams);this.EtatIdCourant=true;this.reset();this.NomObjetGraphique=[];this.AvecCadre=true;this.GenreStructure=EStructureAffichage.Verticale;this.IdentZoneAlClient= -1;this.AddSurZone=[];this.idPremierObjet='';if(this.Nom&&this.avecEventResizeNavigateur()){this.ajouterEvenementGlobal(EEvent.SurResize,this._surResizeInterface);}}
reset(){this.DetruireInstancesFils();this.Instances=[];this.GenreAffichage=[];this.PositionAffichage=[];this.NombreGenreAffichage=0;this._pileInfosFenetres=[];}
FocusSurPremierElement(){}
focusSurPremierObjet(){if(this.idPremierObjet){GHtml.setFocus(this.idPremierObjet);} else{GLog.addLog('['+MethodesObjet.getNomClassDeConstructeur(this.constructor)+'] Il est où mon premierobjet ?','',GLog.genre.Avertissement);}}
addInstance(aParametres){const lParametres={objet:null,constructionFenetre:false,evenement:null,init:null,ident:null,traductions:null};$.extend(lParametres,aParametres);const lObjetGraphique=GApplication.getObjetGraphique(lParametres.objet);if(!GApplication.existeObjetGraphique(lParametres.objet)){GLog.addLog('ObjetAbstraitInterface.addInstance : "'+(lObjetGraphique?lObjetGraphique.nom:lParametres.objet)+'" n"existe pas!',null,GLog.genre.Avertissement);return null;}
if((lParametres.ident!==null&&lParametres.ident!==undefined)){this.NombreGenreAffichage=lParametres.ident;}
this.GenreAffichage[this.NombreGenreAffichage]=lParametres.objet;if(!this.PositionAffichage[lParametres.objet]){this.PositionAffichage[lParametres.objet]=[];}
this.PositionAffichage[lParametres.objet].push(this.NombreGenreAffichage);if(lObjetGraphique){if(lParametres.constructionFenetre){this._pileInfosFenetres[this.NombreGenreAffichage]=({ident:this.NombreGenreAffichage,genre:lParametres.objet,evenement:lParametres.evenement,init:lParametres.init,traductions:lParametres.traductions,coordonnees:{left:0,top:0}});} else{const lInstance=_construireObjetGraphique.bind(this)(lObjetGraphique.constructeur,lObjetGraphique.nom,this.NombreGenreAffichage,lParametres.evenement);this.Instances[this.NombreGenreAffichage]=lInstance;if(lParametres.init){lParametres.init.call(this,lInstance);}}}
return this.NombreGenreAffichage++;}
Add(AGenreAffichage,AEvenement,AInitialiser,aTraductions,I){return this.addInstance({objet:AGenreAffichage,evenement:AEvenement,init:AInitialiser,traductions:aTraductions,ident:I});}
addFenetre(AGenreAffichage,AEvenement,AInitialiser,aTraductions,I){return this.addInstance({objet:AGenreAffichage,constructionFenetre:true,evenement:AEvenement,init:AInitialiser,traductions:aTraductions,ident:I});}
Del(){this.Instances[this.NombreGenreAffichage]=null;this.NombreGenreAffichage--;}
GetInstance(AIdent){let lInstance=this.Instances[AIdent];if(!this.Instances[AIdent]&&GApplication.getObjetGraphique(this.GenreAffichage[AIdent])&&GApplication.getObjetGraphique(this.GenreAffichage[AIdent]).estFenetre&&this._pileInfosFenetres[AIdent]&&!this.__enCoursDeDestruction){lInstance=this.creerFenetre(AIdent);}
return lInstance;}
existeInstance(aIdent){return!!this.Instances[aIdent];}
creerFenetre(AIdent){let lInstance;if(this._pileInfosFenetres[AIdent]){const lInfosFenetre=this._pileInfosFenetres[AIdent];const lObjetGraphique=GApplication.getObjetGraphique(lInfosFenetre.genre);lInstance=_construireObjetGraphique.bind(this)(lObjetGraphique.constructeur,lObjetGraphique.nom,AIdent,lInfosFenetre.evenement);lInstance.destructionSurFermeture=true;const lSelf=this;lInstance.ajouterCallbackSurDestruction(() =>{if(AIdent!==undefined&&lSelf.Instances[AIdent]&&lSelf._pileInfosFenetres[AIdent]){lSelf.Instances[AIdent]=null;const lIndice=lSelf._pileFenetre.indexOf(lSelf.GetZoneId(AIdent));if(lIndice>=0){lSelf._pileFenetre[lIndice]=null;}}});if(!this._pileFenetre){this._pileFenetre=[];}
this._pileFenetre.push(this.GetZoneId(AIdent));ZoneFenetre.ajouterFenetre(this.GetZoneId(AIdent),lInstance.getZIndex?lInstance.getZIndex():'');if(lInfosFenetre.init){lInfosFenetre.init.call(this,lInstance);}
lInstance.coordonnees=lInfosFenetre.coordonnees;lInstance.Initialiser();this.Instances[AIdent]=lInstance;}
return lInstance;}
GetNomInstance(AIdent){return this.GetInstance(AIdent)?this.GetInstance(AIdent).Nom:'';}
getInstanceParNom(aNom){for(let I=0;I<this.NombreGenreAffichage;I++){if(this.GetNomInstance(I)===aNom){return this.GetInstance(I);}}}
GetZoneId(AIdent){return this.ConstruireNom(this.Nom+'.Instances',AIdent);}
Initialiser(aReset){if(aReset){this.reset();}
this.EnConstruction=true;try{this.ConstruireInstances();this.SetParametresGeneraux();GHtml.setHtml(this.Pere===null||this.Pere===undefined?GApplication.getIdConteneur():this.Nom,_construireStructureAffichage.bind(this)(),{instance:this});this.ConstruireAffichage();} finally{this.EnConstruction=false;}
this.RecupererDonnees();this.surResizeInterface();return this;}
AppartientAZone(AIdent){let lElement;for(let I=0;I<this.AddSurZone.length;I++){lElement=this.AddSurZone[I];if((lElement===AIdent&&lElement!=='')||(lElement&&lElement.ident===AIdent)){return true;}}
return false;}
ConstruireStructureAffichageVerticale(lFooter){const H=[];let lInfo;const LStyle=this.couleurFond?GStyle.composeCouleurFond(this.couleurFond):'';H.push('<div style="',LStyle,'" class="interface_affV',(this.AvecCadre?' interface_affV_padding':''),(!!lFooter?lFooter:''),'" ',GObjetWAI.composeRole(EGenreRole.Presentation),'>');const lTabAffichages=[];for(let I=0;I<this.NombreGenreAffichage;I++){if(!this.AppartientAZone(I)&&!GApplication.getObjetGraphique(this.GenreAffichage[I]).estFenetre){lInfo={estZoneClient:this.IdentZoneAlClient===I,indice:I};lTabAffichages.push(lInfo);}}
for(let I=0;I<lTabAffichages.length;I++){lInfo=lTabAffichages[I];H.push('<div id="'+this.GetZoneId(lInfo.indice)+'"',(lInfo.estZoneClient?' class="interface_affV_client"':''),'></div>');}
if(this.NombreGenreAffichage===0){H.push('<div>'+this.composeMessage('')+'</div>');}
H.push('</div>');return H.join('');}
ConstruireStructureAffichageAutre(){}
ConstruireStructureFenetres(){_effacerFenetres.bind(this)();const H=[];for(let I=0;I<this.NombreGenreAffichage;I++){if(GApplication.getObjetGraphique(this.GenreAffichage[I]).estFenetre&&this.Instances[I]){if(!this._pileFenetre){this._pileFenetre=[];}
this._pileFenetre.push(this.GetZoneId(I));ZoneFenetre.ajouterFenetre(this.GetZoneId(I),this.Instances[I]&&this.Instances[I].getZIndex?this.Instances[I].getZIndex():'');}}
return H.join('');}
ConstruireInstances(){}
SetParametresGeneraux(){}
ConstruireStructureAffichage(){const lHtml=[];switch(this.GenreStructure){case EStructureAffichage.Verticale:lHtml.push(this.ConstruireStructureAffichageVerticale());break;default:lHtml.push(this.ConstruireStructureAffichageAutre());break;}
if((this.AddSurZone.length||this.avecBandeau)&&this.ConstruireStructureAffichageBandeau){this.ConstruireStructureAffichageBandeau();}
return lHtml.join('');}
ConstruireAffichage(){for(let I=0;I<this.NombreGenreAffichage;I++){if(this.Instances[I]){if(!GApplication.getObjetGraphique(this.GenreAffichage[I]).estFenetre){this.Instances[I].SetVisible(this.Instances[I].Visible);}
this.Instances[I].Initialiser();}}}
RecupererDonnees(){}
ConstruireObjetGraphique(ANomObjet,AIdent,AEvenement){const lObjetGraphique=GApplication.getObjetGraphique(ANomObjet);return lObjetGraphique?_construireObjetGraphique.bind(this)(lObjetGraphique.constructeur,lObjetGraphique.nom,AIdent,AEvenement):null;}
getSaisiePageEnCours(){return null;}
ActionSurValidation(){if(this._callbackNavigation){this._callbackNavigation();delete this._callbackNavigation;} else if(this.AfficherPage){this.AfficherPage.apply(this,arguments);} else{this.RecupererDonnees.apply(this,arguments);}}
SetIdCourant(AId){if(this.EtatIdCourant&&window.GEtatUtilisateur){window.GEtatUtilisateur.IdCourant=AId;}}
GetIdCourant(){return window.GEtatUtilisateur?window.GEtatUtilisateur.IdCourant:null;}
SetFocusIdCourant(){GHtml.setFocus(this.GetIdCourant());}
SetEtatIdCourant(ABool){this.EtatIdCourant=((ABool!==null&&ABool!==undefined))?ABool:true;}
_surResizeInterface(){if(GNavigateur.bloquerResize){return;}
this.surResizeInterface();}
surResizeInterface(){}
DetruireInstancesFils(){_effacerFenetres.bind(this)();super.DetruireInstancesFils();const N=this.Instances?this.Instances.length:0;let lInstance;for(let I=0;I<N;I++){lInstance=this.Instances[I];if(lInstance&&(!lInstance.isDestroyed||!lInstance.isDestroyed())&&lInstance.free){GLog.addLog('DetruireInstancesFils instance non detruite : '+lInstance.Nom);lInstance.free();}
this.Instances[I]=null;}}}
function _construireObjetGraphique(aConstructeur,aNom,aIdent,aEvenement){GLog.addLog('Interface Construire '+aNom+' ('+aIdent+')','OBJETINTERFACE_LOGNOM');if(aConstructeur){return new aConstructeur({nomObjet:'Instances['+aIdent+']',pere:this,evenement:aEvenement});}
;return null;}
function _construireStructureAffichage(){const lHtml=[];lHtml.push(this.ConstruireStructureFenetres());lHtml.push(this.ConstruireStructureAffichage());return lHtml.join('');}
function _effacerFenetres(){if(this._pileFenetre){this._pileFenetre=[];}}
module.exports=ObjetAbstraitInterface;},fn:"objetinterface.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const GHtml=require('GHtml.js');require('iehtml.bouton.js');const ObjetAbstraitInterface=require('ObjetInterface.js');const GTraductions=require('ObjetTraduction.js');const TypeThemeBouton=require('Type_ThemeBouton.js');const EStructureAffichage=require('Enumere_StructureAffichage.js');const ZoneFenetre=require('IEZoneFenetre.js');const Identite=require('ObjetIdentite.js');const MethodesTableau=require('MethodesTableau.js');class _ObjetFenetre extends ObjetAbstraitInterface{constructor(...aParams){super(...aParams);this.optionsFenetre={listeBoutonsInvisibles:[]};this.EnAffichage=false;this.promise=null;this._promiseResolve=null;this.NomFenetre=this.Nom+'_Fenetre';this.idFenetreContenu=this.Nom+'_FenetreContenu';this.IdTitre=this.Nom+'_Titre';this.IdTitreImage=this.IdTitre+'_image';this.IdContenu=this.Nom+'_Contenu';this.IdPremierElement=this.NomFenetre;this.GenreStructure=EStructureAffichage.Autre;}
setOptionsFenetre(aOptions){$.extend(this.optionsFenetre,aOptions);this._structureBoutons=null;this.$refreshSelf();return this;}
SetBoutonActif(I,AActif){if(this.optionsFenetre.listeBoutonsInactifs){this.optionsFenetre.listeBoutonsInactifs[I]=!AActif;this.$refreshSelf();}}
getControleur(aInstance){return $.extend(true,super.getControleur(this),{$off:function(){return!aInstance.EnAffichage;},listeBoutons:function(){if(!aInstance._structureBoutons){aInstance._structureBoutons=[];const T=aInstance._structureBoutons;aInstance.optionsFenetre.listeBoutons.forEach(function(aElement,aIndex){const lElement={};if(MethodesObjet.isObject(aElement)){Object.assign(lElement,aElement);} else{lElement.libelle=aElement;}
if(aElement){lElement.index=aIndex;lElement.theme=lElement.theme?lElement.theme:(lElement.libelle===GTraductions.getValeur('Valider')?TypeThemeBouton.primaire:TypeThemeBouton.secondaire);lElement.sansFermeture=lElement.sansFermeture?lElement.sansFermeture:false;T.push(lElement);}});}
return aInstance._structureBoutons||[];},fenetreBtn:{event:function(aBoutonRepeat){aInstance.SurValidation(aBoutonRepeat.element.index);},getLibelle(aBoutonRepeat){return aBoutonRepeat.element.libelle;},getDisabled:function(aBoutonRepeat){return aInstance.optionsFenetre.listeBoutonsInactifs&&aInstance.optionsFenetre.listeBoutonsInactifs[aBoutonRepeat.element.index]===true;},getOptions:function(aBoutonRepeat){if(MethodesObjet.isObject(aBoutonRepeat.element.theme)){return aBoutonRepeat.element.theme;}}}});}
ComposeContenu(){return'';}
getBoutonNumero(aNumeroBouton){let lBouton={};if(this.optionsFenetre.listeBoutons){lBouton=this.optionsFenetre.listeBoutons[aNumeroBouton];}
return lBouton||{annuler:true};}
setBoutonVisible(I,aVisible){this.optionsFenetre.listeBoutonsInvisibles[I]=!aVisible;this.$refreshSelf();}
getParametresValidation(aNumeroBouton){const lParametres={instance:this,bouton:this.getBoutonNumero(aNumeroBouton),numeroBouton:aNumeroBouton};if(MethodesObjet.isFunction(this.optionsFenetre.addParametresValidation)){Object.assign(lParametres,this.optionsFenetre.addParametresValidation.call(this.Pere,lParametres));}
return lParametres;}
promiseResolve(aParams){if(this._promiseResolve){this._promiseResolve(aParams);this._promiseResolve=null;}}
SurValidation(ANumeroBouton){const lParams=this.getParametresValidation(ANumeroBouton);this.promiseResolve(lParams);if(this.optionsFenetre.surValiderAvantFermer){this.optionsFenetre.surValiderAvantFermer.call(this.Pere,lParams);}
if(!lParams||!lParams.bouton||!lParams.bouton.sansFermeture){this.Fermer();}
if(this.optionsFenetre.callback){this.optionsFenetre.callback.call(this.Pere,ANumeroBouton,lParams);}
this.callback.appel(ANumeroBouton,lParams);}
Fermer(){if(this.EstAffiche()){try{if(this._focusPrecedent&&$(this._focusPrecedent).length===1){if(GHtml.focusEstDansElement(this.Nom)){$(this._focusPrecedent).focus();}
this._focusPrecedent=null;}} catch(e){}}}
EstAffiche(){return this.EnAffichage===true;}
setBoutonFocus(aVal){let lIndice=aVal;if(MethodesObjet.isObject(aVal)){lIndice=MethodesTableau.indexOfMask(this.optionsFenetre.listeBoutons,aVal);}
if(lIndice>=0){GHtml.setFocus(this._getIdBoutons(lIndice),true);}
return this;}
positionnerFenetre(){}
positionnerSousId(){}
surFixerTaille(){}
_getIdBoutons(aIndice){return this.Nom+'_btns_'+aIndice;}
static creerInstance(aClassFenetre,aParametres,aOptionsFenetre){if(!aParametres||!aParametres.pere){return;}
const lInstance=Identite.creerInstance(aClassFenetre,aParametres);const lParametres=$.extend({initialiser:true,destructionSurFermeture:true},aParametres);lInstance.destructionSurFermeture=lParametres.destructionSurFermeture;if(aOptionsFenetre&&aOptionsFenetre.zIndex){const lZIndex=aOptionsFenetre.zIndex;lInstance.getZIndex=function(){return lZIndex;};}
ZoneFenetre.ajouterFenetre(lParametres.nomComplet,lInstance.getZIndex?lInstance.getZIndex():'');$('#'+lInstance.GetNom().escapeJQ()).on('destroyed',function(){if(lInstance.destructionSurFermeture){lInstance.free();}});if(aOptionsFenetre){lInstance.setOptionsFenetre(aOptionsFenetre);}
if(lParametres.initialiser){if(MethodesObjet.isFunction(lParametres.initialiser)){lParametres.initialiser.call(lParametres.pere,lInstance);}
lInstance.Initialiser();}
return lInstance;}}
_ObjetFenetre.protected={surFermer:function(aCallbacFermerHtml){if(this.SurFermer){this.SurFermer();}
if(MethodesObjet.isFunction(this.optionsFenetre.callbackFermer)){this.optionsFenetre.callbackFermer();}
this.$refresh();GHtml.setDisplay(this.Nom,false);if(aCallbacFermerHtml){aCallbacFermerHtml();}
this.EnAffichage=false;if(this.destructionSurFermeture&&!this.__enCoursDeDestruction){this.__surDestructionApresFermeture_=true;this.free();}
if(MethodesObjet.isFunction(this.optionsFenetre.callbackApresFermer)){this.optionsFenetre.callbackApresFermer();}
this.promiseResolve({surFermer:true});}};module.exports=_ObjetFenetre;},fn:"_objetfenetre.js"});;
IE.fModule({f:function(exports,require,module,global){require('Mobile/Css/ObjetFenetre_Mobile.css');const MethodesObjet=require('MethodesObjet.js');const GHtml=require('GHtml.js');const GStyle=require('GStyle.js');const GTraductions=require('ObjetTraduction.js');const _ObjetFenetre=require('_ObjetFenetre.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const tag=require('tag.js')
;class ObjetFenetreMobile extends _ObjetFenetre{constructor(...aParams){super(...aParams);this.setOptionsFenetre({modale:true,fermerFenetreSurClicHorsFenetre:false,heightMax_mobile:false,avecFooterFlottant:true,sansPaddingContenu:false,titre:'',titreNavigation:'',cssFenetre:MethodesObjet.getObjectClass(this)+'_racine',avecCroixFermeture:true,avecNavigation:false,addParametresValidation:null,surValiderAvantFermer:null,callback:null,callbackFermer:null,callbackApresFermer:null,callbackNavigation:null,listeBoutons:[GTraductions.getValeur('Fermer')],avecAbonnementFermetureFenetreGenerale:true,estFicheMobile:false,empilerFenetre:true,avecComposeBasInFooter:false,avecAnimationOuverture:true});this.nomModale=this.Nom+'_modale';Invocateur.abonner(ObjetInvocateur.events.fermerFenetres,function(aForcer){if(aForcer||this.optionsFenetre.avecAbonnementFermetureFenetreGenerale){this.__fenetreEmpilee=null;this.Fermer();}},this);}
free(){if(this.isDestroyed()){return;}
super.free();const lJFenetre=$('#'+this.nomModale.escapeJQ());const lInstanceModale=lJFenetre.length>0?M.Modal.getInstance(lJFenetre):null;if(lInstanceModale){lInstanceModale.destroy();}
$('#'+this.Nom.escapeJQ()).remove();}
getControleur(aInstance){return $.extend(true,super.getControleur(this),{getClassStickyScroll:function(){const lJNode=$('#'+aInstance.nomModale.escapeJQ());if(lJNode.length===1){if(lJNode.prop('scrollHeight')>Math.ceil(lJNode.outerHeight())){return'avec-scroll';}}
return'';},btnFermer:{event:function(){aInstance.Fermer();},avecCroixFermeture:function(){return!!aInstance.optionsFenetre.avecCroixFermeture;}},btnNavigation:{event:function(aSuivant){if(MethodesObjet.isFunction(aInstance.optionsFenetre.callbackNavigation)){aInstance.optionsFenetre.callbackNavigation(aSuivant);}},avecNavigation:function(){return!!aInstance.optionsFenetre.avecNavigation;}},avecTitre:function(){return!!aInstance.optionsFenetre.titre||!!aInstance.optionsFenetre.avecCroixFermeture;},avecTitreNavigation:function(){return!!aInstance.optionsFenetre.titreNavigation||!!aInstance.optionsFenetre.avecNavigation;},getTitre:function(){const lTitre=(MethodesObjet.isFunction(this.instance.optionsFenetre.titre)?this.instance.optionsFenetre.titre():this.instance.optionsFenetre.titre)||'';const lStyle=(aInstance.optionsFenetre.couleurTexteBandeau?GStyle.composeCouleurTexte(aInstance.optionsFenetre.couleurTexteBandeau):'');return'<h1 class="ie-titre"'+(lStyle?' style="'+lStyle+'"':'')+'>'+lTitre+'</h1>';},getTitreNavigation:function(){const lTitre=(MethodesObjet.isFunction(this.instance.optionsFenetre.titreNavigation)?this.instance.optionsFenetre.titreNavigation():this.instance.optionsFenetre.titreNavigation)||'';const lStyle=(aInstance.optionsFenetre.couleurTexteBandeau?GStyle.composeCouleurTexte(aInstance.optionsFenetre.couleurTexteBandeau):'');return'<h2 class="ie-titre"'+(lStyle?' style="'+lStyle+'"':'')+'>'+lTitre+'</h1>';},_getNodeContent:function(){GHtml.setHtml(this.node,_composer.call(aInstance,aInstance.optionsFenetre.estFicheMobile?'&nbsp;':null),{instance:aInstance});},htmlRepeatBoutons:function(aBoutonRepeat){return aInstance.construireBouton(aBoutonRepeat);}});}
construireBouton(aBoutonRepeat){return['<ie-bouton ie-model="fenetreBtn(bouton)"',' id="',this._getIdBoutons(aBoutonRepeat.element.index),'"',aBoutonRepeat.element.theme&&MethodesObjet.isString(aBoutonRepeat.element.theme)?' class="'+aBoutonRepeat.element.theme+'"':'',' style="',this.optionsFenetre.listeBoutonsInvisibles[aBoutonRepeat.element.index]===true?'display:none;':'','"','>','</ie-bouton>'
].join('');}
ConstruireStructureAffichageAutre(){return tag('div',{id:this.nomModale,class:['modal bottom-sheet',this.optionsFenetre.heightMax_mobile?' height-max':'','  ObjetFenetre_Mobile ',(this.optionsFenetre.cssFenetre||'')]},tag('div',{class:"FormSaisie ofm-design"},tag('header',tag('div',{class:"Fenetre_Titre",'ie-html':"getTitre",'ie-if':"avecTitre",tabindex:"-1"}),tag('ie-btnicon',{class:'icon_fermeture_widget','ie-model':'btnFermer','ie-if':"avecCroixFermeture"})),tag('div',{class:'navigation-contain','ie-class':'getClassStickyScroll'},tag('ie-btnicon',{class:'icon_angle_left','ie-model':'btnNavigation(false)','ie-if':"avecNavigation"}),tag('div',{class:"Fenetre_Titre",'ie-html':"getTitreNavigation",'ie-if':"avecTitreNavigation",tabindex:"-1"}),tag('ie-btnicon',{class:'icon_angle_right','ie-model':'btnNavigation(true)','ie-if':"avecNavigation"})),tag('section',{class:['content',this.optionsFenetre.sansPaddingContenu?'without-padding':''],style:"display:none;",'ie-node':"_getNodeContent",tabindex:'0'}),tag('footer',{class:this.optionsFenetre.avecFooterFlottant?'sticky':'','ie-class':'getClassStickyScroll'},(this.optionsFenetre.avecComposeBasInFooter&&this.ComposeBas?this.ComposeBas():''),tag('div',{'ie-repeat':"bouton in listeBoutons",'ie-html':"htmlRepeatBoutons(bouton)",class:'repeat-bouton'}))));}
Actualiser(){GHtml.setHtml(this.IdContenu,this.ComposeContenu(),{controleur:this.controleur});}
Afficher(aHtml){this.EnAffichage=true;this._focusPrecedent=null;if(!this.optionsFenetre.bloquerFocus&&this.optionsFenetre.restaurerFocusSurFermeture){this._focusPrecedent=document.activeElement;}
Invocateur.evenement('surAffichageFenetre');if(this.optionsFenetre.empilerFenetre){_empilerFenetre.call(this);}
if(GHtml.elementExiste(this.nomModale)){const lJFenetre=$('#'+this.nomModale.escapeJQ());let lInstanceModale=M.Modal.getInstance(lJFenetre);if(!lInstanceModale){M.Modal.init(lJFenetre,{dismissible:!this.optionsFenetre.modale||this.optionsFenetre.fermerFenetreSurClicHorsFenetre,inDuration:this.optionsFenetre.avecAnimationOuverture?300:0,outDuration:200,startingTop:'4%',endingTop:'10%',onCloseEnd:function(){if(!this.__estFenetreEmpilee&&this.EnAffichage){this.Fermer();}}.bind(this),onOpenEnd:function(){if(this.SurAfficher&&!this._openEndInitial){this.SurAfficher();}
this._openEndInitial=this.optionsFenetre.estFicheMobile?false:true;Invocateur.evenement('fenetre_mobile_finOuverture',this);if(!this.optionsFenetre.bloquerFocus){this.FocusSurPremierElement();}
this.$refreshSelf();}.bind(this)});lInstanceModale=M.Modal.getInstance(lJFenetre);}
lInstanceModale.open();GHtml.setDisplay(this.Nom,true);}
const lJContenu=_getJContent.call(this);if(aHtml){lJContenu.IEHtml(_composer.call(this,aHtml),{controleur:this.controleur}).show();}
lJContenu.show();this.$refreshSelf();this.promise=new Promise(function(aResolve){this._promiseResolve=aResolve;}.bind(this));return this.promise;}
FocusSurPremierElement(){GHtml.setFocus(GHtml.getElement(this.Nom).querySelector('header .Fenetre_Titre'));}
getZIndex(){return 0;}
Fermer(){super.Fermer();_ObjetFenetre.protected.surFermer.call(this,function(){const lJFenetre=$('#'+this.nomModale.escapeJQ());if(lJFenetre.length>0){const lInstanceModale=M.Modal.getInstance(lJFenetre);if(lInstanceModale){lInstanceModale.close();}
lJFenetre.find('>div>.content').html('').hide();}
GHtml.setDisplay(this.Nom,false);}.bind(this));if(this.__fenetreEmpilee&&this.__fenetreEmpilee._restaurerEmpilee){this.__fenetreEmpilee._restaurerEmpilee();} else{ObjetFenetreMobile.instanceOuverte=null;}}}
ObjetFenetreMobile.instanceOuverte=null;ObjetFenetreMobile.prototype.__estFenetreVolante=true;function _empilerFenetre(){if(ObjetFenetreMobile.instanceOuverte){this.__fenetreEmpilee=ObjetFenetreMobile.instanceOuverte;const lFenetreEmpilee=this.__fenetreEmpilee;lFenetreEmpilee.__estFenetreEmpilee=true;$('#'+lFenetreEmpilee.nomModale.escapeJQ()).modal('close');$('#'+lFenetreEmpilee.Nom.escapeJQ()).hide();lFenetreEmpilee._restaurerEmpilee=function(){ObjetFenetreMobile.instanceOuverte=lFenetreEmpilee;delete lFenetreEmpilee.__estFenetreEmpilee;if(lFenetreEmpilee.EnAffichage&&!lFenetreEmpilee.isDestroyed()){$('#'+lFenetreEmpilee.Nom.escapeJQ()).show();$('#'+lFenetreEmpilee.nomModale.escapeJQ()).modal('open');}};}
ObjetFenetreMobile.instanceOuverte=this;}
function _composer(aHtml){const H=[tag('div',{class:'wrapper-contenu'},tag('div',{class:'Fenetre_Contenu'},aHtml||this.ComposeContenu()))];if(!this.optionsFenetre.avecComposeBasInFooter){const lHtmlBas=this.ComposeBas?this.ComposeBas():'';if(lHtmlBas){H.push('<div class="Fenetre_Bas">',lHtmlBas,'</div>');}}
return H.join('');}
function _getJContent(){return $('#'+this.nomModale.escapeJQ()).find('>div>section.content');}
ObjetFenetreMobile.creerInstance=_ObjetFenetre.creerInstance;module.exports=ObjetFenetreMobile;},fn:"objetfenetre_mobile.js"});;
IE.fModule({f:function(exports,require,module,global){if(IE.estMobile){module.exports=require('ObjetFenetre_Mobile.js');} else{module.exports=require('ObjetFenetre_Espace.js');}},fn:"objetfenetre.js"});;
IE.fModule({f:function(exports,require,module,global){const GHtml=require('GHtml.js');const GStyle=require('GStyle.js');const GLog=require('IELog.js');const{Invocateur}=require('Invocateur.js');const GUID=require('GUID.js');const GestionnaireModale=(function(){const uBlocage={pile:[],nb:0,avecVoile:false,curseur:null};const uPileZIndex={};let uMaxZIndex= -1;const uZIndexBlocage=1000;const uGenerateurGUID=new GUID.generateur();const uClassBloquageInterface='nav_zoneBloquageInterface';function _ajoutDansPile(aId,aPourPremierPlan,aPourBlocageInterface,aPrioriteBlocage){const lPriorite=_getPrioriteBlocageDePriorite(aPrioriteBlocage);if(uPileZIndex[aId]){uPileZIndex[aId].pourPremierPlan=uPileZIndex[aId].pourPremierPlan||aPourPremierPlan;uPileZIndex[aId].pourBlocageInterface=uPileZIndex[aId].pourBlocageInterface||aPourBlocageInterface;uPileZIndex[aId].prioriteBlocage=Math.max(uPileZIndex[aId].prioriteBlocage,lPriorite);} else{const lElement=GHtml.getElement(aId);const lZindex=GStyle.getZindex(aId);if(lZindex||aPourBlocageInterface){uPileZIndex[aId]={element:lElement,zIndexOrigine:lZindex,zIndex:lZindex,pourPremierPlan:aPourPremierPlan,pourBlocageInterface:aPourBlocageInterface,prioriteBlocage:lPriorite,estBloque:false,pileBlocage:[]};uMaxZIndex=Math.max(uMaxZIndex,lZindex);}}}
function _setZIndex(aId,zIndex){if(!uPileZIndex[aId]){return;}
uPileZIndex[aId].zIndex=zIndex;GStyle.setZindex(aId,zIndex);}
function _getPrioriteBlocageCourant(){let lPriorite=0;uBlocage.pile.forEach(function(aElement){lPriorite=Math.max(lPriorite,aElement.priorite);});return lPriorite;}
function _getPrioriteBlocageDePriorite(aPrioriteBlocage){return aPrioriteBlocage||GestionnaireModale.TypePrioriteBlocageInterface.standard;}
function _notifierAbonneBlocageInterface(aId,aBloquer,aForcerDeblocage,aPrioriteBlocage,aEtatBloquerPrecedent){const lElement=uPileZIndex[aId];if(lElement&&lElement.pourBlocageInterface){const lPrioriteBlocage=_getPrioriteBlocageDePriorite(aPrioriteBlocage);if(!aBloquer&&aForcerDeblocage){lElement.estBloque=false;if(lElement.methode){lElement.methode(aBloquer,uBlocage.avecVoile,uBlocage.curseur);} else{_setZIndex(aId,lElement.zIndexOrigine);}} else{if((aBloquer&&(!lElement.estBloque||(!lElement.avecVoile&&uBlocage.avecVoile!==false))&&(lElement.prioriteBlocage<=lPrioriteBlocage))||(!aBloquer&&lElement.estBloque&&!aEtatBloquerPrecedent)){if(aBloquer){lElement.estBloque=true;} else{lElement.estBloque=!!aEtatBloquerPrecedent;}
if(lElement.methode){if(lElement.estBloque){lElement.avecVoile=uBlocage.avecVoile;}
lElement.methode(lElement.estBloque,uBlocage.avecVoile,uBlocage.curseur);} else{if(lElement.estBloque){if(lElement.zIndex>uZIndexBlocage-10){_setZIndex(aId,uZIndexBlocage-10);}} else{_setZIndex(aId,lElement.zIndexOrigine);}}}}
let lId=aId;if(lElement.blocageGeneral&&global.GApplication){lId=global.GApplication.getIdConteneur();}
if(lElement.estBloque){$('#'+lId.escapeJQ()).addClass(uClassBloquageInterface);} else{$('#'+lId.escapeJQ()).removeClass(uClassBloquageInterface);}}}
function _notifierAbonnesBlocageInterface(aBloquer,aForcerDeblocage,aPrioriteBlocage){for(let lId in uPileZIndex){const lElement=uPileZIndex[lId];let lEtatPrecedent=null;if(aBloquer){lElement.pileBlocage.push(lElement.estBloque);} else{lEtatPrecedent=lElement.pileBlocage.pop();}
_notifierAbonneBlocageInterface(lId,aBloquer,aForcerDeblocage,aPrioriteBlocage,lEtatPrecedent);}}
function _desabonnementBlocageInterface(aId){if(uPileZIndex[aId]&&uPileZIndex[aId].pourBlocageInterface){GStyle.setZindex(aId,uPileZIndex[aId].zIndex);if(!uPileZIndex[aId].pourPremierPlan){delete uPileZIndex[aId];} else{uPileZIndex[aId].estBloque=false;uPileZIndex[aId].pourBlocageInterface=false;}}}
function _desabonnementPremierPlan(aId){if(uPileZIndex[aId]){if(uPileZIndex[aId].zIndex>=uMaxZIndex){uMaxZIndex= -1;for(const lId in uPileZIndex){if(uPileZIndex[lId]&&uPileZIndex[lId].pourPremierPlan&&(lId!==aId)){uMaxZIndex=Math.max(uMaxZIndex,uPileZIndex[lId].zIndex);}}}
_setZIndex(aId,uPileZIndex[aId].zIndexOrigine);if(!uPileZIndex[aId].pourBlocageInterface){delete uPileZIndex[aId];} else{uPileZIndex[aId].pourPremierPlan=false;}}}
Invocateur.abonner('finSession',function(){_notifierAbonnesBlocageInterface(false,true,GestionnaireModale.TypePrioriteBlocageInterface.systeme);});return{TypePrioriteBlocageInterface:{voile:1,standard:10,message:20,messageInformatif:30,systeme:99999},enPremierPlan:function(AIdPremierPlan){if(!uPileZIndex[AIdPremierPlan]){return;}
for(const lId in uPileZIndex){let lElement=uPileZIndex[lId];if(lElement&&lElement.pourPremierPlan){if(!GHtml.elementExiste(lId)){GLog.addLog('Erreur ObjetNavigateur_Espace _enPremierPlan : element supprimé sans etre desabonné',null,GLog.genre.Erreur);_desabonnementPremierPlan(lId);} else if(!lElement.estBloque){if(lId===AIdPremierPlan){_setZIndex(lId,uMaxZIndex+1);} else if(!uPileZIndex[lId].estBloque){_setZIndex(lId,lElement.zIndexOrigine);}}}}},abonnementPremierPlan:function(aAbonner,aId){if(aAbonner){_ajoutDansPile(aId,true,false);} else{_desabonnementPremierPlan(aId);}},abonnementBlocageInterfaceGenerale:function(aId,aBloquerInterfaceGenerale){uPileZIndex[aId]={blocageGeneral:true,pourPremierPlan:false,pourBlocageInterface:true,estBloque:false,pileBlocage:[],prioriteBlocage:GestionnaireModale.TypePrioriteBlocageInterface.voile,methode:aBloquerInterfaceGenerale};},abonnementBlocageInterface:function(aAbonner,aId,aPrioriteBlocage){if(aAbonner){_ajoutDansPile(aId,false,true,aPrioriteBlocage);const lPriorite=_getPrioriteBlocageDePriorite(aPrioriteBlocage);if(GestionnaireModale.estInterfaceBloque()&&_getPrioriteBlocageCourant()>lPriorite){_notifierAbonneBlocageInterface(aId,true ,false,lPriorite);}} else{_desabonnementBlocageInterface(aId);}},estInterfaceBloque:function(){return uBlocage.pile.length>0;},estJElementBloque:function(aJElement){return aJElement&&aJElement.parents?aJElement.closest('.'+uClassBloquageInterface).length>0:false;},bloquerInterface:function(aParams){const lParams=Object.assign({bloquer:false,prioriteBlocage:GestionnaireModale.TypePrioriteBlocageInterface.standard,genreCurseur:null,avecVoile:null,forcerDeblocage:false,guidBlocage:null},aParams);if(!lParams.bloquer&&(uBlocage.pile.length===0)){return;}
let lId=null;lParams.prioriteBlocage=_getPrioriteBlocageDePriorite(lParams.prioriteBlocage);if(lParams.bloquer){const lElement={priorite:lParams.prioriteBlocage,guid:uGenerateurGUID.get()};uBlocage.pile.push(lElement);lId=lElement.guid;uBlocage.avecVoile=lParams.avecVoile;uBlocage.curseur=lParams.genreCurseur;} else{if(lParams.guidBlocage){let lTrouve=false;uBlocage.pile=uBlocage.pile.filter(function(aElement){if(aElement.guid===lParams.guidBlocage){lTrouve=true;}
return aElement.guid!==lParams.guidBlocage;});if(!lTrouve){return;}} else{uBlocage.pile.pop();}}
_notifierAbonnesBlocageInterface(lParams.bloquer,false,lParams.prioriteBlocage);return lId;}};}());module.exports=GestionnaireModale;},fn:"gestionnairemodale.js"});;
IE.fModule({f:function(exports,require,module,global){require('Espace/Css/ObjetMessage.css');require('jIEDraggable.js');const GLog=require('IELog.js');const GChaine=require('GChaine.js');const EGenreAction=require('Enumere_Action.js');const EGenreBoiteMessage=require('Enumere_BoiteMessage.js');const ObjetFenetre=require('ObjetFenetre.js');const GTraductions=require('ObjetTraduction.js');const TypeThemeBouton=require('Type_ThemeBouton.js');const MethodesObjet=require('MethodesObjet.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const GestionnaireModale=require('GestionnaireModale.js');const GHtml=require('GHtml.js');class ObjetMessage{constructor(){this.EnAffichage=false;Invocateur.abonner(ObjetInvocateur.events.erreurCommunication,function(){this.Fermer(EGenreAction.Annuler);},this);}
afficher(aParametres){if(this.EnAffichage){if(!this._pileMessage){this._pileMessage=[];}
this._pileMessage.push(aParametres);GLog.addLog('ObjetMessage.Afficher : un message est deja visible, le nouveau message est empilé : '+aParametres.message,null,GLog.genre.Avertissement);return new Promise(function(aResolve){aParametres.resolvePromise=aResolve;});}
this.Accepte=EGenreAction.Valider;this.EnAffichage=true;return new Promise(function(aResolve){const lParametres=$.extend({type:EGenreBoiteMessage.Information,titre:'',message:'',callback:null,controleur:null,delaiFermeture:null,avecDecalageFocusBouton:false,idRessource:null,width:360,getDisabledBouton:null,demanderConfirmation:true,restaurerFocusSurFermeture:true,listeBoutons:null,resolvePromise:aResolve},aParametres);if(lParametres.type===EGenreBoiteMessage.Confirmation&&lParametres.demanderConfirmation===false){this.Accepte=EGenreAction.Valider;this.EnAffichage=false;_fermer.call(this,lParametres);return;}
if(lParametres.idRessource){const lChaine=GTraductions.getValeur(lParametres.idRessource);if(lChaine!==''){const lJson=require('ObjetJSON.js').parse(lChaine);if(lJson&&lJson.titre&&lJson.html&&lJson.type>=0&&lJson.boutons){lParametres.type=_typeEditeurToBoiteMessage(lJson.type);lParametres.titre=lJson.titre;lParametres.message='<div class="mr-fiche" style="width:'+lJson.width+'px;min-height:'+lJson.height+'px;">'+lJson.html+'</div>';} else{}} else{}}
const lDetailsMessage=_construireMessage.call(this,lParametres);this.fenetre=ObjetFenetre.creerInstance(ObjetFenetre,{pere:this,initialiser:function(aInstance){if(lParametres.controleur){$.extend(true,aInstance.controleur,lParametres.controleur);}
aInstance.genreActionFenetre=EGenreAction.Annuler;aInstance.setOptionsFenetre({modale:true,prioriteBlocageAbonnement:GestionnaireModale.TypePrioriteBlocageInterface.message,cssFenetre:'ObjetMessage ObjetMessage_'+lParametres.type,avecPositionnementResize:false,avecCroixFermeture:false,titre:lDetailsMessage.titre,listeBoutons:lDetailsMessage.listeBoutons,avecTailleSelonContenu:true,restaurerFocusSurFermeture:lParametres.restaurerFocusSurFermeture,empilerFenetre:false,avecAriaDescribedByContenu:true,surValiderAvantFermer:function(aParams){if(aParams.bouton&&aParams.bouton.genreAction!==undefined){aInstance.genreActionFenetre=aParams.bouton.genreAction;}}.bind(this),callbackApresFermer:function(){clearTimeout(this._timeoutFermeture);this.EnAffichage=false;delete this.fenetre;this.Accepte=aInstance.genreActionFenetre;_fermer.call(this,lParametres);}.bind(this)});}.bind(this)});if(MethodesObjet.isFunction(lParametres.getDisabledBouton)){this.fenetre.controleur.fenetreBtn.getDisabled=function(aBoutonRepeat){return lParametres.getDisabledBouton(aBoutonRepeat.element);};}
this.fenetre.controleur._getClassContenuMessage=function(){if(this.node.scrollHeight>this.node.clientHeight){return'contenu-scroll';}
return'';};this.fenetre.Afficher(lDetailsMessage.html.join(''));GHtml.setFocus(this.fenetre._getIdBoutons(0),true,lParametres.avecDecalageFocusBouton);if(lParametres.delaiFermeture){const lDelai=lParametres.delaiFermeture===true?30*1000:lParametres.delaiFermeture;this._timeoutFermeture=setTimeout(function(){if(this.fenetre){this.Fermer(EGenreAction.Valider);}}.bind(this),lDelai);}}.bind(this)).catch(function(aArg){throw aArg;});}
Fermer(aGenreAction){if(this.fenetre){if(aGenreAction!==null&&aGenreAction!==undefined){this.fenetre.genreActionFenetre=aGenreAction;}
this.fenetre.Fermer();}}}
function _construireMessage(aParametres){const lResult={titre:'',listeBoutons:[],html:[]};if(aParametres.titre&&!aParametres.message){aParametres.message=aParametres.titre;aParametres.titre='';}
if(aParametres.titre){lResult.titre=aParametres.titre+'';} else{switch(aParametres.type){case EGenreBoiteMessage.Information:case EGenreBoiteMessage.MrFiche:lResult.titre=GTraductions.getValeur('genreBoiteMessage.Information');break;case EGenreBoiteMessage.Confirmation:lResult.titre=GTraductions.getValeur('genreBoiteMessage.Confirmation');break;default:;}}
const lThemeSecondaireBouton={minWidth:60};const lThemePrimaireBouton={theme:TypeThemeBouton.primaire,minWidth:60};lResult.titre='<i class="om_iconeTitre" aria-hidden="true"></i>'+lResult.titre;const lWidth=aParametres.width||360;lResult.html.push(aParametres.idRessource?aParametres.message:IE.estMobile?GChaine.ToHTML(aParametres.message+''):'<div style="width:'+lWidth+'px;" class="contenu" ie-class="_getClassContenuMessage">'+GChaine.ToHTML(aParametres.message+'')+'</div>');if(aParametres.listeBoutons){lResult.listeBoutons=aParametres.listeBoutons;lResult.listeBoutons.forEach(function(aBouton){switch(aBouton.theme){case TypeThemeBouton.neutre:break;case TypeThemeBouton.primaire:aBouton.theme=lThemePrimaireBouton;break;default:aBouton.theme=lThemeSecondaireBouton;break;}});} else{switch(aParametres.type){case EGenreBoiteMessage.Information:case EGenreBoiteMessage.MrFiche:lResult.listeBoutons.push({libelle:GTraductions.getValeur('principal.fermer'),genreAction:EGenreAction.Valider,theme:lThemeSecondaireBouton,typeMessage:aParametres.type});break;case EGenreBoiteMessage.Confirmation:lResult.listeBoutons.push({libelle:GTraductions.getValeur('principal.oui'),genreAction:EGenreAction.Valider,theme:lThemePrimaireBouton,typeMessage:aParametres.type},{libelle:GTraductions.getValeur('principal.non'),genreAction:EGenreAction.NePasValider,theme:lThemeSecondaireBouton,typeMessage:aParametres.type});break;default:;}}
return lResult;}
function _fermer(aParametres){if(aParametres.callback){if(aParametres.callback.appel){aParametres.callback.appel(this.Accepte);} else{aParametres.callback(this.Accepte);}}
aParametres.resolvePromise(this.Accepte);if(this._pileMessage&&this._pileMessage.length>0){if(window.GApplication&&window.GApplication.SESSION_FINI){return;}
const lParametres=this._pileMessage.pop();if(this._pileMessage.length===0){delete this._pileMessage;}
setTimeout(function(){this.afficher(lParametres);}.bind(this),200);}}
function _typeEditeurToBoiteMessage(aGenreEditeur){switch(aGenreEditeur){case 2:return EGenreBoiteMessage.Information;case 4:return EGenreBoiteMessage.MrFiche;case 3:return EGenreBoiteMessage.Confirmation;default:;return EGenreBoiteMessage.Information;}}
module.exports=ObjetMessage;},fn:"objetmessage.js"});;
IE.fModule({f:function(exports,require,module,global){require('NamespaceIE.js');require('DeclarationExtensionsObjetNatif.js');require('divers.js');const GUID=require('GUID.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const MethodesObjet=require('MethodesObjet.js');const GHtml=require('GHtml.js');const GStyle=require('GStyle.js');const GTraductions=require('ObjetTraduction.js');const{GObjetWAI,EGenreAttribut,EGenreRole}=require('ObjetWAI.js');require('IEHtmlComposants.js');require('IEHtml.BtnImage.js');require('IEHtml.CheckboxRadio.js');require('IEHtml.Identite.js');require('IEHtml.Chips.js');require('DeclarationFontMontserrat.js');require('pep.min.js');const deferLoadingScript=require('deferLoadingScript.js');global.GApplication=null;const EtatApplication={normal:1,modeExclusif:2};let lCommunication=null;let lParametres=null;let lEstDemo=false;let lListeObjetsGraphiques=[],lDateServeurReferant,lDateClientReferant;let lEtatApplication=EtatApplication.normal;let lEstDebug=false;class ObjetApplication{constructor(){this.init();this.nomProduit='INDEX';this.hauteurTitre=20;this.hauteurLigne=20;this.hauteurBandeau=22;this.idLigneSeparateur=GUID.getId();this.idLigneBandeau=GUID.getId();this.idBandeau=GUID.getId();this.idBreadcrumbCombo="breadcrumbBandeauCombo";this.idBreadcrumb="breadcrumbBandeau";this.idBreadcrumbPerso="breadcrumbBandeauPerso";this.estPrimaire=false;this._objetMessage=null;Invocateur.abonner(ObjetInvocateur.events.erreurCommunication,this.finSession,this);if(!window.PointerEvent){deferLoadingScript.load('pep_poly',{done(){}});}}
init(){Invocateur.abonner(ObjetInvocateur.events.modificationModeExclusif,_setModeExclusif,this);}
initAuthentification(aParam){this.parametresUtilisateurBase=aParam.parametresUtilisateurBase;if(aParam.parametresUtilisateur){this.parametresUtilisateur.chargerJSON(aParam.parametresUtilisateur);}
this.droits.chargerJSON(aParam);}
getNom(){return'GApplication';}
getIdConteneur(){return'div';}
getCommunication(){return lCommunication;}
setCommunication(aInstanceCommunication){lCommunication=aInstanceCommunication;if(lCommunication&&lCommunication.setNom){lCommunication.setNom(this.getNom()+'.getCommunication ()');}}
getParametres(){return lParametres;}
setParametres(aInstanceParametres){lParametres=aInstanceParametres;}
getDemo(){return lEstDemo;}
setDemo(aValeur){lEstDemo=aValeur;}
getDateDemo(){return this.dateDemo;}
setDateDemo(aDateDemo){this.dateDemo=aDateDemo;}
initDateServeur(aDate){lDateServeurReferant=aDate;lDateClientReferant=new Date();}
getDateServeur(){if(!lDateServeurReferant||!lDateClientReferant){return new Date();}
return new Date(lDateServeurReferant.getTime()+new Date().getTime()-lDateClientReferant.getTime());}
ajouterObjetGraphique(aIndice,aNom){if(this._verificationAjoutObjetDansTableau){this._verificationAjoutObjetDansTableau(lListeObjetsGraphiques,aIndice,aNom);}
lListeObjetsGraphiques[aIndice]={nom:aNom,estFenetre:_estObjetFenetreVolante(aNom)};}
getObjetGraphique(aParametre){let lInfosObjet=MethodesObjet.isNumber(aParametre)?lListeObjetsGraphiques[aParametre]:null;if(!lInfosObjet){if(MethodesObjet.isString(aParametre)&&window[aParametre]){lInfosObjet={nom:aParametre,estFenetre:_estObjetFenetreVolante(aParametre),constructeur:window[aParametre]};} else if(aParametre&&MethodesObjet.isFunction(aParametre)){lInfosObjet={nom:'NON IDENTIFIE',estFenetre:aParametre.prototype&&aParametre.prototype.__estFenetreVolante,constructeur:aParametre};}} else{if(MethodesObjet.isFunction(lInfosObjet.nom)){lInfosObjet.constructeur=lInfosObjet.nom;lInfosObjet.nom='NON IDENTIFIE';} else{if(!lInfosObjet.constructeur){lInfosObjet.constructeur=window[lInfosObjet.nom];}}}
return lInfosObjet;}
existeObjetGraphique(aParametre){const lObjetGraphique=this.getObjetGraphique(aParametre);return lObjetGraphique&&MethodesObjet.isFunction(lObjetGraphique.constructeur);}
estObjetGraphiqueFenetre(aIndice){try{return lListeObjetsGraphiques[aIndice]&&lListeObjetsGraphiques[aIndice].estFenetre;} catch(e){}}
getMessage(){if(!this._objetMessage){this._objetMessage=new(require('ObjetMessage.js'))();}
return this._objetMessage;}
getEtatApplication(){return lEtatApplication;}
getModeExclusif(){return this.getEtatApplication()===EtatApplication.modeExclusif;}
entreeModeExclusif(){Invocateur.evenement(ObjetInvocateur.events.modeExclusif,true);}
sortieModeExclusif(){Invocateur.evenement(ObjetInvocateur.events.modeExclusif,false);}
changerEtatApplication(aEtat){switch(lEtatApplication){case ObjetApplication.EtatApplication.normal:switch(aEtat){case ObjetApplication.EtatApplication.normal:break;case ObjetApplication.EtatApplication.modeExclusif:lEtatApplication=aEtat;this.entreeModeExclusif();break;default:;}
break;case ObjetApplication.EtatApplication.modeExclusif:switch(aEtat){case ObjetApplication.EtatApplication.normal:lEtatApplication=aEtat;this.sortieModeExclusif();break;case ObjetApplication.EtatApplication.modeExclusif:break;default:;}
break;default:;}}
finSession(aParametres){Invocateur.desabonner(ObjetInvocateur.events.erreurCommunication,this);const lParametresFin={constructionPage:false};Object.assign(lParametresFin,aParametres);Invocateur.evenement(ObjetInvocateur.events.fermerFenetres,true);Invocateur.evenement('finSession');Invocateur.desabonner(ObjetInvocateur.events.modificationModeExclusif,this);$(document).off();$(window).off();Invocateur.desabonner(ObjetInvocateur.events.autorisationRechargementPage);if(lCommunication&&lCommunication.arreter){lCommunication.arreter();}
if(window.GNavigateur){GNavigateur.viderCache();}
if(lParametresFin.constructionPage){try{this.construirePageFinSession(lParametresFin);} catch(e){require('IELog.js').addLog('Exception construirePageFinSession : '+e);}}
this.SESSION_FINI=true;lCommunication=null;lParametres=null;lListeObjetsGraphiques=null;}
construirePageFinSession(aParametres){if(this._unloadEnCours){return;}
const lCouleur={texte:'black',fond:'white',bordure:'black'};if(global.GCouleur){Object.assign(lCouleur,GCouleur);}
const lParametresFin={jsonErreur:null,statut:'',couleur:lCouleur,sansBoutonSeConnecter:false};Object.assign(lParametresFin,aParametres);let lTitre=null;let lMessage=null,lGenreErreur;if(lParametresFin.jsonErreur){lGenreErreur=lParametresFin.jsonErreur.G;lTitre=lParametresFin.jsonErreur.Titre;lMessage=lParametresFin.jsonErreur.Message;}
lTitre=lTitre===null||lTitre===undefined?GTraductions.getValeur('connexion.PageIndisponible'):lTitre;lMessage=lMessage===null||lMessage===undefined?GTraductions.getValeur('connexion.AffichagePageImpossible'):lMessage;const T=[];try{T.push(this.construireEnTetePageFinSession(lParametresFin));} catch(e){}
T.push('<div style="clear:both; position:relative; top:100px;',GStyle.composeCouleurBordure(lCouleur.bordure,2),GStyle.composeCouleurTexte(lCouleur.texte),GStyle.composeCouleurFond(lCouleur.fond),'margin-left:auto; margin-right:auto; text-align : center; min-width:290px; max-width:800px; width:50%; padding:10px;','">');T.push('<div id="waispan_id" class="Texte14 Gras EspaceBas">'+GTraductions.getValeur('connexion.Deconnecter')+'</div>');if(lTitre){T.push('<div class="Texte14 Gras EspaceBas pageDeconnexion_titre">'+lTitre+(lParametresFin.statut?' ('+GTraductions.getValeur('connexion.Erreur')+' '+lParametresFin.statut+')':'')+'</div>');}
if(lMessage){T.push('<div class="Texte12">'+lMessage+'</div>');}
if(lGenreErreur!==7&&!lParametresFin.sansBoutonSeConnecter){T.push('<div class="Texte12 GrandEspaceHaut">','<div tabindex="0" ',GObjetWAI?GObjetWAI.composeRole(EGenreRole.Button):'',GObjetWAI?GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:"waispan_id"}):'','class="AvecMain Souligne"','onkeyup="if (GNavigateur.IsToucheSelection()) window.location.reload()" onclick="window.location.reload ()">',GTraductions.getValeur('connexion.SeConnecter'),'</div>','</div>');}
T.push('</div>');GHtml.setHtml(this.getIdConteneur(),T.join(''));}
construireEnTetePageFinSession(){return'';}
estDebug(){return lEstDebug;}
setEstDebug(aValeur){lEstDebug=aValeur;}
nomPropConteneurDebug(){return'conteneurDebug';}
getDebug(){return this[this.nomPropConteneurDebug()];}}
ObjetApplication.EtatApplication=EtatApplication;function _estObjetFenetreVolante(aNomConstructeur){if(window[aNomConstructeur]&&window[aNomConstructeur].prototype&&window[aNomConstructeur].prototype.__estFenetreVolante){return!!window[aNomConstructeur].prototype.__estFenetreVolante;}
return false;}
function _setModeExclusif(aEstModeExclusif){this.changerEtatApplication(aEstModeExclusif?ObjetApplication.EtatApplication.modeExclusif:ObjetApplication.EtatApplication.normal);}
module.exports=ObjetApplication;},fn:"objetapplication.js"});;
IE.fModule({f:function(exports,require,module,global){require('Produit/Css/AnimationPatience.css');module.exports={getHtml:function(){return'<div class="animation_patience"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>';}};},fn:"animationpatience.js"});;
IE.fModule({f:function(exports,require,module,global){const Requetes=require('CollectionRequetes.js');const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const GTraductions=require('ObjetTraduction.js');class ObjetRequeteSaisieDeconnexion extends ObjetRequeteConsultation{constructor(...aParams){super(...aParams);this.setOptions({messageDetail:GTraductions.getValeur('connexion.DeconnexionEnCours'),avecControleModeExclusif:false});}
lancerRequete(){return this.appelAsynchrone({estRequeteDeconnexion:true});}}
Requetes.inscrire('SaisieDeconnexion',ObjetRequeteSaisieDeconnexion);module.exports=ObjetRequeteSaisieDeconnexion;},fn:"objetrequetesaisiedeconnexion.js"});;
IE.fModule({f:function(exports,require,module,global){;const EGenreMessageHtml={patiencePDF:'patiencePDF',patiencePDF_Mobile:'patiencePDF_mobile',deconnexionENT:'deconnexionENT',deconnexionENT_Mobile:'deconnexionENT_Mobile'};module.exports.EGenreMessageHtml=EGenreMessageHtml;const UtilitaireMessageHtml={construireUrl:function(aGenreMessageHtml){let lUrl='message.html';if(aGenreMessageHtml){lUrl+='?G='+aGenreMessageHtml;}
return lUrl;}};module.exports.UtilitaireMessageHtml=UtilitaireMessageHtml;},fn:"enumere_messagehtml.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const ObjetRequeteSaisieDeconnexion=require('ObjetRequeteSaisieDeconnexion.js');const EGenreBoiteMessage=require('Enumere_BoiteMessage.js');const GTraductions=require('ObjetTraduction.js');const EGenreAction=require('Enumere_Action.js');const ControleSaisieEvenement=require('ControleSaisieEvenement.js');function UtilitaireDeconnexion(){}
UtilitaireDeconnexion.confirmationDeconnexion=function(){return GApplication.getMessage().afficher({type:EGenreBoiteMessage.Confirmation,message:GTraductions.getValeur('connexion.ConfirmezDeconnexion')}).then(function(aGenreBouton){if(aGenreBouton===EGenreAction.Valider){return new Promise(function(aResolve){ControleSaisieEvenement(function(){UtilitaireDeconnexion.deconnexion();aResolve();});});} else{return false;}});};UtilitaireDeconnexion.deconnexion=function(){Invocateur.desabonner(ObjetInvocateur.events.autorisationRechargementPage);if(GEtatUtilisateur.reset){GEtatUtilisateur.reset();}
return UtilitaireDeconnexion.requeteDeconnexion().then(function(){if(GApplication.urlLogout){window.location.href=GApplication.urlLogout;} else if(GApplication.acces.estConnexionCAS()){const EGenreMessageHtml=require('Enumere_MessageHtml.js').EGenreMessageHtml;const UtilitaireMessageHtml=require('Enumere_MessageHtml.js').UtilitaireMessageHtml;window.location.href=UtilitaireMessageHtml.construireUrl(IE.estMobile?EGenreMessageHtml.deconnexionENT_Mobile:EGenreMessageHtml.deconnexionENT);} else{GApplication.finSession({constructionPage:true,statut:0,jsonErreur:{Titre:'',Message:''}});}});};UtilitaireDeconnexion.deconnexionEchecChargement=function(){return UtilitaireDeconnexion.requeteDeconnexion().then(function(){GApplication.finSession({constructionPage:true,statut:0,jsonErreur:{Titre:'',Message:GTraductions.getValeur('connexion.EchecChargement')}});});};UtilitaireDeconnexion.requeteDeconnexion=() =>{return new ObjetRequeteSaisieDeconnexion({}).lancerRequete();};module.exports=UtilitaireDeconnexion;},fn:"utilitairedeconnexion.js"});;
IE.fModule({f:function(exports,require,module,global){require('produit/css/UtilitaireMAJPatience.css');const{Invocateur}=require('Invocateur.js');const MethodesObjet=require('MethodesObjet.js');const ControleSaisieEvenement=require('ControleSaisieEvenement.js');const{GDate}=require('ObjetDate.js');const ObjetFenetre=require('ObjetFenetre.js');const GTraductions=require('ObjetTraduction.js');const GHtml=require('GHtml.js');const{EGenreRole}=require('ObjetWAI.js');const{GObjetWAI,EGenreAttribut}=require('ObjetWAI.js');const TUtilitaireDuree=require('UtilitaireDuree.js');const GestionnaireModale=require('GestionnaireModale.js');const GChaine=require('GChaine.js');const UtilsRequeteJSON=require('ObjetRequeteJSON.js').utils;const AnimationPatience=require('AnimationPatience.js');const UtilitaireDeconnexion=require('UtilitaireDeconnexion.js');function UtilitaireMAJServeur(){}
UtilitaireMAJServeur.initialiser=function(aOptions){const lUtil={fenetre:null,idMessage:'idMessageMAJ',options:{afficherMessageDelaiLong:true,afficherMessageImminentEleve:false,messageTitreFenetre:GTraductions.getValeur('MAJServeur.MAJ_Titre'),messageFenetreMAJPrevue:GTraductions.getValeur('MAJServeur.MAJ_Prevue_S'),messageFenetreMAJImminentEleve:GTraductions.getValeur('MAJServeur.MAJ_Imminente_Eleve_S'),messageFenetreMAJImminent:GTraductions.getValeur('MAJServeur.MAJ_Imminente_S'),messageAnnule:GTraductions.getValeur('MAJServeur.MAJ_Annulee'),messageAttenteMAJ:GTraductions.getValeur('MAJServeur.MAJ_Attente'),messageMAJEffectue:GTraductions.getValeur('MAJServeur.MAJ_Effectue'),cssImage:''}};Object.assign(lUtil.options,aOptions);Invocateur.abonner(UtilsRequeteJSON.getIdentNotification('dureeMAJServeur'),function(aDuree){_notificationMAJ(lUtil,aDuree);});Invocateur.abonner(UtilsRequeteJSON.getIdentNotification('MAJAnnulation'),function(){clearTimeout(lUtil.timeoutDetectionMAJImminente);clearTimeout(lUtil.timeoutRechargment);if(GApplication.SESSION_FINI){return;}
GApplication.getCommunication().setMAJServeurEnCours(false);_ouvrirFenetreSplash({util:lUtil,init:function(aFenetre){aFenetre.estAnnulation=true;}});});};const lDelaiRepeatRequeteFinMAJ=10*1000;const lDureeAttenteMAJPourRequete=10*60*1000;const lDelaiMAJAvertissement=4*60*1000;const lDelaiDeconnexion=1*60*1000;const lDelaiPresencePreparationAvertissement=lDelaiMAJAvertissement+lDelaiDeconnexion;function _ouvrirFenetreSplash(aParams){if(aParams.util.fenetre){aParams.util.fenetre.Fermer();}
aParams.util.fenetre=ObjetFenetre.creerInstance(ObjetFenetre_SplashMAJServeur,{pere:{},initialiser:function(aFenetre){aParams.init(aFenetre);aFenetre.setOptionsFenetre(Object.assign({titre:aParams.util.options.messageTitreFenetre,callbackFermer:function(){delete aParams.util.fenetre;if(aParams.fermer){aParams.fermer(aFenetre);}}},aParams.util.options));}});aParams.util.fenetre.Afficher();}
function _notificationMAJ(aUtil,aDuree){if(!MethodesObjet.isNumber(aDuree)){return;}
if(aUtil.timeoutDetectionMAJImminente){clearTimeout(aUtil.timeoutDetectionMAJImminente);}
let lTimeoutRechargementEcoule=false;let lDureeMs=TUtilitaireDuree.dureeEnMs(aDuree);const lDateMAJReelle=new Date(Date.now()+lDureeMs+lDelaiDeconnexion);if(lDateMAJReelle.getSeconds()===59){lDateMAJReelle.setSeconds(lDateMAJReelle.getSeconds()+1);}
const lEstDelaiLong=lDureeMs>lDelaiMAJAvertissement;if(!lEstDelaiLong){lDureeMs=Math.floor(TUtilitaireDuree.dureeEnMin(aDuree,true))*60*1000;}
if(aUtil.timeoutRechargment){clearTimeout(aUtil.timeoutRechargment);}
aUtil.timeoutRechargment=setTimeout(function(){lTimeoutRechargementEcoule=true;_deconnexion(aUtil);},lDureeMs);if(lDureeMs<1000){return;}
if(lEstDelaiLong){aUtil.timeoutDetectionMAJImminente=setTimeout(function(){GApplication.getCommunication().setMAJServeurEnCours(true);},Math.max(0,lDureeMs-lDelaiPresencePreparationAvertissement));}
if(!lEstDelaiLong||aUtil.options.afficherMessageDelaiLong){aUtil.deconnexionAvecFenetreOuverte=true;_ouvrirFenetreSplash({util:aUtil,init:function(aFenetre){aFenetre.estDelaiLong=lEstDelaiLong;aFenetre.dateReelle=lDateMAJReelle;aFenetre.dureeMs=lDureeMs;},fermer:function(){if(!lTimeoutRechargementEcoule){aUtil.deconnexionAvecFenetreOuverte=false;}}});}}
function _deconnexion(aUtil){const lCallback=function(){UtilitaireDeconnexion.requeteDeconnexion().then(function(){GApplication.finSession({constructionPage:true,statut:0,sansBoutonSeConnecter:true,jsonErreur:{Titre:GTraductions.getValeur('connexion.MessageVeuillezPatienter'),Message:!GApplication.estAppliMobile?['<div id="'+aUtil.idMessage+'">',aUtil.options.messageAttenteMAJ,'<div class="UtilitaireMAJPatience">',AnimationPatience.getHtml(),'</div>','</div>'
].join(''):aUtil.options.messageAttenteMAJ}});if(!GApplication.estAppliMobile){aUtil.dateMSDemarrageAttente=Date.now();setTimeout(function(){_gererRechargementPage(aUtil);},lDelaiRepeatRequeteFinMAJ);}});};ControleSaisieEvenement(lCallback);}
function _messageFinMAJ(aUtil){$(document).find('.pageDeconnexion_titre').remove();GHtml.setHtml(aUtil.idMessage,['<div style="padding-bottom:3px; padding-top: 10px;">',aUtil.options.messageMAJEffectue,'</div>','<div tabindex="0" ',GObjetWAI?GObjetWAI.composeRole(EGenreRole.Button):'',GObjetWAI?GObjetWAI.composeAttribut({genre:EGenreAttribut.describedby,valeur:"waispan_id"}):'','class="AvecMain Souligne"','onkeyup="if (GNavigateur.IsToucheSelection()) window.location.reload()" onclick="window.location.reload ()">',GTraductions.getValeur('connexion.SeConnecter'),'</div>'
].join(''));}
function _gererRechargementPage(aUtil){const lEnvoyerRequeteDelai=function(){setTimeout(function(){if(Date.now()-aUtil.dateMSDemarrageAttente<lDureeAttenteMAJPourRequete){_gererRechargementPage(aUtil);} else{_messageFinMAJ(aUtil);}},lDelaiRepeatRequeteFinMAJ);};fetch('MAJServeurFin.html').then((aReponse) =>{if(aReponse.ok){if(!aUtil.deconnexionAvecFenetreOuverte){window.location.reload();} else{_messageFinMAJ(aUtil);}} else{return Promise.reject();}}).catch(() =>{lEnvoyerRequeteDelai();});}
class ObjetFenetre_SplashMAJServeur extends ObjetFenetre{constructor(...aParams){super(...aParams);this.setOptionsFenetre({modale:true,largeur:500,hauteurBandeau:25,listeBoutons:[GTraductions.getValeur('Fermer')],avecAbonnementFermetureFenetreGenerale:false,couleurFondBandeau:'#ed9e2b',prioriteBlocageAbonnement:GestionnaireModale.TypePrioriteBlocageInterface.messageInformatif});}
ComposeContenu(){const T=[];let lMessage='';if(this.estAnnulation){lMessage=this.optionsFenetre.messageAnnule;} else if(this.estDelaiLong){lMessage=GChaine.Format(this.optionsFenetre.messageFenetreMAJPrevue,[
GDate.FormatDate(this.dateReelle,'%hh%sh%mm')
]);} else{lMessage=GChaine.Format(this.optionsFenetre.afficherMessageImminentEleve?this.optionsFenetre.messageFenetreMAJImminentEleve:this.optionsFenetre.messageFenetreMAJImminent,[
GDate.FormatDureeEnMillisecondes(this.dureeMs,'%xm')
]);}
T.push('<div class="ofsm_image_MAJ ',this.optionsFenetre.cssImage,'"></div>','<div class="ofsm_texte">',lMessage,'</div>');return T.join('');}}
module.exports=UtilitaireMAJServeur;},fn:"utilitairemajserveur.js"});;
IE.fModule({f:function(exports,require,module,global){require('Produit/Css/ObjetFenetre_MessageDynamiqueDemarrage.css');const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const Requetes=require('CollectionRequetes.js');const ObjetFenetre=require('ObjetFenetre.js');const GTraductions=require('ObjetTraduction.js');Requetes.inscrire('InfosDynamiquesMarquerLu',ObjetRequeteConsultation);class ObjetFenetre_MessageDynamiqueDemarrage extends ObjetFenetre{constructor(...aParams){super(...aParams);this.setOptionsFenetre({listeBoutons:[GTraductions.getValeur('Fermer')],avecComposeBasInFooter:true,callbackFermer:function(){if(this.marquerLu&&this.optionsFenetre.messages&&this.optionsFenetre.messages.length>0){const lIds=[];this.optionsFenetre.messages.forEach(function(aMessage){lIds.push(aMessage.id);});Requetes('InfosDynamiquesMarquerLu',this).lancerRequete({tab:lIds});}}.bind(this)});this.marquerLu=false;}
getControleur(aInstance){return $.extend(true,super.getControleur(this),{cbLu:{getValue:function(){return!!aInstance.marquerLu;},setValue:function(aValue){aInstance.marquerLu=aValue;}}});}
ComposeContenu(){if(this.optionsFenetre.messages&&this.optionsFenetre.messages.length>0){let H=[];this.optionsFenetre.messages.forEach(function(aMessage){if(aMessage&&aMessage.contenu){if(H.length>0){H.push('<hr class="ob_mdd_hr">');}
H.push('<div class="comm_contenuMessageDynamique">',aMessage.contenu,'</div>');}});if(!IE.estMobile){H=['<div class="ob_mdd_conteneur">',H.join(''),'</div>'];}
return H.join('');}}
ComposeBas(){return['<ie-checkbox ie-model="cbLu" ie-textright class="ob_mdd_cb">',GTraductions.getValeur('messagesDyn.marquerLu'),'</ie-checkbox>'
].join('');}}
module.exports=ObjetFenetre_MessageDynamiqueDemarrage;},fn:"objetfenetre_messagedynamiquedemarrage.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const UtilsRequeteJSON=require('ObjetRequeteJSON.js').utils;const ObjetFenetre=require('ObjetFenetre.js');const ObjetFenetre_MessageDynamiqueDemarrage=require('ObjetFenetre_MessageDynamiqueDemarrage.js');class ObjetDonneesCentraleNotifications{constructor(){this.nbNotifs=0;Invocateur.abonner(UtilsRequeteJSON.getIdentNotification('compteurCentraleNotif'),function(aCompteur){this.nbNotifs=aCompteur;this._notifSurModification({compteurCentraleNotif:true});},this);Invocateur.abonner(ObjetDonneesCentraleNotifications.typeNotif.masquerNbNotifs,function(aNbNotifs){this.nbNotifs=Math.max(0,this.nbNotifs-aNbNotifs);this._notifSurModification({masquerNbNotifs:true});},this);}
_notifSurModification(aParams){Invocateur.evenement(ObjetDonneesCentraleNotifications.typeNotif.surModification,Object.assign(aParams||{},this.getDonnees()));Invocateur.evenement(ObjetInvocateur.events.refreshIEHtml);}
getDonnees(){return{nbNotifs:this.nbNotifs};}
addMessagesDynamiques(aTabMessages){this.listeMessagesDynamiques=[];if(aTabMessages&&aTabMessages.length>0&&aTabMessages.forEach){aTabMessages.forEach(function(aMessage){if(aMessage&&aMessage.id&&aMessage.contenu){this.listeMessagesDynamiques.push(aMessage);} else{}}.bind(this));}}
initSurInterfaceDisponible(){if(this.listeMessagesDynamiques&&this.listeMessagesDynamiques.length>0){ObjetFenetre.creerInstance(ObjetFenetre_MessageDynamiqueDemarrage,{pere:GInterface},{messages:this.listeMessagesDynamiques}).Afficher();this.listeMessagesDynamiques=[];}
this._notifSurModification();}}
ObjetDonneesCentraleNotifications.typeNotif={surModification:'odcn_surModification',masquerNbNotifs:'odcn_masquerNbNotifs'};module.exports=ObjetDonneesCentraleNotifications;},fn:"objetdonneescentralenotifications.js"});;
IE.fModule({f:function(exports,require,module,global){require('produit/css/TypeStatutConnexion.css');const GTraductions=require('ObjetTraduction.js');const TypeGenreStatutConnexion={GSC_Disponible:0,GSC_EnCours:1,GSC_NePasDeranger:2,GSC_Deconnecte:3};module.exports.TypeGenreStatutConnexion=TypeGenreStatutConnexion;const TypeGenreStatutConnexionBase={SCB_Connecte:0,SCB_NePasDeranger:1,SCB_Invisible:2};module.exports.TypeGenreStatutConnexionBase=TypeGenreStatutConnexionBase;TypeGenreStatutConnexion.arrayAll=[
TypeGenreStatutConnexion.GSC_Disponible,TypeGenreStatutConnexion.GSC_EnCours,TypeGenreStatutConnexion.GSC_NePasDeranger,TypeGenreStatutConnexion.GSC_Deconnecte
];TypeGenreStatutConnexion.getClassIcon=function(aGenre){switch(aGenre){case TypeGenreStatutConnexion.GSC_Disponible:return'TypeGenreStatutConnexion-GSC_Disponible';case TypeGenreStatutConnexion.GSC_EnCours:return'TypeGenreStatutConnexion-GSC_EnCours';case TypeGenreStatutConnexion.GSC_NePasDeranger:return'TypeGenreStatutConnexion-GSC_NePasDeranger';default:return'TypeGenreStatutConnexion-GSC_Deconnecte';}};TypeGenreStatutConnexion.toLibelle=function(aGenre,aAvecLibelleInvisible){switch(aGenre){case TypeGenreStatutConnexion.GSC_Disponible:return GTraductions.getValeur('Messagerie.Connectee');case TypeGenreStatutConnexion.GSC_EnCours:return GTraductions.getValeur('Messagerie.EnClasse');case TypeGenreStatutConnexion.GSC_NePasDeranger:return GTraductions.getValeur('Messagerie.NePasDeranger');default:return aAvecLibelleInvisible?GTraductions.getValeur('Messagerie.Invisible'):GTraductions.getValeur('Messagerie.NonConnectee');}};},fn:"typestatutconnexion.js"});;
IE.fModule({f:function(exports,require,module,global){const{Invocateur}=require('Invocateur.js');const ObjetDonneesCentraleNotifications=require('ObjetDonneesCentraleNotifications.js');const TypeGenreStatutConnexion=require('TypeStatutConnexion.js').TypeGenreStatutConnexion;const UtilsRequeteJSON=require('ObjetRequeteJSON.js').utils;class ObjetDonneesCentraleNotificationsSco extends ObjetDonneesCentraleNotifications{constructor(...aParams){super(...aParams);this.compteurNotifsParOnglet={};Invocateur.abonner('notification_communication',function(aNotifs){for(let i=0;i<aNotifs.length;i++){this.compteurNotifsParOnglet[aNotifs[i].onglet]=aNotifs[i];}
this._notifSurModification({notification_communication:true});},this);Invocateur.abonner('modifier_notification_communication',function(aGenreOnglet,aModificateur){if(aModificateur===0){return;}
if(!this.compteurNotifsParOnglet[aGenreOnglet]){this.compteurNotifsParOnglet[aGenreOnglet]={nb:0,onglet:aGenreOnglet};}
this.compteurNotifsParOnglet[aGenreOnglet].nb=(this.compteurNotifsParOnglet[aGenreOnglet].nb||0)+aModificateur;this.nbNotifs+=aModificateur;this._notifSurModification({modifier_notification_communication:true});},this);Invocateur.abonnerUnique('notification_chatVS',function(aListe){this.listeNotifsChatVS=aListe;}.bind(this));this.nbConversationEnCours=0;Invocateur.abonner('modifier_nb_conversationEnCours',function(aNb){this.nbConversationEnCours=aNb;this._notifSurModification();},this);this.statutConnexionCommunication=TypeGenreStatutConnexion.GSC_Deconnecte;Invocateur.abonner(UtilsRequeteJSON.getIdentNotification('statutConnexion'),function(aStatut){this.statutConnexionCommunication=aStatut;}.bind(this));}
getDonnees(...aParams){return Object.assign({},{compteurNotifsParOnglet:this.compteurNotifsParOnglet,nbConversationEnCours:this.nbConversationEnCours},super.getDonnees(...aParams));}}
module.exports=ObjetDonneesCentraleNotificationsSco;},fn:"objetdonneescentralenotificationssco.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreOnglet={MenuOnglets:-2,GeneralAccueil:-1,GeneralRacine:0,GeneralVieEtablissement:2,GeneralNotes:3,GeneralBulletins:4,GeneralVieScolaire:5,GeneralCompte:6,Accueil:7,Informations:8,Agenda:9,Menus:10,Vacances:11,Releve:12,Bulletins:13,Orientation:14,SaisieOrientation:15,EmploiDuTemps:16,CahierDeTexte:17,Remplacements:18,VieScolaire_Recapitulatif:19,Dossiers:20,Compte:21,CompteEleve:22,SaisieNotes:23,DEV_AppelEtSuivi:24,SaisieAppreciationsBulletin:25,SaisieAppreciationsBulletinGroupe:26,SaisieAppreciationsGenerales:27,SaisieCahierDeTextes:28,SaisieAbsences:29,SaisieAppreciationsReleve:30,SaisieAppreciationsReleve_Gpe:31,FicheBrevet:34,CompteGadget:35,InfoMedicale:36,EquipePedagogique:37,Graphique:38,GeneralResultats:39,GeneralOrientations:40,ConseilDeClasse:41,SaisieAppreciationDeFinDeStage:42,GeneralDansLaClasse:43,SuiviPluriannuel:44,BilanParDomaine:45,CahierDeTextes_Contenu:47,CahierDeTextes_TravailAFaire:48,InfosPerso:49,GeneralStage:52,SaisieAppreciationsFicheBrevet:53,GeneralCompetence:55,Evaluation:56,GeneralBrevet:57,GeneralEquipePedagogique:58,GeneralMesClasses:59,EmploiDuTempsClasse:60,General_CahierDeTextes:61,CahierDeTextesClasse:62,ResultatsClasses:64,ListeEvaluation:65,ListeEvaluationHistorique:67,Punitions:68,Entreprise:69,CahierDeTexte_Progression:71,Dispenses:72,AbsencesEtRetards:73,SuivisAbsenceRetard:74,Affectation_Progression:75,RecapitulatifAbsences:76,TrombinoscopeClasse:77,Saisie_CarnetCorrespondance:78,IManuels:79,EmploiDuTempsSalle:81,Trombinoscope:82,LivretScolaire_Fiche:83,QCM:84,QCM_Saisie:85,QCM_Bibliotheque:86,QCM_Reponse:87,CDT_TAF:88,CDT_Contenu:89,Rencontre:90,Rencontre_Indisponibilites:91,Rencontre_Desideratas:92,CreneauxLibres:93,General_Rencontre_Planning:94,QCM_BibliothequeNathan:96,EmploiDuTempsProfesseur:97,SaisieOffresStage:98,RessourcePedagogique:99,BulletinCompetences:100,OffresStage:101,Casier:102,Casier_Documents:103,Casier_MonCasier:104,ListeEleves:105,Genral_Classes:106,General_Salles:107,LivretScolaire:108,LivretScolaire_Appreciations:109,LivretScolaire_Competences:110,Graphique_Profil:111,Graphique_Evolution:112,SaisieAbsences_AppelEtSuivi:113,SaisieAbsences_Appel:114,Remplacements_Grille:118,Remplacements_Tableau:119,Rencontre_Planning_Liste:120,Rencontre_Planning_Grille:121,GeneralReleveDeNotes:122,ListeProfesseurs:123,ListeClasses:124,ListeGroupes:125,ListeResponsables:126,ListePersonnels:127,Genral_Eleves:128,General_Professeurs:129,EmploiDuTempsEleve:130,Messagerie:131,General_Messagerie:132,EmploiDuTempsPersonnelEtablissement:134,Incidents:135,SaisieAbsences_Appel_Professeur:136,AutorisationSortie:137,RecapAbsences:138,RecapFeuilleAppel:139,RecapPunitions:140,ProgrammesBO:141,Trombinoscope_Professeur:142,Trombinoscope_Personnel:143,ParametresUtilisateur:144,ListeStagiaires:145,CoursNonAssures:146,General_Personnels:147,DocumentsATelecharger:148,General_Progression:149,BibliothequeProgression:150,General_CahierDeTextes_Saisie:151,General_CahierDeTextes_Consultation:152,General_Documentation:153,ListeDevoirSurTable:154,AbsencesGrille:155,General_Materiels:156,EmploiDuTempsMateriel:157,ListeDiffusion:158,RecapitulatifScolarite:161,PlanningParSemaine:162,PlanningParSemaine_Professeur:163,PlanningParSemaine_Eleve:164,PlanningParSemaine_Classe:165,PlanningParSemaine_Salle:166,PlanningParSemaine_PersonnelEtablissement:167,PlanningParSemaine_Materiel:168,PlanningParRessource_Professeur:169,PlanningParRessource_Eleve:170,PlanningParRessource_Classe:171,PlanningParRessource_Salle:172,PlanningParRessource_PersonnelEtablissement:173,PlanningParRessource_Materiel:174,General_Intendance:175,Intendance_SaisieDemandesTravaux:176,RessourcePedagogique_Partage:177,BilanFinDeCycle:178,Trombinoscope_EquipePedagogique:179,ParcoursEducatif_Bulletin:180,ParcoursEducatif_BullCompetence:181,General_Competences_NouveauSocleCommun:182,Saisie_Punitions:192,Saisie_Dispenses:193,ListeDevoirs:194,EvaluationAccueilStage:195,ListeServices:196,RecapitulatifExportLSU:197,DernieresNotes:198,Competences_GrillesParDomaine:199,Competences_GrillesParMatiere:200,DernieresEvaluations:201,ReleveEvaluationsParService:202,General_Competences_Grilles:203,General_Competences_Evaluation:204,General_Competences_BilanPeriodique:205,General_Competences_BilanFinDeCycle:206,General_MonEmploiDuTemps:207,General_MesEleves:208,General_MesCollegues:209,General_OutilsPedagogiques:210,General_CDT:211,General_VieScolaire_Recapitulatif:212,General_RessourcesPedagogiques:214,ReleveEvaluationsParClasse:215,NiveauxDeMaitriseParMatiere:216,General_BulletinsEleveClasse:217,General_BulletinCompetencesEleveClasse:218,BulletinCompetencesClasse:219,General_MesColleguesPersonnels:220,General_ProceduresDisciplinaires:221,General_Dispenses:222,General_Competences_BilanDomaine:223,SaisieAppreciationsGenerales_Competences:224,General_Appreciations:225,General_Appreciations_Competences:226,BulletinAnneesPrec_Note:227,BulletinAnneesPrec_Competence:228,ListeMatieres:229,ReleveDeCompetences:230,TableauDeBord:231,ServicesPeriscolaires:232,Inscriptions:233,EmploiDuTemps_Annuel_Classe:234,InfosEnfant_Prim:235,General_BilanParDomaine:237,General_CahierJournal:238,SaisieProgressions:239,General_PyramideDesAges:240,PyramideDesAges_Histogramme:241,PyramideDesAges_Repartition:242,General_CahierDeTextes_Planification:243,CDT_Planning:244,QCM_Collaboratif:245,AppreciationsBulletinParEleve:246,Intendance_SaisieSecretariat:247,Competences_GrillesCompetencesNumeriques:248,CompetencesNumeriques:249,ManuelsNumeriques:250,General_Blog:251,Blog_Admin:252,Blog_FilActu:253,Blog_Mediatheque:254,SaisieTravailAFaire:255,General_InscriptionsEtablissement:256,InscriptionsEtablissement:257,SaisieAbsences_AppelEtSuiviProfesseur:259,SaisieAvisProfesseur:260,SuiviElevesTutores:261,Onglet_General_Suivi:262,SuiviJustificationsAbsencesRetards:263,Intendance_SaisieDemandesInformatique:264,Intendance_SaisieCommandes:265,SaisieCahierJournal:266,Onglet_General_Apprentissages:267,ListeApprentissages:268,CarnetDeSuivi:269,SyntheseAcquis:270,DocumentsParents:271,RecapDevoirRendu:272,SaisieAvisParcoursup:273,SaisieAppelPeriScolaire:274,ForumPedagogique:275,General_Competences_SuiviCompetences:276,SuiviResultatsCompetences:277,BilanCompetencesParMatiere:278};module.exports=EGenreOnglet;},fn:"enumere_onglet.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeHttpNotificationDonnes={THND_ListeDocJointEtablissement:0,THND_ListeClasse:1,THND_ListeClasseNiveau:2,THND_ListeGroupe:3,THND_ListeProfesseur:4,THND_AutorisationProfesseur:5,THND_AutorisationPersonnel:6,THND_NombreDepotDocumentCasierNonLus:7,THND_NombreMessagesNonLus:8,THND_NombreActualitesNonLues:9,THND_Kiosque:10};module.exports.TypeHttpNotificationDonnes=TypeHttpNotificationDonnes;},fn:"typehttpnotificationdonnes.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const Requetes=require('CollectionRequetes.js');class ObjetRequeteCloudAttente extends ObjetRequeteConsultation{}
Requetes.inscrire('CloudAttente',ObjetRequeteCloudAttente);module.exports=ObjetRequeteCloudAttente;},fn:"objetrequetecloudattente.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const Requetes=require('CollectionRequetes.js');const{Invocateur}=require('Invocateur.js');const UtilsRequeteJSON=require('ObjetRequeteJSON.js').utils;const tag=require('tag.js');const GTraductions=require('ObjetTraduction.js');const UtilitaireOAuth2={revocation(aIdOAuth2,aCallback){new ObjetRequeteOAuth2Attente({}).lancerRequete({idOAuth2:aIdOAuth2,revocation:true}).then((aJSON) =>{if(!!aJSON){GEtatUtilisateur.listeCloud.parcourir(function(aCloud){if(!!aCloud.idOAuth2&&aCloud.idOAuth2===aIdOAuth2){delete aCloud.idOAuth2;}});GEtatUtilisateur.listeCloudDepotServeur.parcourir(function(aCloud){if(!!aCloud.idOAuth2&&aCloud.idOAuth2===aIdOAuth2){delete aCloud.idOAuth2;}});aCallback.call(this);}});},authentification_promise(aIdOAuth2){const lIdentAbonnement=UtilsRequeteJSON.getIdentNotification('tokenOAuth2');return new ObjetRequeteOAuth2Attente({}).lancerRequete({idOAuth2:aIdOAuth2}).then((aJSON) =>{if(aJSON.urlAuthorize){window.open(aJSON.urlAuthorize);let lAvecInterruption=true;const lPromiseMessage=GApplication.getMessage().afficher({message:GTraductions.getValeur('UtilitaireOAuth2.message',[
tag('a',{href:aJSON.urlAuthorize,target:'_blank'},GTraductions.getValeur('UtilitaireOAuth2.lien'))]).toHTML()}).then(() =>{if(lAvecInterruption){return new ObjetRequeteOAuth2Attente({}).lancerRequete({interruption:true});}}).then(() =>{return Promise.reject({sansMessage:true});});const lPromiseNotif=new Promise((aResolve,aReject) =>{Invocateur.abonnerUnique(lIdentAbonnement,(aNotif) =>{lAvecInterruption=false;if(aNotif&&aNotif.ok){aResolve();} else{aReject(aNotif.message);}});});return Promise.race([
lPromiseMessage,lPromiseNotif
]).finally(() =>{GApplication.getMessage().Fermer();Invocateur.desabonner(lIdentAbonnement);});}
if(!aJSON.ok){return Promise.reject(aJSON.message);}}).catch((aError) =>{if(aError&&aError.sansMessage){return Promise.reject();}
return GApplication.getMessage().afficher({message:aError||GTraductions.getValeur('UtilitaireOAuth2.echec')}).then(() =>{return Promise.reject();});});}};class ObjetRequeteOAuth2Attente extends ObjetRequeteConsultation{}
Requetes.inscrire('OAuth2Attente',ObjetRequeteOAuth2Attente);module.exports=UtilitaireOAuth2;},fn:"utilitaireoauth2.js"});;
IE.fModule({f:function(exports,require,module,global){const TTypeElementCloud={tec_Fichier:0,tec_Dossier:1};module.exports.TTypeElementCloud=TTypeElementCloud;const TypeFormatPublication={FP_NonPublie:0,FP_Natif:1,FP_Pdf:2};module.exports.TypeFormatPublication=TypeFormatPublication;},fn:"ttypeelementcloud.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeStatutInterrogationCloud={sic_Inconnu:0,sic_OK:1,sic_TokenInvalide:2,sic_Timeout:3,sic_ArretApplication:4,sic_DossierTropGros:5,sic_DossierInconnu:6,sic_RacineInconnue:7,sic_ImpossibleDePartagerLeFichier:8,sic_AdresseMailNonVerifiee:9,sic_ImpossibleDePartagerUnDossier:10,sic_FichierDejaExistant:11,sic_FichierTropGros:12,sic_PlusDEspace:13};module.exports.TypeStatutInterrogationCloud=TypeStatutInterrogationCloud;},fn:"typestatutinterrogationcloud.js"});;
IE.fModule({f:function(exports,require,module,global){const ObjetRequeteCloudAttente=require('ObjetRequeteCloudAttente.js');const MethodesObjet=require('MethodesObjet.js');const ObjetListeElements=require('ObjetListeElements.js');const ObjetElement=require('ObjetElement.js');const GTraductions=require('ObjetTraduction.js');const EGenreDocumentJoint=require('Enumere_DocumentJoint.js');const EGenreEtat=require('Enumere_Etat.js');const UtilitaireOAuth2=require('UtilitaireOAuth2.js');const EGenreBoiteMessage=require('Enumere_BoiteMessage.js');const{TypeFormatPublication}=require('TTypeElementCloud.js');const{TypeStatutInterrogationCloud}=require('TypeStatutInterrogationCloud.js');const UtilitaireRequetesCloud={requetePartageListeFichiers(aListePJs){const lListeATraiter=aListePJs.getListeElements(function(aEle){return aEle.GetGenre()===EGenreDocumentJoint.Cloud&&aEle.Existe()&&aEle.service!==undefined&&!aEle.traite;});if(lListeATraiter.GetNbrElements()>0){const lElement=lListeATraiter.GetElement(0);lElement.partageFichier=true;return new ObjetRequeteCloudAttente({}).lancerRequete({service:lElement.service,idPartage:lElement.idPartage,partageFichier:lElement.partageFichier,publiPdf:lElement.publiPdf}).then(function(aJSON){if(aJSON.status===TypeStatutInterrogationCloud.sic_OK){lElement.url=aJSON.urlPartage;lElement.traite=true;return;}
if(aJSON.status===TypeStatutInterrogationCloud.sic_TokenInvalide){if(lElement.avecTokenInvalide){return Promise.reject();}
lElement.avecTokenInvalide=true;if(aJSON.idOAuth2){return UtilitaireOAuth2.authentification_promise(aJSON.idOAuth2);}
return Promise.reject();}
lElement.SetEtat(EGenreEtat.Suppression);lElement.traite=true;return GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,message:GTraductions.getValeur('requete.erreur')+' : '+(aJSON.message||'')+' ('+aJSON.status+')'});}).then(() =>{return UtilitaireRequetesCloud.requetePartageListeFichiers(aListePJs);}).catch(function(aError){});}
return Promise.resolve();},requeteUploadVersCloudListFichiers(aParams){const lParams=Object.assign({idPartageDossier:null,service:null,listeFichiersATraiter:null,listeFichiersResultat:null},aParams);if(!MethodesObjet.isNumber(lParams.service)||!lParams.idPartageDossier||!lParams.listeFichiersATraiter||!lParams.listeFichiersATraiter.GetNbrElements||!lParams.listeFichiersResultat){return Promise.reject();}
if(lParams.listeFichiersATraiter.GetNbrElements()===0){return Promise.resolve(true);}
const lIndiceFichierATraiter=0;const lFichier=lParams.listeFichiersATraiter.GetElement(lIndiceFichierATraiter);return Promise.resolve().then(() =>{if(lFichier){const lIdFichierBackup=lFichier.idFichier;return new ObjetRequeteCloudAttente({}).addUpload({listeFichiers:new ObjetListeElements().add(lFichier),annulerSurAbortUpload:true,annulerSurErreurUpload:true}).lancerRequete({upload:true,service:lParams.service,idDossier:lParams.idPartageDossier,nomFichier:lFichier.GetLibelle(),idFichier:lFichier.idFichier}).then((aJSON) =>{if(aJSON.upload&&aJSON.fichier){const lElementCloud=new ObjetElement({Libelle:aJSON.fichier.GetLibelle(),Genre:EGenreDocumentJoint.Cloud,service:lParams.service,idPartage:aJSON.fichier.idPartage,publiPdf:aJSON.fichier.pubPdf?aJSON.fichier.formatPub:TypeFormatPublication.FP_Natif,url:aJSON.fichier.url});lElementCloud.SetEtat(EGenreEtat.Creation);lParams.listeFichiersResultat.add(lElementCloud);return;}
if(aJSON.status===TypeStatutInterrogationCloud.sic_TokenInvalide){if(lParams.avecTokenInvalide){return Promise.reject();}
lParams.avecTokenInvalide=true;if(aJSON.idOAuth2){return UtilitaireOAuth2.authentification_promise(aJSON.idOAuth2).then(() =>{if(lIdFichierBackup){lFichier.idFichier=lIdFichierBackup;}
return{refaireUpload:true};});}}
return GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,message:GTraductions.getValeur('requete.erreur')+' : '+(aJSON.message||'')+' ('+aJSON.status+')'});});}}).then((aParams) =>{if(!aParams||!aParams.refaireUpload){lParams.listeFichiersATraiter.remove(lIndiceFichierATraiter);}
return UtilitaireRequetesCloud.requeteUploadVersCloudListFichiers(lParams);});}};module.exports=UtilitaireRequetesCloud;},fn:"utilitairerequetescloud.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const MethodesObjet=require('MethodesObjet.js');const{c_constantesJSON,ObjetRequeteJSON,utils:UtilsRequeteJSON}=require('ObjetRequeteJSON.js');const ObjetElement=require('ObjetElement.js');const EGenreOnglet=require('Enumere_Onglet.js');const TypeHttpNotificationDonnes=require('TypeHttpNotificationDonnes.js').TypeHttpNotificationDonnes;const UtilitaireRequetesCloud=require('UtilitaireRequetesCloud.js');ObjetRequeteJSON.declarerModules({initialiser:function(){if(global.GEtatUtilisateur&&GEtatUtilisateur.Identification){const lSignature={};if(GEtatUtilisateur.estEspaceAvecMembre()){const lMembre=GEtatUtilisateur.getMembre();if(lMembre){lSignature.membre=new ObjetElement('',lMembre.GetNumero(),lMembre.GetGenre());}}
lSignature.onglet=GEtatUtilisateur.getGenreOnglet()>=0&&MethodesObjet.isNumber(GEtatUtilisateur.getGenreOnglet())?GEtatUtilisateur.getGenreOnglet():EGenreOnglet.GeneralRacine;this._jsonRacineParametres[c_constantesJSON.Signature]=lSignature;}},deserialiserSignatureConsultation:function(){_deserialisationSignatureRequeteConsultSaisie(this.JSONSignature);},deserialiserSignatureSaisie:function(){_deserialisationSignatureRequeteConsultSaisie(this.JSONSignature);},factoryModuleUploadCloud:function(){return _getModuleUploadCloud();},deserialiserPolling:function(aJSONSignature,aJSONRacine){Object.assign(aJSONSignature,aJSONRacine[c_constantesJSON.Donnees]);_deserialisationSignature(aJSONSignature);}});function _deserialisationSignatureRequeteConsultSaisie(aJSON){if(aJSON){if(aJSON.ModeExclusif===true||aJSON.ModeExclusif===false){Invocateur.evenement(ObjetInvocateur.events.modificationModeExclusif,aJSON.ModeExclusif);}
_deserialisationSignature(aJSON);}}
function _deserialisationSignature(aJSON){if(GApplication.droits){GApplication.droits.chargerJSON(aJSON);}
if(aJSON.notificationsCommunication){Invocateur.evenement('notification_communication',aJSON.notificationsCommunication);}
if(aJSON.actualisationMessage){Invocateur.evenement('notification_actualisationMessage');}
if(aJSON.notificationsChatVS){Invocateur.evenement('notification_chatVS',aJSON.notificationsChatVS);Invocateur.evenement('notification_actualisationMessage',true);}
if(aJSON.notificationsKiosque){Invocateur.evenement('notification_Kiosque');}
if(aJSON.notifications){Object.keys(aJSON.notifications).forEach(function(aCle){Invocateur.evenement(UtilsRequeteJSON.getIdentNotification(aCle),aJSON.notifications[aCle]);});}
if(aJSON.listeDonnees){if(!GEtatUtilisateur.listeDonnees){GEtatUtilisateur.listeDonnees={};}
const lDonnees={},lJSON=aJSON.listeDonnees;if(lJSON[TypeHttpNotificationDonnes.THND_ListeClasseNiveau]){lDonnees[TypeHttpNotificationDonnes.THND_ListeClasseNiveau]=lJSON[TypeHttpNotificationDonnes.THND_ListeClasseNiveau];}
if(lJSON[TypeHttpNotificationDonnes.THND_ListeGroupe]){lDonnees[TypeHttpNotificationDonnes.THND_ListeGroupe]=lJSON[TypeHttpNotificationDonnes.THND_ListeGroupe];}
if(lJSON[TypeHttpNotificationDonnes.THND_ListeProfesseur]){lDonnees[TypeHttpNotificationDonnes.THND_ListeProfesseur]=lJSON[TypeHttpNotificationDonnes.THND_ListeProfesseur];}
if(lJSON[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement]){lDonnees[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement]=lJSON[TypeHttpNotificationDonnes.THND_ListeDocJointEtablissement];}
Object.assign(GEtatUtilisateur.listeDonnees,lDonnees);}}
function _getModuleUploadCloud(){return{setListePJs:function(aListe){this.listePJs=aListe;},actif:function(){return this.listePJs&&this.listePJs.GetNbrElements&&this.listePJs.GetNbrElements()>0;},lancer:function(){const lListePJs=this.listePJs;this.listePJs=null;return UtilitaireRequetesCloud.requetePartageListeFichiers(lListePJs);}};}},fn:"declarationobjetrequetepn.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const MethodesObjet=require('MethodesObjet.js');const Requetes=require('CollectionRequetes.js');class ObjetParametresUtilisateur{constructor(){this.init();}
get(aChaine){switch(aChaine){default:{let lValue=MethodesObjet.get(this._parametres,aChaine);if(lValue===undefined){lValue=false;}
return lValue;}}}
set(aChaine,aValeur,aIgnorerSaisie){const lAncienneValeur=MethodesObjet.get(this._parametres,aChaine);let lResult=false;if(aChaine.trim&&aChaine.split){const lSplit=aChaine.split('.');let lObjet=this._parametres;const lLength=lSplit.length;for(let i=0;i<lLength-1;i++){if(!MethodesObjet.isObject(lObjet[lSplit[i]])){lObjet[lSplit[i]]={};}
lObjet=lObjet[lSplit[i]];}}
switch(aChaine){case'widgets':this._parametres.widgets=aValeur;lResult=true;break;default:lResult=MethodesObjet.set(this._parametres,aChaine,aValeur)
;if(lResult){lResult=aValeur!==lAncienneValeur||MethodesObjet.isObject(aValeur);}}
if(lResult&&!aIgnorerSaisie){_save.call(this);}}
has(aChaine){switch(aChaine){default:{const lValue=MethodesObjet.get(this._parametres,aChaine);if(lValue!==undefined){return true;}}}
return false;}
init(){this._parametres={};}
chargerJSON(aJSON){if(aJSON){this._parametres=aJSON;}}}
function _save(){new ObjetRequeteSaisieParametresUtilisateur(null,function(){}).lancerRequete(this._parametres);}
class ObjetRequeteSaisieParametresUtilisateur extends ObjetRequeteConsultation{constructor(aPere,aEvenementSurReussite){super(aPere,aEvenementSurReussite,false);this.setOptions({sansBlocageInterface:true});}
lancerRequete(aParam){this.JSON.parametres=aParam;return this.appelAsynchrone();}
actionApresRequete(){this.callbackReussite.appel();}}
Requetes.inscrire('SaisieParametresUtilisateur',ObjetRequeteSaisieParametresUtilisateur);module.exports=ObjetParametresUtilisateur;},fn:"objetparametresutilisateur.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationJournauxCP.js');const ObjetDroitsPN=require('ObjetDroitsPN.js').ObjetDroitsPN;const ObjetRequeteFonctionParametres=require('ObjetRequeteFonctionParametres.js');const ObjetParametres=require('Parametres.js');const deferLoadingScript=require('deferLoadingScript.js');const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const MethodesObjet=require('MethodesObjet.js');const _ObjetCommunication=require('_ObjetCommunication.js');const GStyle=require('GStyle.js');const EGenreBoiteMessage=require('Enumere_BoiteMessage.js');const GCryptage=require('ObjetCryptage.js');const ObjetCycles=require('ObjetCycles.js');const{GDate}=require('ObjetDate.js');const GTraductions=require('ObjetTraduction.js');const TypeEnsembleNombre=require('TypeEnsembleNombre.js');const ObjetAccesPN=require('objetaccespn.js');const ObjetOptionsEspaceLocalPN=require('ObjetOptionsEspaceLocalPN.js');const TypeModeGrillesEDT=require('TypeModeGrillesEDT.js').TypeModeGrillesEDT;const ObjetApplication=require('ObjetApplication.js');const UtilitaireMAJServeur=require('UtilitaireMAJServeur.js');const ObjetDonneesCentraleNotificationsSco=require('ObjetDonneesCentraleNotificationsSco.js');const UtilitaireDeconnexion=require('UtilitaireDeconnexion.js');require('DeclarationObjetRequetePN.js');const uGestionPresence={modeExclusif:false,compteurAffichageMessagerie:0};class ObjetApplicationSco extends ObjetApplication{constructor(){super();this.nomProduit='PRONOTE';this.donneesCentraleNotifications=new ObjetDonneesCentraleNotificationsSco();}
lancer(aParam){this.setDemo(!!aParam.d);Invocateur.evenement(ObjetInvocateur.events.initChiffrement,aParam);const lParametres={genreEspace:aParam.a,numeroJeton:aParam.e?aParam.e:-1,cleJeton:aParam.f?aParam.f:'',genreAcces:aParam.g?aParam.g:0,numeroSession:aParam.h,forcerInscription:aParam.fi,page:aParam.p};this.acces=new ObjetAccesPN(lParametres.genreAcces,lParametres.genreEspace,0,0,lParametres.numeroJeton,0,'','');if(this.acces.estConnexionCAS()||this.acces.estConnexionCookie()){this.acces.setIdentification(lParametres.numeroJeton,lParametres.cleJeton);}
;this.droits=new ObjetDroitsPN();this.parametresUtilisateur=new(require('ObjetParametresUtilisateur.js'));IE.optionsEspaceLocal=new ObjetOptionsEspaceLocalPN({nomProduit:this.nomProduit,espace:lParametres.genreEspace});deferLoadingScript.setOptions({done(){},fail(aNom){GApplication.getCommunication().sendLogClient(`erreur chargement script defer : ${aNom}`);UtilitaireDeconnexion.deconnexionEchecChargement();},messageChargement:GTraductions.getValeur('connexion.Chargement')});this.initialisation(lParametres);this.lancerRequeteParametres(lParametres);Invocateur.abonner('affichage_messagerie',_surNotificationAffichageMessagerie.bind(this));UtilitaireMAJServeur.initialiser({afficherMessageDelaiLong:!GEtatUtilisateur.estEspacePourEleve(),afficherMessageImminentEleve:GEtatUtilisateur.estEspacePourEleve(),cssImage:GEtatUtilisateur.pourPrimaire()?'Image_AlerteMiseAJourPRM':'Image_AlerteMiseAJourPRN'});if(aParam.fi){GEtatUtilisateur.forcerOngletInscription=true;}
if(IE.optionsEspaceLocal){if(IE.optionsEspaceLocal.getModeAccessible){GEtatUtilisateur.setModeAccessible(IE.optionsEspaceLocal.getModeAccessible());}
if(IE.optionsEspaceLocal.getAvecCodeCompetences){GEtatUtilisateur.setAvecCodeCompetences(IE.optionsEspaceLocal.getAvecCodeCompetences());}
if(IE.optionsEspaceLocal.getAvecThemeAccessible){GEtatUtilisateur.setAvecThemeAccessible(IE.optionsEspaceLocal.getAvecThemeAccessible());}}}
initialisation(){}
lancerRequeteParametres(aParametres){new ObjetRequeteFonctionParametres(this,this.surRequeteParametres.bind(this,aParametres)).lancerRequete({espace:aParametres.genreEspace,uuidRSA:GCryptage.cryptageRSA.encrypter(this.getCommunication().ivAESTemp)});this.getCommunication().setIvAES();}
surRequeteParametres(aParametres,aJSON){try{GParametres=new ObjetParametres(aJSON);this.initialisationApresParametres(aParametres);} catch(e){alert("Erreur : "+e.message);}}
initialisationApresParametres(){function _surUnload(){this.getCommunication().desactiverPresence();}
Invocateur.abonner(ObjetInvocateur.events.surRechargementPage,_surUnload.bind(this));GDate.SetDonnees(GParametres.PremierLundi,GParametres.PremiereDate,GParametres.DerniereDate,GParametres.PlacesParJour,GParametres.PlacesParHeure,GParametres.DureeSequence,GParametres.PremiereHeure,GParametres.LibellesHeures,GParametres.LibellesHeuresFin,GParametres.JoursOuvres);let lJourFerie;let lIndiceJour;GParametres.ensembleJoursFeries=new TypeEnsembleNombre();for(let I=0,lNb=GParametres.listeJoursFeries.GetNbrElements();I<lNb;I++){lJourFerie=GParametres.listeJoursFeries.GetElement(I);for(lIndiceJour=GDate.getNbrJoursEntreDeuxDates(GParametres.dateDebutPremierCycle,lJourFerie.dateDebut);lIndiceJour<=GDate.getNbrJoursEntreDeuxDates(GParametres.dateDebutPremierCycle,lJourFerie.dateFin);lIndiceJour++){GParametres.ensembleJoursFeries.add(lIndiceJour+1);}}
IE.Cycles=new ObjetCycles();IE.Cycles.init({premiereDate:GParametres.PremiereDate,derniereDate:GParametres.DerniereDate,dateDebutPremierCycle:GParametres.dateDebutPremierCycle,joursOuvresParCycle:GParametres.joursOuvresParCycle,premierJourSemaine:GParametres.premierJourSemaine,joursOuvres:GParametres.setOfJoursCycleOuvre,cyclesSansFeries:GParametres.grillesEDTEnCycle===TypeModeGrillesEDT.TMG_CycleSansFeries,cyclesHebdomadaire:GParametres.grillesEDTEnCycle===TypeModeGrillesEDT.TMG_CycleHebdomadaire,joursFeries:GParametres.ensembleJoursFeries});this.actualiserTitle();}
destructionInterface(){if(window.GInterface&&GInterface.free){GInterface.free();}}
getJeton(aFrames){let lJeton;for(let i=0;i<aFrames.length&&(!lJeton);i++){try{lJeton=aFrames[i].frames[0].GJeton;} catch(e){}
try{if(!lJeton&&aFrames[i].frames.length>0){lJeton=this.getJeton(aFrames[i].frames);}} catch(e){}}
return lJeton;}
creerFenetreDebug(){}
getOptionsDebug(){return null;}
getConstructeursDebug(){return{constructeurFenetre:null,constructeurTraitements:null};}
_verificationAjoutObjetDansTableau(aTableau,aGenre,aNom){if(this.estDebug()){}}
avecGestionModeExclusif(){return GEtatUtilisateur.Identification;}
entreeModeExclusif(){if(!this.avecGestionModeExclusif()){return;}
super.entreeModeExclusif();this.getMessage().afficher({type:EGenreBoiteMessage.Information,titre:GTraductions.getValeur('ModeExclusif.UsageExclusif'),message:GTraductions.getValeur('ModeExclusif.EntrerModeExclusif'),delaiFermeture:true});uGestionPresence.modeExclusif=true;_modificationTimerPresence.bind(this)();}
sortieModeExclusif(){if(!this.avecGestionModeExclusif()){return;}
super.sortieModeExclusif();this.getMessage().afficher({type:EGenreBoiteMessage.Information,titre:GTraductions.getValeur('ModeExclusif.UsageExclusif'),message:GTraductions.getValeur('ModeExclusif.SortieModeExclusif'),delaiFermeture:true});uGestionPresence.modeExclusif=false;_modificationTimerPresence.bind(this)();}
finSession(aParametres){this.getCommunication().desactiverPresence();this.destructionInterface();super.finSession(aParametres);global.GInterface=null;}
construireEnTetePageFinSession(aParametres){const T=[];if(window.GParametres&&(GParametres.NomEspace||GParametres.NomEtablissementConnexion)){T.push('<div class="Texte" style="font-size:20px; padding:5px;',GStyle.composeCouleurTexte(aParametres.couleur.texte),'">');if(GParametres.NomEspace){T.push('<div class="Gras" style="float:left;','">',GParametres.NomEspace,'</div>');}
if(GParametres.NomEtablissementConnexion){T.push('<div style="float:right">',GParametres.NomEtablissementConnexion,'</div>');}
T.push('</div>');}
return T.join('');}
actualiserTitle(){document.title=GTraductions.getValeur('title',[GParametres.NomEtablissementConnexion,this.nomProduit,GParametres.NomEspace,'']);}}
function _modificationTimerPresence(){let lTimer=_ObjetCommunication.cDureeTimerPresence;if(uGestionPresence.modeExclusif){lTimer=1000*30;} else if(uGestionPresence.compteurAffichageMessagerie>0){lTimer=1000*30;}
this.getCommunication().setDureeTimerPresence(lTimer);}
function _surNotificationAffichageMessagerie(aEntreeSurAffichage){uGestionPresence.compteurAffichageMessagerie=Math.max(uGestionPresence.compteurAffichageMessagerie+(aEntreeSurAffichage?1:-1),0);_modificationTimerPresence.bind(this)();}
module.exports=ObjetApplicationSco;},fn:"objetapplicationsco.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');require('DeclarationJQuery.js');require('jInputDisabled.js');require('jInputChecked.js');const MethodesObjet=require('MethodesObjet.js');require('iehtml.checkboxradio.js');(function($){$.fn.jIECheckBox=function(aOptions){const lInputs=[];let lInput;this.each(function(){let lJqthis=$(this);const lEstCB=lJqthis.is(':checkbox');const lEstRB=lJqthis.is(':radio');if(!lEstCB&&!lEstRB){return;}
if(lJqthis.parent().hasClass('iecb')||lJqthis.parent().hasClass('ieswitch')){lInputs.push(this);return;}
if(lEstCB){lJqthis.attr('ie-checkbox','');} else{lJqthis.attr('ie-radio','');}
if(aOptions){const lCss={};if(MethodesObjet.isNumber(aOptions.marginLeftMin)){lCss['margin-left']=aOptions.marginLeftMin+'px';}
if(MethodesObjet.isNumber(aOptions.marginRightMin)){lCss['margin-right']=aOptions.marginRightMin+'px';}
if(MethodesObjet.isNumber(aOptions.marginTopMin)){lCss['margin-top']=aOptions.marginTopMin+'px';}
if(MethodesObjet.isNumber(aOptions.marginBottomMin)){lCss['margin-bottom']=aOptions.marginBottomMin+'px';}
lJqthis.css(lCss);}
const lNodeParent=lJqthis.parent().get(0);const lNode=IEHtml.injectHTML(lNodeParent,this,null,true,this.nextSibling);lInput=$(lNode).find('input').get(0);if(lInput){lInputs.push(lInput);lJqthis=$(lInput);lJqthis.addClass(this.className);}});return $(lInputs);};}(jQuery));module.exports=$;},fn:"jiecheckbox.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const TypeEnsembleNombre=require('TypeEnsembleNombre.js');global.GEtatUtilisateur=null;class ObjetEtatUtilisateurCP{constructor(){this.ModeAccessibleActif=false;this.EtatSaisie=false;this.parametres={ratioFicheEleve:1};this.reglesSaisieMotDePasse={min:0,max:0,regles:new TypeEnsembleNombre(),init:false};Invocateur.abonner(ObjetInvocateur.events.etatSaisie,this.setEtatSaisie.bind(this),this);}
setEtatSaisie(aEtat){this.EtatSaisie=aEtat;}
getRatioFicheEleve(){return this.parametres.ratioFicheEleve;}
actualiserRatioFicheEleve(){this.parametres.ratioFicheEleve=this.parametres.ratioFicheEleve===1?2:1;return this.parametres.ratioFicheEleve;}
avecImports(){return false;}
avecFicheEtablissement(){return false;}
getModeAccessible(){return this.ModeAccessibleActif;}
avecPlusieursMembres(){return false;}
setTriListe(aParams){const lParams=$.extend({liste:null,tri:undefined,colonnesTriables:true,identifiant:'id',onglet:''},aParams);if(!lParams.liste||!lParams.liste.setOptionsListe||!lParams.identifiant||!lParams.colonnesTriables){return;}
if(!this._trisListe_){this._trisListe_={};}
const lCle=lParams.onglet+'|'+lParams.identifiant;if(!this._trisListe_[lCle]){this._trisListe_[lCle]=lParams.tri;}
const lThis=this;aParams.liste.setOptionsListe({colonnesTriables:lParams.colonnesTriables,numeroColonneTriDefaut:function(){return this._trisListe_[lCle];}.bind(this),evenementSurTri:function(aColonnesTris){lThis._trisListe_[lCle]=aColonnesTris;}});return this;}
setReglesSaisieMotDePasse(aJSON){if(aJSON&&aJSON.reglesSaisieMDP){$.extend(this.reglesSaisieMotDePasse,aJSON.reglesSaisieMDP);this.reglesSaisieMotDePasse.init=true;}}
espacesAvecBoutonsTimeLine(){return true;}
getUniquementNonLues(){if((this.uniquementNonLues!==null)&&(this.uniquementNonLues!==undefined)){return this.uniquementNonLues;} else{return false;}}
setUniquementNonLues(aBoolean){this.uniquementNonLues=aBoolean;}}
module.exports=ObjetEtatUtilisateurCP;},fn:"objetetatutilisateurcp.js"});;
IE.fModule({f:function(exports,require,module,global){
class ObjetIdentification{constructor(aRessource,aListeRessources){this.ressource=aRessource;this.SetListeRessources(aListeRessources);}
getMembre(){return this.NumeroEleve?this.ListeRessources.GetElementParNumero(this.NumeroEleve):this.ressource;}
SetListeRessources(AListeRessources){this.ListeRessources=AListeRessources;this.NumeroEleve=null;for(let I=0;(I<this.ListeRessources.GetNbrElements())&&(this.NumeroEleve===null||this.NumeroEleve===undefined);I++){if(this.ListeRessources.GetElement(I).AvecSelection!==false){this.NumeroEleve=this.ListeRessources.GetNumero(I);}}}
GetLibelleClasse(){const LEleve=this.getMembre();return(LEleve&&LEleve.Classe)?LEleve.Classe.GetLibelle():'';}
GetNumeroClasse(){const LEleve=this.getMembre();return(LEleve&&LEleve.Classe)?LEleve.Classe.GetNumero():'';}
GetLibelleGroupes(){const LEleve=this.getMembre();if(LEleve){const LListeGroupes=LEleve.ListeGroupes;const N=!!LListeGroupes?LListeGroupes.GetNbrElements():0;const T=[];for(let I=0;I<N;I++){T.push(LListeGroupes.GetLibelle(I));}
return T.join(', ');}
return'';}}
module.exports=ObjetIdentification;},fn:"objetidentification.js"});;
IE.fModule({f:function(exports,require,module,global){const MethodesObjet=require('MethodesObjet.js');const ObjetElement=require('ObjetElement.js');const ObjetListeElements=require('ObjetListeElements.js');class ObjetNavigation{constructor(){this.TableauxRessources={};this.Classe=null;this.Groupe=null;this.Periode=null;this.Eleve=null;this.Service=null;this.Appreciation=null;this.avecCoursAnnule=true;this.Niveau= -1;this.NumeroMatiereCahierDeTextes=0;this.afficherFicheService=true;this.triDevoirs=false;}
SetRessource(AGenreRessource,AParametre,ANumero,AGenre){if(AParametre instanceof ObjetListeElements){this.TableauxRessources[AGenreRessource]=MethodesObjet.dupliquer(AParametre);} else if(MethodesObjet.isObject(AParametre)){this.TableauxRessources[AGenreRessource]=new ObjetListeElements().AddElement(MethodesObjet.dupliquer(AParametre));} else{this.TableauxRessources[AGenreRessource]=new ObjetListeElements().AddElement(new ObjetElement(AParametre,ANumero,AGenre));}}
GetRessource(AGenreRessource){return this.TableauxRessources[AGenreRessource]?this.TableauxRessources[AGenreRessource].GetElement(0):null;}
getRessources(AGenreRessource){return this.TableauxRessources[AGenreRessource];}
GetNumeroRessource(AGenreRessource){return this.GetRessource(AGenreRessource)?this.GetRessource(AGenreRessource).GetNumero():null;}
GetGenreRessource(AGenreRessource){return this.GetRessource(AGenreRessource)?this.GetRessource(AGenreRessource).GetGenre():null;}
GetLibelleRessource(AGenreRessource){return this.GetRessource(AGenreRessource)?this.GetRessource(AGenreRessource).GetLibelle():null;}}
module.exports=ObjetNavigation;},fn:"objetnavigation.js"});;
IE.fModule({f:function(exports,require,module,global){const GChaine=require('GChaine.js');const tag=require('tag.js');const TUtilitaireUrl=(function(){return{construireListeUrls:function(aListe,aParams){const lParams=Object.assign({genreFiltre:null,genreRessource:TUtilitaireUrl.genreRessourceDefault,separateur:' ',IEModelChips:'',argsIEModelChips:null,maxWidth:0,class:''},aParams);if(!aListe||!aListe.parcourir){return'';}
const T=[];aListe.parcourir(function(aElement,aIndex){if(aElement.Existe()){if(lParams.genreFiltre===null||lParams.genreFiltre===undefined||(aElement.GetGenre()===lParams.genreFiltre)){let lArgsIEModel=null;if(!!lParams.IEModelChips){lArgsIEModel=[aIndex];if(!!lParams.argsIEModelChips&&Array.isArray(lParams.argsIEModelChips)){lArgsIEModel=lArgsIEModel.concat(lParams.argsIEModelChips);}}
const lIeChips=GChaine.composerUrlLienExterne({documentJoint:aElement,genreRessource:lParams.genreRessource,maxWidth:lParams.maxWidth,ieModelChips:lParams.IEModelChips,argsIEModel:lArgsIEModel,class:lParams.class});T.push(tag('span',lIeChips));}}});let lResult=T.join(lParams.separateur);if(T.length>0){lResult=tag('div',{class:'liste-url-chips'},lResult);}
return lResult;},genreRessourceDefault:null};}());module.exports=TUtilitaireUrl;},fn:"utilitaireurl.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeGenreObservationVS={OVS_DefautCarnet:0,OVS_ObservationParent:1,OVS_Encouragement:2,OVS_Autres:3};module.exports.TypeGenreObservationVS=TypeGenreObservationVS;},fn:"typegenreobservationvs.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeGenrePunition={GP_ExclusionCours:0,GP_Retenues:1,GP_Devoir:2,GP_Autre:3};module.exports.TypeGenrePunition=TypeGenrePunition;},fn:"typegenrepunition.js"});;
IE.fModule({f:function(exports,require,module,global){const GTraductions=require('ObjetTraduction.js');const TUtilitaireUrl=require('UtilitaireUrl.js');const EGenreEspace=require('Enumere_Espace.js');const TypeGenreObservationVS=require('TypeGenreObservationVS.js').TypeGenreObservationVS;const TypeGenrePunition=require('TypeGenrePunition.js').TypeGenrePunition;const EGenreRessource={Aucune:0,Classe:1,Groupe:2,Enseignant:3,Eleve:4,Responsable:5,Niveau:6,Orientation:7,Specialite:8,OptionSpecialite:9,Etablissement:10,Periode:11,Service:12,Absence:13,Retard:14,Exclusion:15,Matiere:16,Salle:17,CoEnseignant:18,Suivis:19,Cours:20,Infirmerie:21,AbsenceRepas:22,Pilier:23,ElementPilier:24,Competence:25,_DisciplineBrevet:26,Palier:27,SousItem:28,Evaluation:29,Stage:30,SousMatiere:31,MaitreDeStage:32,InspecteurPedagogique:33,Personnel:34,EvaluationHistorique:35,DossierProgression:36,ContenuDeCours:37,TravailAFaire:38,Progression:39,Dispense:40,Punition:41,Sanction:42,Communication:43,AbsenceInternat:44,Observation:45,ObservationProfesseurEleve:46,ConvocationVS:47,DocumentJoint:48,InternetCategorie:49,DocJointEtablissement:50,Option:51,ProgrammationPunition:52,ReportPunition:53,DisciplineLivretScolaire:54,QCM:55,ExecutionQCM:56,QCMEditeur:57,PartieDeClasse:58,DocJointEleve:59,Devoir:60,InternetEnumere:61,AppreciationBulletinCompetence:62,Entreprise:63,DomaineProfessionnel:64,OffreDeStage:65,SujetDeStage:66,DocumentCasier:67,Message:68,PossessionMessage:69,RelationMessageDocJointEtablissement:70,Engagement:71,MesureConservatoire:72,SousCategorieObjetDossier:73,Incident:74,ProtagonisteIncident:75,RelationIncidentFichierExterne:76,RegimeEleve:77,RepasAPreparer:78,SessionDeStage:79,Materiel:80,Bourse:81,RelationTravailAFaireEleve:82,LieuDossier:83,ElementProgramme:84,ChapitreEltPgm:85,EltPgmTravailleCDT:86,Appreciation:87,ExecutionDevoirKiosque:88,PanierRessourceKiosque:89,RessourceNumeriqueKiosque:90,MetaMatiere:91,EvaluationSujet:92,EvaluationCorrige:93,LibelleCours:94,Site:95,QuestionQCM:96,RelationElevePilierDeCompetence:97,QuestionCopieQCM:98,Coordonnees:99,ResponsablePostulant:100,ExecutionQCMEleve:101,DocJointInscription:102,CategorieDossier:103};EGenreRessource.correspondAuGenreUtilisateurEspaceCourant=function(aGenre){switch(GEtatUtilisateur.GenreEspace){case EGenreEspace.Academie:return(aGenre===EGenreRessource.InspecteurPedagogique);case EGenreEspace.Eleve:case EGenreEspace.Mobile_Eleve:case EGenreEspace.PrimEleve:case EGenreEspace.Mobile_PrimEleve:return(aGenre===EGenreRessource.Eleve);case EGenreEspace.Entreprise:return(aGenre===EGenreRessource.MaitreDeStage);case EGenreEspace.Etablissement:return(aGenre===EGenreRessource.Personnel);case EGenreEspace.Parent:case EGenreEspace.Mobile_Parent:case EGenreEspace.PrimParent:case EGenreEspace.Mobile_PrimParent:return(aGenre===EGenreRessource.Responsable);case EGenreEspace.Tuteur:case EGenreEspace.Mobile_Tuteur:case EGenreEspace.Accompagnant:case EGenreEspace.Mobile_Accompagnant:case EGenreEspace.PrimAccompagnant:case EGenreEspace.Mobile_PrimAccompagnant:case EGenreEspace.PrimPeriscolaire:case EGenreEspace.Mobile_PrimPeriscolaire:return(aGenre===EGenreRessource.Personnel);case EGenreEspace.Professeur:case EGenreEspace.Mobile_Professeur:case EGenreEspace.PrimProfesseur:case EGenreEspace.Mobile_PrimProfesseur:return(aGenre===EGenreRessource.Enseignant);case EGenreEspace.Administrateur:case EGenreEspace.Mobile_Administrateur:return(aGenre===EGenreRessource.Personnel);default:return false;}};EGenreRessource.getNiveauDeploiementCompetence=function(aCompetence){switch(aCompetence.GetGenre()){case EGenreRessource.Pilier:return 4;case EGenreRessource.ElementPilier:return 3;case EGenreRessource.Competence:return 2;case EGenreRessource.SousItem:return 1;case EGenreRessource.Evaluation:case EGenreRessource.EvaluationHistorique:return 0;}};EGenreRessource.getGenrePereCompetence=function(aGenre,aGenrePourEvaluation){switch(aGenre){case EGenreRessource.ElementPilier:return null;case EGenreRessource.Competence:return EGenreRessource.ElementPilier;case EGenreRessource.SousItem:return EGenreRessource.Competence;case EGenreRessource.Evaluation:return aGenrePourEvaluation;}};EGenreRessource.getNiveauDeploiementSelectionQCM=function(aObjet){switch(aObjet.GetGenre()){case EGenreRessource.Matiere:return 3;case EGenreRessource.Niveau:return 2;case EGenreRessource.QCM:return 1;case EGenreRessource.Aucune:return 0;}};EGenreRessource.getNomImageAbsence=function(aObjet){switch(aObjet.genre){case EGenreRessource.ObservationProfesseurEleve:switch(aObjet.genreObservation){case TypeGenreObservationVS.OVS_DefautCarnet:return'Color_RecapVS_Lue icon_Defaut_de_carnet';case TypeGenreObservationVS.OVS_Autres:if(aObjet.estLue===false){return'Color_RecapVS_NonLue icon_asterisk';}
return'Color_RecapVS_Lue icon_asterisk';case TypeGenreObservationVS.OVS_ObservationParent:if(aObjet.estLue===false){return'Color_RecapVS_NonLue icon_observation';}
return'Color_RecapVS_Lue icon_observation';case TypeGenreObservationVS.OVS_Encouragement:if(aObjet.estLue===false){return'Color_RecapVS_NonLue icon_smile';}
return'Color_RecapVS_Lue icon_smile';default:return'';}
case EGenreRessource.Absence:if(aObjet.estUneCreationParent===true){if(aObjet.refusee===true){return'Color_RecapVS_NonLue iconVSDetail icon_exclamation';} else if(aObjet.confirmee===true){return'Color_RecapVS_Lue iconVSDetail icon_ok';} else{return'Color_RecapVS_Lue iconVSDetail icon_edt_permanence';}} else if(aObjet.justifie===false){return'Color_RecapVS_NonLue icon_absences';}
return'Color_RecapVS_Lue icon_absences';case EGenreRessource.AbsenceRepas:return'Color_RecapVS_Lue icon_food';case EGenreRessource.AbsenceInternat:return'Color_RecapVS_Lue icon_internat';case EGenreRessource.Retard:return'Color_RecapVS_Lue icon_retard';case EGenreRessource.Infirmerie:return'Color_RecapVS_Lue icon_f0fe';case EGenreRessource.Incident:return'Color_RecapVS_Lue icon_bolt';case EGenreRessource.Exclusion:return'Color_RecapVS_Lue icon_punition_exclusion';case EGenreRessource.Punition:if(aObjet.estProgrammation){return'Color_RecapVS_Lue icon_recap_vs_programmation';}
switch(aObjet.genreNature){case TypeGenrePunition.GP_ExclusionCours:return'Color_RecapVS_Lue icon_punition_exclusion';case TypeGenrePunition.GP_Retenues:case TypeGenrePunition.GP_Devoir:case TypeGenrePunition.GP_Autre:return'Color_RecapVS_Lue icon_punition';default:return'Color_RecapVS_Lue icon_punition';}
case EGenreRessource.Sanction:if(aObjet.avecSursis===true){return'Color_RecapVS_Lue icon_legal';}
return'Color_RecapVS_Lue icon_legal';case EGenreRessource.MesureConservatoire:return'Color_RecapVS_Lue icon_mesure_conservatoire';}
return'';};EGenreRessource.getIconAbsence=function(aObjet){switch(aObjet.genre){case EGenreRessource.Observation:case EGenreRessource.ObservationProfesseurEleve:switch(aObjet.genreObservation){case TypeGenreObservationVS.OVS_DefautCarnet:return'icon_Defaut_de_carnet';case TypeGenreObservationVS.OVS_Autres:return'icon_asterisk';case TypeGenreObservationVS.OVS_ObservationParent:return'icon_observation';case TypeGenreObservationVS.OVS_Encouragement:return'icon_smile';default:return'';}
case EGenreRessource.Absence:return'icon_absences';case EGenreRessource.AbsenceRepas:case EGenreRessource.RepasAPreparer:return'icon_food';case EGenreRessource.AbsenceInternat:return'icon_internat';case EGenreRessource.Retard:return'icon_retard';case EGenreRessource.Infirmerie:return'icon_medkit';case EGenreRessource.Dispense:return'icon_dispense';case EGenreRessource.Incident:return'icon_bolt';case EGenreRessource.Exclusion:return'icon_punition_exclusion';case EGenreRessource.Punition:switch(aObjet.genreNature){case TypeGenrePunition.GP_ExclusionCours:return'icon_punition_exclusion';case TypeGenrePunition.GP_Retenues:case TypeGenrePunition.GP_Devoir:case TypeGenrePunition.GP_Autre:return'icon_punition';default:return'icon_punition';}
case EGenreRessource.Sanction:return'icon_legal';case EGenreRessource.MesureConservatoire:return'icon_mesure_conservatoire';}
return'';};EGenreRessource.getPositionAbsence=function(aObjet){let lResult=0;switch(aObjet.genre){case EGenreRessource.ObservationProfesseurEleve:switch(aObjet.genreObservation){case TypeGenreObservationVS.OVS_ObservationParent:lResult=0;break;case TypeGenreObservationVS.OVS_Encouragement:lResult=1;break;case TypeGenreObservationVS.OVS_DefautCarnet:lResult=2;break;case TypeGenreObservationVS.OVS_Autres:lResult=60;break;default:;lResult=60;break;}
break;case EGenreRessource.Absence:lResult=10;break;case EGenreRessource.AbsenceRepas:lResult=12;break;case EGenreRessource.AbsenceInternat:lResult=13;break;case EGenreRessource.Retard:lResult=21;break;case EGenreRessource.Infirmerie:lResult=20;break;case EGenreRessource.Incident:lResult=25;break;case EGenreRessource.Exclusion:;lResult=30;break;case EGenreRessource.Punition:lResult=30;break;case EGenreRessource.MesureConservatoire:lResult=40;break;case EGenreRessource.Sanction:lResult=50;break;default:lResult=9999;break;}
return lResult;};EGenreRessource.getTitreFenetreSelectionRessource=function(aGenre){switch(aGenre){case EGenreRessource.Eleve:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherEleves');case EGenreRessource.Enseignant:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherProfesseurs');case EGenreRessource.Responsable:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherResponsables');case EGenreRessource.Personnel:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherPersonnel');case EGenreRessource.MaitreDeStage:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherMaitresDeStage');case EGenreRessource.InspecteurPedagogique:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherInspecteurs');case EGenreRessource.Periode:return GTraductions.getValeur('Fenetre_SelectionRessource.CocherPeriodes');default:return null;}};TUtilitaireUrl.genreRessourceDefault=EGenreRessource.DocumentJoint;module.exports=EGenreRessource;},fn:"enumere_ressource.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreConnexion={Normale:0,Allegee:1};module.exports=EGenreConnexion;},fn:"enumere_connexion.js"});;
IE.fModule({f:function(exports,require,module,global){const ObjetEtatUtilisateurCP=require('ObjetEtatUtilisateurCP.js');const MethodesObjet=require('MethodesObjet.js');const MethodesTableau=require('MethodesTableau.js');const ObjetElement=require('ObjetElement.js');const ObjetListeElements=require('ObjetListeElements.js');const GChaine=require('GChaine.js');const ObjetTri=require('ObjetTri.js');const ObjetIdentification=require('ObjetIdentification.js');const GTraductions=require('ObjetTraduction.js');const ObjetNavigation=require('ObjetNavigation.js');const EGenreRessource=require('Enumere_Ressource.js');const EGenreEspace=require('Enumere_Espace.js');const EGenreOnglet=require('Enumere_Onglet.js');const{TypeDroits}=require('ObjetDroitsPN.js');const EGenreConnexion=require('enumere_connexion.js');class ObjetEtatUtilisateur extends ObjetEtatUtilisateurCP{constructor(aGenreEspace){super();this.GenreEspace=aGenreEspace;this.Navigation=new ObjetNavigation();this.genreOnglet=null;this.accessibilite={avecCodeCompetences:false,avecThemeAccessible:false};}
initAuthentification(aParam){this.avecRessourcesGranulaire=aParam.avecRessourcesGranulaire;this.avecRessourcesRenduTAF=aParam.avecRessourcesRenduTAF;this.avecRessourcesEnvoiNote=aParam.avecRessourcesEnvoiNote;this.activerKiosqueRenduTAF=aParam.activerKiosqueRenduTAF;this.activerKiosqueEnvoiNote=aParam.activerKiosqueEnvoiNote&&!this.pourPrimaire();if(aParam.messagesDyn&&this.genreConnexion!==EGenreConnexion.Allegee){GApplication.donneesCentraleNotifications.addMessagesDynamiques(aParam.messagesDyn);}
this.listeRessourcesRecherche=aParam.listeRessourcesRecherche;this.modeSecurisationParDefaut=aParam.modeSecurisationParDefaut;this.deserialiserOnglets(aParam);this.deserialiserRessources(aParam);this.deserialiserInfosSupp(aParam);this.deserialiserPage(aParam);this.setReglesSaisieMotDePasse(aParam);}
deserialiserOnglets(aParam){this.listeOngletsInvisibles=aParam.listeOngletsInvisibles;this.listeGenreOngletsNotification=aParam.listeOngletsNotification;if(aParam.listeOnglets){this.listeOnglets=new ObjetListeElements();this.listeOngletsNotification=new ObjetListeElements();for(let i=0;i<aParam.listeOnglets.length;i++){_ajouterOnglet.call(this,aParam.listeOnglets[i],0,null);}}}
deserialiserRessources(aJSON){const lRessource=new ObjetElement().fromJSON(aJSON.ressource);lRessource.libelleLong=lRessource.GetLibelle();if(!!aJSON&&!!aJSON.ressource){lRessource.estDelegue=aJSON.ressource.estDelegue;lRessource.estMembreCA=aJSON.ressource.estMembreCA;lRessource.avecDiscussionResponsables=aJSON.ressource.avecDiscussionResponsables;lRessource.listeClassesDelegue=aJSON.ressource.listeClassesDelegue;lRessource.nbMaxJoursDeclarationAbsence=aJSON.ressource.nbMaxJoursDeclarationAbsence;}
let lMembreJSON,lMembre;const lListeRessources=new ObjetListeElements();if(!!aJSON&&!!aJSON.ressource&&!!aJSON.ressource.listeRessources){for(let i=0;i<aJSON.ressource.listeRessources.length;i++){lMembreJSON=aJSON.ressource.listeRessources[i];lMembre=new ObjetElement().fromJSON(lMembreJSON);this._traiterUtilisateur(lMembre,lMembreJSON,aJSON);lListeRessources.AddElement(lMembre);}} else if(!!aJSON&&!!aJSON.ressource&&!!aJSON.ressource.listeDisciplines){for(let i=0;i<aJSON.ressource.listeDisciplines.length;i++){const lDisciplineJSON=aJSON.ressource.listeDisciplines[i];const lDiscipline=new ObjetElement().fromJSON(lDisciplineJSON);lListeRessources.AddElement(lDiscipline);lDiscipline.ClassAffichage='Gras';lDiscipline.AvecSelection=false;lDiscipline.estGroupeDeRessource=true;lDiscipline.Numero=0;if(!!lDisciplineJSON.listeRessources){for(let j=0;j<lDisciplineJSON.listeRessources.length;j++){lMembreJSON=lDisciplineJSON.listeRessources[j];lMembre=new ObjetElement().fromJSON(lMembreJSON);this._traiterUtilisateur(lMembre,lMembreJSON,aJSON);lListeRessources.AddElement(lMembre);lMembre.pere=lDiscipline;lMembre.ClassAffichage='GrandEspaceGauche';}}}} else{this._traiterUtilisateur(lRessource,aJSON.ressource,aJSON);}
lListeRessources.setTri([
ObjetTri.init(function(D){return(D.Genre===EGenreRessource.Eleve)&&D.Classe&&D.Classe.existeNumero()?false:true;}),ObjetTri.init(function(D){return D.pere?D.pere.GetLibelle():D.Position>0?D.Position:D.GetLibelle();}),ObjetTri.init(function(D){return!D.estGroupeDeRessource;}),ObjetTri.init(function(D){return D.Position>0?D.Position:D.GetLibelle();})
]);lListeRessources.trier();this.SetIdentification(lRessource,lListeRessources);}
_traiterUtilisateur(aUtilisateur,aUtilisateurJSON,aJSONReponse){if(!!aUtilisateurJSON.listeSessions){aUtilisateur.listeSessionsRencontreDesiderataIndispo=aUtilisateurJSON.listeSessions.getListeElements(function(D){return D.visibleDesiderataIndispo;});aUtilisateur.listeSessionsRencontrePlanning=aUtilisateurJSON.listeSessions.getListeElements((function(D){return D.visiblePlanning;}).bind(this));}
if(aUtilisateurJSON.destinatairesCarnetLiaison){aUtilisateur.destinatairesCarnetLiaison=aUtilisateurJSON.destinatairesCarnetLiaison;aUtilisateur.destinatairesCarnetLiaison.setTri([ObjetTri.init('Genre'),ObjetTri.init('Libelle')]).trier();}
if(!!aUtilisateurJSON.listeProfesseurs&&!!aJSONReponse.listeClasses){aUtilisateur.listeProfesseurs=aUtilisateurJSON.listeProfesseurs;aUtilisateur.listeProfesseurs.parcourir(_traiterListeProfesseurs.bind(this,aJSONReponse.listeClasses));aUtilisateur.listeProfesseurs.trier();}
if(aUtilisateurJSON.Etablissement!==undefined){aUtilisateur.Etablissement=aUtilisateurJSON.Etablissement;}
if(aUtilisateurJSON.notificationsPush!==undefined){aUtilisateur.notificationsPush=aUtilisateurJSON.notificationsPush;}
if(aUtilisateurJSON.autoriserImage!==undefined){aUtilisateur.autoriserImage=aUtilisateurJSON.autoriserImage;}
aUtilisateur.avecPhoto=!!aUtilisateurJSON.avecPhoto;if(this.estEspacePourEleve()){aUtilisateur.Classe=new ObjetElement().fromJSON(aUtilisateurJSON.classeDEleve);aUtilisateur.libelleLong=aUtilisateur.GetLibelle();if(!!aUtilisateur.Classe&&aUtilisateur.Classe.GetLibelle()){aUtilisateur.libelleLong+=' ('+aUtilisateur.Classe.GetLibelle()+')';}
if(aUtilisateurJSON.listeClassesHistoriques!==undefined){aUtilisateur.listeClasseHistorique=aUtilisateurJSON.listeClassesHistoriques;}
if(aUtilisateurJSON.listeGroupes!==undefined){aUtilisateur.ListeGroupes=aUtilisateurJSON.listeGroupes;}
if(aUtilisateurJSON.autoriserImage!==undefined){aUtilisateur.autoriserImage=aUtilisateurJSON.autoriserImage;}
aUtilisateur.tableauOnglets=[];if(!!aUtilisateurJSON.listeOngletsPourPeriodes){aUtilisateurJSON.listeOngletsPourPeriodes.parcourir(function(aOnglet){aUtilisateur.tableauOnglets[aOnglet.GetGenre()]=aOnglet;});}
if(!!aUtilisateurJSON.listeOngletsPourPiliers){aUtilisateurJSON.listeOngletsPourPiliers.parcourir(function(aOnglet){aUtilisateur.tableauOnglets[aOnglet.GetGenre()]=aOnglet;});}}
if(!!aUtilisateurJSON.acces){aUtilisateur.acces=aUtilisateurJSON.acces;}}
deserialiserInfosSupp(aParam){this.infosSupp={};this.urlInstallClient=aParam.UrlInstallClient;this.urlParamClient=aParam.UrlParamClient;this.designationClient=aParam.designationClient;this.listeMotifsAbsences=aParam.listeMotifsAbsences;this.listeMotifsRetards=aParam.listeMotifsRetards;this.autorisationKiosque=!!aParam.autorisationKiosque;this.autorisationCloud=!!aParam.autorisationCloud;this.derniereConnexion=aParam.derniereConnexion;this.cloudIndexActif=!!aParam.cloudIndexActif;this.avecCloudIndex=!!aParam.avecCloudIndex;this.listeCloud=aParam.listeCloud||new ObjetListeElements();this.listeCloudDepotServeur=aParam.listeCloudDepotServeur||new ObjetListeElements();this.listeClasses=aParam.listeClasses;this.listeMatieres=aParam.listeMatieres;this.listeNiveaux=aParam.listeNiveaux;this.existeCDTsDetaches=aParam.existeCDTsDetaches;this.tabEtablissementsModeleGrille=aParam.tabEtablissementsModeleGrille;this.listeInformationsEtablissements=aParam.listeInformationsEtablissements;this.joursOuvresServices=aParam.joursOuvresServices;}
deserialiserPage(aParam){const lPage=aParam.page;if(lPage&&this.existeGenreOnglet){lPage.membre=lPage.Membre?new ObjetElement('',lPage.Membre):null;lPage.periode=new ObjetElement('',lPage.Periode);lPage.competence=new ObjetElement('',lPage.Competence);lPage.service=new ObjetElement('',lPage.Service);if(this.existeGenreOnglet&&this.existeGenreOnglet(lPage.Onglet)){this.setPage(lPage);}}}
SetIdentification(aRessource,aListeRessources){this.Identification=new ObjetIdentification(aRessource,aListeRessources);this.Identification.indiceEleve=0;if(this.page&&this.page.membre){this.SetNumeroEleve(this.page.membre.GetNumero());}}
getUtilisateur(){return this.Identification.ressource;}
getMembre(){return this.Identification.getMembre();}
avecPlusieursMembres(){return(this.Identification&&
this.Identification.ListeRessources&&
this.Identification.ListeRessources.GetNbrElements()>1);}
SetNumeroEleve(aNumeroEleve){let lIndice=false;for(let I=0;I<this.Identification.ListeRessources.GetNbrElements();I++){const lEleve=this.Identification.ListeRessources.GetElement(I);if(lEleve.GetNumero()===aNumeroEleve){lIndice=I;}}
if(lIndice===false){return;}
this.Identification.indiceEleve=lIndice;this.Identification.NumeroEleve=aNumeroEleve;this.Navigation.SetRessource(EGenreRessource.Eleve,GEtatUtilisateur.getMembre().GetLibelle(),aNumeroEleve);this.Navigation.SetRessource(EGenreRessource.Classe,GEtatUtilisateur.Identification.GetLibelleClasse(),GEtatUtilisateur.Identification.GetNumeroClasse(),EGenreRessource.Classe);}
getClasse(){return this.listeClasses.GetElementParNumeroEtGenre(this.Navigation.GetNumeroRessource(EGenreRessource.Classe),this.Navigation.GetGenreRessource(EGenreRessource.Classe));}
setClasse(aClasse){this.Navigation.SetRessource(EGenreRessource.Classe,aClasse);}
getPage(){return this.page;}
resetPage(){this.page=null;}
setPage(aPage){this.page=aPage;if(this.page&&this.page.Onglet>0){this.setGenreOnglet(this.page.Onglet);}
if(this.page&&this.page.ressource!==null&&this.page.ressource!==undefined){this.setGenreRessource(this.page.ressource);}}
getGenreOnglet(){return this.genreOnglet;}
setGenreOnglet(aGenreOnglet){this.genreOnglet=aGenreOnglet;}
getOngletSelectionne(){let lOngletSelectionne=null;if(this.listeOnglets){let lGenreOngletActif=this.genreOnglet;if(lGenreOngletActif){this.listeOnglets.parcourir((aOnglet) =>{if(aOnglet.GetGenre()===lGenreOngletActif){lOngletSelectionne=aOnglet;return false;}});}}
return lOngletSelectionne;}
estOngletAutorise(aGenreOnglet){let lOK=false;this.listeOnglets.parcourir(function(aOnglet){if(aOnglet.GetGenre()===aGenreOnglet&&aOnglet.Actif){lOK=true;return false;}});return lOK;}
estModeAccessible(){return this.ModeAccessibleActif;}
setModeAccessible(aActif){this.ModeAccessibleActif=aActif;if(IE.optionsEspaceLocal){IE.optionsEspaceLocal.setModeAccessible(aActif);}}
estAvecCodeCompetences(){return this.accessibilite.avecCodeCompetences;}
setAvecCodeCompetences(aActif){this.accessibilite.avecCodeCompetences=aActif;if(IE.optionsEspaceLocal){IE.optionsEspaceLocal.setAvecCodeCompetences(aActif);}}
estAvecThemeAccessible(){return this.accessibilite.avecThemeAccessible;}
setAvecThemeAccessible(aActif){this.accessibilite.avecThemeAccessible=aActif;if(IE.optionsEspaceLocal){IE.optionsEspaceLocal.setAvecThemeAccessible(aActif);}}
existeGenreOnglet(aGenreOnglet){const lGenreOnglet=this.listeOnglets.GetElementParGenre(aGenreOnglet);return lGenreOnglet&&lGenreOnglet.Actif;}
getEtablissement(){if(MethodesTableau.existe(this.GenreEspace,[
EGenreEspace.Parent,EGenreEspace.Mobile_Parent,EGenreEspace.PrimParent,EGenreEspace.Mobile_PrimParent,EGenreEspace.Accompagnant,EGenreEspace.Mobile_Accompagnant,EGenreEspace.PrimAccompagnant,EGenreEspace.Mobile_PrimAccompagnant,EGenreEspace.Tuteur,EGenreEspace.Mobile_Tuteur,EGenreEspace.Entreprise,EGenreEspace.Academie
])){return!!GEtatUtilisateur.getMembre().Etablissement?this.listeInformationsEtablissements.GetElementParNumero(GEtatUtilisateur.getMembre().Etablissement.GetNumero()):null;} else{return!!GEtatUtilisateur.getUtilisateur().Etablissement?this.listeInformationsEtablissements.GetElementParNumero(GEtatUtilisateur.getUtilisateur().Etablissement.GetNumero()):null;}}
ongletEstVisible(){return false;}
desactiverPageAccueil(){this.sansPageAccueil=true;}
avecPageAccueil(){if(this.sansPageAccueil){return false;}
const lOnglet=this.listeOnglets.GetElementParGenre(EGenreOnglet.Accueil);return MethodesTableau.existe(this.GenreEspace,[
EGenreEspace.Parent,EGenreEspace.Mobile_Parent,EGenreEspace.Eleve,EGenreEspace.Mobile_Eleve,EGenreEspace.Professeur,EGenreEspace.Mobile_Professeur,EGenreEspace.Etablissement,EGenreEspace.Mobile_Etablissement,EGenreEspace.Administrateur,EGenreEspace.Mobile_Administrateur,EGenreEspace.PrimProfesseur,EGenreEspace.Mobile_PrimProfesseur,EGenreEspace.PrimParent,EGenreEspace.Mobile_PrimParent,EGenreEspace.PrimEleve,EGenreEspace.Mobile_PrimEleve,EGenreEspace.Accompagnant,EGenreEspace.Mobile_Accompagnant,EGenreEspace.PrimAccompagnant,EGenreEspace.Mobile_PrimAccompagnant,EGenreEspace.Tuteur,EGenreEspace.Mobile_Tuteur,EGenreEspace.PrimPeriscolaire,EGenreEspace.Mobile_PrimPeriscolaire
])&&lOnglet&&lOnglet.Actif;}
estOngletActif(aGenreOnglet){const lOnglet=this.listeOnglets.GetElementParGenre(aGenreOnglet);return lOnglet?lOnglet.Actif:false;}
espacesAvecBoutonsTimeLine(){return MethodesTableau.existe(this.GenreEspace,[EGenreEspace.Professeur,EGenreEspace.PrimProfesseur,EGenreEspace.PrimParent,EGenreEspace.PrimAccompagnant,EGenreEspace.PrimEleve,EGenreEspace.Administrateur]);}
estEspacePourEleve(){return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[
EGenreEspace.Parent,EGenreEspace.Mobile_Parent,EGenreEspace.Eleve,EGenreEspace.Mobile_Eleve,EGenreEspace.Entreprise,EGenreEspace.PrimParent,EGenreEspace.Mobile_PrimParent,EGenreEspace.PrimEleve,EGenreEspace.Mobile_PrimEleve,EGenreEspace.Accompagnant,EGenreEspace.Mobile_Accompagnant,EGenreEspace.PrimAccompagnant,EGenreEspace.Mobile_PrimAccompagnant,EGenreEspace.Tuteur,EGenreEspace.Mobile_Tuteur
]);}
estEspaceEleve(){return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[
EGenreEspace.Eleve,EGenreEspace.Mobile_Eleve,EGenreEspace.PrimEleve,EGenreEspace.Mobile_PrimEleve
]);}
estEspacePourProf(){return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[
EGenreEspace.Professeur,EGenreEspace.Mobile_Professeur,EGenreEspace.Academie
]);}
estEspaceMobile(){return MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[
EGenreEspace.Mobile_Administrateur,EGenreEspace.Mobile_Commun,EGenreEspace.Mobile_Professeur,EGenreEspace.Mobile_Eleve,EGenreEspace.Mobile_Etablissement,EGenreEspace.Mobile_Parent,EGenreEspace.Mobile_PrimParent,EGenreEspace.Mobile_PrimEleve,EGenreEspace.Mobile_PrimProfesseur,EGenreEspace.Mobile_Accompagnant,EGenreEspace.Mobile_PrimAccompagnant,EGenreEspace.Mobile_PrimPeriscolaire
]);}
estEspaceAvecMembre(){return GParametres.avecMembre;}
pourPrimaire(){return MethodesTableau.existe(this.GenreEspace,[
EGenreEspace.PrimProfesseur,EGenreEspace.Mobile_PrimProfesseur,EGenreEspace.PrimParent,EGenreEspace.Mobile_PrimParent,EGenreEspace.PrimEleve,EGenreEspace.Mobile_PrimEleve,EGenreEspace.PrimAccompagnant,EGenreEspace.Mobile_PrimAccompagnant,EGenreEspace.PrimPeriscolaire,EGenreEspace.Mobile_PrimPeriscolaire
]);}
pourThemePrimaire(){return MethodesTableau.existe(this.GenreEspace,[
EGenreEspace.PrimParent,EGenreEspace.PrimEleve,EGenreEspace.Mobile_PrimParent,EGenreEspace.Mobile_PrimEleve,EGenreEspace.PrimAccompagnant,EGenreEspace.Mobile_PrimAccompagnant
]);}
getListeClasses(aParams){if(GApplication.droits.get(TypeDroits.eleves.voirTousLesEleves)&&!GApplication.parametresUtilisateur.get('masquerDonneesAutresProfesseurs')){aParams.uniquementClasseEnseignee=false;}
const lListeClasses=new ObjetListeElements();let lRecupererClasse=false;if(aParams.avecToutes){lListeClasses.AddElement(new ObjetElement(GTraductions.getValeur('toutes'),0));}
for(let I=0;I<this.listeClasses.GetNbrElements();I++){const lClasse=this.listeClasses.GetElement(I);if((aParams.avecClasse&&(lClasse.GetGenre()===EGenreRessource.Classe))||(aParams.avecGroupe&&(lClasse.GetGenre()===EGenreRessource.Groupe))){lRecupererClasse=true;if(aParams.uniquementClassePrincipal){lRecupererClasse=lClasse.estPrincipal;} else if(aParams.uniquementClasseEnseignee){lRecupererClasse=lClasse.estResponsable||lClasse.enseigne;}
if(aParams.sansClasseDeRegroupement&&lClasse.dansRegroupement){lRecupererClasse=false;}
if(lRecupererClasse){lListeClasses.AddElement(lClasse);if(aParams.avecGroupeEtClasseDeRegroupement&&lClasse.listeComposantes){for(let j=0;j<lClasse.listeComposantes.GetNbrElements();j++){let lComposante=lClasse.listeComposantes.GetElement(j);lListeClasses.AddElement(lComposante);}}}}}
return lListeClasses;}
getCategorie(){return this.Navigation.categorie;}
setCategorie(aCategorie){this.Navigation.categorie=aCategorie;}
getBilletBlog(){return this.Navigation.billet;}
setBilletBlog(aBillet){this.Navigation.billet=aBillet;}
getInfoSond(){return this.Navigation.infoSond;}
setInfoSond(aInfoSond){this.Navigation.infoSond=aInfoSond;}
getContexteTAF(){return this.Navigation.contexteTAF;}
setContexteTAF(aContexteTAF){this.Navigation.contexteTAF=aContexteTAF;}
getContexteCDT(){return this.Navigation.contexteCDT;}
setContexteCDT(aContexteCDT){this.Navigation.contexteCDT=aContexteCDT;}
getGenreAffichageCompteSelectionne(){return this.Navigation.GenreAffichageCompteSelectionne;}
setGenreAffichageCompteSelectionne(aGenreAffichageCompte){this.Navigation.GenreAffichageCompteSelectionne=aGenreAffichageCompte;}}
function _ajouterOnglet(aJSON,aProfondeur,aOngletPere){const lOnglet=new ObjetElement().fromJSON(aJSON);if(this.listeOngletsInvisibles&&MethodesTableau.existe(lOnglet.GetGenre(),this.listeOngletsInvisibles)){lOnglet.Actif=false;}
lOnglet.Libelle=GChaine.ToHTML(GTraductions.getValeur('Onglet.Libelle')[lOnglet.GetGenre()]);lOnglet.libelleLong=GTraductions.getValeur('Onglet.LibelleLong')[lOnglet.GetGenre()]!==' '?GTraductions.getValeur('Onglet.LibelleLong')[lOnglet.GetGenre()]:lOnglet.Libelle;if(lOnglet.Actif!==false&&this.listeGenreOngletsNotification&&MethodesTableau.existe(lOnglet.GetGenre(),this.listeGenreOngletsNotification)){const lElementNotification=MethodesObjet.dupliquer(lOnglet);lElementNotification.profondeur=0;lElementNotification.avecClic=true;this.listeOngletsNotification.AddElement(lElementNotification);}
lOnglet.profondeur=aProfondeur;if(aOngletPere){lOnglet.onglet=aOngletPere;}
this.listeOnglets.AddElement(lOnglet);let lAvecFilsActifs=false;if(aJSON.Onglet){for(let i=0;i<aJSON.Onglet.length;i++){lAvecFilsActifs=_ajouterOnglet.call(this,aJSON.Onglet[i],aProfondeur+1,lOnglet)||lAvecFilsActifs;}
if(!lAvecFilsActifs){lOnglet.Actif=false;}}
return lOnglet.Actif;}
function _traiterListeProfesseurs(aListeClasses ,aProfesseur){const lArrayClasse=aProfesseur.listeClasses;aProfesseur.listeClasses=new ObjetListeElements();if(aProfesseur.GetGenre()===0){aProfesseur.Position=0;}
if(lArrayClasse){for(let i=0;i<lArrayClasse.length;i++){let lClasse=aListeClasses.GetElement(lArrayClasse[i]);if(lClasse){let lClasseCopie=new ObjetElement(lClasse.GetLibelle(),lClasse.GetNumero(),lClasse.GetGenre());lClasseCopie.estResponsable=lClasse.estResponsable;aProfesseur.listeClasses.AddElement(lClasseCopie);}}}}
module.exports=ObjetEtatUtilisateur;},fn:"objetetatutilisateur.js"});;
IE.fModule({f:function(exports,require,module,global){const{GDate}=require('ObjetDate.js');const ObjetEtatUtilisateur=require('ObjetEtatUtilisateur.js');const ObjetListeElements=require('ObjetListeElements.js');const EGenreRessource=require('Enumere_Ressource.js');const ObjetTri=require('ObjetTri.js');const{TypeDroits}=require('ObjetDroitsPN.js');const MethodesTableau=require('MethodesTableau.js');const EGenreEspace=require('Enumere_Espace.js');class ObjetEtatUtilisateur_Mobile extends ObjetEtatUtilisateur{constructor(AGenreEspace){super(AGenreEspace);this.historiqueNavigation=[];this.derniereDate=null;}
Initialiser(){this.historiqueNavigation=[];}
getOngletInfosPeriodes(){return this.Identification.getMembre().tableauOnglets[this.genreOnglet];}
getListeClasses(aParams){if(GApplication.droits.get(TypeDroits.eleves.voirTousLesEleves)&&!GApplication.parametresUtilisateur.get('masquerDonneesAutresProfesseurs')){aParams.uniquementClasseEnseignee=false;}
var lAvecClasse=aParams.avecClasse;var lAvecGroupe=aParams.avecGroupe;var lSeuleMesClasses=aParams.uniquementClasseEnseignee;const lSeuleClassePrincipal=aParams.uniquementClassePrincipal;var result=new ObjetListeElements();var lListeClasses;if(!!this.listeClasses){lListeClasses=this.listeClasses;} else if(!!this.Identification&&!!this.Identification.getMembre()){lListeClasses=this.Identification.getMembre().listeClasses;}
if(!!lListeClasses){var _EGenreClasse={principal:0,enseigne:1,autre:2};lListeClasses.parcourir(function(aClasse){if(aClasse.estPrincipal){aClasse.genreClasse=_EGenreClasse.principal;} else if(aClasse.enseigne){aClasse.genreClasse=_EGenreClasse.enseigne;} else{aClasse.genreClasse=_EGenreClasse.autre;}
var lAccepteClasse=(lAvecClasse&&(aClasse.GetGenre()===EGenreRessource.Classe))||(lAvecGroupe&&(aClasse.GetGenre()===EGenreRessource.Groupe));if(lAccepteClasse){lAccepteClasse=(!lSeuleMesClasses||!!aClasse.estResponsable||!!aClasse.enseigne);}
if(aParams.sansClasseDeRegroupement&&aClasse.dansRegroupement){lAccepteClasse=false;}
if(lSeuleClassePrincipal&&!aClasse.estPrincipal){lAccepteClasse=false;}
if(lAccepteClasse){result.AddElement(aClasse);}});}
result.setTri([
ObjetTri.init(function(D){return D.genreClasse;}),ObjetTri.init(function(D){return D.GetNumero()!== -1;}),ObjetTri.init('Libelle')
]);result.trier();return result;}
getDerniereDate(){if(this.derniereDate===null||this.derniereDate===undefined){return GDate.getDateCourante();} else{return this.derniereDate;}}
setDerniereDate(aDate){this.derniereDate=aDate;}
setGenreAffichage(aGenreAff){this.genreAffichage=aGenreAff;}
getGenreAffichage(){return this.genreAffichage;}
setPeriodePourReleve(aPeriode){this.periodePourReleve=aPeriode;}
getPeriodePourReleve(){return this.periodePourReleve;}
setPeriodePourBulletin(aPeriode){this.periodePourBulletin=aPeriode;}
getPeriodePourBulletin(){return this.periodePourBulletin;}
setNavigationDate(aDate){this.historiqueNavigation['Date']=aDate;}
getNavigationDate(){return!!this.historiqueNavigation['Date']?this.historiqueNavigation['Date']:false;}
setNavigationCours(aCours){this.historiqueNavigation['Cours']=aCours;}
getNavigationCours(){return!!this.historiqueNavigation['Cours']?this.historiqueNavigation['Cours']:false;}
getNavigationTableauDeBord(){return this.historiqueNavigation['TableauDeBord'];}
setNavigationTableauDeBord(aObjet){this.historiqueNavigation['TableauDeBord']=aObjet;}
avecFicheEtablissement(){var lEtablissement,lAvecInfo=false;if(this.listeInformationsEtablissements){if(MethodesTableau.existe(GEtatUtilisateur.GenreEspace,[EGenreEspace.Mobile_Parent,EGenreEspace.Mobile_Accompagnant,EGenreEspace.Mobile_PrimParent,EGenreEspace.Mobile_PrimAccompagnant])){if(!!this.getMembre().Etablissement){lEtablissement=this.listeInformationsEtablissements.GetElementParNumero(this.getMembre().Etablissement.GetNumero());if(!!lEtablissement&&lEtablissement.avecInformations){lAvecInfo=true;}}} else{for(var i=0,lNbr=this.listeInformationsEtablissements.GetNbrElements();i<lNbr;i++){lEtablissement=this.listeInformationsEtablissements.GetElement(i);if(lEtablissement.avecInformations){lAvecInfo=true;}}}}
return lAvecInfo;}
ongletEstVisible(aGenreOnglet){return this.existeGenreOnglet(aGenreOnglet);}}
module.exports=ObjetEtatUtilisateur_Mobile;},fn:"objetetatutilisateur_mobile.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreErreurAcces={Aucune:0,Identification:1,Autorisation:2,ConnexionClasse:3,AucuneRessource:4,Connexion:5,BloqueeEleve:6,FonctionAccompagnant:7,AccompagnantAucunEleve:8,Message:9};module.exports=EGenreErreurAcces;},fn:"enumere_erreuracces.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeCommandeSecurisationCompteHttp={csch_VerifierPIN:0,csch_VerifierMotDePassePersonnalise:1,csch_LibellesSourceConnexionDejaConnus:2,csch_EnregistrerChoixUtilisateur:3,csch_AffecterModeDoubleAuthentification:4,csch_AffecterCodePIN:5,csch_RenommerSourceConnexionConnue:6,csch_SupprimerSourceConnexionConnue:7,csch_AffecterMotDePassePersonnalise:8,csch_ModifierLogin:9,csch_DemandeReinitialisationPIN:10,csch_VerifierCodeReinitialisationPIN:11};module.exports.TypeCommandeSecurisationCompteHttp=TypeCommandeSecurisationCompteHttp;const TypeActionIHMSecurisationCompte={AIHMSC_PersonnalisationMotDePasse:0,AIHMSC_ChoixStrategie:1,AIHMSC_ChoixCodePINetSource:2,AIHMSC_SaisieCodePINetSource:3,AIHMSC_ReinitCodePINetSource:4,AIHMSC_SaisieSourcePourNotifSeulement:5};module.exports.TypeActionIHMSecurisationCompte=TypeActionIHMSecurisationCompte;const TypeModeGestionDoubleAuthentification={MGDA_PasEncoreChoisi:0,MGDA_Inactive:1,MGDA_NotificationSeulement:2,MGDA_SaisieCodePIN:3};module.exports.TypeModeGestionDoubleAuthentification=TypeModeGestionDoubleAuthentification;const TypeGenreSourceConnexion={GSC_ClientLourd:0,GSC_ApplicationMobile:1,GSC_Navigateur:2};module.exports.TypeGenreSourceConnexion=TypeGenreSourceConnexion;module.exports.C_MaxPinRetry=3;module.exports.C_MinPinLength=4;module.exports.C_LibelleAppareilMaxLength=30;TypeModeGestionDoubleAuthentification.getOrdreModeDoubleAuth=function(aModeParDefaut){let lTabOrdre=[
TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN,TypeModeGestionDoubleAuthentification.MGDA_NotificationSeulement,TypeModeGestionDoubleAuthentification.MGDA_Inactive
];if(aModeParDefaut===TypeModeGestionDoubleAuthentification.MGDA_Inactive){lTabOrdre=lTabOrdre.reverse();}
return lTabOrdre;};const TypeGenreSourceConnexionUtil={getIcone(aGenreSourceConnexion){let lNomIcone='';switch(aGenreSourceConnexion){case TypeGenreSourceConnexion.GSC_ClientLourd:lNomIcone='icon_laptop';break;case TypeGenreSourceConnexion.GSC_ApplicationMobile:lNomIcone='icon_mobile_phone';break;case TypeGenreSourceConnexion.GSC_Navigateur:lNomIcone='icon_globe';break;default:;}
return lNomIcone;}};module.exports.TypeGenreSourceConnexionUtil=TypeGenreSourceConnexionUtil;},fn:"typesecurisationcompte.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const Requetes=require('CollectionRequetes.js');const TypeCommandeSecurisationCompteHttp=require('TypeSecurisationCompte.js').TypeCommandeSecurisationCompteHttp;class ObjetRequeteSecurisationCompteDoubleAuth extends ObjetRequeteConsultation{constructor(...aParams){super(...aParams);}
lancerRequete(aParams){this.JSON.action=aParams.action;const lComm=GApplication.getCommunication();switch(this.JSON.action){case TypeCommandeSecurisationCompteHttp.csch_VerifierMotDePassePersonnalise:this.JSON.nouveauMDP=lComm.getChaineChiffreeAES(aParams.nouveauMDP);break;case TypeCommandeSecurisationCompteHttp.csch_VerifierPIN:case TypeCommandeSecurisationCompteHttp.csch_VerifierCodeReinitialisationPIN:this.JSON.codePin=lComm.getChaineChiffreeAES(aParams.codePin);break;case TypeCommandeSecurisationCompteHttp.csch_LibellesSourceConnexionDejaConnus:this.JSON.libelle=aParams.libelle;break;case TypeCommandeSecurisationCompteHttp.csch_EnregistrerChoixUtilisateur:this.JSON.mode=aParams.mode;if(aParams.nouveauMDP){this.JSON.nouveauMDP=lComm.getChaineChiffreeAES(aParams.nouveauMDP);}
if(aParams.codePin){this.JSON.codePin=lComm.getChaineChiffreeAES(aParams.codePin);}
if(aParams.reinitPIN_OK){this.JSON.reinitPIN_OK=true;this.JSON.codePINVerifReinit=lComm.getChaineChiffreeAES(aParams.codePINVerifReinit);}
this.JSON.avecIdentification=aParams.avecIdentification;this.JSON.strIdentification=aParams.strIdentification;break;case TypeCommandeSecurisationCompteHttp.csch_DemandeReinitialisationPIN:break;default:;}
return this.appelAsynchrone();}
actionApresRequete(){if(GApplication.estAppliMobile&&this.JSONReponse.jetonConnexionAppliMobile){window.messageData.push({action:'surAuth',data:this.JSONReponse.jetonConnexionAppliMobile});}
this.callbackReussite.appel(this.JSONReponse);}}
Requetes.inscrire('SecurisationCompteDoubleAuth',ObjetRequeteSecurisationCompteDoubleAuth);class ObjetRequeteSecurisationComptePreference extends ObjetRequeteConsultation{constructor(...aParams){super(...aParams);}
lancerRequete(aParams){this.JSON.action=aParams.action;const lComm=GApplication.getCommunication();switch(this.JSON.action){case TypeCommandeSecurisationCompteHttp.csch_AffecterMotDePassePersonnalise:this.JSON.ancienMDP=lComm.getChaineChiffreeAES(aParams.ancienMDP);this.JSON.nouveauMDP=lComm.getChaineChiffreeAES(aParams.nouveauMDP);break;case TypeCommandeSecurisationCompteHttp.csch_ModifierLogin:this.JSON.ancienMDP=lComm.getChaineChiffreeAES(aParams.ancienMDP);this.JSON.identifiant=lComm.getChaineChiffreeAES(aParams.nouveauMDP);break;case TypeCommandeSecurisationCompteHttp.csch_VerifierPIN:this.JSON.codePin=lComm.getChaineChiffreeAES(aParams.codePin);break;case TypeCommandeSecurisationCompteHttp.csch_AffecterModeDoubleAuthentification:this.JSON.mode=aParams.mode;if(aParams.ancienCodePin){this.JSON.ancienCodePin=lComm.getChaineChiffreeAES(aParams.ancienCodePin);}
break;case TypeCommandeSecurisationCompteHttp.csch_AffecterCodePIN:this.JSON.codePin=lComm.getChaineChiffreeAES(aParams.codePin);if(aParams.ancienCodePin){this.JSON.ancienCodePin=lComm.getChaineChiffreeAES(aParams.ancienCodePin);}
break;case TypeCommandeSecurisationCompteHttp.csch_SupprimerSourceConnexionConnue:this.JSON.identifiantSysteme=aParams.identifiantSysteme;this.JSON.genreSource=aParams.genreSource;break;case TypeCommandeSecurisationCompteHttp.csch_RenommerSourceConnexionConnue:this.JSON.identifiantSysteme=aParams.identifiantSysteme;this.JSON.genreSource=aParams.genreSource;this.JSON.libelleSaisi=aParams.libelleSaisi;break;default:;}
return this.appelAsynchrone();}
actionApresRequete(){if(GApplication.estAppliMobile&&this.JSONReponse.jetonConnexionAppliMobile){window.messageData.push({action:'surAuth',data:this.JSONReponse.jetonConnexionAppliMobile});}
this.callbackReussite.appel(this.JSONReponse);}}
Requetes.inscrire('SecurisationComptePreference',ObjetRequeteSecurisationComptePreference);module.exports={ObjetRequeteSecurisationCompteDoubleAuth,ObjetRequeteSecurisationComptePreference};},fn:"objetrequetesecurisationcompte.js"});;
IE.fModule({f:function(exports,require,module,global){const IELocalStorage=require('LocalStorage.js');const ObjetElement=require('ObjetElement.js');const MethodesObjet=require('MethodesObjet.js');const Requetes=require('CollectionRequetes.js');const EGenreCryptage=require('Enumere_Cryptage.js');const GCryptage=require('ObjetCryptage.js');const GTraductions=require('ObjetTraduction.js');const EGenreErreurAcces=require('Enumere_ErreurAcces.js');const SecurisationCompte=require('TypeSecurisationCompte.js');const TypeActionIHMSecurisationCompte=SecurisationCompte.TypeActionIHMSecurisationCompte;const TypeCommandeSecurisationCompteHttp=SecurisationCompte.TypeCommandeSecurisationCompteHttp;const UtilitaireDeconnexion=require('UtilitaireDeconnexion.js');const ObjetRequeteSecurisationCompteDoubleAuth=require('ObjetRequeteSecurisationCompte.js').ObjetRequeteSecurisationCompteDoubleAuth;class ObjetMoteurConnexion{constructor(){this.const={};this.const.Cookie_Identification=GApplication.nomProduit+'_Identification';this.const.Cookie_Authentification=GApplication.nomProduit+'_Authentification';this.const.Cookie_Espace=GApplication.nomProduit+'_Espace';this.const.Cookie_estCAS=GApplication.nomProduit+'_EstCas';this.genreEtat={aucun:0,malInitialise:1,autoInitialise:8,enIdentification:2,identifie:3,nonIdentifie:4,enAuthentification:5,authentifie:6,nonAuthentifie:7,erreur:9};this.reset(true);}
reset(aFull){this.stockageMDPActif=IELocalStorage.actif&&!GApplication.getDemo();this.avecStockageMDP=false;this.estAppliMobile=GApplication.estAppliMobile;this.modeValidationAppliMobile=MethodesObjet.isFunction(GParametres.getCookieValidationAppli)&&document.cookie.indexOf(GParametres.getCookieValidationAppli()+'=')> -1;this.modeValidationAppliMobileJeton=false;this.nomRessource='';this.ressourceInternet=new ObjetElement();this.genreConnexion=0;this.login=new ObjetElement();this.motDePasse=new ObjetElement();this.alea='';this.pourENT=false;this.demandeConnexionAuto=false;this.enConnexionAuto=false;this.demandeConnexionAppliMobile=false;this.demandeConnexionAppliMobileJeton=false;this.enConnexionAppliMobile=false;this.uuidAppliMobile='';this.loginTokenSAV='';this.tokenSAV='';this.erreurCode=EGenreErreurAcces.Aucune;this.erreur={erreurTitre:null,erreurMessage:null,erreurBandeau:null};if(aFull){this.stockageMDPActive=false;this.genreEspace=null;this.callback=null;this.requetes={};this.requetes.parametres=null;this.requetes.listeRessources=null;this.requetes.identification=null;this.requetes.authentification=null;}
this.etat=this.genreEtat.aucun;}
init(aParam){this.callback=aParam.callback;this.requetes.listeRessources=aParam.requetes.listeRessources||null;this.requetes.identification=aParam.requetes.identification||null;this.requetes.authentification=aParam.requetes.authentification||null;this.stockageMDPActive=aParam.stockageMDPActive||false;this.etat=this.genreEtat.aucun;this.genreEspace=GEtatUtilisateur.GenreEspace;if(this.stockageMDPActif&&this.stockageMDPActive){this.login=new ObjetElement(IELocalStorage.getItem(this.const.Cookie_Identification));this.motDePasse=new ObjetElement(IELocalStorage.getItem(this.const.Cookie_Authentification));this.avecStockageMDP=!!this.getLogin()&&!!this.getMotDePasse()&&(parseInt(IELocalStorage.getItem(this.const.Cookie_Espace))===this.genreEspace);if(!this.avecStockageMDP){this.setStockageMdp(false);} else{this.etat=this.genreEtat.autoInitialise;this.callback();}}
if(window&&window.opener){window.addEventListener('message',this.messageTokenSAV.bind(this),false);window.opener.postMessage(JSON.stringify({loaded:true}),'*');}}
setLogin(aLogin){this.login.Libelle=aLogin;}
getLogin(aPourVisu){const lLoginBrut=this.login.GetLibelle();let lLogin=lLoginBrut;if(lLogin&&!this.pourENT&&(this.login.GetGenre()>0)){lLogin=lLogin.toLowerCase();}
return aPourVisu?lLoginBrut:lLogin;}
setMotDePasse(aMdp){this.motDePasse.Libelle=aMdp;}
getMotDePasse(aPourVisu){let lMotDePasse=this.motDePasse.GetLibelle();if(lMotDePasse&&!this.pourENT&&(this.motDePasse.GetGenre()>0)){lMotDePasse=lMotDePasse.toLowerCase();}
return aPourVisu&&this.avecStockageMDP&&!!lMotDePasse?'********':aPourVisu&&!!lMotDePasse?lMotDePasse:!!lMotDePasse?forge.md.sha256.create().update(this.alea).update(forge.util.encodeUtf8(lMotDePasse)).digest().toHex().toUpperCase():'';}
setGenreConnexion(aGenre){if(GEtatUtilisateur.setGenreConnexion){GEtatUtilisateur.setGenreConnexion(aGenre);}
this.genreConnexion=aGenre;}
getGenreConnexion(){return this.genreConnexion;}
aMotDePasseStocke(){return!!IELocalStorage.getItem(this.const.Cookie_Authentification);}
getCle(){return(this.tokenSAV?this.tokenSAV:(this.pourENT?'':this.getLogin())+this.getMotDePasse());}
setStockageMdp(aActif){if(this.stockageMDPActif&&this.stockageMDPActive&&this.avecStockageMDP===true&&aActif===false){this.avecStockageMDP=false;this.reset();this.viderStockageMDP();} else if(this.stockageMDPActif&&this.stockageMDPActive){this.avecStockageMDP=aActif;}}
setTokenSAV(aToken){let lMsg=forge.random.generate(Math.max(2,Math.floor(Math.random()*100)%10));let lTotal=0;for(let i=0;i<lMsg.length;i++){lTotal+=lMsg.charCodeAt(i);}
if(lTotal%255!==0){lMsg+=String.fromCharCode(255-(lTotal%255));}
this.tokenSAV=aToken;this.stockageMDPActive=false;this.demandeConnexionAuto=false;this.enConnexionAuto=false;this.demandeConnexionAppliMobile=false;this.demandeConnexionAppliMobileJeton=false;this.enConnexionAppliMobile=false;this.modeValidationAppliMobile=false;this.loginTokenSAV=GCryptage.encrypter({genreCryptage:EGenreCryptage.AES,chaine:lMsg,cle:GCryptage.getBuffer(this.tokenSAV),iv:GApplication.getCommunication().ivAES});}
viderStockageMDP(){IELocalStorage.removeItem(this.const.Cookie_Identification);IELocalStorage.removeItem(this.const.Cookie_Authentification);IELocalStorage.removeItem(this.const.Cookie_Espace);IELocalStorage.removeItem(this.const.Cookie_estCAS);}
supprimerCookieValidationAppli(){document.cookie=GApplication.getCookieValidationAppli()+'=;expires='+new Date(0).toUTCString();}
setChallenge(aChallenge){const lChallenge=GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:aChallenge,cle:GCryptage.getBuffer(this.getCle()),iv:GApplication.getCommunication().ivAES,avecAlea:true});this.challenge=GCryptage.encrypter({genreCryptage:EGenreCryptage.AES,chaine:lChallenge,cle:GCryptage.getBuffer(this.getCle()),iv:GApplication.getCommunication().ivAES});}
validationLoginMdp(){this.demandeConnexionAuto=!this.modeValidationAppliMobile&&!this.estAppliMobile&&!this.aMotDePasseStocke()&&this.avecStockageMDP;this.enConnexionAuto=!this.modeValidationAppliMobile&&!this.estAppliMobile&&this.aMotDePasseStocke()&&this.avecStockageMDP;this.demandeConnexionAppliMobile=this.modeValidationAppliMobile;this.demandeConnexionAppliMobileJeton=this.modeValidationAppliMobile&&this.modeValidationAppliMobileJeton;this.enConnexionAppliMobile=GApplication.estAppliMobile;return MethodesObjet.isFunction(this.callback)&&((!!this.getLogin()&&!!this.getMotDePasse()&&(!this.estAppliMobile||!!this.uuidAppliMobile))||(this.tokenSAV&&this.loginTokenSAV));}
identification(){if(this.validationLoginMdp()){if(this.etat===this.genreEtat.authentifie){return;}
this.etat=this.genreEtat.enIdentification;Requetes(this.requetes.identification,this).lancerRequete({genreConnexion:this.genreConnexion,genreEspace:this.genreEspace,identifiant:this.getLogin(),pourENT:this.pourENT,enConnexionAuto:this.enConnexionAuto,demandeConnexionAuto:this.demandeConnexionAuto,enConnexionAppliMobile:this.enConnexionAppliMobile,demandeConnexionAppliMobile:this.demandeConnexionAppliMobile,demandeConnexionAppliMobileJeton:this.demandeConnexionAppliMobileJeton,uuidAppliMobile:this.uuidAppliMobile,loginTokenSAV:this.loginTokenSAV}).then(this.apresIdentification.bind(this));} else{this.etat=this.genreEtat.malInitialise;this.callback();}}
apresIdentification(aParam){this.etat=this.genreEtat.identifie;if(this.demandeConnexionAppliMobile&&aParam.login){this.login=new ObjetElement(aParam.login);}
this.ressourceInternet=aParam.utilisateur||new ObjetElement('');this.login.Genre=aParam.modeCompLog||0;this.motDePasse.Genre=aParam.modeCompMdp||0;this.alea=aParam.alea||'';this.setChallenge(aParam.challenge);if(this.getMotDePasse()||(this.tokenSAV&&this.loginTokenSAV)){this.authentification();}}
authentification(){this.etat=this.genreEtat.enAuthentification;Requetes(this.requetes.authentification,this).lancerRequete({genreConnexion:this.genreConnexion,identifiant:this.getLogin(),pourENT:this.pourENT,ressourceInternet:this.ressourceInternet,nomRessource:this.nomRessource,genreRecherche:this.genreRecherche,enConnexionAuto:this.enConnexionAuto,demandeConnexionAuto:this.demandeConnexionAuto,enConnexionAppliMobile:this.enConnexionAppliMobile,demandeConnexionAppliMobile:this.demandeConnexionAppliMobile,demandeConnexionAppliMobileJeton:this.demandeConnexionAppliMobileJeton,uuidAppliMobile:this.uuidAppliMobile,loginTokenSAV:this.loginTokenSAV,challenge:this.challenge}).then(this.apresAuthentification.bind(this));}
apresAuthentification(aParam){if($.isNumeric(aParam.Acces)){this.etat=this.genreEtat.erreur;this.setMessageErreur(aParam.Acces,aParam.AccesMessage);if(window&&window.opener&&this.tokenSAV){window.removeEventListener('message',this.messageTokenSAV.bind(this),false);window.opener.postMessage(JSON.stringify({result:aParam.Acces,erreur:this.erreur}),'*');}
this.callback(aParam);} else if(aParam.cle){GApplication.getCommunication().cleAES=GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:aParam.cle,cle:GCryptage.getBuffer(this.getCle()),iv:GApplication.getCommunication().ivAES,enBytes:true});_apresAuthentificationReussie.call(this,aParam);} else{this.etat=this.genreEtat.nonAuthentifie;if(window&&window.opener&&this.tokenSAV){window.removeEventListener('message',this.messageTokenSAV.bind(this),false);window.opener.postMessage(JSON.stringify({result:-1}),'*');}
this.callback(aParam);}}
setMessageErreur(AGenreErreur,aMessage){this.erreur={erreurTitre:null,erreurMessage:null,erreurBandeau:null};this.erreurCode=AGenreErreur;switch(AGenreErreur){case EGenreErreurAcces.Identification:this.erreur={erreurMessage:GTraductions.getValeur('connexion.ErreurIdentification')};break;case EGenreErreurAcces.Autorisation:this.erreur={erreurMessage:GTraductions.getValeur('connexion.ErreurAutorisation',[GParametres.GetNomEspace()]),erreurTitre:GTraductions.getValeur('connexion.AccesRefuse')};break;case EGenreErreurAcces.ConnexionClasse:this.erreur={erreurMessage:GTraductions.getValeur('connexion.ErreurConnexionClasse')};break;case EGenreErreurAcces.AucuneRessource:this.erreur={erreurMessage:GTraductions.getValeur('connexion.ErreurAucuneRessource',[GParametres.GetNomEspace()]),erreurTitre:GTraductions.getValeur('connexion.AccesRefuse')};break;case EGenreErreurAcces.Connexion:this.erreur={erreurMessage:GTraductions.getValeur('connexion.ErreurConnexion')};break;case EGenreErreurAcces.BloqueeEleve:this.erreur={erreurMessage:GTraductions.getValeur('connexion.ErreurBloqueeEleve')};break;case EGenreErreurAcces.FonctionAccompagnant:this.erreur={erreurMessage:GTraductions.getValeur('connexion.ErreurFonctionAccompagnant',[GParametres.GetNomEspace()])};break;case EGenreErreurAcces.AccompagnantAucunEleve:this.erreur={erreurMessage:GTraductions.getValeur('connexion.ErreurAccompagnantAucunEleve',[GParametres.GetNomEspace()])};break;case EGenreErreurAcces.Message:this.erreur={erreurMessage:aMessage?aMessage.message||'':'',erreurTitre:aMessage?aMessage.titre||'':''}
;break;default:break;}}
_authentificationTokenSAV(){this.setTokenSAV(this.tokenSAV);this.identification();}
messageTokenSAV(aEvent){if(aEvent&&aEvent.data){const lData=JSON.parse(aEvent.data);if(lData&&lData.tokenSAV){this.tokenSAV=lData.tokenSAV;this._authentificationTokenSAV.call(this);}}}}
function _avecSecurisationDoubleAuth(aParam){return aParam&&aParam.actionsDoubleAuth&&aParam.actionsDoubleAuth.contains&&(aParam.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_ChoixStrategie)||aParam.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_SaisieCodePINetSource)||aParam.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_SaisieSourcePourNotifSeulement));}
function _avecPersonnalisationMDP(aParam){return aParam&&aParam.actionsDoubleAuth&&aParam.actionsDoubleAuth.contains&&aParam.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_PersonnalisationMotDePasse);}
function _requeteSecurisationCompteEnregistrementPromise(aParams){const lParams=Object.assign({action:TypeCommandeSecurisationCompteHttp.csch_EnregistrerChoixUtilisateur},aParams.valeursSecurisationCompte);return new ObjetRequeteSecurisationCompteDoubleAuth(this).lancerRequete(lParams).catch(function(aReponse){return Promise.resolve().then(function(){if(aReponse&&aReponse.promiseMessage){return aReponse.promiseMessage;}}).then(function(){return Promise.reject();});});}
function _securisationCompte_promise(aParam){this.securisationCompte.callbackInitSecurisationCompte(aParam);aParam.valeursSecurisationCompte={};return Promise.resolve().then(function(){if(_avecPersonnalisationMDP(aParam)){return this.securisationCompte.callbackPersonnalisationMDP_promise(aParam).then(function(aResult){if(aResult.reussite&&aResult.paramForcerMDP){if(aResult.paramForcerMDP.nouveauMDP){aParam.valeursSecurisationCompte.nouveauMDP=aResult.paramForcerMDP.nouveauMDP;}
Object.assign(aParam,aResult.paramForcerMDP);} else{return Promise.reject();}});}}.bind(this)).then(function(){if(_avecSecurisationDoubleAuth(aParam)){return this.securisationCompte.callbackSecurisationDoubleAuth_promise(aParam).then(function(aResult){if(aResult&&aResult.suivant&&aResult.donnees){Object.assign(aParam.valeursSecurisationCompte,aResult.donnees);} else{return Promise.reject();}});}}.bind(this)).then(function(){if(_avecSecurisationDoubleAuth(aParam)||_avecPersonnalisationMDP(aParam)||aParam.changementStrategieImpose){return _requeteSecurisationCompteEnregistrementPromise.call(this,aParam);}}.bind(this));}
function _apresAuthentificationReussie(aParam){if(aParam.login){this.login.Libelle=aParam.login;}
this.jetonConnexionAppliMobile=aParam.jetonConnexionAppliMobile;this.jetonConnexionAuto=aParam.jetonConnexionAuto;if(this.jetonConnexionAuto){IELocalStorage.setItem(this.const.Cookie_Authentification,this.jetonConnexionAuto);IELocalStorage.setItem(this.const.Cookie_Identification,this.getLogin());IELocalStorage.setItem(this.const.Cookie_Espace,this.genreEspace);}
if(window&&window.opener&&this.tokenSAV){window.removeEventListener('message',this.messageTokenSAV.bind(this),false);window.opener.postMessage(JSON.stringify({result:0}),'*');}
if(this.modeValidationAppliMobile||document.cookie.indexOf('validationAppliMobile=')> -1){window.loginState={status:0,libelle:aParam.libelleUtil,login:this.getLogin(true),mdp:this.jetonConnexionAppliMobile};if(document.cookie.indexOf('validationAppliMobile=')> -1){document.cookie='validationAppliMobile=;expires='+new Date(0).toUTCString();document.cookie="appliMobile=1;expires="+new Date(new Date().getTime()+(365*24*60*60*1000)).toUTCString();}
return;}
if(GApplication.estAppliMobile){window.messageData.push({action:'surAuth',data:this.jetonConnexionAppliMobile});}
Promise.resolve().then(function(){if(aParam.actionsDoubleAuth){return _securisationCompte_promise.call(this,aParam);}}.bind(this)).then(function(){_authentifieTotalement.call(this,aParam);}.bind(this),function(aArg){if(aArg){}
UtilitaireDeconnexion.deconnexion().then(function(){window.location.reload();});});}
function _authentifieTotalement(aParam){this.etat=this.genreEtat.authentifie;this.callback(aParam);}
module.exports=ObjetMoteurConnexion;},fn:"objetmoteurconnexion.js"});;
IE.fModule({f:function(exports,require,module,global){class UtilitaireRedirection{constructor(){this.parametresAConserver=['login','fd','redirect','redirect_sauthm'];this.parametres=[];const lSearches=window.location.search.replace(/^\?/,'').split('&');for(const i in lSearches){const lItems=lSearches[i].split('=');if(lItems.length===2){this.parametres.push({parametre:lItems[0],valeur:lItems[1]});}}}
getParametresUrl(aObjet){let lParamUrl='';const lParametres=[];let lParametre;if(aObjet&&aObjet.parametresAConserver){this.parametresAConserver=aObjet.parametresAConserver;}
for(const i in this.parametres){lParametre=this.parametres[i];const lRegExpParametre=new RegExp(lParametre.parametre,'i');if(lRegExpParametre.test(this.parametresAConserver.join(' '))&&(!aObjet||!aObjet.parametresASupprimer||!lRegExpParametre.test(aObjet.parametresASupprimer.join(' ')))){lParametres.push(lParametre);}}
if(aObjet&&aObjet.parametres){for(const i in aObjet.parametres){lParametre=aObjet.parametres[i];if(!this.existParametre(lParametre.parametre)){lParametres.push(lParametre);}}}
for(const i in lParametres){lParametre=lParametres[i];lParamUrl+=(lParamUrl?'&':'')+lParametre.parametre+'='+lParametre.valeur;}
return(lParamUrl?'?':'')+lParamUrl;}
existParametre(aParametre){const obj=this.parametres.filter(function(aItem){return aItem.parametre===aParametre;});return(obj!==undefined)&&(obj.length>0);}
getValeurParametre(aParametre){const obj=this.parametres.filter(function(aItem){return aItem.parametre===aParametre;});if((obj!==undefined)&&(obj.length===1)){return decodeURIComponent(obj[0].valeur);}}}
module.exports=UtilitaireRedirection;},fn:"utilitaireredirection.js"});;
IE.fModule({f:function(exports,require,module,global){const GChaine=require('GChaine.js');const EStructureAffichage=require('Enumere_StructureAffichage.js');const ObjetAbstraitInterface=require('ObjetInterface.js');const GTraductions=require('ObjetTraduction.js');const ObjetMoteurConnexion=require('ObjetMoteurConnexion.js');const GUID=require('GUID.js');const EGenreBoiteMessage=require('Enumere_BoiteMessage.js');const ToucheClavier=require('ToucheClavier.js');const EGenreErreurAcces=require('Enumere_ErreurAcces.js');const UtilitaireRedirection=require('UtilitaireRedirection.js');class _InterfaceConnexion extends ObjetAbstraitInterface{constructor(...aParams){super(...aParams);this.options={avecAnimation:true,genreImageConnexion:0,urlImageConnexion:'',avecChoixConnexion:false,avecRetourEspace:false,stockageMDPActive:false,avecRecupIdMdp:false,pourInscription:false,texteExplicatifIdentifiant:'',texteExplicatifMotdepasse:'',requetes:{identification:'',authentification:''}};this.moteurConnexion=null;this.id={bandeau:GUID.getId(),btnConnexion:GUID.getId(),checkBox:GUID.getId(),choixLangue:GUID.getId(),connect:GUID.getId(),inscription:GUID.getId(),image:GUID.getId(),imageSuite:GUID.getId(),thisNom:this.Nom,waiModeAccessible:GUID.getId(),wrapper:GUID.getId(),wrapperConnect:GUID.getId(),nameRadio:GUID.getId(),identification:GUID.getId(),motDePasse:GUID.getId(),checkSouvenir:GUID.getId(),pageConnexionAuto:GUID.getId()};}
SetParametresGeneraux(){this.GenreStructure=EStructureAffichage.Autre;}
setOptions(aOptions){Object.assign(this.options,aOptions);if(window.location.search.search("redirect=1")>0&&GParametres.URLEspace){this.options.avecRetourEspace=true;} else{this.options.avecRetourEspace=false;}}
ConstruireStructureAffichageAutre(){if(this.estConnexionSansInterface()){return'<div class="GrandEspaceHaut GrandEspaceGauche Gras" id="'+this.id.pageConnexionAuto+'">'+GTraductions.getValeur('connexion.ConnexionCAS')+'</div>';} else{return this.construirePage(this);}}
construirePage(){return'';}
RecupererDonnees(){this.moteurConnexion=new ObjetMoteurConnexion();this.moteurConnexion.init({callback:this.callbackMoteur.bind(this),requetes:{identification:this.options.requetes.identification,authentification:this.options.requetes.authentification},stockageMDPActive:this.options.stockageMDPActive});if(this.callbackInitSecurisationCompte){this.moteurConnexion.securisationCompte={callbackInitSecurisationCompte:this.callbackInitSecurisationCompte.bind(this),callbackPersonnalisationMDP_promise:this.callbackPersonnalisationMDP_promise.bind(this),callbackSecurisationDoubleAuth_promise:this.callbackSecurisationDoubleAuth_promise.bind(this)};}
if(GApplication.getDemo()){this.moteurConnexion.setLogin(GTraductions.getValeur('Demo.Identifiant'));this.moteurConnexion.setMotDePasse(GTraductions.getValeur('Demo.MotDePasse'));$('#'+this.id.identification).attr('readonly',true);$('#'+this.id.motDePasse).attr('readonly',true);this.preremplir();} else{if(!GNavigateur.isIpad){$('#'+this.id.identification).focus();}}
if(window.hookAccesDepuisAppli){window.hookAccesDepuisAppli.call(this);} else if(GApplication.smartAppBanner){GApplication.smartAppBanner.show();}
$('body').on('keyup',this.switchModeAccessible);}
switchModeAccessible(event){if(event.which===ToucheClavier.X&&event.originalEvent.ctrlKey&&event.originalEvent.shiftKey){GEtatUtilisateur.setModeAccessible(!IE.optionsEspaceLocal.getModeAccessible());setTimeout(function(){window.location.reload();},500);}}
free(){super.free();$('body').off('keyup',this.switchModeAccessible);}
callbackMoteur(){switch(this.moteurConnexion.etat){case this.moteurConnexion.genreEtat.aucun:break;case this.moteurConnexion.genreEtat.malInitialise:break;case this.moteurConnexion.genreEtat.autoInitialise:this.preremplir();break;case this.moteurConnexion.genreEtat.enIdentification:break;case this.moteurConnexion.genreEtat.identifie:break;case this.moteurConnexion.genreEtat.nonIdentifie:break;case this.moteurConnexion.genreEtat.enAuthentification:break;case this.moteurConnexion.genreEtat.authentifie:this._reussiteAuthentification.apply(this,arguments);break;case this.moteurConnexion.genreEtat.nonAuthentifie:break;case this.moteurConnexion.genreEtat.erreur:{let lAction;if(this.moteurConnexion.erreurCode===EGenreErreurAcces.Identification){lAction=(function(){this.moteurConnexion.setMotDePasse('');this.moteurConnexion.setStockageMdp(false);}).bind(this);} else{lAction=(function(){this.moteurConnexion.setLogin('');this.moteurConnexion.setMotDePasse('');this.moteurConnexion.setStockageMdp(false);}).bind(this);}
this.signalerErreur();GApplication.getMessage().afficher({type:EGenreBoiteMessage.Information,titre:this.moteurConnexion.erreur.erreurTitre,message:this.moteurConnexion.erreur.erreurMessage,callback:lAction});this._echecAuthentification.apply(this,arguments);break;}
default:;break;}}
getControleur(aInstance){return $.extend(true,super.getControleur(aInstance),{getHint:function(aMessage){switch(aMessage){case'texteExplicatifIdentifiant':return aInstance.options.texteExplicatifIdentifiant;case'texteExplicatifMotdepasse':return aInstance.options.texteExplicatifMotdepasse;case'texteExplicatifModeConnexion':return'<strong>'+GTraductions.getValeur('connexion.modeConnexionTitre')+'</strong><br />'+GTraductions.getValeur('connexion.modeConnexionMessage');case'texteExplicatifRecupIdMdp':return GTraductions.getValeur('connexion.RecuperationMDP.titre');case'texteExplicatifValidation':return GChaine.toTitle(GTraductions.getValeur('connexion.seConnecterTitre'));default:return'';}},choixConnexion:{getValue:function(aMode){return aInstance.moteurConnexion?aMode===aInstance.moteurConnexion.genreConnexion:0;},setValue:function(aValue){if(!!aInstance.moteurConnexion){aInstance.moteurConnexion.setGenreConnexion(aValue);}}},login:{getValue:function(){return!!aInstance.moteurConnexion?aInstance.moteurConnexion.getLogin(true):'';},setValue:function(aValue){if(!!aInstance.moteurConnexion){aInstance.moteurConnexion.setLogin(aValue);}}},motDePasse:{getValue:function(){return!!aInstance.moteurConnexion?aInstance.moteurConnexion.getMotDePasse(true):'';},setValue:function(aValue){if(!!aInstance.moteurConnexion){aInstance.moteurConnexion.setMotDePasse(aValue);}},interrompreEvent:function(aEvent){if(aEvent.type==='keyup'&&aEvent.which===ToucheClavier.RetourChariot){if(!!aInstance.moteurConnexion&&!GApplication.getCommunication().requeteEnCours()){aInstance.moteurConnexion.identification();}
return true;}}},montrerMasquerMotDePasse:{event:function(){let lTrigger=$('.as-input.as-password').find('.btnImage');let lTarget=$('.as-input.as-password').find('input');lTrigger.toggleClass('icon_eye_close icon_eye_open');lTarget.attr("type")==="password"?lTarget.attr("type","text"):lTarget.attr("type","password");},getTitle:function(){return $('.as-input.as-password').find('.btnImage').hasClass('icon_eye_open')?GTraductions.getValeur('connexion.VoirMDP'):GTraductions.getValeur('connexion.masquerMDP');}},stockageMDP:{getValue:function(){return!!aInstance.moteurConnexion?aInstance.moteurConnexion.avecStockageMDP:false;},setValue:function(aValue){if(!!aInstance.moteurConnexion){aInstance.moteurConnexion.setStockageMdp(aValue);}}},boutonRedirigerParent:{getDisabled:function(){return false;},event:function(){if(GParametres&&GParametres.infosInscription&&GParametres.infosInscription.espace&&GParametres.infosInscription.espace.url){let lUrl=window.location.href.split('/');lUrl.pop();lUrl.push(GParametres.infosInscription.espace.url);lUrl=lUrl.join('/');window.location.href=lUrl;}}},boutonCreation:{getDisabled:function(){return false;},event:function(){aInstance.eventCreation();}},btnConnexionInscription:{getDisabled:function(){return false;},event:function(){aInstance.options.pourInscription=false;}},boutonValidation:{getDisabled:function(){return!aInstance.moteurConnexion||!aInstance.moteurConnexion.getLogin()||!aInstance.moteurConnexion.getMotDePasse();},event:function(){if(!!aInstance.moteurConnexion&&!GApplication.getCommunication().requeteEnCours()){aInstance.moteurConnexion.identification();}}},choixLangue:function(){return aInstance.options.utilitaireChangementLangue.construire(aInstance.controleur);},visibiliteChangementLangue:function(){return aInstance.options.utilitaireChangementLangue.avecChoixLangues();},visibiliteModeConnexion:function(){return aInstance.options.avecChoixConnexion;},visibiliteRecupIdMdp:function(){return aInstance.options.avecRecupIdMdp;},visibiliteConnexion:function(){return!aInstance.options.pourInscription;},visibiliteInscription:function(){return aInstance.options.pourInscription;},visibiliteRedirigerParent:function(){return aInstance.options.pourInscription&&GParametres&&GParametres.infosInscription&&GParametres.infosInscription.espace;},visibiliteRetourEspace:function(){return aInstance.options.avecRetourEspace;}});}
retourEspaceBureau(){window.location.assign(GParametres.URLEspace+new UtilitaireRedirection().getParametresUrl({parametres:[{parametre:'fd',valeur:'1'}],parametresASupprimer:['redirect']}));}
signalerErreur(){}
preremplir(){}
traiterEvenementValidation(aLogin,aMotDePasse,aPourENT,aUuidAppliMobile){this.moteurConnexion.genreEspace=GEtatUtilisateur.GenreEspace;if(!!aLogin){this.moteurConnexion.login.Libelle=aLogin;}
if(!!aMotDePasse){this.moteurConnexion.motDePasse.Libelle=aMotDePasse;}
this.moteurConnexion.pourENT=aPourENT?aPourENT:false;this.moteurConnexion.avecStockageMDP=false;this.moteurConnexion.uuidAppliMobile=this.uuidAppliMobile||aUuidAppliMobile;this.moteurConnexion.identification();}
estConnexionSansInterface(){return GApplication.acces&&(GApplication.acces.estConnexionCAS()||GApplication.acces.estConnexionCookie());}
_reussiteAuthentification(){}
_echecAuthentification(){}}
module.exports=_InterfaceConnexion;},fn:"_interfaceconnexion.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeArrierePlanAuthentification={Photo:0,_Rebus:1,Neutre:2,PersonnaliseURL:3,Louvre:4,Arbre:5,PersonnaliseFichier:6};module.exports.TypeArrierePlanAuthentification=TypeArrierePlanAuthentification;},fn:"typearriereplanauthentification.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeArrierePlanAuthentification=require('TypeArrierePlanAuthentification.js').TypeArrierePlanAuthentification;const{GDate}=require('ObjetDate.js');class ObjetImageConnexion{constructor(){this.definitionImages=[];this.definitionImagesExtra={};}
getClassImage(){return'';}
getObjetImagePronote(aGenreImageConnexion){let lDate=new Date();if(location&&location.search&&location.search.search(/dateCnx=[0-9]{4}-[0-9]{2}-[0-9]{2}/)> -1){const lDateMatch=location.search.match(/dateCnx=([0-9]{4}-[0-9]{2}-[0-9]{2})/);lDate=new Date(lDateMatch[1]);}
let lResult={};try{switch(aGenreImageConnexion){case TypeArrierePlanAuthentification.Photo:lResult=this.definitionImages[TypeArrierePlanAuthentification.Photo][lDate.getMonth()%this.definitionImages[TypeArrierePlanAuthentification.Photo].length];break;case TypeArrierePlanAuthentification.Louvre:if(this.definitionImages[TypeArrierePlanAuthentification.Louvre].length===12){lResult=this.definitionImages[TypeArrierePlanAuthentification.Louvre][(lDate.getMonth())%this.definitionImages[TypeArrierePlanAuthentification.Louvre].length];} else if(this.definitionImages[TypeArrierePlanAuthentification.Louvre].length===53){const lDatePourSemaine=new Date(lDate.getTime());lDatePourSemaine.setHours(0,0,0,0);lDatePourSemaine.setDate(lDatePourSemaine.getDate()+3-(lDatePourSemaine.getDay()+6)%7);const lWeek1=new Date(lDatePourSemaine.getFullYear(),0,4);const lSemaine=1+Math.round(((lDatePourSemaine.getTime()-lWeek1.getTime())/86400000-3+(lWeek1.getDay()+6)%7)/7);lResult=this.definitionImages[TypeArrierePlanAuthentification.Louvre][(lSemaine-1)%this.definitionImages[TypeArrierePlanAuthentification.Louvre].length];} else{lResult=this.definitionImages[TypeArrierePlanAuthentification.Louvre][GDate.getNbrJoursEntreDeuxDates(new Date(lDate.getFullYear(),0,1),lDate)%this.definitionImages[TypeArrierePlanAuthentification.Louvre].length];}
if(this.definitionImagesExtra[lDate.getMonth()+'-'+lDate.getDate()]){lResult=this.definitionImagesExtra[lDate.getMonth()+'-'+lDate.getDate()];if(lResult.suiviLogo1){lResult.suiviLien=lResult.suiviLogo1;}}
if(new Date()>=lResult.dateMaxLien){lResult.lien='';lResult.lienSuite='';}
break;case TypeArrierePlanAuthentification.Arbre:lDate.setFullYear(1900);if(lDate<new Date(1900,2,20)){lResult=this.definitionImages[TypeArrierePlanAuthentification.Arbre][0];} else if(lDate<new Date(1900,5,21)){lResult=this.definitionImages[TypeArrierePlanAuthentification.Arbre][1];} else if(lDate<new Date(1900,8,23)){lResult=this.definitionImages[TypeArrierePlanAuthentification.Arbre][2];} else if(lDate<new Date(1900,11,21)){lResult=this.definitionImages[TypeArrierePlanAuthentification.Arbre][3];} else{lResult=this.definitionImages[TypeArrierePlanAuthentification.Arbre][0];}
break;default:lResult={};break;}} catch(e){lResult={};}
return lResult;}
getClassFond(){return'Image_Connexion_Fond Repeat';}
setDefinitionImages(aArray){this.definitionImages=aArray;}
setDefinitionImagesExtra(aObjet){this.definitionImagesExtra=aObjet;}}
const lObjetImageConnexion=new ObjetImageConnexion();module.exports=lObjetImageConnexion;},fn:"objetimageconnexion.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreEvenementObjetSaisie={selection:0,deploiement:1,fermeture:2};module.exports=EGenreEvenementObjetSaisie;},fn:"enumere_evenementobjetsaisie.js"});;
IE.fModule({f:function(exports,require,module,global){require('produit/css/ChangementLangue.css');const uNomCookieLangue='ielang';const UtilitaireChangementLangueProduit={affecterLangue:function(aIdLang){const lDate=new Date();lDate.setDate(lDate.getDate()+365);document.cookie=uNomCookieLangue+'='+aIdLang+'; expires='+lDate.toGMTString()+'; path=/;';window.location.reload();},getImageCss:function(aLangId){switch(aLangId){case 12:case 1036:return'Image_flagFR';case 1033:return'Image_flagGB';case 1031:return'Image_flagDE';case 9:case 2057:return'Image_flagGB';case 2060:return'Image_flagBE';case 3084:return'Image_flagCA';case 4108:return'Image_flagCH';case 16:case 1040:return'Image_flagIT';case 2067:return'Image_flagNL';case 6145:return'Image_flagMA';case 10:case 3082:return'Image_flagES';default:;return'Image_flagFR';}}};module.exports=UtilitaireChangementLangueProduit;},fn:"utilitairechangementlangueproduit.js"});;
IE.fModule({f:function(exports,require,module,global){const EGenreSaisie={Combo:2,SaisieRecherche:3};module.exports=EGenreSaisie;},fn:"enumere_saisie.js"});;
IE.fModule({f:function(exports,require,module,global){require('Produit/Css/Form-components.css');const GChaine=require('GChaine.js');const GHtml=require('GHtml.js');const EEvent=require('Enumere_Event.js');const Identite=require('ObjetIdentite.js');const{GObjetWAI,EGenreRole,EGenreAttribut}=require('ObjetWAI.js');const tag=require('tag.js');const EGenreBoutonCellule={Aucun:0,Fleche:1,Loupe:2,Points:3,Image:4};class ObjetCelluleBouton extends Identite{constructor(...aParams){super(...aParams);this.idZone=this.Nom+'_Zone';this.NomEdit=this.Nom+'_Edit';this.NomDescr=this.Nom+'_Descr';this.idTexte=this.NomEdit;this.idBouton=this.Nom+'_Bouton';this.libelle='';this._options={hauteur:18,largeur:80,genreBouton:EGenreBoutonCellule.Aucun,iconeGauche:'',avecBordures:true,couleurFondSurvol:null,avecCouleurFondBouton:true,avecFocusVisibleTexte:true,avecZoneSaisie:true,estSaisissable:false,selectionSaisieSurFocus:false,taillePolice:10,classeZone:'FondBlanc',classTexte:'',classBackground:'',styleZoneTexte:'',styleBouton:'',placeHolder:'',libelleHaut:'',withTabulation:true,roleWAIZone:'',labelWAIEdit:'',popupWAI:false,labelledById:'',desactiverAideSaisie:false,ariaExpanded:false,titleForce:'',setValue:null,editAvecTrim:false};this.setOptions_ObjetCelluleBouton({estSaisissable:true,genreBouton:EGenreBoutonCellule.Fleche});this.IdPremierElement=this.NomEdit;}
getControleur(aInstance){return $.extend(true,super.getControleur(this),{ifLibelleHaut:function(){return!!aInstance._options.libelleHaut;},htmlLibelleHaut:function(){return aInstance._options.libelleHaut;},surZoneMouseenterMouseleave:function(aEvent){if(!this.instance.Actif){return;}
this.instance._enSurvol=aEvent.type==='mouseenter';this.controleur.$refreshSelf();},getClassZone:function(){return'Texte'+this.instance._options.taillePolice+' '+this.instance._options.classeZone+' CelluleBoutonZoneJQ'+(this.instance.Actif?' AvecMain':'');},getStyleConteneur:function(){return{'width':(aInstance._options.largeur&&aInstance._options.largeur==='100%'?'100%':'')};},getStyleContenu:function(){return{'width':(aInstance._options.largeur&&aInstance._options.largeur!=='100%'?aInstance._options.largeur+'px':'')};},getAttrContenu(){const lAttr={'aria-disabled':aInstance.Actif?null:true,'aria-labelledby':aInstance._options.labelledById||null};if(aInstance._options.roleWAIZone===EGenreRole.Combobox){lAttr['aria-expanded']=!!aInstance._options.ariaExpanded;}
return lAttr;},getTitleDescriptionEdit:function(){return!this.instance._options.titleForce?this.instance.estLibelleHTML?'':(this.instance.libelle&&GChaine.GetLongueurChaineDansDiv(this.instance.libelle,this.instance._options.taillePolice,false)>=this.instance._options.largeur)?GChaine.enleverEntites(this.instance.libelle):'':this.instance._options.titleForce;},edit:{getValue:function(){return aInstance.libelle;},setValue:function(aValue){aInstance.libelle=aValue;if(aInstance._options.setValue){aInstance._options.setValue(aValue,aInstance);}},getDisabled:function(){return!aInstance.Actif;},node:function(){if(!aInstance._options.estSaisissable){$(this.node).on('focus',function(){GHtml.setFocus(this,false);});}
$(this.node).on('keyup blur focusout',function(aEvent){_surEventEdit(aInstance,aEvent);});},getNodeSansSaisie:function(){$(this.node).on('mousedown click keyup blur focusout',function(aEvent){_surEventEdit(aInstance,aEvent);});},getClassEdit:function(){return'CelluleBoutonNomEditJQ Texte'+this.instance._options.taillePolice+' '+(this.instance._options.classTexte||'')+(this.instance.Actif?(this.instance._options.estSaisissable?' AvecTexte':' AvecMain'):'')+' '+(this.instance._options.classBackground||'');},getStylePourBoutonNonEditable:function(){return{'background-color':this.instance.Actif?'':GCouleur.nonEditable.fond};}},getHtmlConsult:function(){if(this.instance.libelle||!this.instance._options.placeHolder){return GChaine.AvecEspaceSiVide(this.instance.estLibelleHTML?this.instance.libelle:GChaine.Insecable(this.instance.libelle));} else if(this.instance._options.placeHolder){if(this.instance._options.placeHolder.libelleHtml){return GChaine.AvecEspaceSiVide(this.instance._options.placeHolder.libelleHtml);} else{return'<span class="as-placeholder">'+this.instance._options.placeHolder||''+'</span>';}}},getNodeBouton:function(){$(this.node).on('mousedown click keyup',function(aEvent){if(!aInstance.Actif){return;}
let lEvent=null;switch(aEvent.type){case'mousedown':lEvent=EEvent.SurMouseDown;break;case'click':lEvent=EEvent.SurClick;break;case'keyup':lEvent=EEvent.SurKeyUp;break;}
if(lEvent!==null){aInstance.callback.appel(lEvent,aEvent,false);if(aInstance.Pere&&aInstance.Pere.$refreshSelf){aInstance.Pere.$refreshSelf();}}});}});}
setParametres_PN(aAvecBouton,aLargeur,aHauteur,aClassTexte){this.setOptions_ObjetCelluleBouton({genreBouton:aAvecBouton?EGenreBoutonCellule.Fleche:EGenreBoutonCellule.Aucun,largeur:aLargeur,hauteur:aHauteur?aHauteur:15,classTexte:aClassTexte?aClassTexte:'Gras',estSaisissable:false,avecZoneSaisie:false});}
setOptions_ObjetCelluleBouton(aOptions){$.extend(this._options,aOptions);this.avecBouton=this._options.genreBouton!==EGenreBoutonCellule.Aucun;this.$refreshSelf();}
SetInformationWAI(aGenreRoleWAI,aLabelFor){this._options.roleWAIZone=aGenreRoleWAI===null||aGenreRoleWAI===undefined?'':aGenreRoleWAI;this._options.labelWAIZone=aLabelFor===null||aLabelFor===undefined?'':aLabelFor;}
ConstruireAffichage(){const H=[];let lClasseBtn='';switch(this._options.genreBouton){case EGenreBoutonCellule.Fleche:lClasseBtn='as-select ';break;case EGenreBoutonCellule.Loupe:lClasseBtn='as-search';break;case EGenreBoutonCellule.Points:lClasseBtn='as-multi-choix';break;case EGenreBoutonCellule.Image:lClasseBtn='as-date-picker';break;}
H.push('<div ie-if="ifLibelleHaut" ie-html="htmlLibelleHaut" class="LibelleHaut"></div>');H.push('<div class="input-wrapper" ie-style="getStyleConteneur">','<div class="ocb_cont as-input ',lClasseBtn,'">');if(this._options.iconeGauche){H.push(tag('i',{class:['ocb_icone_gauche',this._options.iconeGauche],'ie-node':'edit.getNodeSansSaisie',role:EGenreRole.Combobox}));}
if(this._options.avecZoneSaisie){H.push('<input type="text" ie-model="edit"',(this._options.editAvecTrim?' ie-trim ':''),' id="'+this.NomEdit+'" ','ie-style="getStyleContenu" ','ie-attr="getAttrContenu" ',this._options.desactiverAideSaisie?'autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"':'','ie-title="getTitleDescriptionEdit"',this._options.selectionSaisieSurFocus?' ie-selecttextfocus ':'',(!this._options.estSaisissable?'readonly  aria-readonly="true" ':''),GObjetWAI.composeAttribut({genre:EGenreAttribut.autocomplete,valeur:'list'})+' ',(this._options.owns?GObjetWAI.composeAttribut({genre:EGenreAttribut.owns,valeur:this._options.owns})+' ':''),(this._options.labelWAIEdit?GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this._options.labelWAIEdit})+' ':''),' placeholder="',this._options.placeHolder||'','" />');} else{H.push('<div',(this._options.withTabulation?' tabIndex="0"':''),' id="',this.idTexte,'"','ie-html="getHtmlConsult" ','ie-style="getStyleContenu" ','ie-attr="getAttrContenu" ',GHtml.composeAttr('ie-node','edit.getNodeSansSaisie'),!this._options.titleForce?' ie-ellipsis ':'',this._options.titleForce?' title="'+GChaine.toTitle(this._options.titleForce)+'"':'',' ',this._options.roleWAIZone?GObjetWAI.composeRole(this._options.roleWAIZone):'',this._options.roleWAIZone===EGenreRole.Combobox?' aria-expanded="false"':'',this._options.roleWAIZone===EGenreRole.Combobox?' aria-live="polite" aria-relevant="text" ':'',(this._options.owns?' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.owns,valeur:this._options.owns}):''),(this._options.labelWAIEdit?' '+GObjetWAI.composeAttribut({genre:EGenreAttribut.label,valeur:this._options.labelWAIEdit}):''),this._options.popupWAI?` aria-haspopup="true"`:'',(this._options.placeHolder?' placeholder="'+this._options.placeHolder+'"':''),'></div>');}
if(this.avecBouton){H.push('<div class="ocb_bouton"',GHtml.composeAttr('ie-node','getNodeBouton'),'></div>');}
H.push('</div>');H.push('</div>');return H.join('');}
RecupererDonnees(){if(!GHtml.elementExiste(this.idZone)){return;}
let lEventMap={};if(this._options.avecFocusVisibleTexte){lEventMap={'focusin':function(){$(this).find('.CelluleBoutonNomEditJQ').css('outline',GCouleur.texte+' dotted 1px');},'focusout':function(){$(this).find('.CelluleBoutonNomEditJQ').css('outline','none');}};}
$('#'+this.Nom.escapeJQ()).on(lEventMap,{instance:this}).addClass('OmbreFocus').data('couleurFocus',GCouleur.texte);}
SetActif(AActif){super.SetActif(AActif);this.$refreshSelf();}
setLibelle(aLibelle){this.libelle=aLibelle;this.estLibelleHTML=false;this.$refreshSelf();}
setLibelleHtml(aLibelleHtml){if(this._options.avecZoneSaisie){return;}
this.estLibelleHTML=true;this.libelle=aLibelleHtml;this.$refreshSelf();}
getLibelle(){return this.libelle;}
setLargeur(aLargeur){this.setOptions_ObjetCelluleBouton({largeur:aLargeur?aLargeur:undefined});}
setTitle(aTitle){this.setOptions_ObjetCelluleBouton({titleForce:aTitle});}
setFocus(){GHtml.setFocus(this.NomEdit);}
setAvecBouton(aAvecBouton){if(this.avecBouton===aAvecBouton){return;}
this.avecBouton=aAvecBouton;this.$refreshSelf();}}
function _surEventEdit(aInstance,aEvent){if(!aInstance.Actif){return;}
let lEvent=null;switch(aEvent.type){case'keyup':lEvent=EEvent.SurKeyUp;break;case'blur':lEvent=EEvent.SurBlur;break;case'focusout':lEvent=EEvent.SurFocusOut;break;case'mousedown':lEvent=EEvent.SurMouseDown;break;case'click':lEvent=EEvent.SurClick;break;default:;}
if(lEvent){aInstance.callback.appel(lEvent,aEvent,true);if(aInstance.Pere&&aInstance.Pere.$refreshSelf){aInstance.Pere.$refreshSelf();}}}
module.exports={EGenreBoutonCellule:EGenreBoutonCellule,ObjetCelluleBouton:ObjetCelluleBouton};},fn:"objetcellulebouton.js"});;
IE.fModule({f:function(exports,require,module,global){require('Produit/Css/ObjetSaisie.css');const GUID=require('GUID.js');const GLog=require('IELog.js');const MethodesObjet=require('MethodesObjet.js');const MethodesTableau=require('MethodesTableau.js');const GChaine=require('GChaine.js');const GHtml=require('GHtml.js');const GPosition=require('GPosition.js');const GStyle=require('GStyle.js');const ControleSaisieEvenement=require('ControleSaisieEvenement.js');const EGenreEvenementObjetSaisie=require('Enumere_EvenementObjetSaisie.js');const EEvent=require('Enumere_Event.js');const EGenreSaisie=require('Enumere_Saisie.js');require('iehtml.bouton.js');require('iehtml.btnimage.js');require('IEHtmlComposants.js');const ObjetCelluleBouton=require('ObjetCelluleBouton.js').ObjetCelluleBouton;const Identite=require('ObjetIdentite.js');const ObjetElement=require('ObjetElement.js');const ObjetListeElements=require('ObjetListeElements.js');const GTraductions=require('ObjetTraduction.js');const{GObjetWAI,EGenreRole,EGenreAttribut,EGenreObjet}=require('ObjetWAI.js');const EGenreBoutonCellule=require('ObjetCelluleBouton.js').EGenreBoutonCellule;const TypeThemeBouton=require('Type_ThemeBouton.js');const ToucheClavier=require('ToucheClavier.js');const tag=require('tag.js');const ZoneFenetre=require('IEZoneFenetre.js');const IEHtml=require('IEHtml.js');const{Invocateur,ObjetInvocateur}=require('Invocateur.js');const lClasseJQ=GUID.getClassCss();class ObjetSaisie extends Identite{constructor(...aParams){super(...aParams);this.NomListe=this.Nom+'_Liste';this.nomListeConteneur=this.Nom+'_Liste_cont';this.idContenu=this.Nom+'_Contenu';this.idContenuScroll=this.Nom+'_ContenuScroll';this.idWrapperBouton=this.Nom+'_wrapperbouton';this.NomLabel=this.Nom+'_Label';this.idBtnValidation=this.Nom+'_btnValidation';this.idBloc=this.Nom+'_bloc';this.Survolee= -1;this.Selection= -1;this.Timer=null;this._listeSelections=new ObjetListeElements();this.modeTactile=false;this.cache={editionEnCours:false,zIndexMobileActif:false};this.init();Invocateur.abonner(`surAffichageFenetre ${ObjetInvocateur.events.resizeNavigateur}`,() =>{if(this.listeDeroulee&&_estOuvertureModale.call(this)){this.FermerListe(false);}},this);}
init(){_initParseur.bind(this)();this.bouton=new ObjetCelluleBouton(this.Nom+'.bouton',null,this,_surEvenementBouton.bind(this));this.IdPremierElement=this.bouton.NomEdit;this.initialiserOptions_ObjetSaisie();this.decalageTopOuvertureInverse=15;}
DetruireInstances(){$('#'+this.idContenu.escapeJQ()).stop(true,true);clearTimeout(this.cache.timerMAJ);clearTimeout(this._timerInitParseur);clearTimeout(this._timerEditionRecherche);$(`#${this.nomListeConteneur.escapeJQ()}`).remove();}
initialiserOptions_ObjetSaisie(){this._options={mode:EGenreSaisie.Combo,multiSelection:false,avecElementObligatoire:false,avecDesignMobile:false,avecOuvertureDeroulantModale:null,longueur:125,hauteur:null,hauteurLigneDefault:18,hauteurLigneTactile:36,largeurListe:null,estLargeurAuto:false,getTailleElementlargeurAuto:function(aElement,aEstGras){return Math.ceil(GChaine.GetLongueurChaineDansDiv(aElement.GetLibelle(),'1.2rem',aEstGras))+4;}.bind(this),largeurAutoMin:40,largeurAutoMax:500,avecBouton:true,iconeGauche:'',deroulerListeSeulementSiPlusieursElements:true,initAutoSelectionAvecUnElement:true,controlerNbrElements:false,avecTriListeElements:false,nbrLignes:15,classTexte:'Gras',classBackground:null,placeHolder:'',desactiverAideSaisie:false,couleurFondDeroulant:null,celluleAvecTexteHtml:false,getContenuCellule:null,texteEdit:'',couleurTexteEdit:null,styleTexteEdit:null,classTexteEdit:null,largeurTexteEdit:null,getClassElement:null,getContenuElement:null,getEstElementNonSelectionnable:null,getElementSelectionnableParPrecSuiv:null,getEnteteListe:null,getPiedListe:null,libelleHaut:'',avecEventSurFermetureListe:false,avecFondSelectionSurSurvol:true,avecGrasSurSurvol:false,modifierContenuCelluleSurSelection:true,avecReservationPlaceBarreScroll:false,desactiverScrollInfini:false,nbBlocsScrollInfini:2,labelWAIZone:'',roleWAIZone:'',labelWAIEdit:'',roleWAIEdit:'',labelledById:'',roleWAIList:EGenreRole.Listbox,avecBoutonsPrecSuiv:false,avecBoutonsPrecSuivVisiblesInactifs:true,avecBoutonsPrecSuiv_boucle:false,optionsBouton:{},surValidation:null,getInfosElementCB:null,getLibelleCelluleMultiSelection:function(aListeSelections){return aListeSelections?aListeSelections.getTableauLibelles().join(', '):'';},getLibelleBoutonValider:function(aNombreSelectionnes,aNombre){return aNombre>0?GChaine.Format('%s (%d / %d)',[GTraductions.getValeur('Valider'),aNombreSelectionnes,aNombre]):GTraductions.getValeur('Valider');},surEditionRecherche:null,nbCarMinRecherche:2,delaiSurEditionRecherche:500,rechercheTout:['','*'],avecSurlignageSuggestion:true,couleurSurlignageSuggestion:GCouleur.surlignageTexte,avecSurlignageElement:null,callbackToutCalcule:null,dureeAnimationDeploiement:150};}
setOptions_ObjetSaisie(aOptions){$.extend(this._options,aOptions);const lEstListeOuCombo=MethodesTableau.existe(this._options.mode,[EGenreSaisie.Combo]),lAvecSaisieRechercheDynamique=_avecSaisieRechercheDynamique.call(this);const lOptionsBouton=$.extend({estSaisissable:!lEstListeOuCombo,avecZoneSaisie:!lEstListeOuCombo,genreBouton:this._options.avecBouton?lEstListeOuCombo?EGenreBoutonCellule.Fleche:EGenreBoutonCellule.Loupe:EGenreBoutonCellule.Aucun,largeur:this._options.avecDesignMobile&&IE.estMobile?'100%':this._options.longueur,hauteur:this._options.hauteur||undefined,iconeGauche:this._options.avecBoutonsPrecSuiv?'':this._options.iconeGauche,classTexte:this._options.classTexte,classBackground:this._options.classBackground,placeHolder:this._options.placeHolder,desactiverAideSaisie:this._options.desactiverAideSaisie||this._options.mode===EGenreSaisie.SaisieRecherche,roleWAIZone:this._options.roleWAIZone||EGenreRole.Combobox,roleWAIEdit:this._options.roleWAIEdit||undefined,labelWAIZone:this._options.labelWAIZone||undefined,labelledById:this._options.labelledById||(this._options.texteEdit?this.NomLabel:undefined),owns:lEstListeOuCombo?this.NomListe:'',setValue:this._options.mode===EGenreSaisie.SaisieRecherche?_modificationSaisieBoutonRecherche.bind(this):null,editAvecTrim:lAvecSaisieRechercheDynamique,selectionSaisieSurFocus:lAvecSaisieRechercheDynamique},aOptions.optionsBouton);this.bouton.setOptions_ObjetCelluleBouton(lOptionsBouton);this.$refreshSelf();return this;}
chercherIndiceSelectionSelonSens(aIndice,aPrecedent,aEnBoucle,aMethodeSelec){if(!this.ListeElements||!this.ListeElements.GetNbrElements){return-1;}
let lIndice=aIndice;const lNbr=this.ListeElements.GetNbrElements();if(lIndice!==null&&lIndice!==undefined){while(lIndice<lNbr&&
lIndice>=0&&(!_estSelectionnable.call(this,this.ListeElements.GetElement(lIndice))||(aMethodeSelec&&aMethodeSelec({element:this.ListeElements.GetElement(lIndice)})!==true))){lIndice+=aPrecedent?-1:1;}} else{lIndice= -1;}
if(lIndice>=lNbr){lIndice= -1;}
if(aEnBoucle&&lIndice=== -1){return this.chercherIndiceSelectionSelonSens(aPrecedent?lNbr-1:0,aPrecedent,false,aMethodeSelec);}
return lIndice;}
getControleur(aInstance){return $.extend(true,super.getControleur(this),{ifLibelleHaut:function(){return!!aInstance._options.libelleHaut;},htmlLibelleHaut:function(){return aInstance._options.libelleHaut;},getTitleHtml:function(aChaine){return aChaine;},listeEventOut:function(){return{nodesExclus:[GHtml.getElement(aInstance.bouton.Nom)],callback:function(){if(aInstance.listeDeroulee&&aInstance.activerEventOut){_declencherFermetureListe.call(aInstance);}}};},nodeOverlay(){$(this.node).on({click(){_declencherFermetureListe.call(aInstance,true);}});},btnSuivPrec:{event:function(aPrecedent){_surPrecedentSuivant.call(this.instance,aPrecedent);},getDisabled:function(aPrecedent){return!_boutonPrecSuivOK.call(this.instance,aPrecedent);},getStyle:function(aPrecedent){if(this.instance._options.avecBoutonsPrecSuivVisiblesInactifs){return;}
return{visibility:_boutonPrecSuivOK.call(this.instance,aPrecedent)?'':'hidden'};}},getNodeBouton(){$(this.node).on({'swipeleft':function(){if(aInstance._options.avecBoutonsPrecSuiv&&_boutonPrecSuivOK.call(aInstance,false)){_surPrecedentSuivant.call(aInstance,false);}},'swiperight':function(){if(aInstance._options.avecBoutonsPrecSuiv&&_boutonPrecSuivOK.call(aInstance,true)){_surPrecedentSuivant.call(aInstance,true);}}});},getClassesDynamiques:function(){const lClasses=[];if(!aInstance.getActif()){lClasses.push('input-wrapper-disabled');}
return lClasses.join(' ');},getNodeContenu:function(){$(this.node).on('keydown',function(aEvent){if(!aEvent.altKey&&(aEvent.which===ToucheClavier.FlecheBas||aEvent.which===ToucheClavier.FlecheHaut)){aEvent.preventDefault();}});if(aInstance.cache.scrollInfiniActif){$(this.node).on('scroll',function(){_majBlocsDeTop.call(aInstance,this.scrollTop);});}},getAttrWAIOption:function(aLigne){const lResult={};if(this.instance._options.multiSelection){lResult[GObjetWAI.getAttribut(EGenreAttribut.selected)]=''+(!!this.instance._listeSelections.GetElementParElement(this.instance.ListeElements?this.instance.ListeElements.GetElement(aLigne):null));} else{lResult[GObjetWAI.getAttribut(EGenreAttribut.selected)]=''+(this.instance.Selection===aLigne);}
return lResult;},cbElement:{getValue:function(aIndice){return getValueElementCB.call(this.instance,aIndice);},setValue:function(aIndice,aValue){_setValueElementCB.call(this.instance,aIndice,aValue);},getIndeterminate:function(aIndice){const lInfos=this.instance._infosElementsCbs?this.instance._infosElementsCbs[aIndice]:null;if(lInfos){const lSelection=_getSelectionElement.call(this.instance,lInfos,aIndice);return lSelection.nbFilsSelectionne>0&&lSelection.nbFilsSelectionne<lSelection.nbFils;}
return false;},getDisabled:function(aIndice){const lInfos=this.instance._infosElementsCbs?this.instance._infosElementsCbs[aIndice]:null;if(lInfos){return lInfos.nonEditable;}
return false;}},getNodeCBMulti:function(){$(this.node).on({'mouseenter mouseleave':function(event){if(event.type==='mouseenter'){_selectionLigne.call(aInstance,aInstance.Survolee,false);aInstance.Survolee= -1;}}});},btnValidationCB:{event:function(aEvent){aEvent.stopPropagation();this.instance.SurValidation(true,-1,{validationMultiSelection:true});},getDisabled:function(){let lDisabled=false;if(aInstance._options.avecElementObligatoire){let lNbSelectionnes=0;aInstance.ListeElements.parcourir(function(aElement,aIndex){const lInfosCBs=aInstance._infosElementsCbs?aInstance._infosElementsCbs[aIndex]:null;if(lInfosCBs&&!lInfosCBs.estCumul&&_estSelectionnable.call(aInstance,aElement)){if(lInfosCBs.selectionne){lNbSelectionnes+=1;}}});lDisabled=(lNbSelectionnes===0);}
return lDisabled;},getNode:function(){$(this.node).on({mouseover:function(){_survolBoutonMultiSelection.call(aInstance);}});},getHtml:function(){let lNb=0;let lNbSelectionnes=0;if(aInstance.ListeElements){aInstance.ListeElements.parcourir(function(aElement,aIndex){const lInfosCBs=aInstance._infosElementsCbs?aInstance._infosElementsCbs[aIndex]:null;if(lInfosCBs&&!lInfosCBs.estCumul&&_estSelectionnable.call(aInstance,aElement)){lNb+=1;if(lInfosCBs.selectionne){lNbSelectionnes+=1;}}});}
return aInstance._options.getLibelleBoutonValider(lNbSelectionnes,lNb);}},getNodeListeVide:function(){$(this.node).eventValidation(function(){aInstance.FermerListe();});}});}
SetParametres(AMode,ALongueur,AAvecBouton,aAvecStyleSite,aControlerNbrElements,aHauteur,aClassTexte){this.setOptions_ObjetSaisie({mode:AMode,longueur:ALongueur===null||ALongueur===undefined?undefined:ALongueur,hauteur:aHauteur,avecBouton:AAvecBouton===null||AAvecBouton===undefined?undefined:AAvecBouton,controlerNbrElements:aControlerNbrElements,classTexte:aClassTexte});GLog.addLog('ObjetSaisie.SetParametres deprecated!',null,GLog.genre.Deprecated);}
setLabel(aTexte,aClass,aStyle){this._options.texteEdit=aTexte;$.extend(this._options,{classTexteEdit:aClass?aClass:undefined,styleTexteEdit:aStyle?aStyle:undefined});const lElementLabel=GHtml.getElement(this.NomLabel);if(GHtml.estElement(lElementLabel)){GHtml.setHtml(lElementLabel,GChaine.Insecable(this._options.texteEdit)+'&nbsp;');if(this._options.classTexteEdit){GHtml.setClass(lElementLabel,this._options.classTexteEdit);}
if(this._options.styleTexteEdit){GStyle.setStyle(lElementLabel,this._options.styleTexteEdit);}}}
RecupererDonnees(){this.setOptions_ObjetSaisie({});this.bouton.Initialiser();}
ConstruireAffichage(){$('#'+this.idContenu.escapeJQ()).stop(true,true);const lOuvertureModale=_estOuvertureModale.call(this);let H='';const LFor=(this._options.labelWAIZone||MethodesTableau.existe(this._options.mode,[EGenreSaisie.Combo]))?'':'for="'+this.bouton.NomEdit+'"';const lDesignMobile=this._options.avecDesignMobile&&IE.estMobile;H+='<div ie-if="ifLibelleHaut" ie-html="htmlLibelleHaut" ></div>';H+='<div class="input-wrapper ObjetSaisie'+((this._options.longueur==='100%'||lDesignMobile)?' ObjetSaisie_100P':'')+(lDesignMobile?' design-mobile':'')+(lOuvertureModale?' open-up':'')+'" ie-class="getClassesDynamiques" '+GObjetWAI.composeRole(EGenreRole.Presentation)+' id="'+this.idWrapperBouton+'">';if(this._options.texteEdit){if(this._options.largeurTexteEdit){H+='<div style="'+GStyle.composeWidth(this._options.largeurTexteEdit)+'">';}
const lStyleTextEdit=this._options.couleurTexteEdit?'style="'+GStyle.composeCouleurTexte(this._options.couleurTexteEdit)+'"':this._options.styleTexteEdit?'style="'+this._options.styleTexteEdit+'"':'';H+='<label id="'+this.NomLabel+'" class="'+((this._options.classTexteEdit!==null&&this._options.classTexteEdit!==undefined)?this._options.classTexteEdit:' Gras')+'" '+LFor+' '+lStyleTextEdit+'>'+GChaine.Insecable(this._options.texteEdit)+'&nbsp;</label>';if(this._options.largeurTexteEdit){H+='</div>';}}
if(this._options.avecBoutonsPrecSuiv){H+=tag('ie-btnicon',{class:['icon_angle_left',lDesignMobile?'':'icon btnImageIcon'],'ie-model':'btnSuivPrec(true)','ie-style':'getStyle',title:GTraductions.getValeur('Precedent')});}
H+='<div class="ObjetSaisie_cont">';H+='<div  id="'+this.bouton.GetNom()+'" ie-node="getNodeBouton"></div>';const lHtmlList=tag('div',{role:GObjetWAI.WaiRole[this._options.roleWAIList],'aria-labelledby':this.bouton.NomEdit,id:this.NomListe,'ie-eventout':lOuvertureModale?false:'listeEventOut',class:['deroulant-conteneur-show-hide',IE.estMobile||GNavigateur.isTactile?' is-tactile':''],style:lOuvertureModale?false:'display: none;',tabIndex:-1});if(lOuvertureModale){let lZIndex=2000;$(`#${this.nomListeConteneur.escapeJQ()}`).remove();IEHtml.injectHTMLParams({element:ZoneFenetre.getElementZoneFenetre(),html:tag('div',{id:this.nomListeConteneur,class:'ObjetSaisie ObjetSaisie-modal',style:`z-index:${lZIndex}`},lHtmlList+tag('div',{class:'overlay','ie-node':'nodeOverlay'})),controleur:this.controleur});} else{H+=lHtmlList;}
H+='</div>';if(this._options.avecBoutonsPrecSuiv){H+=tag('ie-btnicon',{class:['icon_angle_right',lOuvertureModale?'':'icon btnImageIcon'],'ie-model':'btnSuivPrec(false)','ie-style':'getStyle',title:GTraductions.getValeur('Suivant')});}
H+='</div>';H+='</div>';return H;}
SetSelection(ASelection){const lIndice=this.chercherIndiceSelectionSelonSens(ASelection,false);if(lIndice>=0){if(this._options.multiSelection){_selectionnerUnElementEnMultiSelection.call(this,lIndice);}
this.SurValidation(false,lIndice);}}
SurSelection(aParams){if((this.getNbElementsVisible()>0||!this._options.deroulerListeSeulementSiPlusieursElements)&&!this.ActualiserListe){_deroulerListe.call(this);} else{this.SurValidation(false,undefined,aParams);}}
DeroulerListe(){_deroulerListe.call(this);}
SurValidation(aInteractionUtilisateur,ASelection,aParams){this.InteractionUtilisateur=aInteractionUtilisateur;this.cache.surDemandeSaisieRechercheTout=false;const lParams=Object.assign({saisieRecherche:false,validationMultiSelection:false,surBoutonCellule:false},aParams);const lEstMultiSelection=this._options.multiSelection;if(!this.ListeElements||
!this.ListeElements.GetElement(ASelection)||
_estSelectionnable.call(this,this.ListeElements.GetElement(ASelection))){this.Selection=ASelection;this.FermerListe(true);this.$refreshSelf();clearTimeout(this._timerEditionRecherche);let LValeur;const lEditionEnCours=this.cache.editionEnCours;this.cache.editionEnCours=false;if(lEstMultiSelection){if(!this._listeSelections){this._listeSelections=new ObjetListeElements();}
this._listeSelections.vider();const lListeIndices=[];if(this.ListeElements){this.ListeElements.parcourir(function(D,aIndex){const lInfos=this._infosElementsCbs?this._infosElementsCbs[aIndex]:null;if(lInfos&&ASelection===aIndex&&lInfos.estCumul){this.Selection= -1;}
if(lInfos&&!lInfos.estCumul&&lInfos.selectionne){this._listeSelections.AddElement(D);lListeIndices.push(aIndex);}}.bind(this));}
let lMAJContenu=lParams.validationMultiSelection||this.Selection>=0||this._listeSelections.GetNbrElements()>0;if(lParams.surBoutonCellule&&this._options.mode===EGenreSaisie.SaisieRecherche&&!lEditionEnCours){LValeur='';lMAJContenu=false;this.cache.surDemandeSaisieRechercheTout=true;} else if(lParams.saisieRecherche||lEditionEnCours||(this._options.mode===EGenreSaisie.SaisieRecherche&&this._listeSelections.GetNbrElements()===0&&!lParams.validationMultiSelection)){LValeur=this.GetContenu();} else{LValeur=this._options.getLibelleCelluleMultiSelection(this._listeSelections);}
if(this._options.modifierContenuCelluleSurSelection&&lMAJContenu){this.SetContenu(LValeur);}
$('#'+this.NomListe.escapeJQ()+', #'+this.bouton.NomEdit.escapeJQ()).attr(GObjetWAI.getAttribut(EGenreAttribut.activedescendant),this.Nom+'_'+lListeIndices.join(','+this.Nom+'_'));} else if(ASelection>=0){const lElement=this.ListeElements.GetElement(this.Selection);LValeur=lElement?lElement.GetLibelle():'';if(this._options.modifierContenuCelluleSurSelection){if(this._options.getContenuCellule){_appliquerGetContenuCellule.call(this,lElement);} else if(this._options.celluleAvecTexteHtml&&lElement&&lElement.libelleHtml){this.bouton.setLibelleHtml(lElement.libelleHtml);} else{this.SetContenu(LValeur);}
$('#'+this.NomListe.escapeJQ()+', #'+this.bouton.NomEdit.escapeJQ()).attr(GObjetWAI.getAttribut(EGenreAttribut.activedescendant),this.Nom+'_'+ASelection);}} else{if(lParams.surBoutonCellule&&this._options.mode===EGenreSaisie.SaisieRecherche&&!lEditionEnCours){LValeur='';this.cache.surDemandeSaisieRechercheTout=true;} else{LValeur=MethodesTableau.existe(this._options.mode,[EGenreSaisie.Combo])?'*':this.GetContenu();}}
if((ASelection>=0||lEstMultiSelection)&&this.ControleNavigation&&ControleSaisieEvenement){ControleSaisieEvenement(_retourSurNavigation.bind(this,Object.assign({valeur:LValeur,retourSaisieAnnule:true},lParams)));} else{_retourSurNavigation.call(this,Object.assign({valeur:LValeur,retourSaisieAnnule:false},lParams));}}}
_remplirListe(){const lHeightScroll=this.cache.heightScroll;this.cache={scrollInfiniActif:false,blocs:[],nbVisibles:0,toutCalcule:false,heightScroll:lHeightScroll,largeurCellule:this._options.avecDesignMobile&&IE.estMobile?'100%':this._options.longueur,editionEnCours:false,surDemandeSaisieRechercheTout:this.cache.surDemandeSaisieRechercheTout};if(!this.ListeElements){if(this._options.multiSelection){this._infosElementsCbs={};}
return;}
_trierElements.call(this);let lBlocs={debut:0,fin:0,lignesVisibles:[]};let lNb=0;let lTailleMaxLibelle=0;this.cache.blocs.push(lBlocs);this.ListeElements.parcourir(function(aElement,aIndex){if(lNb>=this._options.nbrLignes){lBlocs={debut:aIndex,fin:aIndex,lignesVisibles:[]};this.cache.blocs.push(lBlocs);lNb=0;}
lBlocs.debut=Math.min(lBlocs.debut,aIndex);lBlocs.fin=Math.max(lBlocs.debut,aIndex);if(aElement.Existe()&&aElement.Visible!==false){lNb+=1;lBlocs.lignesVisibles.push(aIndex);this.cache.nbVisibles+=1;if(this._options.estLargeurAuto&&MethodesObjet.isFunction(this._options.getTailleElementlargeurAuto)){lTailleMaxLibelle=Math.max(lTailleMaxLibelle,this._options.getTailleElementlargeurAuto(aElement,this._options.classTexte==='Gras'));}}}.bind(this));if(this._options.estLargeurAuto&&lTailleMaxLibelle&&$.isNumeric(this.cache.largeurCellule)){this.cache.largeurCellule=Math.min(Math.max(lTailleMaxLibelle,this._options.largeurAutoMin),this._options.largeurAutoMax);this.bouton.setLargeur(this.cache.largeurCellule);}
this.cache.scrollInfiniActif=!this._options.desactiverScrollInfini&&
this.cache.blocs.length>(2*this._options.nbBlocsScrollInfini+2)&&
this.cache.nbVisibles>100;this.cache.avecCBMultiSelection=false;if(this._options.multiSelection){if(!this._infosElementsCbs){this._infosElementsCbs={};}
this.ListeElements.parcourir(function(aElement,aIndex){if(aElement.Existe()&&aElement.Visible!==false){_initInfosElementsCBs.call(this,aIndex);if(this._infosElementsCbs[aIndex].avecCB){this.cache.avecCBMultiSelection=this._infosElementsCbs[aIndex].avecCB;}}}.bind(this));}
if(this.cache.nbVisibles===0&&this._options.deroulerListeSeulementSiPlusieursElements){return;}
if($('#'+this.Nom.escapeJQ()).length===0){return;}
let lLargeurListe=_getLargeurListe.call(this),lCompteurLigne=0,lNumeroDerniereLigne=0,lNumeroLigneReference= -1,lHeightBoutonTactile=36,lEstMultiSelection=this._options.multiSelection,lAvecScroll=false;this.cache.recherchesSurlignage=null;this.cache.avecSurlignage=this._options.avecSurlignageSuggestion&&this._options.mode===EGenreSaisie.SaisieRecherche;const lEstOuvertureModale=_estOuvertureModale.call(this);if(!lEstOuvertureModale){$('#'+this.idWrapperBouton.escapeJQ()).css('position','relative');$('#'+this.NomListe.escapeJQ()).css('width',lLargeurListe);}
if(lEstMultiSelection&&!this._infosElementsCbs){this._infosElementsCbs={};}
if(this.cache.avecSurlignage&&!this.cache.surDemandeSaisieRechercheTout){const lRecherche=this.bouton.getLibelle().trim();if(lRecherche&&lRecherche.length>0&&(!this._options.rechercheTout||!MethodesTableau.existe(lRecherche,this._options.rechercheTout))){this.cache.recherchesSurlignage=lRecherche.split(' ');}}
if(!_avecDeroulerListe.call(this)){return;}
const T=[];T.push('<div role="presentation" ',(this._options.couleurFondDeroulant)?+'style="'+GStyle.composeCouleurFond(this._options.couleurFondDeroulant)+'">':'>');lLargeurListe=lLargeurListe-1;let lEnteteListe;if(MethodesObjet.isFunction(this._options.getEnteteListe)){lEnteteListe=this._options.getEnteteListe(this);if(lEnteteListe&&lEnteteListe.html){T.push('<div class="ObjetSaisie_entete_liste"></div>');}}
T.push('<div id="'+this.idContenu+'" tabIndex="-1" ie-node="getNodeContenu"',' style="height:0px; overflow-y: auto; overflow-x: hidden;',(lEstOuvertureModale?'':GStyle.composeWidth(lLargeurListe)),'"',' ',GObjetWAI.composeRole(EGenreRole.Presentation),'>');this.ListeElements.parcourir(function(aElement,aIndex){if(aElement.Existe()&&aElement.Visible!==false){lNumeroDerniereLigne=aIndex;lCompteurLigne+=1;if(lCompteurLigne===this._options.nbrLignes){lNumeroLigneReference=aIndex;}
if(lCompteurLigne>this._options.nbrLignes){lAvecScroll=true;}}}.bind(this));this.cache.largeurContenu=lLargeurListe-(GNavigateur.GetLargeurBarreDeScroll&&(lAvecScroll||this._options.avecReservationPlaceBarreScroll)?GNavigateur.GetLargeurBarreDeScroll()-2:0);T.push('<ul class="liste-as-options',(this.cache.avecCBMultiSelection?' multi-selections ':''),'" id="',this.idContenuScroll,'" role="presentation">');const lEstContenuVide=this.cache.nbVisibles===0;if(lEstContenuVide){T.push('<li ie-node="getNodeListeVide"><div class="as-li ObjetSaisie_contenuvide">',GTraductions.getValeur('Navigation.ObjetSaisieVide'),'</div></li>');} else{if(this.cache.scrollInfiniActif){for(let i=0;i<=this._options.nbBlocsScrollInfini;i++){T.push(_composeBloc.call(this,this.cache.blocs[i],i));}} else{this.cache.blocs.forEach(function(aBloc,aIndex){T.push(_composeBloc.call(this,aBloc,aIndex));}.bind(this));}}
T.push('</ul>');T.push('</div>');let lPiedListe;if(MethodesObjet.isFunction(this._options.getPiedListe)){lPiedListe=this._options.getPiedListe(this);if(lPiedListe&&lPiedListe.html){T.push('<div class="ObjetSaisie_pied_liste"></div>');}}
if(lEstMultiSelection){T.push('<div class="validate-conteneur">');T.push('<ie-bouton ie-model="btnValidationCB" ie-node="getNode" ie-html="getHtml" class="'+TypeThemeBouton.primaire+'" id="',this.idBtnValidation,'"',(this.modeTactile?'style="'+GStyle.composeHeight(lHeightBoutonTactile)+'"':''),'>','</ie-bouton>');T.push('</div>');}
if(GHtml.elementExiste(this.NomListe)){GHtml.setDisplay(this.NomListe,true);if(lEstOuvertureModale){const lConteneur=GHtml.getElement(this.nomListeConteneur);lConteneur.classList.add('visible');}
GHtml.setHtml(this.NomListe,T.join(''),{controleur:this.controleur,ignorerScroll:true});if(lEnteteListe&&lEnteteListe.html){$('#'+this.NomListe.escapeJQ()+' .ObjetSaisie_entete_liste').IEHtml(lEnteteListe.html,{controleur:lEnteteListe.controleur,instance:this});}
if(lPiedListe&&lPiedListe.html){$('#'+this.NomListe.escapeJQ()+' .ObjetSaisie_pied_liste').IEHtml(lPiedListe.html,{controleur:lPiedListe.controleur,instance:this});}
if(this.cache.scrollInfiniActif){let lTop=0,lNbLignesVisibles=0,lAvecBlocInvisible=false;this.cache.blocs.forEach(function(aBloc,aNumeroBloc){if(aBloc.dessine){_majBloc.call(this,aNumeroBloc);lTop+=aBloc.height;lNbLignesVisibles+=aBloc.lignesVisibles.length;} else{lAvecBlocInvisible=true;}}.bind(this));if(!this.cache.heightScroll){this.cache.heightScroll=lTop;if(lAvecBlocInvisible){this.cache.heightScroll=lTop/lNbLignesVisibles*this.cache.nbVisibles;}}
$('#'+this.idContenuScroll.escapeJQ()).height(this.cache.heightScroll);_majBlocsTacheFond.call(this);}
const lEventMap={'focusin.saisie':_surFocusLigne,'pointerdown.saisie':function(event){const T=this.id.split('_');const lIndice=parseInt(T[T.length-1],10);event.data.instance.SurLigne(lIndice);},'click.saisie':_surClickListe,'mousemove.saisie':_surMouseMoveListe};$('#'+this.NomListe.escapeJQ()).off(lEventMap).on(lEventMap,'.'+lClasseJQ,{instance:this});const lEventMap2={focusin:_surFocusLigne,keydown:_surKeyDownListe,keyup:_surKeyUpListe};$('#'+this.NomListe.escapeJQ()).off(lEventMap2).on(lEventMap2,{instance:this});}
if(lNumeroLigneReference<0){lNumeroLigneReference=lNumeroDerniereLigne;}
this._ouvertureInverse=false;if(!lEstOuvertureModale){const lJLigne=lEstContenuVide?$('#'+this.Nom.escapeJQ()+' .ObjetSaisie_contenuvide'):$('#'+this.Nom.escapeJQ()+'_'+lNumeroLigneReference);if(lJLigne.length>0){this.hauteurContenu=lJLigne.position().top+lJLigne.outerHeight(true);} else{this.hauteurContenu=0;}
if(lEstMultiSelection){this.hauteurContenu+=1;}
const lDecalageOmbre=1;const lJBouton=$('#'+this.bouton.GetNom().escapeJQ());let lPositionBouton=lJBouton.position();if(!lPositionBouton){lPositionBouton={top:0,left:0};}
const lRectOverflow=GPosition.getClientRect(GHtml.getParentOverflowNonVisible(lJBouton.get(0)));const lRectBouton=GPosition.getClientRect(lJBouton.get(0)),lJListe=$('#'+this.NomListe.escapeJQ());const lCorrectionHauteur=lDecalageOmbre+5+GPosition.remToPixels(1.2)+(lEstMultiSelection?$('#'+this.NomListe.escapeJQ()+' .validate-conteneur').outerHeight():0)+(lEnteteListe&&lEnteteListe.html?$('#'+this.NomListe.escapeJQ()+' .ObjetSaisie_entete_liste').outerHeight()+GPosition.remToPixels(0.4*2):0)+(lPiedListe&&lPiedListe.html?$('#'+this.NomListe.escapeJQ()+' .ObjetSaisie_pied_liste').outerHeight()+GPosition.remToPixels(0.4*2):0);const lHauteurVersBas=Math.min(lRectOverflow.bottom,GNavigateur.EcranH)-lRectBouton.bottom-lCorrectionHauteur;const lHauteurVersHaut=lRectBouton.top-lCorrectionHauteur-lRectOverflow.top;this.decalageTopOuvertureInverse=lCorrectionHauteur-3;if(this.hauteurContenu>lHauteurVersBas&&lHauteurVersHaut>20&&lHauteurVersHaut*2/3>lHauteurVersBas){this._ouvertureInverse=true;this.hauteurContenu=Math.min(this.hauteurContenu,lHauteurVersHaut);if(lJListe.length){lJListe.css({top:-(lRectBouton.height+lDecalageOmbre)+'px'});}} else{if(lJListe.length){lJListe.css({top:(lRectBouton.height+lDecalageOmbre)+'px'});}
this.hauteurContenu=Math.min(this.hauteurContenu,lHauteurVersBas);}
let lLeft=lPositionBouton.left;if(this._options.largeurListe){const lLeftAbs=GPosition.getLeft(this.Nom);const lWidthListe=$('#'+this.NomListe.escapeJQ()).width();if(lLeftAbs+lWidthListe>GNavigateur.ClientL){lLeft=Math.max(-lLeftAbs+2 ,GPosition.getWidth(this.Nom)-lWidthListe);}}
lJListe.css({left:lLeft});} else{const lJContenu=$(`#${this.idContenu.escapeJQ()}`);const lHeightContenu_bak=lJContenu.height();lJContenu.height('auto');const lHeightScroll=GPosition.getClientRect(this.idContenuScroll).height;const lNodeListe=GHtml.getElement(this.NomListe);this.hauteurContenu=Math.max(20,lHeightScroll-(lNodeListe.scrollHeight-lNodeListe.clientHeight));this.hauteurContenu=Math.floor(this.hauteurContenu);lJContenu.height(lHeightContenu_bak);}
if(this.cache.largeurCellule===0){this.cache.largeurCellule=GHtml.getElement(this.NomListe).scrollWidth;this.bouton.setLargeur(this.cache.largeurCellule);GPosition.setWidth(this.NomListe,this.cache.largeurCellule);}
GHtml.setDisplay(this.NomListe,false);if(lEstOuvertureModale){GHtml.getElement(this.nomListeConteneur).classList.remove('visible');}}
getNbElementsVisible(){let lResult=0;if(this.ListeElements){for(let i=0,lNb=this.ListeElements.GetNbrElements();i<lNb;i++){const lElement=this.ListeElements.GetElement(i);if(lElement.Existe()&&lElement.Visible!==false){lResult++;}}}
return lResult;}
FermerListe(AAvecFocus){if(this.Selection>=0){_majBlocsDeLigne.call(this,this.Selection,true);}
if(this.listeDeroulee){_arreterFermetureListe.call(this);clearTimeout(this._timerEditionRecherche);clearTimeout(this.cache.timerMAJ);_selectionLigne.bind(this)(this.Survolee,false);this.Survolee= -1;if(AAvecFocus){this.SetFocus();}
this.listeDeroulee=false;this.activerEventOut=false;this.bouton.setOptions_ObjetCelluleBouton({ariaExpanded:false});const lElementListe=GHtml.getElement(this.NomListe);const lElementContenuListe=GHtml.getElement(this.idContenu);if(GHtml.estElement(lElementListe)&&GHtml.estElement(lElementContenuListe)){lElementContenuListe.style.overflowY='hidden';if(!_estOuvertureModale.call(this)){GStyle.setZindex(lElementListe,200);}
const lObjet=this;if(this._ouvertureInverse){$(lElementListe).css({top:-lObjet.hauteurContenu-this.decalageTopOuvertureInverse});}
$(lElementContenuListe).css({height:lObjet.hauteurContenu}).animate({height:0},{duration:this._options.dureeAnimationDeploiement,step:this._ouvertureInverse?_etapeFermetureInverse.bind(this,$(lElementListe)):null,complete:_eventAnimationFermetureFin.bind(this)});}}}
SurLigne(ASurvolee,aSansFocusLigne){if(!this.listeDeroulee){return;}
const lAvecFocus=aSansFocusLigne!==true;if(this.Survolee!==ASurvolee&&MethodesObjet.isNumber(ASurvolee)){_majBlocsDeLigne.call(this,ASurvolee);const N=this.ListeElements.GetNbrElements();if(_estSelectionnable.call(this,this.ListeElements.GetElement(ASurvolee))){if((this.Survolee> -1)&&(this.Survolee<N)){_selectionLigne.bind(this)(this.Survolee,false);}
this.Survolee=ASurvolee;_selectionLigne.bind(this)(this.Survolee,true);}
const lElementContenu=GHtml.getElement(this.idContenu);if(lElementContenu){const lJContenuElement=$('#'+this.Nom.escapeJQ()+'_'+this.Survolee);if(lJContenuElement.length===1){if(this.Survolee===0){lElementContenu.scrollTop=0;} else{GPosition.scrollToElement(lJContenuElement.get(0),lElementContenu);}}}
if(lAvecFocus){GHtml.setFocus(this.Nom+'_'+this.Survolee);}} else if(ASurvolee=== -1){if(lAvecFocus){_majBlocsDeLigne.call(this,ASurvolee);GHtml.setFocus(this.NomListe);}}}
setDonnees_ObjetSaisie(aParams){const lParams=Object.assign({liste:null,selection:null,deroulerListe:false,actualiserListe:false,ignorerSelectionAutomatiqueAvecUnElement:false,options:null},aParams);if(lParams.options){this.setOptions_ObjetSaisie(lParams.options);}
if(this.listeDeroulee){this.FermerListe(false);}
clearTimeout(this.cache.timerMAJ);this.ListeElements=lParams.liste;this.ActualiserListe=lParams.actualiserListe;_trierElements.call(this);if(!this.ListeElements||this.getNbElementsVisible()===0){$('#'+this.bouton.NomEdit.escapeJQ()).attr(GObjetWAI.getAttribut(EGenreAttribut.label),GObjetWAI.InfoWai[EGenreObjet.ObjetSaisieVide]);}
this.listeDeroulee=false;this.activerEventOut=false;this.cache.heightScroll=0;let lAvecSelectionAutomatique=false;if(this._options.initAutoSelectionAvecUnElement&&!this._options.multiSelection&&!lParams.ignorerSelectionAutomatiqueAvecUnElement){lAvecSelectionAutomatique=_gererCasUnSeulElement.call(this);}
this._remplirListe();if(!lAvecSelectionAutomatique){this.SetSelection(lParams.selection);}
if(this._options.multiSelection&&lParams.selection instanceof ObjetListeElements){_initListeSelections.call(this,lParams.selection);}
if(lParams.deroulerListe&&(this.getNbElementsVisible()>1||!this._options.deroulerListeSeulementSiPlusieursElements)){_deroulerListe.call(this,lParams.selection?null:0);}}
SetDonnees(AListeElements,ASelection,ADeroulerListe,AActualiserListe){this.setDonnees_ObjetSaisie({liste:AListeElements,selection:ASelection,deroulerListe:ADeroulerListe,actualiserListe:AActualiserListe});}
SetFocus(){this.bouton.setFocus();if(_avecSaisieRechercheDynamique.call(this)){setTimeout(function(){GHtml.setCursorAtEnd(this.bouton.NomEdit);}.bind(this),0);}}
ViderContenu(){this.SetContenu('');$('#'+this.NomListe.escapeJQ()+', #'+this.bouton.NomEdit.escapeJQ()).attr(GObjetWAI.getAttribut(EGenreAttribut.activedescendant),'');}
SetContenu(AContenu){let lLibelle='';if(AContenu instanceof ObjetListeElements){lLibelle=this._options.getLibelleCelluleMultiSelection(AContenu);} else if(AContenu instanceof ObjetElement){lLibelle=AContenu.GetLibelle();} else{lLibelle=AContenu||'';}
this.bouton.setLibelle(lLibelle);}
GetContenu(){if(MethodesTableau.existe(this._options.mode,[EGenreSaisie.Combo])){return this.Selection> -1?this.ListeElements.GetElement(this.Selection).GetLibelle():'';} else{return this.bouton.getLibelle();}}
getListeElements(){return this.ListeElements;}
Reset(){this.SetDonnees(new ObjetListeElements());this.ViderContenu();}
GetSelection(){return this.Selection> -1?this.ListeElements.GetElement(this.Selection):null;}
initSelectionParNumeroEtGenre(ANumero,AGenre,AIndice){if((ANumero===null||ANumero===undefined)&&(AGenre===null||AGenre===undefined)){ANumero=0;}
if(this.ListeElements){let LIndice=this.ListeElements.GetIndiceParNumeroEtGenre(ANumero,AGenre);if(LIndice===null||LIndice===undefined){LIndice=AIndice;}
this.initSelection(LIndice);}}
initSelection(aSelection){this.Selection=aSelection>=0?aSelection:-1;if(this.Selection>=0&&this._options.modifierContenuCelluleSurSelection){const lElement=this.ListeElements.GetElement(this.Selection);if(lElement){if(this._options.getContenuCellule){_appliquerGetContenuCellule.call(this,lElement);} else if(this._options.celluleAvecTexteHtml&&lElement.libelleHtml){this.bouton.setLibelleHtml(lElement.libelleHtml);} else{this.SetContenu(lElement.GetLibelle());}
$('#'+this.NomListe.escapeJQ()+', #'+this.bouton.NomEdit.escapeJQ()).attr(GObjetWAI.getAttribut(EGenreAttribut.activedescendant),this.Nom+'_'+this.Selection);}}
this.$refreshSelf();}
SetSelectionParNumeroEtGenre(ANumero,AGenre,AIndice){let lResult=false;if((ANumero===null||ANumero===undefined)&&(AGenre===null||AGenre===undefined)){ANumero=0;}
if(this.ListeElements){let LIndice=this.ListeElements.GetIndiceParNumeroEtGenre(ANumero,AGenre);if(LIndice===null||LIndice===undefined){LIndice=AIndice;}
lResult=LIndice>=0;this.SetSelection(LIndice);}
return lResult;}
setSelectionParIndice(aIndice){if(this.ListeElements.GetNbrElementsExistes()<=1){return;}
this.SetSelection(aIndice);}
setSelectionParElement(aElement,aIndice){if(aElement){this.SetSelectionParNumeroEtGenre(aElement.GetNumero(),aElement.GetGenre(),aIndice);} else{this.SetSelectionParNumeroEtGenre(null,null,aIndice);}}
setListeSelections(aListeSelections){let lResult=false
;if(this._infosElementsCbs){lResult=_initListeSelections.call(this,aListeSelections);}
this.SurValidation(false,-1,{validationMultiSelection:true});return lResult;}
surPrecedentSuivant(aPrecedent){_surPrecedentSuivant.call(this,aPrecedent);}
SetActif(AActif){super.SetActif(AActif);this.bouton.SetActif(AActif);this.$refreshSelf();}}
function _avecSaisieRechercheDynamique(){return this._options.mode===EGenreSaisie.SaisieRecherche&&!_estOuvertureModale.call(this)&&!!this._options.surEditionRecherche;}
function _trierElements(){if(this._options.avecTriListeElements&&this.ListeElements){this.ListeElements.trier();}}
function _callbackRecherche(aParam){const lParam=Object.assign({liste:null},aParam);if(lParam.liste&&lParam.liste.GetNbrElements()>0){this.ListeElements=lParam.liste;_trierElements.call(this);this.FermerListe(false);_deroulerListe.call(this,0,false ,true);} else{this.FermerListe(false);}}
function _modificationSaisieBoutonRecherche(aValue){this.ListeElements=new ObjetListeElements();this.Selection= -1;const lValue=(aValue+'').trim();clearTimeout(this._timerEditionRecherche);if(lValue.length<this._options.nbCarMinRecherche){this.FermerListe(false);} else if(this._options.surEditionRecherche){this.cache.editionEnCours=true;if(_avecSaisieRechercheDynamique.call(this)){if(this._options.delaiSurEditionRecherche>=0){this._timerEditionRecherche=setTimeout(function(){this.cache.surDemandeSaisieRechercheTout=false;this._options.surEditionRecherche(lValue,_callbackRecherche.bind(this));}.bind(this),this._options.delaiSurEditionRecherche);} else{this.cache.surDemandeSaisieRechercheTout=false;this._options.surEditionRecherche(lValue,_callbackRecherche.bind(this));}}}}
function _boutonPrecSuivOK(aPrecedent){const lListe=this.ListeElements;if(!lListe||!lListe.GetNbrElements||lListe.GetNbrElements()<2){return false;}
if(!this.getActif()){return false;}
let lIndice=this.Selection;const lEnBoucle=this._options.avecBoutonsPrecSuiv_boucle;if(lIndice=== -1){if(aPrecedent){lIndice=lEnBoucle?0:-1;} else{return lListe.GetNbrElements()>0;}}
const lElement=lListe.GetElement(lIndice);if(!lElement){return false;}
if(aPrecedent&&lListe.GetElement(this.chercherIndiceSelectionSelonSens(lIndice-1,true,lEnBoucle,this._options.getElementSelectionnableParPrecSuiv))){return true;}
if(!aPrecedent&&lListe.GetElement(this.chercherIndiceSelectionSelonSens(lIndice+1,false,lEnBoucle,this._options.getElementSelectionnableParPrecSuiv))){return true;}
return false;}
function _parcourirFilsDeCumul(aIndice,aFunction){const lInfos=this._infosElementsCbs[aIndice];this.ListeElements.parcourir(function(D,aIndex){if(aIndice!==aIndex&&
D.Visible!==false&&(!lInfos.estFilsCumul||lInfos.estFilsCumul(D))){aFunction.call(this,D,aIndex);}},this);}
function _getSelectionElement(aInfos,aIndice){const lResult={selectionne:false,nbFils:0,nbFilsSelectionne:0};if(!aInfos.estCumul){lResult.selectionne=aInfos.selectionne;} else{_parcourirFilsDeCumul.call(this,aIndice,function(D,aIndex){lResult.nbFils+=1;const lInfosFils=this._infosElementsCbs[aIndex];if(lInfosFils&&lInfosFils.selectionne){lResult.nbFilsSelectionne+=1;}});lResult.selectionne=lResult.nbFilsSelectionne>0&&lResult.nbFilsSelectionne===lResult.nbFils;}
return lResult;}
function getValueElementCB(aIndice){const lInfos=this._infosElementsCbs?this._infosElementsCbs[aIndice]:null;if(lInfos){return _getSelectionElement.call(this,lInfos,aIndice).selectionne;}
return false;}
function _modifierSelectionElement(aIndice,aValue,aProfondeur){const lInfos=this._infosElementsCbs?this._infosElementsCbs[aIndice]:null
;if(lInfos){lInfos.selectionne=aValue;const lElementSource=this.ListeElements.GetElement(aIndice),lProfondeur=aProfondeur||0;if(lProfondeur>1){return;}
this.ListeElements.parcourir(function(D,aIndex){const lInfosElement=this._infosElementsCbs?this._infosElementsCbs[aIndex]:null;if(aIndice!==aIndex&&
D.Visible!==false&&
lInfosElement&&
!lInfosElement.estCumul&&
lInfosElement.setModifierSelection){const lResult=lInfosElement.setModifierSelection({elementCourantSelectionne:lInfosElement.selectionne,elementSource:lElementSource,elementSourceSelectionne:aValue});if((lResult===true&&lInfosElement.selectionne!==true)||(lResult===false&&lInfosElement.selectionne!==false)){_modifierSelectionElement.call(this,aIndex,lResult,lProfondeur+1);}}},this);}}
function _setValueElementCB(aIndice,aValue){const lInfos=this._infosElementsCbs?this._infosElementsCbs[aIndice]:null;if(lInfos){if(lInfos.estCumul){_parcourirFilsDeCumul.call(this,aIndice,function(D,aIndex){_modifierSelectionElement.call(this,aIndex,aValue);});} else{_modifierSelectionElement.call(this,aIndice,aValue);}}}
function _surPrecedentSuivant(aPrecedent){let lIndice=this.Selection;const lListe=this.ListeElements;const lEnBoucle=this._options.avecBoutonsPrecSuiv_boucle;const lMethodeSelec=this._options.getElementSelectionnableParPrecSuiv;if(this._options.multiSelection&&lListe){lListe.parcourir(function(D,aIndex){const lInfos=this._infosElementsCbs?this._infosElementsCbs[aIndex]:null;if(lInfos&&!lInfos.estCumul&&lInfos.selectionne){lIndice=aIndex;if(aPrecedent){return false;}}},this);}
if(lIndice=== -1&&aPrecedent){lIndice=lEnBoucle?0:-1;}
if(MethodesObjet.isNumber(lIndice)&&lListe&&lListe.GetElement){if(aPrecedent&&(lListe.GetElement(lIndice-1)||lEnBoucle)){lIndice=this.chercherIndiceSelectionSelonSens(lIndice-1,true,lEnBoucle,lMethodeSelec);} else if(!aPrecedent&&(lListe.GetElement(lIndice+1)||lEnBoucle)){lIndice=this.chercherIndiceSelectionSelonSens(lIndice+1,false,lEnBoucle,lMethodeSelec);}
if(lIndice>=0){if(this._options.multiSelection){lListe.parcourir(function(D,aIndex){const lInfos=this._infosElementsCbs?this._infosElementsCbs[aIndex]:null;if(lInfos&&lInfos.selectionne){lInfos.selectionne=false;}},this);_setValueElementCB.call(this,lIndice,true);this.SurValidation(true,lIndice);} else{this.SurValidation(true,lIndice);}}}}
function _getLargeurListe(){return this.modeTactile?(window.innerWidth||document.body.offsetWidth)/2:this._options.largeurListe?this._options.largeurListe:$('#'+this.bouton.GetNom().escapeJQ()).width();}
function _surEvenementBouton(aGenreEvent,aEvent,aEvenementSurEdit){switch(aGenreEvent){case EEvent.SurMouseDown:if(aEvenementSurEdit){if(MethodesTableau.existe(this._options.mode,[EGenreSaisie.Combo])){this.SurSelection();}} else{this.SurSelection({surBoutonCellule:true});}
break;case EEvent.SurKeyUp:switch(this._options.mode){case EGenreSaisie.Combo:{if(!this.listeDeroulee){if(aEvent.which===ToucheClavier.FlecheHaut||aEvent.which===ToucheClavier.FlecheBas){_deroulerListe.call(this);} else if(aEvent.which===ToucheClavier.Debut){_deroulerListe.call(this,0);} else if(aEvent.which===ToucheClavier.Fin){_deroulerListe.call(this,_getDerniereLingeSelectionnable.call(this));}}
if(!this.listeDeroulee&&!aEvent.altKey&&(aEvent.which===ToucheClavier.FlecheGauche||aEvent.which===ToucheClavier.FlecheDroite)&&!this._options.multiSelection){_surPrecedentSuivant.call(this,aEvent.which===ToucheClavier.FlecheGauche);}
break;}
case EGenreSaisie.SaisieRecherche:{const lNbVisibles=this.getNbElementsVisible();if(!this.listeDeroulee&&
aEvent.which===ToucheClavier.FlecheBas&&(lNbVisibles>0||!this._options.deroulerListeSeulementSiPlusieursElements)){_deroulerListe.call(this,0 ,true);} else{_defilerFleches.call(this,aEvent);}
if(ToucheClavier.estEventRetourChariot(aEvent)){if(this.listeDeroulee&&(lNbVisibles>0||!this._options.deroulerListeSeulementSiPlusieursElements)){this.SurValidation(true,this.Selection>=0?this.Selection:0);} else if((lNbVisibles>0||!this._options.deroulerListeSeulementSiPlusieursElements)&&!this.ActualiserListe){if(lNbVisibles>1||!this._options.deroulerListeSeulementSiPlusieursElements){_deroulerListe.call(this,0 ,true);} else{_gererCasUnSeulElement.call(this);}} else{this.SurValidation(false,-1,{saisieRecherche:true});}}
return;}}
if(ToucheClavier.estEventSelection(aEvent)){this.SurSelection();}
break;case EEvent.SurFocusOut:switch(this._options.mode){case EGenreSaisie.SaisieRecherche:if(_avecSaisieRechercheDynamique.call(this)){_declencherFermetureListe.call(this);}
break;}
break;}}
function _appliquerGetContenuCellule(aElement){if(!aElement){this.SetContenu('');return;}
const lContenuCellule=this._options.getContenuCellule(aElement,this);if(lContenuCellule&&lContenuCellule.libelleHtml){if(MethodesObjet.isString(lContenuCellule.libelleHtml)){this.bouton.setLibelleHtml(lContenuCellule.libelleHtml);}} else{const lLibelle=lContenuCellule&&lContenuCellule.libelle?lContenuCellule.libelle:lContenuCellule;if(lLibelle&&MethodesObjet.isString(lLibelle)){this.SetContenu(lContenuCellule&&lContenuCellule.libelle?lContenuCellule.libelle:lContenuCellule);}}}
function _getParamsCallback(aParams){return Object.assign({combo:this,genreEvenement:-1,element:null,indice:null,genre:this.Genre,surSetDonnees:null,listeSelections:null,estComboMultiSelection:this._options.multiSelection,interactionUtilisateur:this.InteractionUtilisateur,estSelectionManuelle:false,editionEnCours:this.cache.editionEnCours,valeur:null,saisieRecherche:false,validationMultiSelection:false,surBoutonCellule:false},aParams);}
function _callback(aParams){return this.callback.appel(aParams.genreEvenement,aParams.element,aParams.indice,aParams.genre,aParams.valeur,aParams.surSetDonnees,aParams.listeSelections,aParams);}
function _retourSurNavigation(aParams){if(aParams.retourSaisieAnnule){this.SetEtatSaisie(false);}
const lSurSetDonnes=this._surSetDonnnes;const lParams=_getParamsCallback.call(this,Object.assign({genreEvenement:EGenreEvenementObjetSaisie.selection,element:this.Selection>=0?this.ListeElements.GetElement(this.Selection):null,indice:Math.max(this.Selection||0,0),genre:this.Genre,surSetDonnees:lSurSetDonnes,listeSelections:this._listeSelections,estSelectionManuelle:this.InteractionUtilisateur},aParams));delete this._surSetDonnnes;if(lParams.element&&lParams.element.callbackSelection&&MethodesObjet.isFunction(lParams.element.callbackSelection)){lParams.element.callbackSelection(lParams);}
_callback.call(this,lParams);if(this._options.surValidation){this._options.surValidation.call(this.Pere,lParams);}
if(this.Pere&&this.Pere.$refreshSelf){this.Pere.$refreshSelf();}
if(this._options.mode===EGenreSaisie.SaisieRecherche){this.ListeElements=new ObjetListeElements();}}
function _survolBoutonMultiSelection(){_selectionLigne.call(this,this.Survolee,false);this.Survolee+=1;}
function _defilerFleches(aEvent,aSurKeyDown){if(this.listeDeroulee){if(_estEventFermetureFleche(aEvent)){if(!aSurKeyDown){this.FermerListe(true);}
return false;}
if(aEvent.which===ToucheClavier.FlecheBas){if(_chercherSuivantSelectionnable.bind(this)(this.Survolee,true)<this.ListeElements.GetNbrElements()){this.SurLigne(_chercherSuivantSelectionnable.bind(this)(this.Survolee,true));return true;}
if(this._options.multiSelection&&this.Survolee<this.ListeElements.GetNbrElements()){_survolBoutonMultiSelection.call(this);GHtml.setFocus(this.idBtnValidation,true);return true;}}
if(aEvent.which===ToucheClavier.FlecheHaut){if(_chercherSuivantSelectionnable.bind(this)(this.Survolee,false)> -1){this.SurLigne(_chercherSuivantSelectionnable.bind(this)(this.Survolee,false));}
return true;}}
return false;}
function _defiler(aEvent,aIgnorerFleches){if(!this.listeDeroulee&&(MethodesTableau.existe(this._options.mode,[EGenreSaisie.Combo]))){if(ToucheClavier.estEventRetourChariot(aEvent)){_deroulerListe.call(this);}}
if(this.listeDeroulee){if(ToucheClavier.estEventSelection(aEvent)||_estEventFermetureFleche(aEvent)){_surValidationClavier.call(this);} else if(aEvent.which===ToucheClavier.Echap){this.FermerListe(true);} else if(!(!aIgnorerFleches&&_defilerFleches.call(this,aEvent))&&ToucheClavier.estEventCaractereAlphaNumerique(aEvent)){clearTimeout(this._timerInitParseur);this._timerInitParseur=setTimeout(_initParseur.bind(this),500);this._parseur=this._parseur+aEvent.key;const lIndice=this.ListeElements.getIndiceParParsingLibelle(this._parseur);if(lIndice>=0){this.SurLigne(lIndice);}}}}
function _surValidationClavier(){if(this._options.multiSelection){_setValueElementCB.call(this,this.Survolee,!getValueElementCB.call(this,this.Survolee));this.$refreshSelf();} else{this.SurValidation(true,this.Survolee);}}
function _estEventFermetureFleche(aEvent){return aEvent&&aEvent.altKey&&aEvent.which===ToucheClavier.FlecheHaut;}
function _initParseur(){this._parseur='';}
function _chercherSuivantSelectionnable(aIndice,aSensSuivant){const lSens=aSensSuivant?1:-1;aIndice=aIndice+lSens;const N=this.ListeElements.GetNbrElements();while((aIndice> -1)&&(aIndice<N)&&this.ListeElements&&this.ListeElements.GetElement(aIndice)&&!_estSelectionnable.call(this,this.ListeElements.GetElement(aIndice))){aIndice+=lSens;}
return aIndice;}
function _initInfosElementsCBs(aNumeroLigne){const lElement=this.ListeElements.GetElement(aNumeroLigne);const lSelectionnable=!!_estSelectionnable.call(this,lElement);this._infosElementsCbs[aNumeroLigne]={selectionne:lSelectionnable&&!!this._listeSelections.GetElementParElement(lElement),avecCB:lSelectionnable,selectionnable:lSelectionnable,nonEditable:false,estCumul:false,estFilsCumul:null,setModifierSelection:null};if(this._options.getInfosElementCB&&lElement){$.extend(this._infosElementsCbs[aNumeroLigne],this._options.getInfosElementCB(lElement));}}
function _composeLigne(aElement,I){const T=[];if(!aElement){return'';}
let LLibelle=aElement.GetLibelle();const lParams={element:aElement,indice:I};const lPaddingLeft=3;lParams.largeur=this.cache.largeurContenu-lPaddingLeft;const lClassElement=this._options.getClassElement?this._options.getClassElement(lParams):'';let lAvecEllipsis=!aElement.libelleHtmlTitle&&!this._options.getContenuElement&&!_estOuvertureModale.call(this);if(this.cache.avecSurlignage&&this.cache.recherchesSurlignage&&!aElement.libelleHtml&&!this._options.getContenuElement&&(!this._options.avecSurlignageElement||this._options.avecSurlignageElement(lParams))){LLibelle=GChaine.getLibelleSurligne(LLibelle,this.cache.recherchesSurlignage,{couleur:this._options.couleurSurlignageSuggestion});}
LLibelle=GChaine.AvecEspaceSiVide(LLibelle);T.push('<li',(!!lClassElement?' class="'+lClassElement+'"':''),' role="presentation">');if(aElement.ClassAffichage||aElement.StyleAffichage){LLibelle='<div '+(lAvecEllipsis?'  ie-ellipsis ':'')+(aElement.ClassAffichage?'class="'+aElement.ClassAffichage+'" ':'')+(aElement.StyleAffichage?'style="'+aElement.StyleAffichage+'"':'')+'>'+LLibelle+'</div>';lAvecEllipsis=false;}
if(this.cache.avecCBMultiSelection&&this._infosElementsCbs&&this._infosElementsCbs[lParams.indice]&&this._infosElementsCbs[lParams.indice].avecCB){T.push('<div class="check-conteneur"',GHtml.composeAttr('ie-node','getNodeCBMulti',[I]),'>','<ie-checkbox ie-model="cbElement(',I,')"></ie-checkbox>','</div>');}
const lLineHeight=(this.modeTactile?this._options.hauteurLigneTactile:this._options.hauteur?this._options.hauteur:this._options.hauteurLigneDefault);T.push('<div id="'+this.Nom+'_'+I+'" '+GObjetWAI.composeRole(EGenreRole.Option),' ie-attr="getAttrWAIOption(',I,')"',aElement.libelleHtmlTitle?' ie-hint="'+GChaine.toTitle(aElement.libelleHtmlTitle)+'" ':'',lAvecEllipsis?' ie-ellipsis':'',' class="as-li ',lClasseJQ,'" '+'style="line-height:'+(lLineHeight*0.1)+'rem; overflow: hidden;" tabindex="-1">');if(aElement.libelleHtml||this._options.getContenuElement){const lContenu=this._options.getContenuElement?this._options.getContenuElement(lParams):aElement.libelleHtml;if(this.modeTactile){T.push('<div class="InlineBlock" style="height:100%;width:0;">&nbsp;</div><div class="InlineBlock" style="line-height:initial; width:100%;">');}
T.push(lContenu+(this.modeTactile?'</div>':''));} else{T.push(LLibelle);}
T.push('</div>','</li>');return T.join('');}
function _composeBloc(aBloc,aNumeroBloc){const T=[];if(aBloc&&aBloc.lignesVisibles){aBloc.dessine=true;aBloc.calcule=false;aBloc.top=0;aBloc.height=0;if(this.cache.scrollInfiniActif){T.push('<li id="',this.idBloc+aNumeroBloc,'" style="position:absolute;top:-1000px" role="presentation">');T.push('<ul class="liste-as-options',(this.cache.avecCBMultiSelection?' multi-selections ':''),'" role="presentation">');}
aBloc.lignesVisibles.forEach(function(aNumeroLigne){T.push(_composeLigne.call(this,this.ListeElements.GetElement(aNumeroLigne),aNumeroLigne));}.bind(this));if(this.cache.scrollInfiniActif){T.push('</ul>');T.push('</li>');}}
return T.join('');}
function _majBlocsTacheFond(){clearTimeout(this.cache.timerMAJ);if(!this.listeDeroulee){return;}
if(this.cache.toutCalcule){return;}
let lNumeroACalculer=0;const lToutCalcule=this.cache.blocs.every(function(aBloc,aNumeroBloc){if(!aBloc.calcule){lNumeroACalculer=aNumeroBloc;}
return!!aBloc.calcule;});if(lNumeroACalculer>0){this.cache.timerMAJ=setTimeout(function(aNumeroBloc){const lBloc=this.cache.blocs[aNumeroBloc];const lASupprimer=!lBloc.dessine;_majBloc.call(this,aNumeroBloc);if(lASupprimer){$('#'+(this.idBloc+aNumeroBloc).escapeJQ()).remove();lBloc.dessine=false;}
_majBlocsTacheFond.call(this);}.bind(this,lNumeroACalculer),0);}
if(!this.cache.toutCalcule&&lToutCalcule){this.cache.toutCalcule=true;if(this._options.callbackToutCalcule){this._options.callbackToutCalcule();}
const lDernierBloc=this.cache.blocs[this.cache.blocs.length-1];const lHeightScroll=lDernierBloc.top+lDernierBloc.height;if(lHeightScroll!==this.cache.heightScroll){this.cache.heightScroll=lHeightScroll;$('#'+this.idContenuScroll.escapeJQ()).height(lHeightScroll);}}}
function _majBloc(aNumeroBloc,aSurFermeture){if(!aSurFermeture){const lBlocPrecedent=this.cache.blocs[aNumeroBloc-1];if(lBlocPrecedent&&!lBlocPrecedent.calcule){_majBloc.call(this,aNumeroBloc-1);}}
const lBloc=this.cache.blocs[aNumeroBloc];if(!lBloc){return;}
if(!lBloc.dessine){lBloc.dessine=true;GHtml.addHtml(this.idContenuScroll,_composeBloc.call(this,lBloc,aNumeroBloc),{controleur:this.controleur,ignorerScroll:true});}
if(!lBloc.calcule&&!aSurFermeture){const lJBloc=$('#'+(this.idBloc+aNumeroBloc).escapeJQ());lBloc.height=lJBloc.height();lBloc.top=aNumeroBloc===0?0:this.cache.blocs[aNumeroBloc-1].top+this.cache.blocs[aNumeroBloc-1].height;lBloc.calcule=true;lJBloc.css('top',lBloc.top);}}
function _visibiliteSurNumeroBloc(aNumeroBlocVisible,aSurFermeture){this.cache.blocs.forEach(function(aBloc,aNumeroBloc){const lVisible=aSurFermeture?aNumeroBloc===aNumeroBlocVisible:aNumeroBloc<=aNumeroBlocVisible+this._options.nbBlocsScrollInfini&&aNumeroBloc>=aNumeroBlocVisible-this._options.nbBlocsScrollInfini;const lSurvolSurBloc=aBloc.debut<=this.Survolee&&aBloc.fin>=this.Survolee;if(lVisible){const lEstDejaDessine=aBloc.dessine;_majBloc.call(this,aNumeroBloc,aSurFermeture);if(!lEstDejaDessine&&lSurvolSurBloc){_selectionLigne.call(this,this.Survolee,true);GHtml.setFocus(this.Nom+'_'+this.Survolee);}} else{if(aBloc.dessine){$('#'+(this.idBloc+aNumeroBloc).escapeJQ()).remove();}
aBloc.dessine=false;if(lSurvolSurBloc){GHtml.setFocus(this.idContenu);}}}.bind(this));}
function _majBlocsDeLigne(aLigne,aSurFermeture){if(!this.cache.scrollInfiniActif){return;}
let lNumeroBloc=0;this.cache.blocs.every(function(aBloc,aNumeroBloc){lNumeroBloc=aNumeroBloc;return aLigne>=0&&(aLigne<aBloc.debut||aLigne>aBloc.fin);});_visibiliteSurNumeroBloc.call(this,lNumeroBloc,aSurFermeture);if(!aSurFermeture){_majBlocsTacheFond.call(this);}}
function _majBlocsDeTop(aTop){if(!this.cache.scrollInfiniActif){return;}
let lNumeroBlocVisible=0;let lTrouve=false;let lDernierBlocCalcule=0;this.cache.blocs.every(function(aBloc,aNumeroBloc){if(aBloc.calcule){lDernierBlocCalcule=aNumeroBloc;}
return!!aBloc.calcule;});this.cache.blocs.every(function(aBloc,aNumeroBloc){if(aBloc.calcule&&
aBloc.top<=aTop&&(aBloc.top+aBloc.height)>aTop){lNumeroBlocVisible=aNumeroBloc;lTrouve=true;}
return!lTrouve;});if(!lTrouve){if(lDernierBlocCalcule>=0){_majBloc.call(this,lDernierBlocCalcule+1);_majBlocsDeTop.call(this,aTop);}
return;}
_visibiliteSurNumeroBloc.call(this,lNumeroBlocVisible);_majBlocsTacheFond.call(this);}
function _surFocusLigne(event){_arreterFermetureListe.call(event.data.instance);}
function _surKeyDownListe(aEvent){const lThis=aEvent.data.instance;if(lThis.listeDeroulee&&aEvent.which===ToucheClavier.Tab){_surValidationClavier.call(lThis);} else if(aEvent.which===ToucheClavier.Debut){lThis.SurLigne(lThis.chercherIndiceSelectionSelonSens(0));} else if(aEvent.which===ToucheClavier.Fin){lThis.SurLigne(_getDerniereLingeSelectionnable.call(lThis));} else{_defilerFleches.call(lThis,aEvent,true);}}
function _surKeyUpListe(event){_defiler.call(event.data.instance,event,true);if(event.which===ToucheClavier.Echap){GNavigateur.StopperEvenement(event);}}
function _selectionnerUnElementEnMultiSelection(aIndice){if(this._infosElementsCbs&&this._infosElementsCbs[aIndice]&&!this._infosElementsCbs[aIndice].selectionnable){return false;}
if(this.ListeElements){this.ListeElements.parcourir(function(D,aIndex){const lInfos=this._infosElementsCbs?this._infosElementsCbs[aIndex]:null;if(lInfos&&lInfos.selectionne){lInfos.selectionne=false;}},this);}
_setValueElementCB.call(this,aIndice,true);return true;}
function _surClickListe(event){const T=this.id.split('_'),lIndice=parseInt(T[T.length-1],10),lInstance=event.data.instance;if(lInstance._options.multiSelection){_selectionnerUnElementEnMultiSelection.call(lInstance,lIndice);}
lInstance.SurValidation(true,lIndice);}
function _surMouseMoveListe(event){const T=this.id.split('_');const lIndice=parseInt(T[T.length-1],10);event.data.instance.SurLigne(lIndice);_arreterFermetureListe.call(event.data.instance);}
function _avecDeroulerListe(){const lNbVisibles=this.getNbElementsVisible();return lNbVisibles>1||(lNbVisibles>0&&this._options.mode===EGenreSaisie.SaisieRecherche)||(lNbVisibles>0&&this._options.multiSelection&&this._options.mode===EGenreSaisie.Combo)||(!this._options.deroulerListeSeulementSiPlusieursElements&&lNbVisibles<=1);}
function _estOuvertureModale(){if(this._options.avecOuvertureDeroulantModale===true){return true;}
if(this._options.avecOuvertureDeroulantModale===false){return false;}
return IE.estMobile;}
function _deroulerListe(ASurvolee,aListeDejaRemplie,aSansFocusLigne){if(this.listeDeroulee){this.FermerListe();this.listeDeroulee=false;return;}
const lParams=_getParamsCallback.call(this,{genreEvenement:EGenreEvenementObjetSaisie.deploiement});if(_callback.call(this,lParams)===false){if(this.Pere&&this.Pere.$refreshSelf){this.Pere.$refreshSelf();}
return;}
if(_avecDeroulerListe.call(this)){_arreterFermetureListe.call(this);if(_avecSaisieRechercheDynamique.call(this)){setTimeout(_arreterFermetureListe.bind(this),0);}
if(!aListeDejaRemplie){this._remplirListe();}
this.listeDeroulee=true;this.bouton.setOptions_ObjetCelluleBouton({ariaExpanded:true});const lElementListe=GHtml.getElement(this.NomListe);const lElementContenuListe=GHtml.getElement(this.idContenu);GHtml.setDisplay(lElementListe,true);lElementContenuListe.style.overflowY='hidden';if(_estOuvertureModale.call(this)){const lCont=GHtml.getElement(this.nomListeConteneur);lCont.classList.add('visible');lCont.offsetWidth;lCont.classList.add('active');if(global.M){if(!this.cache.zIndexMobileActif){this.cache.zIndexMobileActif=true;M.Modal._modalsOpen+=1;}
const lZIndex=1000+M.Modal._modalsOpen*2;lCont.style.zIndex=lZIndex;}} else{GStyle.setZindex(lElementListe,500);this.activerEventOut=false;setTimeout(function(){this.activerEventOut=true;}.bind(this),50);}
const lObjet=this;$(lElementContenuListe).css({height:0}).animate({height:lObjet.hauteurContenu+'px'},this._options.dureeAnimationDeploiement);if(this._ouvertureInverse){$(lElementListe).css({top:-this.decalageTopOuvertureInverse}).animate({top:-(lObjet.hauteurContenu+this.decalageTopOuvertureInverse)+'px'},this._options.dureeAnimationDeploiement);}
$(lElementContenuListe).queue(function(){$('#'+lObjet.idContenu.escapeJQ()).css('overflowY','auto');_eventAnimationOuvertureFin.call(lObjet,ASurvolee,aSansFocusLigne);$(this).dequeue();});} else{_gererCasUnSeulElement.bind(this)();}}
function _eventAnimationOuvertureFin(ASurvolee,aSansFocusLigne){let lNumeroLigne=ASurvolee===null||ASurvolee===undefined?this.Selection===null||this.Selection===undefined?0:this.Selection:ASurvolee;lNumeroLigne=this.chercherIndiceSelectionSelonSens(lNumeroLigne>=0?lNumeroLigne:0);this.SurLigne(lNumeroLigne,aSansFocusLigne);}
function _declencherFermetureListe(AAvecFocus){clearTimeout(this.Timer);this.Timer=setTimeout(this.FermerListe.bind(this,AAvecFocus),100);}
function _arreterFermetureListe(){clearTimeout(this.Timer);this.Timer=null;}
function _etapeFermetureInverse(aJElement ,aNow){aJElement.css({top:-aNow-this.decalageTopOuvertureInverse});}
function _eventAnimationFermetureFin(){if(_estOuvertureModale.call(this)){GHtml.getElement(this.nomListeConteneur).classList.remove('visible');if(global.M&&this.cache.zIndexMobileActif){this.cache.zIndexMobileActif=false;M.Modal._modalsOpen-=1;}}
setTimeout(GHtml.setDisplay.bind(GHtml,this.NomListe,false),5);if(this._options.avecEventSurFermetureListe){_callback.call(this,_getParamsCallback.call(this,{genreEvenement:EGenreEvenementObjetSaisie.fermeture,indice:0}));if(this.Pere&&this.Pere.$refreshSelf){this.Pere.$refreshSelf();}}}
function _estSelectionnable(aElement){return!!aElement&&aElement.AvecSelection!==false&&aElement.Visible!==false&&(!this._options.getEstElementNonSelectionnable||this._options.getEstElementNonSelectionnable(aElement)!==true);}
function _selectionLigne(aLigne,aSelectionner){if((aLigne> -1)&&(aLigne<this.ListeElements.GetNbrElements())){const lElement=this.ListeElements.GetElement(aLigne);if(aSelectionner&&!_estSelectionnable.call(this,lElement)){return;}
const lJDOM=$(`#${this.Nom.escapeJQ()+'_'+aLigne}`);if(lJDOM.length===0){return;}
if(this._options.avecFondSelectionSurSurvol){if(aSelectionner){lJDOM.addClass('selected');} else{lJDOM.removeClass('selected');}}
if(this._options.avecGrasSurSurvol){if(aSelectionner){lJDOM.addClass('Gras');} else{lJDOM.removeClass('Gras');}}}}
function _gererCasUnSeulElement(){let lResult=false;if(this.getNbElementsVisible()===1){let LLibelle='';let lEstHtml=false;let lElement;const lIndex=this.ListeElements.getIndiceElementParFiltre(function(aEl){return aEl.Visible!==false;});lElement=this.ListeElements.GetElement(lIndex);if(lElement){LLibelle=lElement.GetLibelle();if(this._options.getContenuElement){LLibelle=this._options.getContenuElement({element:lElement,index:lIndex});} else if(this._options.celluleAvecTexteHtml&&lElement.libelleHtml){LLibelle=lElement.libelleHtml;lEstHtml=true;}}
if(LLibelle){this.Selection=lIndex;if(this._options.controlerNbrElements){GHtml.setHtml(this.Nom,'<span class="Gras Insecable">'+LLibelle+'</span>');}
this.SurValidation(false,this.Selection);lResult=true;} else{this.Selection= -1;}
if(this._options.modifierContenuCelluleSurSelection){if(this._options.getContenuCellule){_appliquerGetContenuCellule.call(this,lElement);} else if(lEstHtml){this.bouton.setLibelleHtml(LLibelle);} else{this.SetContenu(LLibelle);}
$('#'+this.NomListe.escapeJQ()+', #'+this.bouton.NomEdit.escapeJQ()).attr(GObjetWAI.getAttribut(EGenreAttribut.activedescendant),this.Selection> -1?this.Nom+'_'+this.Selection:'');}}
this.$refreshSelf();return lResult;}
function _initListeSelections(aListeSelections){const lListeSelections=MethodesObjet.dupliquer(aListeSelections);if(!this._listeSelections){this._listeSelections=new ObjetListeElements();}
this._listeSelections.vider();let lResult=false;if(this.ListeElements){this.ListeElements.parcourir(function(D,aIndex){const lElement=lListeSelections?lListeSelections.GetElementParNumero(D.GetNumero()):null;if(lElement){lResult=true;this._listeSelections.AddElement(lElement);if(this._infosElementsCbs&&this._infosElementsCbs[aIndex]){this._infosElementsCbs[aIndex].selectionne=true;}} else if(this._infosElementsCbs&&this._infosElementsCbs[aIndex]){this._infosElementsCbs[aIndex].selectionne=false;}}.bind(this));}
return lResult;}
function _getDerniereLingeSelectionnable(){return this.ListeElements&&this.ListeElements.GetNbrElements?this.chercherIndiceSelectionSelonSens(this.ListeElements.GetNbrElements()-1,true):0;}
module.exports=ObjetSaisie;},fn:"objetsaisie.js"});;
IE.fModule({f:function(exports,require,module,global){const IEHtml=require('IEHtml.js');const GLog=require('IELog.js');const MethodesObjet=require('MethodesObjet.js');const GHtml=require('GHtml.js');const EGenreEvenementObjetSaisie=require('Enumere_EvenementObjetSaisie.js');const ObjetListeElements=require('ObjetListeElements.js');const ObjetSaisie=require('ObjetSaisie.js');const ObjetElement=require('ObjetElement.js');IEHtml.addBalise('ie-combo',function(aContexteCourant,aOutils){function _listesIdentiques(aListe1,aListe2){return aListe1&&aListe1.listeIdentiqueParElementsOrdonnes?aListe1.listeIdentiqueParElementsOrdonnes(aListe2):false;}
const lModele=aOutils.getModel(aContexteCourant),const_forcerActualisation='forcer_Actualisation';if(!lModele){return;}
const lInfosEvent=aOutils.getAccesParametresModel('event',aContexteCourant),lInfosInit=aOutils.getAccesParametresModel('init',aContexteCourant),lInfosGetDonnees=aOutils.getAccesParametresModel('getDonnees',aContexteCourant),lInfosGetIndice=aOutils.getAccesParametresModel('getIndiceSelection',aContexteCourant),lInfosSetIndice=aOutils.getAccesParametresModel('setIndiceSelection',aContexteCourant),lInfosGetLibelle=aOutils.getAccesParametresModel('getLibelle',aContexteCourant),lInfosDestroy=aOutils.getAccesParametresModel('destroy',aContexteCourant),lInfosGetDisabled=aOutils.getAccesParametresModel('getDisabled',aContexteCourant),lAvecControleSaisie=aOutils.getControleSaisieEvent(aContexteCourant),lRefresh=aContexteCourant.contexte.refresh;let lListeSelectionsBackup=null;let lInstanceCombo;const lInfosInstance=aOutils.creerInstanceIdentite(ObjetSaisie,{pere:aContexteCourant.controleur,evenement:function(...aArgs){const lParametres=aArgs[7];const lCallback=function(){if(lParametres.genreEvenement===EGenreEvenementObjetSaisie.selection){if(((lParametres.estComboMultiSelection&&!_listesIdentiques(lParametres.listeSelections,lListeSelectionsBackup))||(MethodesObjet.isNumber(lParametres.indice)&&lParametres.indice!==aContexteCourant.data.$indice))||aContexteCourant.data.$indice===const_forcerActualisation){if(lInfosSetIndice.estFonction){lInfosSetIndice.callback([lParametres.estComboMultiSelection?lParametres.listeSelections:lParametres.indice,lInstanceCombo,aContexteCourant.data]);}
aContexteCourant.data.$indice=lParametres.indice;}}
if(lInfosEvent.estFonction){lInfosEvent.callback([lParametres,lInstanceCombo,aContexteCourant.data]);}
lRefresh();};lCallback();}});lInstanceCombo=lInfosInstance.instance;lInstanceCombo.ControleNavigation=!!lAvecControleSaisie;const lRacine=GHtml.htmlToDOM('<div id="'+lInstanceCombo.GetNom()+'"></div>'),lJRacine=$(lRacine);if(IE.estMobile&&aContexteCourant.node.classList.contains('combo-selecteur')){lInstanceCombo.setOptions_ObjetSaisie({avecDesignMobile:true,iconeGauche:'icon_ul',avecBouton:false});} else if(IE.estMobile&&aContexteCourant.node.classList.contains('combo-mobile')){lInstanceCombo.setOptions_ObjetSaisie({avecDesignMobile:true});}
const lParams={liste:new ObjetListeElements,indice:-1};const lRemplirListe=(aNode,aParams,aAEstFils) =>{if(aNode&&aNode.childNodes){for(let i=0;i<aNode.childNodes.length;i++){const lNode=aNode.childNodes[i];const lNodeName=lNode.nodeName.toLowerCase();if(lNodeName&&lNodeName==='option'){const lArticle=new ObjetElement({Libelle:lNode.innerHTML,Numero:lNode.value,node:lNode,avecIndentation:aAEstFils});aParams.liste.add(lArticle);if(lNode.getAttribute('selected')==='selected'){aParams.indice=aParams.liste.GetNbrElements()-1;}} else if(lNodeName&&lNodeName==='optgroup'){const lLibelle=lNode.getAttribute('label')||''
;aParams.liste.add(new ObjetElement({Libelle:lLibelle,AvecSelection:false,estCumul:true,node:lNode}));lRemplirListe(lNode,aParams,true);}}}};lRemplirListe(aContexteCourant.node,lParams);if(lParams.liste.GetNbrElements()>0){lInstanceCombo.setDonnees_ObjetSaisie({liste:lParams.liste,selection:lParams.indice,options:{getClassElement(aParams){if(aParams.element.estCumul){return'liste-fond-cumul';} else if(aParams.element.avecIndentation){return'element-indentation';}
return'';}}});if(lParams.indice<0){lInstanceCombo.initSelection(0);}}
if(lInfosInit.estFonction){lInfosInit.callback([lInstanceCombo,aContexteCourant.data]);}
aOutils.injectHTML({element:lRacine,html:lInstanceCombo.ConstruireAffichage(),controleur:lInstanceCombo.controleur,ignorerScroll:true,contexte:aContexteCourant.contexte});lJRacine.IEData(aContexteCourant.data);lJRacine.on('destroyed',function(){if(lInfosDestroy.estFonction){lInfosDestroy.callback([lInstanceCombo,aContexteCourant.data]);}
lInfosInstance.callbackDestruction();lInstanceCombo.free();lInstanceCombo=null;});aOutils.surInjectionHtml(aContexteCourant,function(){lInstanceCombo.RecupererDonnees();let lActualiserSelection;const lDemarrerGetIndice=function(){if(lInfosGetIndice.estFonction){let lGetterIndice;lActualiserSelection=function(){if(!lInstanceCombo){return;}
const lIndice=lGetterIndice(),lEstListe=lInstanceCombo._options.multiSelection;if(((lEstListe&&(!lListeSelectionsBackup||!lListeSelectionsBackup.preventionBoucle)&&!_listesIdentiques(lIndice,lListeSelectionsBackup))||(!lEstListe&&lIndice!==aContexteCourant.data.$indice))||aContexteCourant.data.$indice===const_forcerActualisation){if(lEstListe){if(lIndice&&lIndice instanceof ObjetListeElements){lListeSelectionsBackup=lIndice;} else{lListeSelectionsBackup=new ObjetListeElements()
;}
lListeSelectionsBackup.preventionBoucle=true;lInstanceCombo.setListeSelections(lIndice);} else{aContexteCourant.data.$indice=lIndice;if(lIndice>=0){lInstanceCombo.SetSelection(lIndice);}}} else if(lListeSelectionsBackup&&lListeSelectionsBackup.preventionBoucle){lListeSelectionsBackup.preventionBoucle=false;}};lGetterIndice=function(){let lIndice=lInfosGetIndice.callback([lInstanceCombo,aContexteCourant.data])||0;if(!lInstanceCombo._options.multiSelection){lIndice=lInstanceCombo.chercherIndiceSelectionSelonSens(lIndice,false);}
return lIndice;};const lIndice=lGetterIndice();if(lInstanceCombo._options.multiSelection){if(lIndice&&lIndice instanceof ObjetListeElements){lListeSelectionsBackup=lIndice;} else{lListeSelectionsBackup=new ObjetListeElements()
;}
lInstanceCombo.setListeSelections(lListeSelectionsBackup);} else{aContexteCourant.data.$indice=lIndice;if(lIndice>=0){lInstanceCombo.SetSelection(lIndice);}}
aOutils.abonnerRefresh(lActualiserSelection,lRacine,aContexteCourant);}};if(lInfosGetDonnees.estFonction){const lGetterDonnees=function(){return lInfosGetDonnees.callback([lInstanceCombo.ListeElements,lInstanceCombo,aContexteCourant.data])||null;};const lDonnees=lGetterDonnees();let lComboInitialise=false;if(lDonnees&&lDonnees.GetNbrElements){lInstanceCombo.setDonnees_ObjetSaisie({liste:lDonnees});lDemarrerGetIndice();lComboInitialise=true;}
aOutils.abonnerRefresh(function(){if(!lInstanceCombo){GLog.addLog('lInstanceCombo n\'existe pas');return null;}
const lDonnees=lGetterDonnees();if(lDonnees&&lDonnees.GetNbrElements&&lInstanceCombo.ListeElements!==lDonnees){lInstanceCombo.setDonnees_ObjetSaisie({liste:lDonnees});aContexteCourant.data.$indice=const_forcerActualisation;if(!lComboInitialise){lDemarrerGetIndice();lComboInitialise=true;} else if(lActualiserSelection){lActualiserSelection();}}},lRacine,aContexteCourant);} else{lDemarrerGetIndice();}
if(lInfosGetLibelle.estFonction){const lGetterLibelle=function(){return lInfosGetLibelle.callback([lInstanceCombo,aContexteCourant.data]);};const lLibelle=lGetterLibelle();if(lLibelle===''||(lLibelle&&lLibelle.length>0)){lInstanceCombo.SetContenu(lLibelle);}
aOutils.abonnerRefresh(function(){if(!lInstanceCombo){GLog.addLog('lInstanceCombo n\'existe pas');return null;}
const lLibelle=lGetterLibelle();if((lLibelle===''||(lLibelle&&lLibelle.length>0))&&lLibelle!==lInstanceCombo.bouton.getLibelle()){lInstanceCombo.SetContenu(lLibelle);}},lRacine,aContexteCourant);}});if(lInfosGetDisabled.estFonction){const lGetterDisabled=function(){return!!lInfosGetDisabled.callback([lInstanceCombo,aContexteCourant.data]);};const lEstDisabled=lGetterDisabled();aContexteCourant.data.$disabled=lEstDisabled;if(lEstDisabled){lInstanceCombo.SetActif(false);}
aOutils.abonnerRefresh(function(){if(!lInstanceCombo){GLog.addLog('lInstanceCombo n\'existe pas');return null;}
const lEstDisabled=lGetterDisabled();if(lEstDisabled!==aContexteCourant.data.$disabled){aContexteCourant.data.$disabled=lEstDisabled;lInstanceCombo.SetActif(!lEstDisabled);}},lRacine,aContexteCourant);}
if(lModele&&aContexteCourant.data.$modeleParsed){aOutils.surNodeEtNodeAfter(aContexteCourant);}
aOutils.copyAttributs(aContexteCourant.node,lJRacine);lJRacine.addClass('ObjetSaisie ie-combo');aOutils.replaceNode(aContexteCourant.node,lRacine);aOutils.addCommentaireDebug(lRacine,'ie-combo ie-model="'+lModele+'"');return{node:lRacine,avecCompileFils:false};});module.exports=IEHtml;},fn:"iehtml.combo.js"});;
IE.fModule({f:function(exports,require,module,global){require('produit/css/ChangementLangue.css');const IELocalStorage=require('LocalStorage.js');const MethodesObjet=require('MethodesObjet.js');const ControleSaisieEvenement=require('ControleSaisieEvenement.js');const EGenreAction=require('Enumere_Action.js');const EGenreBoiteMessage=require('Enumere_BoiteMessage.js');const GTraductions=require('ObjetTraduction.js');const EGenreEvenementObjetSaisie=require('Enumere_EvenementObjetSaisie.js');const UtilitaireChangementLangueProduit=require('UtilitaireChangementLangueProduit.js');require('IEHtml.Combo.js');const UtilitaireChangementLangue=Object.assign({avecChoixLangues:function(){return!GApplication.estAppliMobile&&GParametres.listeLangues&&GParametres.listeLangues.GetNbrElements()>1;},getListeLangues:function(){const lListe=MethodesObjet.dupliquer(GParametres.listeLangues);lListe.parcourir(function(D){D.Libelle=D.description;const lImage=UtilitaireChangementLangue.getImageCss(D.langID);D.imageDrapeau=lImage?'<div class="'+UtilitaireChangementLangue.getImageCss(D.langID)+'"></div>':'';D.libelleHtml=lImage?'<div class="flag-img">'+D.imageDrapeau+'<div class="flag-label" ie-ellipsis>'+D.Libelle+'</div></div>':D.Libelle;});lListe.trier();return lListe;},modifierLangue:function(aLangue){if(!IELocalStorage.actif){GApplication.getMessage().afficher({titre:GTraductions.getValeur('ChangementLangue.ChangerLangueImpossible'),message:GTraductions.getValeur('ChangementLangue.ChangerLangueImpossibleDetail')});return;}
if(!aLangue||!aLangue.langID){return;}
ControleSaisieEvenement(function(){GApplication.getMessage().afficher({type:EGenreBoiteMessage.Confirmation,message:GTraductions.getValeur('ChangementLangue.MessageConfirmationChangerLangue'),callback:function(aGenre){if(aGenre===EGenreAction.Valider){UtilitaireChangementLangue.affecterLangue(aLangue.langID);}}});});},construire:function(aControleur,aOptions){if(!aControleur){return'';}
if(!this.avecChoixLangues()){return'';}
let lIndiceSelection= -1;const lListe=UtilitaireChangementLangue.getListeLangues();aControleur.comboChangementLangue={init:function(aInstance){aInstance.largeurBouton=0;aInstance.setOptions_ObjetSaisie({longueur:22,largeurListe:180,avecBouton:false,avecOuvertureDeroulantModale:(IE.estMobile?true:false),avecEventSurFermetureListe:!!aOptions&&!!aOptions.avecEventFermeture,getContenuCellule:function(){const lElement=lListe.GetElement(lIndiceSelection);if(lElement){return{libelleHtml:lElement.imageDrapeau};}},optionsBouton:{avecBordures:false,couleurFondSurvol:GCouleur.themeNeutre.moyen1,avecFocusVisibleTexte:false,titleForce:GTraductions.getValeur('ChangementLangue.ChangerLaLangue'),classeZone:''}});aInstance.SetDonnees(lListe,lIndiceSelection);},event:function(aParametres,aCombo){if(aParametres.genreEvenement===EGenreEvenementObjetSaisie.selection&&aCombo.InteractionUtilisateur&&aParametres.indice!==lIndiceSelection){UtilitaireChangementLangue.modifierLangue(aParametres.element);}
if(aOptions&&MethodesObjet.isFunction(aOptions.supplementSurEvent)){aOptions.supplementSurEvent(aParametres,aCombo);}},getDisabled:function(){return lListe.GetNbrElements()<2;}};lListe.parcourir(function(aElement,aIndex){if(aElement.langID===GParametres.langID){lIndiceSelection=aIndex;return false;}});if(lIndiceSelection<0){lIndiceSelection=0;}
return'<ie-combo class="flag-conteneur" ie-model="comboChangementLangue"></ie-combo>';}},UtilitaireChangementLangueProduit);module.exports=UtilitaireChangementLangue;},fn:"utilitairechangementlangue.js"});;
IE.fModule({f:function(exports,require,module,global){
class _FenetreModale_Mobile{constructor(){this.Nom='FenetreModale';this._pret=false;this.isOpen=false;this.EnAffichage=false;}
setPret(aPret){this._pret=aPret;}
getPret(){return this._pret;}
composerConteneur(){this.setPret(true);return(['<div id="'+this.Nom+'" class="modal">','<div class="modal-header" style="display:none;">','</div>','<div class="modal-content" style="display:none;">','</div>','<div class="modal-footer" style="display:none;">','</div>','</div>']).join('');}
setContent(aHtml){$('#'+this.Nom.escapeJQ()).children('.modal-content').html(aHtml).show();}
_getOptionsPopUp(){return{dismissible:false,opacity:0,inDuration:300,outDuration:200,startingTop:'4%',endingTop:'10%',onCloseStart:function(){this._onCloseStart();}.bind(this),onCloseEnd:(function(){this.isOpen=false;}).bind(this)};}
_onCloseStart(){this.EnAffichage=false;}
afficher(){this._ouvrir();}
_ouvrir(){if(!this.getPret()){return;}
const $fenetreModale=$('#'+this.Nom.escapeJQ());let lInstanceModale=M.Modal.getInstance($fenetreModale);if(!lInstanceModale){M.Modal.init($fenetreModale,this._getOptionsPopUp());lInstanceModale=M.Modal.getInstance($fenetreModale);}
lInstanceModale.open();this.isOpen=true;this.EnAffichage=true;}
fermer(){$('#'+this.Nom.escapeJQ()).modal('close');$('#'+this.Nom.escapeJQ()).children('.modal-content').html('').hide();}
afficherContenu(){}
GetNom(){return this.Nom;}}
module.exports=_FenetreModale_Mobile;},fn:"_fenetremodale_mobile.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetInvocateur,Invocateur}=require('Invocateur.js');const _FenetreModale_Mobile=require('_FenetreModale_Mobile.js');class FenetreModale_Patience extends _FenetreModale_Mobile{constructor(...aParams){super(...aParams);this.Nom='Fenetre_Modale_Patience';this.avecMessage=true;this.compteurBlocage=0;if(Invocateur){Invocateur.abonner(ObjetInvocateur.events.eventIOAjax,_surEventIOAjax,this);Invocateur.abonner(ObjetInvocateur.events.erreurCommunication,this.fermer,this);Invocateur.abonner(ObjetInvocateur.events.patience,_surPatience,this);}}
_getOptionsPopUp(){return Object.assign(super._getOptionsPopUp(),{dismissible:false,inDuration:0,outDuration:0,startingTop:'45%',endingTop:'45%'});}
composerConteneur(){this.setPret(true);return(['<div id="'+this.Nom+'" class="modal" style="width:64px;height:64px;background-color:transparent;box-shadow:none;overflow:visible;">','<div class="modal-content" style="overflow:hidden;">','<div class="preloader-wrapper big active">','<div class="spinner-layer spinner-blue-only">','<div class="circle-clipper left">','<div class="circle"></div>','</div><div class="gap-patch">','<div class="circle"></div>','</div><div class="circle-clipper right">','<div class="circle"></div>','</div>','</div>','</div>','<div id="idPreloaderText" style="overflow:hidden;position:absolute; top:calc(50% + 64px + 5px);width:100%; min-width: 200px;text-align:center;','right: 50%;transform: translateX(50%);opacity: 0.9;border-radius: 0.5rem;box-shadow: 0 2px 4px 1px rgba(0, 0, 0, 0.2); background-color: white; display: none;"></div>','</div>','</div>']).join('');}
afficher(aTexte){this.compteurBlocage+=1;if(this.compteurBlocage>1){return;}
_setTexte(aTexte);this._ouvrir();}
fermer(){this.compteurBlocage=Math.max(0,this.compteurBlocage-1);if(this.compteurBlocage>0){return;}
_setTexte('');if($('#'+this.Nom.escapeJQ()).length>0){try{$('#'+this.Nom.escapeJQ()).modal('close');} catch(e){require('IELog.js').addLog('Erreur '+e);}}}}
function _setTexte(aTexte){const lTexte=aTexte||'';$('#idPreloaderText').text(lTexte).css('display',lTexte?'':'none');}
function _surEventIOAjax(aParametres){if(aParametres.actualisation){return;}
if(aParametres.blocageDeconnexion===true){this.blocageDeconnexion=true;this.compteurBlocage=0;this.afficher(aParametres.message||'');return;}
if(aParametres.blocageDeconnexion===false){delete this.blocageDeconnexion;this.fermer();return;}
if(this.blocageDeconnexion){return;}
if(aParametres.emission){if(aParametres.upload){if(aParametres.nombreFichiers>0&&aParametres.progress){if(aParametres.progress.percent===0&&!aParametres.progress.personnalise){this.afficher();}} else if(aParametres.nombreFichiers>0){this.afficher();}} else{this.afficher();}} else{this.fermer();}}
function _surPatience(aAfficher,aParametres){const lParametres=Object.assign({message:''},aParametres);if(aAfficher){this.afficher(lParametres.message);} else{this.fermer();}}
module.exports=FenetreModale_Patience;},fn:"fenetremodale_patience.js"});;
IE.fModule({f:function(exports,require,module,global){require('Espace/Css/ObjetSaisieCodePIN.css');const GHtml=require('GHtml.js');const Identite=require('ObjetIdentite.js');const GTraductions=require('ObjetTraduction.js');const SecurisationCompte=require('TypeSecurisationCompte.js');const TypeModeGestionDoubleAuthentification=SecurisationCompte.TypeModeGestionDoubleAuthentification;const TypeCommandeSecurisationCompteHttp=SecurisationCompte.TypeCommandeSecurisationCompteHttp;const UtilitaireDeconnexion=require('UtilitaireDeconnexion.js');const tag=require('tag.js');const TypeEtape={val:'val',confirm:'confirm',validation:'validation'};class ObjetSaisieCodePIN extends Identite{constructor(...aParams){super(...aParams);this.options={classeRequete:null,modePIN:ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControlePIN,callbackPINOublie_promise:null,emailOcculte:''};this.codePin={};_init.call(this);this.Actif=true;}
getControleur(aInstance){return $.extend(true,super.getControleur(this),{inputVal:{getValue:function(){return aInstance.codePin.val;},getDisabled:function(){return true;},getClass:function(){return!_getDisabled.call(aInstance)&&aInstance.codePin.etapeConfirmation===TypeEtape.val?'scp_inputActif':'';}},inputConfirm:{getValue:function(){return aInstance.codePin.confirm;},getClass:function(){return!_getDisabled.call(aInstance)&&aInstance.codePin.etapeConfirmation===TypeEtape.confirm?'scp_inputActif':'';}},btnVal:{event:function(aVal){switch(aInstance.codePin.etapeConfirmation){case TypeEtape.val:aInstance.codePin.val+=aVal;break;case TypeEtape.confirm:aInstance.codePin.confirm+=aVal;break;}},getDisabled:_getDisabled.bind(aInstance)},btnClear:{event:function(){_init.call(aInstance);},getDisabled:_getDisabled.bind(aInstance,true)},btnValider:{event:function(){_surValider.call(aInstance);},getDisabled:_getDisabled.bind(aInstance)},btnPINOubli:{event:function(){const lNode=this.node;new(aInstance.options.classeRequete)(aInstance).lancerRequete({action:TypeCommandeSecurisationCompteHttp.csch_DemandeReinitialisationPIN}).then(function(aJSONReponse){if(aJSONReponse.ok){return GApplication.getMessage().afficher({message:GTraductions.getValeur('DoubleAuth.EMailReinitialisationPIN_S',[aInstance.options.emailOcculte])});}
return Promise.reject();}).then(function(){return aInstance.options.callbackPINOublie_promise();}).then(function(aParams){if(aParams&&aParams.reinitPIN_OK){aInstance.Actif=false;aInstance.$refreshSelf();$(lNode).hide();}});}},getHtmlMessagePin:function(){return _construireMessagePINVerification.call(aInstance);}});}
setDonnees(aDonnees){this.donnees=aDonnees;_init.call(this);this.Afficher(_construire.call(this));}
surValider(){_surValider.call(this,true);}}
ObjetSaisieCodePIN.ModeSaisieValiderPIN={msControlePIN:'msControlePIN',msModifierPIN:'msModifierPIN',msDefinirPIN:'msDefinirPIN',msControleReInitPIN:'msControleReInitPIN'};function _init(){Object.assign(this.codePin,{val:'',confirm:'',etapeConfirmation:TypeEtape.val,saisiePinVerifie:false});this.callback.appel('');}
function _construireMessagePINVerification(){if(this.codePin.saisiePinVerifie){return['<i class="icon_ok"></i>',GTraductions.getValeur('DoubleAuth.ValiderCodeValide')
].join('');}
if(this.codePin.nbEchecVerifie>0){const H=[];if(this.codePin.nbEchecVerifie>=SecurisationCompte.C_MaxPinRetry){H.push(GTraductions.getValeur('DoubleAuth.ValiderCodePinInvalide'));} else{H.push('<i class="icon_remove"></i>',GTraductions.getValeur('DoubleAuth.NouvelAppareilTentatives',[SecurisationCompte.C_MaxPinRetry-this.codePin.nbEchecVerifie]));}
return H.join('');}}
function _surValider(aAppelValiderExterne){const lEstControleReInitPIN=this.options.modePIN===ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControleReInitPIN;if(this.options.modePIN!==ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControlePIN&&!lEstControleReInitPIN){if(this.codePin.etapeConfirmation===TypeEtape.val){if(this.codePin.val.length<SecurisationCompte.C_MinPinLength){return GApplication.getMessage().afficher({message:GTraductions.getValeur('DoubleAuth.PinInsuffisant',[SecurisationCompte.C_MinPinLength])});}
this.codePin.etapeConfirmation=TypeEtape.confirm;return;}
if(this.codePin.etapeConfirmation===TypeEtape.confirm){if(this.codePin.val!==this.codePin.confirm){return GApplication.getMessage().afficher({message:GTraductions.getValeur('DoubleAuth.PinNonConfirme')});}
this.codePin.etapeConfirmation=TypeEtape.validation;}}
if(this.options.modePIN===ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControlePIN||lEstControleReInitPIN){if(aAppelValiderExterne&&!this.codePin.val){return GApplication.getMessage().afficher({message:GTraductions.getValeur('DoubleAuth.InfoSaisiePIN')});}
new(this.options.classeRequete)(this).lancerRequete({action:lEstControleReInitPIN?TypeCommandeSecurisationCompteHttp.csch_VerifierCodeReinitialisationPIN:TypeCommandeSecurisationCompteHttp.csch_VerifierPIN,codePin:this.codePin.val}).then(function(aJSON){if(aJSON&&aJSON.result){this.codePin.saisiePinVerifie=true;this.callback.appel(this.codePin.val,aAppelValiderExterne);} else{return Promise.reject();}}.bind(this)).catch(function(){_init.call(this);this.codePin.nbEchecVerifie=this.codePin.nbEchecVerifie||0;this.codePin.nbEchecVerifie+=1;if(this.codePin.nbEchecVerifie===1){GApplication.getMessage().afficher({message:GTraductions.getValeur('DoubleAuth.ValiderCodePinInvalide')+'<br>'+
GTraductions.getValeur('DoubleAuth.NouvelAppareilTentatives',[SecurisationCompte.C_MaxPinRetry-this.codePin.nbEchecVerifie])});}
if(this.codePin.nbEchecVerifie>=SecurisationCompte.C_MaxPinRetry){return UtilitaireDeconnexion.deconnexion();}}.bind(this));} else{this.callback.appel(this.codePin.val);}}
function _getDisabled(aEstBtnClear){if(!this.Actif){return true;}
let lDisabled=this.donnees.mode!==TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN;if(lDisabled){_init.call(this);this.$refreshSelf();}
if(this.donnees.mode===TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN&&
this.options.modePIN===ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControlePIN&&(this.codePin.saisiePinVerifie||
this.codePin.nbEchecVerifie>=SecurisationCompte.C_MaxPinRetry)){lDisabled=true;}
if(aEstBtnClear!==true&&
this.donnees.mode===TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN&&
this.codePin.etapeConfirmation===TypeEtape.validation){lDisabled=true;}
return lDisabled;}
function _construire(){const H=[];H.push('<div class="ObjetSaisieCodePIN">');if(this.options.modePIN===ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControlePIN){H.push(tag('label',GTraductions.getValeur('DoubleAuth.ValiderInfoPIN')));} else if(this.options.modePIN===ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControleReInitPIN){H.push(tag('label',GTraductions.getValeur('DoubleAuth.ProcedureReInitialisationCodePIN')));}
H.push('<div class="scp_zone">');H.push('<div class="scp_gauche">');let lPlaceholder='';switch(this.options.modePIN){case ObjetSaisieCodePIN.ModeSaisieValiderPIN.msModifierPIN:lPlaceholder=GTraductions.getValeur('DoubleAuth.InfoNouveauPIN',[SecurisationCompte.C_MinPinLength]);break;case ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControleReInitPIN:lPlaceholder=GTraductions.getValeur('DoubleAuth.InfosSaisieReinitialisationPIN');break;default:lPlaceholder=GTraductions.getValeur('DoubleAuth.InfoSaisiePIN');break;}
let lHtmlBtnOublie='';if(this.options.callbackPINOublie_promise){lHtmlBtnOublie=tag('ie-bouton',{'ie-model':'btnPINOubli',class:'bt-pin-oublie',title:GTraductions.getValeur('DoubleAuth.HintReinitialiserMonCodePIN')},GTraductions.getValeur('DoubleAuth.ReinitialiserMonCodePIN'));}
H.push(tag('div',{class:"input-field"},tag('input',{type:"password",'ie-model':"inputVal",class:"style-input",'ie-class':"getClass",placeholder:lPlaceholder})));if(this.options.modePIN!==ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControlePIN&&this.options.modePIN!==ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControleReInitPIN){H.push('<div class="input-field">','<input type="password" ie-model="inputConfirm" disabled class="style-input" ie-class="getClass" placeholder="',GTraductions.getValeur('DoubleAuth.InfoConfirmPIN'),'" />');if(this.options.modePIN===ObjetSaisieCodePIN.ModeSaisieValiderPIN.msDefinirPIN){H.push('<p class="text-pin">',GTraductions.getValeur('DoubleAuth.CodePINMinimum',[SecurisationCompte.C_MinPinLength]),'</p>');}
H.push('</div>');} else{if(this.options.modePIN===ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControlePIN){if(lHtmlBtnOublie){if(!IE.estMobile){H.push(lHtmlBtnOublie);}} else{H.push('<label>',GTraductions.getValeur('DoubleAuth.NouvelAppareilOubliPIN'),'</label>');}}
H.push('<div class="scp_ecarteur_flex"></div>');H.push('<div ie-html="getHtmlMessagePin" class="scp_messagePin"></div>');}
H.push('</div>');H.push('<div class="scp_boutons">');const lTab=[];for(let i=0;i<10;i++){lTab.push(i);}
while(lTab.length>0){const lIndice=Math.floor(Math.random()*lTab.length);const lVal=lTab[lIndice];lTab.splice(lIndice,1);H.push('<ie-bouton class="themeBoutonNeutre"',GHtml.composeAttr('ie-model','btnVal',lVal),'>',lVal,'</ie-bouton>');}
H.push('<ie-bouton class="themeBoutonNeutre scp_btnclear"',GHtml.composeAttr('ie-model','btnClear'),GHtml.composeAttr('title',GTraductions.getValeur('DoubleAuth.Effacer')),'>','<i class="icon_delete_clavier_mobile"></i>','</ie-bouton>');H.push('<ie-bouton class="themeBoutonNeutre scp_btnvalider"',GHtml.composeAttr('ie-model','btnValider'),'>',GTraductions.getValeur('Valider'),'</ie-bouton>');H.push('</div>');H.push('</div>');if(lHtmlBtnOublie&&IE.estMobile){H.push(tag('div',{class:'bt-pin-bas'},lHtmlBtnOublie));}
H.push('</div>');return H.join('');}
module.exports=ObjetSaisieCodePIN;},fn:"objetsaisiecodepin.js"});;
IE.fModule({f:function(exports,require,module,global){require('Produit/Css/ObjetChoixStrategieSecurisation.css');const GHtml=require('GHtml.js');const Identite=require('ObjetIdentite.js');const GTraductions=require('ObjetTraduction.js');const SecurisationCompte=require('TypeSecurisationCompte.js');const TypeModeGestionDoubleAuthentification=SecurisationCompte.TypeModeGestionDoubleAuthentification;const TypeEnsembleNombre=require('TypeEnsembleNombre.js');const ObjetSaisieCodePIN=require('ObjetSaisieCodePIN.js');class ObjetChoixStrategieSecurisation extends Identite{constructor(...aParams){super(...aParams);this.options={modeAffichage:ObjetChoixStrategieSecurisation.typeAffichage.prefUtilisateur,modesPossibles:new TypeEnsembleNombre(),modeSecurisationParDefaut:TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN,callbackChoix:null,optionsPIN:{},callbackPIN:null};}
getControleur(aInstance){return $.extend(true,super.getControleur(this),{rbChoixStrat:{getValue:function(aGenre){if(aInstance.donnees.mode===aGenre){return true;}
const lModesPossibles=aInstance.options.modesPossibles;switch(aGenre){case TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN:return(aInstance.donnees.mode===TypeModeGestionDoubleAuthentification.MGDA_PasEncoreChoisi||(!lModesPossibles.contains(TypeModeGestionDoubleAuthentification.MGDA_NotificationSeulement)&&!lModesPossibles.contains(TypeModeGestionDoubleAuthentification.MGDA_Inactive)));case TypeModeGestionDoubleAuthentification.MGDA_NotificationSeulement:return((!lModesPossibles.contains(TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN)&&[TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN,TypeModeGestionDoubleAuthentification.MGDA_PasEncoreChoisi].indexOf(aInstance.donnees.mode)>=0)||(!lModesPossibles.contains(TypeModeGestionDoubleAuthentification.MGDA_Inactive)&&aInstance.donnees.mode===TypeModeGestionDoubleAuthentification.MGDA_Inactive));case TypeModeGestionDoubleAuthentification.MGDA_Inactive:return!lModesPossibles.contains(TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN)&&!lModesPossibles.contains(TypeModeGestionDoubleAuthentification.MGDA_NotificationSeulement);}
return false;},setValue:function(aGenre){aInstance.options.callbackChoix(aGenre);},getDisabled:_getDisabled.bind(aInstance)},btnPIN:{event:function(){aInstance.options.callbackChoix(TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN);},getDisabled:function(){return aInstance.donnees.mode!==TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN||_getDisabled.call(aInstance);}}});}
setDonnees(aDonnees){this.donnees=aDonnees;if(this.instanceCodePIN){this.instanceCodePIN.free();this.instanceCodePIN=null;}
if(this.options.modeAffichage===ObjetChoixStrategieSecurisation.typeAffichage.securisation){this.instanceCodePIN=Identite.creerInstance(ObjetSaisieCodePIN,{pere:this,evenement:function(){this.options.callbackPIN.apply(this,arguments);}});}
this.Afficher(_construire.call(this));if(this.instanceCodePIN){this.instanceCodePIN.setOptions(this.options.optionsPIN).setDonnees(this.donnees);}}}
ObjetChoixStrategieSecurisation.typeAffichage={prefUtilisateur:'prefUtilisateur',securisation:'securisation'};function _getDisabled(){return!!this.donnees.nonEditable;}
function _construire(){const H=[];let lAvecRB=false;const lUniquementChoixCodePIN=this.options.modesPossibles.count()===1&&this.options.modesPossibles.contains(TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN);H.push('<div class="ObjetChoixStrategieSecurisation">');let lLegende=GTraductions.getValeur('DoubleAuth.RenforcerSecuInfo')+'<br />';if(lUniquementChoixCodePIN){lLegende+=GTraductions.getValeur('DoubleAuth.RenforcerSecuPINImpose');} else{lLegende+=GTraductions.getValeur('DoubleAuth.RenforcerSecuChoix');}
H.push('<p>',lLegende,'</p>');H.push('<a href="',GTraductions.getValeur('DoubleAuth.urlTutoVideoSecurite'),'"target="_blank" class="css_lienVideo">',GTraductions.getValeur('DoubleAuth.TutoVideoSecurite'),'</a>');H.push('<div class="css_Choix">');TypeModeGestionDoubleAuthentification.getOrdreModeDoubleAuth(this.options.modeSecurisationParDefaut).forEach(function(aMode){switch(aMode){case TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN:if(this.options.modesPossibles.contains(TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN)){H.push(`<div class="choix">`);if(!lUniquementChoixCodePIN){H.push('<ie-radio class="css_rbMode colored-label"',GHtml.composeAttr('ie-model','rbChoixStrat',[TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN]),'>',GTraductions.getValeur('DoubleAuth.RenforcerSecuDefinirPIN'),'</ie-radio>');lAvecRB=true;}
switch(this.options.modeAffichage){case ObjetChoixStrategieSecurisation.typeAffichage.prefUtilisateur:H.push('<div class="css_btnPin">','<ie-bouton ie-model="btnPIN">',GTraductions.getValeur('DoubleAuth.RenforcerButtonModifier'),'</ie-bouton>','</div>');break;case ObjetChoixStrategieSecurisation.typeAffichage.securisation:H.push('<div class="css_btnPin">','<div class="css_titreCodePIN"><label>',GTraductions.getValeur('DoubleAuth.RenforcerSecuInfoPIN'),'</label></div>','<div class="saisie-pin" id="',this.instanceCodePIN.GetNom(),'"></div>','</div>');break;default:;}
H.push(`</div>`);}
break;case TypeModeGestionDoubleAuthentification.MGDA_NotificationSeulement:if(this.options.modesPossibles.contains(TypeModeGestionDoubleAuthentification.MGDA_NotificationSeulement)){H.push(`<div class="choix">`);if(lAvecRB&&this.options.modeAffichage===ObjetChoixStrategieSecurisation.typeAffichage.securisation){H.push('<div class="sc_mode_sep"></div>');}
H.push('<ie-radio class="css_rbMode  colored-label"',GHtml.composeAttr('ie-model','rbChoixStrat',[TypeModeGestionDoubleAuthentification.MGDA_NotificationSeulement]),'>',GTraductions.getValeur('DoubleAuth.RenforcerSecuNotification1'),'</ie-radio>','<p>',GTraductions.getValeur('DoubleAuth.RenforcerSecuNotification2'),'</p>');lAvecRB=true;H.push(`</div>`);}
break;case TypeModeGestionDoubleAuthentification.MGDA_Inactive:if(this.options.modesPossibles.contains(TypeModeGestionDoubleAuthentification.MGDA_Inactive)){H.push(`<div class="choix">`);if(lAvecRB&&this.options.modeAffichage===ObjetChoixStrategieSecurisation.typeAffichage.securisation){H.push('<div class="sc_mode_sep"></div>');}
H.push('<ie-radio class="css_rbMode  colored-label"',GHtml.composeAttr('ie-model','rbChoixStrat',[TypeModeGestionDoubleAuthentification.MGDA_Inactive]),'>',GTraductions.getValeur('DoubleAuth.RenforcerSecuAucune'),'</ie-radio>');H.push(`</div>`);}
break;default:;}}.bind(this));H.push('</div>');H.push('</div>');return H.join('');}
module.exports=ObjetChoixStrategieSecurisation;},fn:"objetchoixstrategiesecurisation.js"});;
IE.fModule({f:function(exports,require,module,global){require('Produit/Css/InterfaceSecurisationCompteCP.css');const MethodesObjet=require('MethodesObjet.js');const ObjetInterface=require('ObjetInterface.js');const GTraductions=require('ObjetTraduction.js');const GHtml=require('GHtml.js');const SecurisationCompte=require('TypeSecurisationCompte.js');const TypeModeGestionDoubleAuthentification=SecurisationCompte.TypeModeGestionDoubleAuthentification;const TypeActionIHMSecurisationCompte=SecurisationCompte.TypeActionIHMSecurisationCompte;const TypeCommandeSecurisationCompteHttp=SecurisationCompte.TypeCommandeSecurisationCompteHttp;const ObjetChoixStrategieSecurisation=require('ObjetChoixStrategieSecurisation.js');const ObjetSaisieCodePIN=require('ObjetSaisieCodePIN.js');const EStructureAffichage=require('Enumere_StructureAffichage.js');const ObjetRequeteSecurisationCompteDoubleAuth=require('ObjetRequeteSecurisationCompte.js').ObjetRequeteSecurisationCompteDoubleAuth;const EGenreAction=require('Enumere_Action.js');const EGenreBoiteMessage=require('Enumere_BoiteMessage.js');const ToucheClavier=require('ToucheClavier.js');const TypeThemeBouton=require('Type_ThemeBouton.js');const ObjetFenetre=require('ObjetFenetre.js');class InterfaceSecurisationCompteCP extends ObjetInterface{constructor(...aParams){super(...aParams);this.valeurs={cbIdentification:true,strIdentification:'',mode:TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN,avecWarningIdentification:true};this.GenreStructure=EStructureAffichage.Autre;}
getControleur(aInstance){return $.extend(true,super.getControleur(this),{cbIdentification:{getValue:function(){return aInstance.valeurs.cbIdentification&&_avecIdentificationAppareil.call(aInstance);},setValue:function(aValue){aInstance.valeurs.cbIdentification=aValue;if(aInstance.valeurs.avecWarningIdentification&&!aInstance.valeurs.cbIdentification){aInstance.valeurs.avecWarningIdentification=false;GApplication.getMessage().afficher({message:GTraductions.getValeur('DoubleAuth.EnregistrerAppareilResterInconnu')+'<br>'+
GTraductions.getValeur('DoubleAuth.PersonnesConfiance')});}},getDisabled:function(){return!_avecIdentificationAppareil.call(aInstance);}},inputIdentification:{getValue:function(){return aInstance.valeurs.strIdentification;},setValue:function(aValue){aInstance.valeurs.strIdentification=aValue;},getDisabled:function(){return!aInstance.valeurs.cbIdentification||!_avecIdentificationAppareil.call(aInstance);},node:function(){$(this.node).on('keyup',function(aEvent){if(aEvent.which===ToucheClavier.RetourChariot){_surSuivant(aInstance);}});}},getHtmlCompteurInput:function(){return aInstance.valeurs.strIdentification.length>0?aInstance.valeurs.strIdentification.length+'/'+SecurisationCompte.C_LibelleAppareilMaxLength:'&nbsp;';},btnAnnuler:{event:function(){aInstance.resolve({annuler:true});}},btnSuivant:{event:function(){_surSuivant(aInstance);}}});}
ConstruireInstances(){this.identChoixStrategie=this.Add(ObjetChoixStrategieSecurisation);this.identSaisieCodePIN=this.Add(ObjetSaisieCodePIN,_evenementSaisieCodePIN);}
setDonneesPromise(aDonnees){return new Promise(function(aResolve){this.donnees=aDonnees;if(this.donnees.libelleSaisieExistant&&this.donnees.changementStrategieImpose){this.valeurs.strIdentification=this.donnees.libelleSaisieExistant;}
this.resolve=aResolve;this.Afficher(_construire.call(this));if(this.donnees.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_ChoixStrategie)){_initVerifierMode(this);this.GetInstance(this.identChoixStrategie).setOptions({modeAffichage:ObjetChoixStrategieSecurisation.typeAffichage.securisation,modesPossibles:this.donnees.modesPossibles,modeSecurisationParDefaut:this.donnees.modeSecurisationParDefaut,callbackChoix:function(aGenre){this.valeurs.mode=aGenre;delete this.valeurs.codePIN;if(!_avecIdentificationAppareil.call(this)){this.valeurs.strIdentification='';}}.bind(this),optionsPIN:{classeRequete:ObjetRequeteSecurisationCompteDoubleAuth,modePIN:ObjetSaisieCodePIN.ModeSaisieValiderPIN.msDefinirPIN},callbackPIN:_evenementSaisieCodePIN.bind(this)}).setDonnees(this.valeurs);} else if(this.donnees.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_SaisieCodePINetSource)){this.GetInstance(this.identSaisieCodePIN).setOptions({classeRequete:ObjetRequeteSecurisationCompteDoubleAuth,modePIN:ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControlePIN,callbackPINOublie_promise:this.donnees.avecReinitPIN?_callbackPINOublie_promise.bind(this):null,emailOcculte:this.donnees.emailOcculte}).setDonnees(this.valeurs);}
this.FocusSurPremierElement();}.bind(this));}
FocusSurPremierElement(){GHtml.setFocus($('#'+this.Nom.escapeJQ()+' section:first-child').get(0));}}
const c_echecControle='echecControle';function _surSuivant(aInstance){const lEstChoixStrategie=aInstance.donnees.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_ChoixStrategie);const lAvecSaisieCodePIN=aInstance.valeurs.mode===TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN;const lModeCodePIN=aInstance.donnees.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_SaisieCodePINetSource);if((lEstChoixStrategie||lModeCodePIN)&&lAvecSaisieCodePIN&&!aInstance.valeurs.codePIN){let lInstanceCodePIN=null;if(lEstChoixStrategie){const lInstanceStrat=aInstance.GetInstance(aInstance.identChoixStrategie);if(lInstanceStrat){lInstanceCodePIN=lInstanceStrat.instanceCodePIN;}} else if(lModeCodePIN){lInstanceCodePIN=aInstance.GetInstance(aInstance.identSaisieCodePIN);}
if(lInstanceCodePIN){return lInstanceCodePIN.surValider();}}
if(_avecIdentificationAppareil.call(aInstance)){if(aInstance.valeurs.cbIdentification&&!aInstance.valeurs.strIdentification){return GApplication.getMessage().afficher({message:GTraductions.getValeur('DoubleAuth.EnregistrerAppareilNomInvalide')}).then(function(){_focusInputIndentification(aInstance);});}}
_controleNomUniquePromise(aInstance).then(function(){const lDonnees={};if(aInstance.donnees.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_ChoixStrategie)){lDonnees.mode=aInstance.valeurs.mode;}
if(aInstance.valeurs.mode===TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN){lDonnees.codePin=aInstance.valeurs.codePIN;}
if(aInstance.valeurs.reinitPIN_OK){lDonnees.codePINVerifReinit=aInstance.valeurs.codePINVerifReinit;lDonnees.reinitPIN_OK=true;}
if(_avecIdentificationAppareil.call(aInstance)){lDonnees.avecIdentification=aInstance.valeurs.cbIdentification;if(lDonnees.avecIdentification){lDonnees.strIdentification=aInstance.valeurs.strIdentification;}}
aInstance.resolve({suivant:true,donnees:lDonnees});},function(aParams){});}
function _controleNomUniquePromise(aInstance){return Promise.resolve().then(function(){if(aInstance.valeurs.cbIdentification&&aInstance.valeurs.strIdentification){if(aInstance.donnees.changementStrategieImpose&&aInstance.valeurs.strIdentification===aInstance.donnees.libelleSaisieExistant){return;}
return new ObjetRequeteSecurisationCompteDoubleAuth(aInstance).lancerRequete({action:TypeCommandeSecurisationCompteHttp.csch_LibellesSourceConnexionDejaConnus,libelle:aInstance.valeurs.strIdentification}).then(function(aJSON){if(aJSON&&aJSON.dejaConnu){if(aInstance.donnees.changementStrategieImpose){return GApplication.getMessage().afficher({message:GTraductions.getValeur('DoubleAuth.LibelleAppareilDejaUtilise')}).then(function(){_focusInputIndentification(aInstance);return Promise.reject(c_echecControle);});}
let lMessage='';if(GApplication.estAppliMobile||!GParametres.urlFAQEnregistrementDoubleAuth){lMessage=GTraductions.getValeur('DoubleAuth.EnregistrerAppareilNomDejaUtilise');} else{lMessage=[
GTraductions.getValeur('DoubleAuth.Message_SourceConnexion_1'),'<br><br>','<ul class="browser-default"><li>',GTraductions.getValeur('DoubleAuth.Message_SourceConnexion_2'),'<div style="font-style: italic; padding:.3rem 0 .5rem 0;">',GTraductions.getValeur('DoubleAuth.Message_SourceConnexion_3_S',['<a href="'+GParametres.urlFAQEnregistrementDoubleAuth+'">'+GTraductions.getValeur('DoubleAuth.FAQEnregistrement')+'</a>'
]),'</div></li><li>',GTraductions.getValeur('DoubleAuth.Message_SourceConnexion_4'),'</li></ul>'
].join('');}
return GApplication.getMessage().afficher({type:EGenreBoiteMessage.Confirmation,message:lMessage,listeBoutons:[{libelle:GTraductions.getValeur('Annuler'),theme:TypeThemeBouton.secondaire},{libelle:GTraductions.getValeur('Valider'),theme:TypeThemeBouton.primaire,genreAction:EGenreAction.Valider}]}).then(function(aGenreAction){if(aGenreAction!==EGenreAction.Valider){_focusInputIndentification(aInstance);return Promise.reject(c_echecControle);}});}});}});}
function _evenementSaisieCodePIN(aCodePIN,aAppelValiderExterne){this.valeurs.codePIN=aCodePIN;if(this.valeurs.codePIN){if(aAppelValiderExterne){_surSuivant(this);} else{_focusInputIndentification(this);}}}
function _focusInputIndentification(aInstance){$('#'+aInstance.Nom.escapeJQ()+' .sc_identification input:not(.sc_input_bidon)').focus();}
function _avecIdentificationAppareil(){return[TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN,TypeModeGestionDoubleAuthentification.MGDA_NotificationSeulement].indexOf(this.valeurs.mode)>=0;}
function _construire(){const lAvecChoixStrategie=this.donnees.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_ChoixStrategie);const lAvecChoixCodePIN=this.donnees.actionsDoubleAuth.contains(TypeActionIHMSecurisationCompte.AIHMSC_SaisieCodePINetSource);const H=[];H.push('<div class="InterfaceSecurisationCompteCP">');if(lAvecChoixStrategie){H.push('<section class="choix-strategie" tabindex="-1">','<h1>',GTraductions.getValeur('DoubleAuth.RenforcerSecuTitre'),'</h1>','<div  id="',this.GetInstance(this.identChoixStrategie).Nom,'"></div>','</section>');} else if(lAvecChoixCodePIN){H.push('<section class="choix-pin" tabindex="-1">','<h1>',GTraductions.getValeur('DoubleAuth.ValiderTitreInconnu'),'</h1>','<div class="sc_zone">','<div class="sc_codePIN" id="',this.GetInstance(this.identSaisieCodePIN).GetNom(),'"></div>','</div>','</section>');} else{}
H.push('<section class="identification" tabindex="-1">','<h1>',!lAvecChoixStrategie&&!lAvecChoixCodePIN?GTraductions.getValeur('DoubleAuth.ValiderTitreInconnu'):GTraductions.getValeur('DoubleAuth.EnregistrerAppareilTitre'),'</h1>','<div class="sc_identification">','<div class="sc_legende">',!lAvecChoixStrategie&&!lAvecChoixCodePIN?GTraductions.getValeur('DoubleAuth.EnregistrerAppareilRappelNotif')+'<br>':'',GTraductions.getValeur('DoubleAuth.EnregistrerAppareilInfoIdentification'),'</div>','<ie-checkbox ie-model="cbIdentification">',GTraductions.getValeur('DoubleAuth.EnregistrerAppareilNommerAppareil'),'</ie-checkbox>','<div class="sc_legende_cb">',GTraductions.getValeur('DoubleAuth.EnregistrerAppareilSuggestions'),'</div>','<div class="input-field">','<input type="text" ie-model="inputIdentification" class="style-input" maxlength="',SecurisationCompte.C_LibelleAppareilMaxLength,'" ie-trim autocomplete="address-level1" />','<div ie-html="getHtmlCompteurInput" class="sc_compteurInput"></div>',!lAvecChoixStrategie&&GParametres.urlFAQEnregistrementDoubleAuth?'<a class="sc_lien_faq" href="'+GParametres.urlFAQEnregistrementDoubleAuth+'">'+GTraductions.getValeur('DoubleAuth.MessageFAQEnregistrement')+'</a>':'','<input type="text" class="sc_input_bidon" autocomplete="address-level1" />','</div>','</div>','</section>');H.push('<section class="sc_boutonsValid" tabindex="-1">','<ie-bouton ie-model="btnAnnuler">',GTraductions.getValeur('DoubleAuth.Annuler'),'</ie-bouton>','<ie-bouton ie-model="btnSuivant" class="themeBoutonPrimaire">',GTraductions.getValeur('DoubleAuth.Suivant'),'</ie-bouton>','</section>');H.push('</div>');return H.join('');}
function _initVerifierMode(aInstance){if(MethodesObjet.isNumber(aInstance.donnees.modeSecurisationParDefaut)){aInstance.valeurs.mode=aInstance.donnees.modeSecurisationParDefaut;}
const lModesPossibles=aInstance.donnees.modesPossibles;if(aInstance.valeurs.mode===TypeModeGestionDoubleAuthentification.MGDA_PasEncoreChoisi||!lModesPossibles.contains(aInstance.valeurs.mode)){TypeModeGestionDoubleAuthentification.getOrdreModeDoubleAuth(aInstance.donnees.modeSecurisationParDefaut).every(function(aMode){if(aMode!==aInstance.valeurs.mode&&lModesPossibles.contains(aMode)){aInstance.valeurs.mode=aMode;return false;}
return true;});}}
function _callbackPINOublie_promise(){return ObjetFenetre.creerInstance(_ObjetFenetre_ReinitPIN,{pere:this}).Afficher().then(function(aResult){if(aResult&&aResult.resultReinitPIN){return aResult.resultReinitPIN;}}).then(function(aResult){if(aResult&&aResult.reinitPIN_OK){Object.assign(this.valeurs,aResult);_focusInputIndentification(this);}
return aResult;}.bind(this));}
class _ObjetFenetre_ReinitPIN extends ObjetFenetre{constructor(...aParams){super(...aParams);this.resultReinitPIN={};this.etapeVerifPIN=true;this.setOptionsFenetre({titre:GTraductions.getValeur('DoubleAuth.TitreReInitialisationCodePIN'),listeBoutons:[],addParametresValidation:function(){return{resultReinitPIN:this.resultReinitPIN};}.bind(this)});}
ConstruireInstances(){this.identPIN=this.Add(ObjetSaisieCodePIN,function(aCodePIN){if(aCodePIN){if(this.etapeVerifPIN){this.etapeVerifPIN=false;this.resultReinitPIN.codePINVerifReinit=aCodePIN;this.GetInstance(this.identPIN).setOptions({classeRequete:ObjetRequeteSecurisationCompteDoubleAuth,modePIN:ObjetSaisieCodePIN.ModeSaisieValiderPIN.msModifierPIN}).setDonnees({mode:TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN});} else{this.resultReinitPIN.codePIN=aCodePIN;this.resultReinitPIN.reinitPIN_OK=true;this.SurValidation();}}});}
ComposeContenu(){return['<div id="',this.GetInstance(this.identPIN).GetNom(),'"></div>'].join('');}
Afficher(){this.GetInstance(this.identPIN).setOptions({classeRequete:ObjetRequeteSecurisationCompteDoubleAuth,modePIN:ObjetSaisieCodePIN.ModeSaisieValiderPIN.msControleReInitPIN}).setDonnees({mode:TypeModeGestionDoubleAuthentification.MGDA_SaisieCodePIN});return super.Afficher();}}
module.exports=InterfaceSecurisationCompteCP;},fn:"interfacesecurisationcomptecp.js"});;
IE.fModule({f:function(exports,require,module,global){const ObjetFenetre=require('ObjetFenetre.js');const GTraductions=require('ObjetTraduction.js');const GHtml=require('_ObjetHtml.js').GHtml;class ObjetFenetre_MentionsLegales extends ObjetFenetre{constructor(...aParams){super(...aParams);this.idContenu=this.GetNom()+'_Contenu';this.listes={evenements:null,lieux:null};this.parametres={};this.setOptionsFenetre({largeur:450,hauteur:320,listeBoutons:[GTraductions.getValeur('Fermer')]});}
ConstruireInstances(){}
setParametresFenetreSuivi(aParametres){Object.assign(this.parametres,aParametres);}
composeContenu(aParametres){const H=[];H.push('<div class="ie-titre-petit PetitEspaceBas">',GTraductions.getValeur('FenetreMentionsLegales.adresseEtablissement'),'</div>');H.push('<span>',aParametres.adresseEtablissement,'</span>');H.push('<div  class="GrandEspaceHaut ie-titre-petit PetitEspaceBas">',GTraductions.getValeur('FenetreMentionsLegales.formeJuridique'),'</div>');H.push('<span>',aParametres.formeJuridique,'</span>');H.push('<div class="GrandEspaceHaut ie-titre-petit PetitEspaceBas">',GTraductions.getValeur('FenetreMentionsLegales.hebergeur'),'</div>');H.push('<span>',aParametres.hebergeur,'</span>');H.push('<div class="GrandEspaceHaut ie-titre-petit PetitEspaceBas">',GTraductions.getValeur('FenetreMentionsLegales.responsablePublication'),'</div>');H.push('<span>',aParametres.responsablePublication,'</span>');if(!!aParametres.informationsComplementaires){H.push('<div class="GrandEspaceHaut ie-titre-petit PetitEspaceBas">',GTraductions.getValeur('FenetreMentionsLegales.informationsComplementaires'),'</div>');H.push(aParametres.informationsComplementaires);}
H.push('<br>');H.push('<h2 class="ie-titre">',GTraductions.getValeur('FenetreMentionsLegales.utilisationCookie'),'</h2>');H.push('<p>',GTraductions.getValeur('FenetreMentionsLegales.informationCookie',[GApplication.nomProduit]),' ',GTraductions.getValeur('FenetreMentionsLegales.informationCookieSuite',[GApplication.nomProduit]),'</p>');H.push('<p>',GTraductions.getValeur('FenetreMentionsLegales.utilisationCookieTitre'),'</p>');H.push('<ul>','<li style="list-style-type: disc;">',GTraductions.getValeur('FenetreMentionsLegales.utilisationCookieCASTGC'),'</li>','<li style="list-style-type: disc;">',GTraductions.getValeur('FenetreMentionsLegales.utilisationCookieLang'),'</li>','</ul>');return H.join('');}
SetDonnees(aParam){GHtml.setHtml(this.idContenu,this.composeContenu(aParam));this.Afficher();}
ComposeContenu(){const H=[];H.push('<div id="',this.idContenu,'" class="FenetreSuiviStage">');H.push('</div>');return H.join('');}
SurValidation(){this.Fermer();}}
module.exports=ObjetFenetre_MentionsLegales;},fn:"objetfenetre_mentionslegales.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const Requetes=require('CollectionRequetes.js');class ObjetRequeteMentionsLegales extends ObjetRequeteConsultation{constructor(...aParams){super(...aParams);}
lancerRequete(aParametres){Object.assign(this.JSON,aParametres);return this.appelAsynchrone();}
actionApresRequete(){this.callbackReussite.appel(this.JSONReponse);}}
Requetes.inscrire('MentionsLegales',ObjetRequeteMentionsLegales);module.exports=ObjetRequeteMentionsLegales;},fn:"objetrequetementionslegales.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const Requetes=require('CollectionRequetes.js');const GTraductions=require('ObjetTraduction.js');class ObjetRequeteIdentification extends ObjetRequeteConsultation{constructor(...aParams){super(...aParams);}
lancerRequete(aParam){Object.assign(this.JSON,aParam);return this.appelAsynchrone({messageDetail:GTraductions.getValeur('Identification')});}
actionApresRequete(){this.callbackReussite.appel(this.JSONReponse);}}
Requetes.inscrire('Identification',ObjetRequeteIdentification);module.exports=ObjetRequeteIdentification;},fn:"objetrequeteidentification.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const Callback=require('Callback.js');const Requetes=require('CollectionRequetes.js');const GTraductions=require('ObjetTraduction.js');class ObjetRequeteAuthentificationPN extends ObjetRequeteConsultation{constructor(aPere,aEvenementSurReussite,aEvenementSurEchec,aActionAvantDeserialisation){super(aPere,aEvenementSurReussite,aEvenementSurEchec);if(aActionAvantDeserialisation){this.callbackAvantDeserialisation=new Callback(aPere,aActionAvantDeserialisation);}}
lancerRequete(aParam){this.JSON.connexion=aParam.genreConnexion;this.JSON.challenge=aParam.challenge;this.JSON.espace=GEtatUtilisateur.GenreEspace;return this.appelAsynchrone({messageDetail:GTraductions.getValeur('Authentification')});}
actionApresRequete(){if(this.callbackAvantDeserialisation){this.callbackAvantDeserialisation.appel();}
this.callbackReussite.appel(this.JSONReponse);}}
Requetes.inscrire('Authentification',ObjetRequeteAuthentificationPN);module.exports=ObjetRequeteAuthentificationPN;},fn:"objetrequeteauthentificationpn.js"});;
IE.fModule({f:function(exports,require,module,global){const GTraductions=require('ObjetTraduction.js');const TLienPolitiqueMotDePasse={getLien:function(){return['<a href="',GTraductions.getValeur('LienPolitiqueMotDePasse.UrlFAQMotDePasse'),'" target="_blank">',GTraductions.getValeur('LienPolitiqueMotDePasse.ConsulterNotrePolitiqueSecuriteMDP'),'</a>'].join('');}};module.exports=TLienPolitiqueMotDePasse;},fn:"lienpolitiquemotdepasse.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeOptionGenerationMotDePasse={OGMDP_AvecAuMoinsUneLettre:0,OGMDP_AvecAuMoinsUnChiffre:1,OGMDP_AvecAuMoinsUnCaractereSpecial:2,OGMDP_AvecMelangeMinusculeMajuscule:3,OGMDP_AvecControleIdentifiantDifferent:4};module.exports.TypeOptionGenerationMotDePasse=TypeOptionGenerationMotDePasse;},fn:"typeoptiongenerationmotdepasse.js"});;
IE.fModule({f:function(exports,require,module,global){
const MethodesObjet=require('MethodesObjet.js');const GChaine=require('GChaine.js');const GStyle=require('GStyle.js');const GTraductions=require('ObjetTraduction.js');const TypeEnsembleNombre=require('TypeEnsembleNombre.js');const TypeOptionGenerationMotDePasse=require('TypeOptionGenerationMotDePasse.js').TypeOptionGenerationMotDePasse;const TValidationMotDePasse=(function(){function _construireLigneValidateur(aEchec,aTraduction,aOptions){const H=[];H.push('<div class="NoWrap',aOptions.avecEspace?' PetitEspaceBas':'','">');if(aEchec!==undefined){H.push('<div class="InlineBlock AlignementMilieuVertical ',(!aEchec?'Image_CocheVerte as-icon':'Image_CocheCroixRouge as-icon'),'" aria-label="',`${aEchec?GTraductions.getValeur('validationMDP.RegleInvalide'):GTraductions.getValeur('validationMDP.RegleValide')} :`,'"></div>');} else{H.push('<div class="InlineBlock AlignementMilieuVertical" style="',GStyle.composeWidth(16),'"></div>');}
H.push('<div class="InlineBlock AlignementMilieuVertical PetitEspaceGauche">',aTraduction,'</div>');H.push('</div>');return H.join('');}
return{construire:function(aReglesSaisieMotDePasse,aErreursMDP,aOptions){const H=[];let lErreursMDP;const lOptions={avecEspace:true,avecMdpDifferent:false,avecMDPDifferentLogin:true};$.extend(lOptions,aOptions);if(aErreursMDP){lErreursMDP={erreurTailleMDP:false,reglesNonRespectes:new TypeEnsembleNombre()};$.extend(lErreursMDP,aErreursMDP);}
H.push('<div>');H.push('<div class="',lOptions.avecEspace?'EspaceBas':'',' Gras">',GTraductions.getValeur('validationMDP.titre')+' :','</div>');H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.erreurTailleMDP:undefined,MethodesObjet.isNumber(aReglesSaisieMotDePasse.max)?GChaine.Format(GTraductions.getValeur('validationMDP.longueurMDPMinMax'),[aReglesSaisieMotDePasse.min,aReglesSaisieMotDePasse.max]):GChaine.Format(GTraductions.getValeur('validationMDP.longueurMDPMin'),[aReglesSaisieMotDePasse.min]),lOptions));if(aReglesSaisieMotDePasse.regles.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUnChiffre)){H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.reglesNonRespectes.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUnChiffre):undefined,GTraductions.getValeur('validationMDP.chiffre'),lOptions));}
if(aReglesSaisieMotDePasse.regles.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUneLettre)){H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.reglesNonRespectes.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUneLettre):undefined,GTraductions.getValeur('validationMDP.lettre'),lOptions));}
if(aReglesSaisieMotDePasse.regles.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUnCaractereSpecial)){H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.reglesNonRespectes.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecAuMoinsUnCaractereSpecial):undefined,GTraductions.getValeur('validationMDP.special'),lOptions));}
if(aReglesSaisieMotDePasse.regles.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecMelangeMinusculeMajuscule)){H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.reglesNonRespectes.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecMelangeMinusculeMajuscule):undefined,GTraductions.getValeur('validationMDP.MajMin'),lOptions));}
if(lOptions.avecMDPDifferentLogin||aReglesSaisieMotDePasse.regles.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecControleIdentifiantDifferent)){H.push(_construireLigneValidateur(lErreursMDP?lErreursMDP.reglesNonRespectes.contains(TypeOptionGenerationMotDePasse.OGMDP_AvecControleIdentifiantDifferent):undefined,GTraductions.getValeur('validationMDP.login'),lOptions));}
if(lOptions.avecMdpDifferent){H.push(_construireLigneValidateur(lErreursMDP?!!lErreursMDP.MDPIdentique:undefined,GTraductions.getValeur('validationMDP.mdpDifferent'),lOptions));}
H.push('</div>');return H.join('');}};}());module.exports=TValidationMotDePasse;},fn:"validationmotdepasse.js"});;
IE.fModule({f:function(exports,require,module,global){require('Produit/css/ObjetSaisieMotDePasseCP.css');const IEHtml=require('IEHtml.js');const GHtml=require('GHtml.js');const TLienPolitiqueMotDePasse=require('LienPolitiqueMotDePasse.js');const GTraductions=require('ObjetTraduction.js');const ToucheClavier=require('ToucheClavier.js');const TValidationMotDePasse=require('ValidationMotDePasse.js');const GUID=require('GUID.js');const Identite=require('ObjetIdentite.js');class ObjetSaisieMotDePasseCP extends Identite{constructor(...aParams){super(...aParams);this.options={classRequeteSaisie:null,donneesReglesMdp:null,callbackApresValidation:null,callbackFocusValidation:null,setReglesMDP:null,forcerModificationMdp:false,avecMDPActuel:true,avecReglesMDP:true,avecMdpNouveauDifferentDeActuel:true,pourMobile:false,attrInputActuel:'type = "password" autocomplete = "new-password" aria-required="true"',attrInputNouveau:'type = "password" autocomplete = "new-password" aria-required="true"',messageExplication:'',libelleMDPActuel:GTraductions.getValeur('saisieMDP.MotDePasseActuel'),libelleNewMDP:GTraductions.getValeur('saisieMDP.NewMotDePasse'),libelleConfirmNewMDP:GTraductions.getValeur('saisieMDP.Confirmation'),libelleEchecModification:GTraductions.getValeur('saisieMDP.EchecModification'),libelleReussiteModification:GTraductions.getValeur('saisieMDP.ReussiteModification'),libelleMDPActuelIncorrect:GTraductions.getValeur('saisieMDP.MotActuelIncorrect'),libelleConfirmationIncorrecte:GTraductions.getValeur('saisieMDP.ConfirmationIncorrecte')};this.mdp={actuel:'',nouveau:'',confirmation:''};const lId=GUID.getId();this.ids={input1:lId+'_in1',input2:lId+'_in2',input3:lId+'_in3',validateur:lId+'_validateur'};}
setOptions(aOptions){Object.assign(this.options,aOptions);return this;}
SetDonnees(){this.Afficher(_construireHtml.call(this));if(this.options.avecReglesMDP){$('#'+this.ids.validateur.escapeJQ()).IEHtml(TValidationMotDePasse.construire(this.options.donneesReglesMdp,null,_getOptionsValidationMdp.call(this)));}
GHtml.setFocus(!_avecMDPActuel.call(this)?this.ids.input2:this.ids.input1);}
getControleur(aInstance){return $.extend(true,super.getControleur(this),{mdp:{actuel:{getValue:function(){return aInstance.mdp.actuel;},setValue:function(aValue){aInstance.mdp.actuel=aValue;},node:function(){$(this.node).on('keyup',function(event){if(event.which===ToucheClavier.RetourChariot){GHtml.setFocus(aInstance.ids.input2);}});}},nouveau:{getValue:function(){return aInstance.mdp.nouveau;},setValue:function(aValue){aInstance.mdp.nouveau=aValue;},getDisabled:function(){return aInstance.mdp.actuel.length===0&&_avecMDPActuel.call(aInstance);},node:function(){$(this.node).on('keyup',function(event){if(event.which===ToucheClavier.RetourChariot){GHtml.setFocus(aInstance.ids.input3);}});}},confirmation:{getValue:function(){return aInstance.mdp.confirmation;},setValue:function(aValue){aInstance.mdp.confirmation=aValue;},getDisabled:function(){return((aInstance.mdp.actuel.length===0&&_avecMDPActuel.call(aInstance))||aInstance.mdp.nouveau.length===0);},node:function(){$(this.node).on('keyup',function(event){if(event.which===ToucheClavier.RetourChariot&&aInstance.options.callbackFocusValidation){aInstance.options.callbackFocusValidation();}});},getHint:function(){return aInstance.mdp.confirmation.length===0||aInstance.mdp.confirmation===aInstance.mdp.nouveau?null:aInstance.options.libelleConfirmationIncorrecte;}}},montrerMasquerMotDePasse:{event:function(){let lTrigger=$('.as-input.as-password').find('.btnImage');let lTarget=lTrigger.prev('input');lTrigger.toggleClass('icon_eye_close icon_eye_open');lTarget.attr("type")==="password"?lTarget.attr("type","text"):lTarget.attr("type","password");},getTitle:function(){return $('.as-input.as-password').find('.btnImage').hasClass('icon_eye_open')?GTraductions.getValeur('connexion.VoirMDP'):GTraductions.getValeur('connexion.masquerMDP');}},getClassNewMDP:function(){switch(_getEtatNewPassword(aInstance)){case'disabled':return'is-disabled';case'invalid':return'is-dirty';}
return'';},getAttrNewMDP(){return{'aria-invalid':_getEtatNewPassword(aInstance)==='invalid'?'true':null};}});}
avecValidationPossible(){return(this.mdp.actuel.length>0||!_avecMDPActuel.call(this))&&this.mdp.confirmation.length>0;}
valider(){if(!_controleAvantValidation.call(this)){return;}
if(this._requeteSaisieEnCours){return;}
this._requeteSaisieEnCours=true;if(this.options.classRequeteSecurisation){return new(this.options.classRequeteSecurisation)(this).setOptions({gererMessageErreur:function(){}.bind(this)}).lancerRequete({action:this.options.actionRequeteSecurisation,ancienMDP:this.mdp.actuel,nouveauMDP:this.mdp.confirmation}).finally(function(){this._requeteSaisieEnCours=false;}.bind(this)).then(function(aJSON){_surReponseSaisie.call(this,{JSON:aJSON,avecErreur:false,nouveauMDP:this.mdp.confirmation});}.bind(this),function(aParams){return GApplication.getMessage().afficher({titre:this.options.libelleEchecModification,message:aParams?aParams.message||'':''}).then(function(){this.options.callbackApresValidation({avecErreur:true});}.bind(this));}.bind(this));}
return new(this.options.classRequeteSaisie)(this).lancerRequete({ancienMDP:this.mdp.actuel,nouveauMDP:this.mdp.confirmation,forcerModification:this.options.forcerModificationMdp}).then(function(aParams){this._requeteSaisieEnCours=false;_surReponseSaisie.call(this,aParams);}.bind(this),function(){this._requeteSaisieEnCours=false;return GApplication.getMessage().afficher({message:this.options.libelleEchecModification}).then(function(){this.options.callbackApresValidation({avecErreur:true});});}.bind(this));}}
function _avecMDPActuel(){return this.options.avecMDPActuel&&!this.options.forcerModificationMdp;}
function _getOptionsValidationMdp(){return{avecMdpDifferent:this.options.avecMdpNouveauDifferentDeActuel};}
function _construireHtml(){const H=[];H.push('<div class="ObjetSaisieMotDePasseCP">');if(this.options.messageExplication){H.push('<div class="BlocMessageEnTete">',this.options.messageExplication,'</div>');}
H.push('<div class="BlocContenu">');H.push('<div class="BlocMDP">');if(_avecMDPActuel.call(this)){H.push('   <label for="',this.ids.input1,'">',this.options.libelleMDPActuel,'</label>','   <div class="as-input as-password">','       <input ie-model="mdp.actuel" id="',this.ids.input1,'" ',this.options.attrInputActuel,' />','       <ie-btnicon class="icon_eye_open" ie-model="montrerMasquerMotDePasse()" tabIndex="-1"></ie-btnicon>','   </div>');}
H.push('   <label for="',this.ids.input2,'">',this.options.libelleNewMDP,'</label>','   <div class="as-input as-password confirm-wrapper" ie-class="getClassNewMDP">','       <input ie-model="mdp.nouveau" id="',this.ids.input2,'" ',this.options.attrInputNouveau,' ie-attr="getAttrNewMDP" />','       <ie-btnicon class="icon_eye_open" ie-model="montrerMasquerMotDePasse()" tabIndex="-1"></ie-btnicon>','   </div>');H.push('   <label for="',this.ids.input3,'">',this.options.libelleConfirmNewMDP,'</label>','   <div class="as-input as-password confirm-wrapper" ie-class="getClassNewMDP">','       <input ie-model="mdp.confirmation" id="',this.ids.input3,'"  ',this.options.attrInputNouveau,' ie-hint="getHint" ie-attr="getAttrNewMDP" />','       <ie-btnicon class="icon_eye_open" ie-model="montrerMasquerMotDePasse()" tabIndex="-1"></ie-btnicon>','   </div>');H.push('</div>');if(this.options.avecReglesMDP){H.push('<div class="BlocValidation">');H.push('<div class=validateur" id="',this.ids.validateur,'"></div>');H.push('</div>');}
H.push('</div>');if(this.options.avecReglesMDP){H.push('<div class="link-as-button">',TLienPolitiqueMotDePasse.getLien(),'</div>');}
H.push('<div style="display:none"><input type="password" /></div>');H.push('<div style="display:none"><input type="password" /></div>');H.push('<div style="display:none"><input type="password" /></div>');H.push('</div>');return H.join('');}
function _surReponseSaisie(aParams){const lParams=Object.assign({avecErreur:true,JSON:null,messageDejaAffiche:false,messageErreur:''},aParams);if(lParams.JSON&&(lParams.JSON.erreurMDP||lParams.JSON.messageErreur)){if(this.options.avecReglesMDP){this.options.donneesReglesMdp=lParams.JSON.reglesSaisieMDP;if(this.options.setReglesMDP&&lParams.JSON.reglesSaisieMDP){this.options.setReglesMDP(lParams.JSON);}}
const lErreursMDP=lParams.JSON.erreurMDP;let lErreursMDPPourValidation=lErreursMDP;let lMessage='';if(lParams.JSON.messageErreur){lMessage+=lParams.JSON.messageErreur;} else if(lErreursMDP&&lErreursMDP.erreurAncienMDP){lMessage+=this.options.libelleMDPActuelIncorrect+'<br><br>';lErreursMDPPourValidation=null;}
if(this.options.avecReglesMDP&&lErreursMDPPourValidation){lMessage+=TValidationMotDePasse.construire(this.options.donneesReglesMdp,lErreursMDPPourValidation,_getOptionsValidationMdp.call(this));}
let lIdFocus='';this.mdp.nouveau='';this.mdp.confirmation='';if(lParams.JSON.messageErreur||(lErreursMDP&&lErreursMDP.erreurAncienMDP)){this.mdp.actuel='';lIdFocus=this.ids.input1;} else{lIdFocus=this.ids.input2;}
if(this.options.avecReglesMDP){$('#'+this.ids.validateur.escapeJQ()).IEHtml(TValidationMotDePasse.construire(this.options.donneesReglesMdp,lErreursMDPPourValidation,_getOptionsValidationMdp.call(this)));}
return GApplication.getMessage().afficher({titre:this.options.libelleEchecModification,message:lMessage}).then(function(){GHtml.setFocus(lIdFocus);IEHtml.refresh();});} else{if(lParams.avecErreur){this.mdp.nouveau='';this.mdp.confirmation='';}
let lPromise=Promise.resolve();if(!lParams.messageDejaAffiche){if(lParams.avecErreur){lPromise=GApplication.getMessage().afficher({message:this.options.libelleEchecModification+(lParams.messageErreur?'<br><br>'+lParams.messageErreur:'')});} else if(this.options.avecMessageReussiteModif){lPromise=GApplication.getMessage().afficher({message:this.options.libelleReussiteModification});}}
lPromise.then(function(){this.options.callbackApresValidation(lParams);}.bind(this));}}
function _controleAvantValidation(){if(this.mdp.confirmation&&this.mdp.confirmation!==this.mdp.nouveau&&this.options.libelleConfirmationIncorrecte){this.mdp.nouveau='';this.mdp.confirmation='';GApplication.getMessage().afficher({message:this.options.libelleConfirmationIncorrecte}).then(function(){GHtml.setFocus(this.ids.input2);IEHtml.refresh();}.bind(this));return false;}
return true;}
function _getEtatNewPassword(aInstance){return aInstance.mdp.actuel.length===0&&_avecMDPActuel.call(aInstance)?'disabled':aInstance.mdp.confirmation.length===0||aInstance.mdp.confirmation===aInstance.mdp.nouveau?'valid':'invalid';}
ObjetSaisieMotDePasseCP.C_TailleMaxMotDePasse=32;ObjetSaisieMotDePasseCP.C_TailleMinLogin=2;ObjetSaisieMotDePasseCP.C_TailleMaxLogin=128;module.exports=ObjetSaisieMotDePasseCP;},fn:"objetsaisiemotdepassecp.js"});;
IE.fModule({f:function(exports,require,module,global){module.exports=function(aParams){var H='';H+='<div class="mobile '+aParams.options.classApplication+'">';H+='<nav class="nav-login" id='+aParams.id.BandeauLogin+' >';H+='<div class="nav-wrapper connexion">';H+='<div class="masque-rond">';H+='<div class="content">';H+='<div class="titre">';H+='<h1>'+aParams.options.nomEspace+'</h1>';H+='<h2> '+aParams.options.titreEtablissement+'</h2>';H+='</div>';H+='</div>';H+='</div>';H+='</div>';H+='<div class="drapeau-changement-langue" ie-display="visibiliteChangementLangue" ie-html="choixLangue"></div>';H+='</nav>';H+='<nav class="nav-login" style="display:none" id='+aParams.id.BandeauDoubleAuth+'>';H+='<div class="nav-wrapper design-2021">';H+='<div class="header-gauche">';H+='<div class="masque-vide"></div>';H+='</div>';H+='<div class="header-droit">';H+='<div class="infos-container" tabIndex="0" role="heading">';H+='<h1>'+aParams.options.nomEspace+' </h1>';H+='<h2> '+aParams.options.titreEtablissement+' </h2>';H+='</div>';H+='</div>';H+='</div>';H+='</nav>';H+='<main class="main-contain">';H+='<form id='+aParams.id.Form+' target="_self" onsubmit="event.stopImmediatePropagation();event.preventDefault();return false;"  autocomplete="off">';H+='<fieldset class="login-contain">';H+='<h3 class="'+aParams.options.classLogoName+'"><span>'+aParams.options.nomApplication+'</span></h3>';H+='<div class="input-field">';H+='<input id="'+aParams.id.identification+'" type="text" title="'+aParams.traductions.texteTitreIdentifiant+'" ie-model="login" ie-textbrut autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />';H+='<label for="'+aParams.id.identification+'" class="icon_uniF2BD">'+aParams.traductions.texteIdentifiant+'</label>';H+='</div>';H+='<div class="input-field">';H+='<div class="as-input as-password">';H+='<input id="'+aParams.id.motDePasse+'" type="password" title="'+aParams.traductions.texteTitreMotdepasse+'" ie-model="motDePasse" />';H+='<ie-btnicon class="icon_eye_open" ie-model="montrerMasquerMotDePasse()" ie-title="montrerMasquerMotDePasse.getTitle"></ie-btnicon>';H+='</div>';H+='<label for="'+aParams.id.motDePasse+'"  class="icon_strategie_code_pin">'+aParams.traductions.texteMotdepasse+'</label>';H+='</div>';H+='<div class="check-field ">';H+='<ie-checkbox ie-textleft  class="colored-label" id="'+aParams.id.checkSouvenir+'" ie-model="stockageMDP"  title="'+aParams.traductions.seSouvenirInfo+'">'+aParams.traductions.seSouvenirLabel+'</ie-checkbox>';H+='</div>';H+='<div class="btn-contain">';H+='<ie-bouton id="'+aParams.id.btnConnexion+'" class="themeBoutonPrimaire" ie-model="boutonValidation">'+aParams.traductions.texteBouton+'</ie-bouton>';H+='</div>';H+='<div class="retour-espace"  ie-display="visibiliteRetourEspace">';H+='<p>'+aParams.traductions.redirigeMobile+'</p>';H+='<ie-bouton class=" small-bt themeBoutonNeutre" onclick="'+aParams.id.thisNom+'.retourEspaceBureau()">'+aParams.traductions.retourEspace+'</ie-bouton>';H+='</div>';H+='</fieldset>';H+='</form>';H+='<div id='+aParams.id.ChangementMDP+' style="display:none">';H+='<div id='+aParams.id.ContenuChangementMDP+'></div>';H+='<div  class="btn-contain">';H+='<ie-bouton id="'+aParams.id.BtnChangementMDP+'" class="themeBoutonPrimaire" ie-model="boutonChangementMDP">';H+=aParams.traductions.valider+'</ie-bouton>';H+='</div>';H+='</div>';H+='<div id='+aParams.id.securisationCompte+' style="display:none">';H+='<div id='+aParams.id.contenuSecurisationCompte+'></div>';H+='</div>';H+='</main>';if(aParams.options.afficherCookieInfo){H+='<div class="cookies-disclaimer">';H+='<p>';H+=aParams.traductions.cookiesMessage1;H+='&nbsp;'+aParams.traductions.cookiesMessage2;H+='<span role="button" tabindex="0" class="as-link m-left" ie-node="ouvrirMentionsLegales" aria-haspopup="dialog">'+aParams.traductions.mentionsLegales+'.</span>';H+='</p>';H+='<ie-bouton tabindex="0" aria-label="$'+aParams.traductions.fermer+'" ie-hint="'+aParams.traductions.fermer+'" ie-node="btnFermer">'+aParams.traductions.fermer+'</ie-bouton>';H+='</div>';}
H+='<footer style="flex-wrap: wrap;">';if(aParams.options.mentionsPagesPubliques&&aParams.options.mentionsPagesPubliques.lien){H+='<div style="flex-basis: 100%; text-align: center;">'+aParams.options.mentionsPagesPubliques.lien+'</div>';}
if(aParams.options.publierMentions){H+='<div class="AvecMain" ie-node="ouvrirMentionsLegales">'+aParams.traductions.mentionsLegales+'</div>';}
H+='<a href="'+aParams.options.urlSiteIndexEducation+'" title="'+aParams.options.titreLien+'" target="_blank">';H+=aParams.options.texteLien;H+='</a>';H+='</footer>';H+='</div>';return H;};},fn:"mobile/script/html/interfaceconnexion.html.js"});;
IE.fModule({f:function(exports,require,module,global){const _InterfaceConnexion=require('_InterfaceConnexion.js');const GTraductions=require('ObjetTraduction.js');const EGenreOnglet=require('Enumere_Onglet.js');const GImageConnexion=require('ObjetImageConnexion.js');const GChaine=require('GChaine.js');const UtilitaireChangementLangue=require('UtilitaireChangementLangue.js');const EGenreEspace=require('Enumere_Espace.js');const FenetreModale_Patience=require('FenetreModale_Patience.js');const GHtml=require('GHtml.js');const GCryptage=require('ObjetCryptage.js');const EGenreCryptage=require('Enumere_Cryptage.js');const InterfaceSecurisationCompteCP=require('InterfaceSecurisationCompteCP.js');const Requetes=require('CollectionRequetes.js');const TypeCommandeSecurisationCompteHttp=require('TypeSecurisationCompte.js').TypeCommandeSecurisationCompteHttp;const ObjetRequeteSecurisationCompteDoubleAuth=require('ObjetRequeteSecurisationCompte.js').ObjetRequeteSecurisationCompteDoubleAuth;const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const ObjetFenetre=require('ObjetFenetre.js');const ObjetFenetre_MentionsLegales=require('ObjetFenetre_MentionsLegales.js');const ObjetRequeteMentionsLegales=require('ObjetRequeteMentionsLegales.js');require('ObjetRequeteIdentification.js');require('ObjetRequeteAuthentificationPN.js');const IELocalStorage=require('LocalStorage.js');Requetes.inscrire('ParametresUtilisateur',ObjetRequeteConsultation);const lCookieLocalStorage="etatAffichageCookiesInfo";class InterfaceConnexion_Mobile extends _InterfaceConnexion{constructor(...aParams){super(...aParams);let lCleIdentifiantTitre;let lCleMdpTitre;let lCleMdpMessage;if(GApplication.getDemo()){lCleIdentifiantTitre='connexion.identifiantTitreDemo';lCleMdpTitre='connexion.motDePasseTitreDemo';lCleMdpMessage='connexion.motDePasseMessageDemo';} else{lCleIdentifiantTitre='connexion.identifiantTitre';lCleMdpTitre='connexion.motDePasseTitre';lCleMdpMessage='connexion.motDePasseMessage';}
this.setOptions({genreImageConnexion:GParametres.genreImageConnexion,urlImageConnexion:GParametres.urlImageConnexion,avecChoixConnexion:GParametres.avecChoixConnexion,stockageMDPActive:true,avecRecupIdMdp:GParametres.avecRecuperationInfosConnexion,texteExplicatifIdentifiant:'<strong>'+GTraductions.getValeur(lCleIdentifiantTitre)+'</strong><br />'+GTraductions.getValeur('connexion.identifiantMessage'),texteExplicatifMotdepasse:'<strong>'+GTraductions.getValeur(lCleMdpTitre,[GParametres.GetNomEspace()])+'</strong><br />'+GTraductions.getValeur(lCleMdpMessage,[GTraductions.getValeur('Onglet.Libelle')[EGenreOnglet.InfosPerso]]),requetes:{identification:'Identification',authentification:'Authentification'},utilitaireChangementLangue:UtilitaireChangementLangue});this.fenetreModalePatience=new FenetreModale_Patience();}
ConstruireInstances(){super.ConstruireInstances();this.identForcerChangementMDP=this.Add(require('ObjetSaisieMotDePasseCP.js'));this.identSecurisationCompte=this.Add(InterfaceSecurisationCompteCP);}
construirePage(){const lFctHtml=require('mobile/script/html/InterfaceConnexion.html.js');const lEstEDT=GApplication.estEDT;const lNomApp=lEstEDT?'EDT':GEtatUtilisateur.pourPrimaire()?'PRONOTE PRIMAIRE':'PRONOTE';const lGenreImageConnexion=this.options.genreImageConnexion;const lObjetImage=GImageConnexion.getObjetImagePronote(lGenreImageConnexion);let lImageEspace='Icone_EspaceInvite';switch(GEtatUtilisateur.GenreEspace){case EGenreEspace.Professeur:lImageEspace='Icone_EspaceEnseignant';break;case EGenreEspace.Eleve:lImageEspace='Icone_EspaceEtudiant';break;case EGenreEspace.Etablissement:lImageEspace='Icone_EspaceSecretariat';break;case EGenreEspace.Parent:lImageEspace='Icone_EspaceParent';break;case EGenreEspace.Entreprise:lImageEspace='Icone_EspaceEntreprise';break;case EGenreEspace.Academie:lImageEspace='Icone_EspaceAcademie';break;case EGenreEspace.Administrateur:lImageEspace='Icone_EspaceAdministratif';break;case EGenreEspace.Accompagnant:lImageEspace='Icone_EspaceAccompagnant';break;case EGenreEspace.Tuteur:lImageEspace='Icone_EspaceTuteur';break;case EGenreEspace.Inscription:lImageEspace='Icone_EspaceInscription';break;case EGenreEspace.PrimProfesseur:lImageEspace='Icone_EspaceEnseignant';break;case EGenreEspace.PrimParent:lImageEspace='Icone_EspaceParent';break;case EGenreEspace.PrimEleve:lImageEspace='Icone_EspaceEtudiant';break;case EGenreEspace.PrimAccompagnant:lImageEspace='Icone_EspaceAccompagnant';break;case EGenreEspace.PrimPeriscolaire:lImageEspace='Icone_EspacePeriscolaire';break;}
this.id.Form=this.Nom+'form';this.id.ChangementMDP=this.Nom+'idChangementMDP';this.id.ContenuChangementMDP=this.GetInstance(this.identForcerChangementMDP).GetNom();this.id.BtnChangementMDP=this.Nom+'idBtnChangementMDP';this.id.BandeauLogin=this.Nom+'idBandeauLogin';this.id.BandeauDoubleAuth=this.Nom+'idBandeauDoubleAuth';this.id.securisationCompte=this.Nom+'idsecurisationCompte';this.id.contenuSecurisationCompte=this.GetInstance(this.identSecurisationCompte).GetNom();let lCleIdentifiant;let lCleMotDePasse;if(GApplication.getDemo()){lCleIdentifiant='connexion.identifiantInfoDemo';lCleMotDePasse='connexion.motDePasseInfoDemo';} else{lCleIdentifiant='connexion.identifiantInfo';lCleMotDePasse='connexion.motDePasseInfo';}
const lParamHtml={};lParamHtml.id=this.id;lParamHtml.traductions={texteBouton:GTraductions.getValeur('connexion.seConnecter'),titreBouton:GChaine.toTitle(GTraductions.getValeur('connexion.seConnecterTitre')),texteModeConnexion:this.options.avecChoixConnexion?GTraductions.getValeur('connexion.modeConnexion'):'',texteIdentifiant:GTraductions.getValeur('connexion.identifiant'),texteTitreIdentifiant:GChaine.toTitle(GTraductions.getValeur(lCleIdentifiant)),texteTitreMotdepasse:GChaine.toTitle(GTraductions.getValeur(lCleMotDePasse)),texteMotdepasse:GTraductions.getValeur('connexion.motDePasse'),texteRecupIdMdp:this.options.avecRecupIdMdp?GTraductions.getValeur('connexion.RecuperationMDP.texte'):'',modeConnexion1:GTraductions.getValeur('connexion.modeConnexion1'),modeConnexion2:GTraductions.getValeur('connexion.modeConnexion2'),mentionsLegales:GTraductions.getValeur('mentionsLegales'),cookiesMessage1:GTraductions.getValeur('PiedPage.CookieInfo_Message_1'),cookiesMessage2:GTraductions.getValeur('PiedPage.CookieInfo_Message_2'),fermer:GTraductions.getValeur('Fermer'),louvre:{lien:GTraductions.getValeur('Louvre.Lien',['<b><em>'+lObjetImage.nomExpo+'</em></b>'])},WAI:{raccourciAccessible:GTraductions.getValeur('WAI.raccourciAccessible'),info:IE.optionsEspaceLocal&&IE.optionsEspaceLocal.getModeAccessible(GEtatUtilisateur.GenreEspace)?GTraductions.getValeur('WAI.modeAccessibleActive'):GTraductions.getValeur('WAI.modeAccessibleDesactive')},seSouvenirLabel:GTraductions.getValeur('connexion.SeSouvenir'),seSouvenirOui:GTraductions.getValeur('principal.oui'),seSouvenirNon:GTraductions.getValeur('principal.non'),seSouvenirInfo:GTraductions.getValeur('connexion.SeSouvenirInfo'),redirigeMobile:GTraductions.getValeur('mobile.redirigeVersionMobile'),retourEspace:GTraductions.getValeur('mobile.accederVersionClassique'),valider:GTraductions.getValeur('Valider')};lParamHtml.options={logoDepartementImage:GParametres.logoDepartementImage,titreEtablissement:GChaine.AvecEspaceSiVide(GParametres.NomEtablissementConnexion),sousTitre:GTraductions.getValeur('AnneeScolaire')+' '+GParametres.anneeScolaire,urlLien:GParametres.urlSiteIndexEducation,titreLien:GParametres.version,nomApplication:lNomApp,texteLien:lNomApp+' &copy; '+GParametres.millesime,classApplication:'mobile-'+lNomApp.toLowerCase(),classLogoName:'logo_'+lNomApp.toLowerCase(),classImageEspace:lImageEspace,genreFondImage:lGenreImageConnexion,classFondImage:lObjetImage.classeImage,srcFondImage:lObjetImage.srcImage,urlImageSuite:lObjetImage.urlImageSuite,widthImageSuite:lObjetImage.widthImageSuite,heightImageSuite:lObjetImage.heightImageSuite,urlImageFond:lObjetImage.urlImageFond||this.options.urlImageConnexion,couleurFondBg:lObjetImage.couleurFond||'white',couleurConnexion:lObjetImage.couleurConnexion,lien:lObjetImage.lien,suiviLogo1:lObjetImage.suiviLogo1,suiviLogo2:lObjetImage.suiviLogo2,nomEspace:GParametres.GetNomEspace(),modeDemo:GApplication.getDemo(),avecRecupIdMdp:this.options.avecRecupIdMdp,infoWAIident:GTraductions.getValeur('connexion.identifiant'),publierMentions:GParametres.publierMentions,urlLogo:GParametres.urlLogo,urlSiteIndexEducation:GParametres.urlSiteIndexEducation||'',modeConnexion1:0,modeConnexion2:1,mentionsPagesPubliques:GParametres.mentionsPagesPubliques,afficherCookieInfo:!GApplication.getDemo()?this.AfficherCookieInfo():false};const lHtml=[];lHtml.push(this.fenetreModalePatience.composerConteneur());lHtml.push(lFctHtml(lParamHtml));return lHtml.join('');}
ActionSurMentionsLegales(aParams){let lFenetreMentionsLegales=ObjetFenetre.creerInstance(ObjetFenetre_MentionsLegales,{pere:this,initialiser:function(){}});lFenetreMentionsLegales.setOptionsFenetre({titre:GTraductions.getValeur('PiedPage.mentionsLegales')});lFenetreMentionsLegales.SetDonnees(aParams);}
getControleur(aInstance){return $.extend(true,super.getControleur(this),{boutonChangementMDP:{event:function(){aInstance.GetInstance(aInstance.identForcerChangementMDP).valider();},getDisabled:function(){return!aInstance.GetInstance(aInstance.identForcerChangementMDP).avecValidationPossible();}},btnFermer:function(){$(this.node).eventValidation(function(){let lGenreEspace=global.GEtatUtilisateur!==undefined?'_'+GEtatUtilisateur.GenreEspace:'';IELocalStorage.setItem(lCookieLocalStorage+lGenreEspace,false);$(this).parent().hide();});},ouvrirMentionsLegales:function(){$(this.node).eventValidation(function(){let lRequete=new ObjetRequeteMentionsLegales(aInstance,aInstance.ActionSurMentionsLegales);lRequete.lancerRequete();});},getNodeLogoDepartement:function(){$(this.node).on({click:function(){if(GParametres.logoDepartementLien){window.open(GParametres.logoDepartementLien);}},error:function(){$(this).parent().remove();}});}});}
callbackInitSecurisationCompte(){if(this.estConnexionSansInterface()){const lJPage=$('#'+this.id.pageConnexionAuto.escapeJQ());const lJParent=lJPage.parent();lJPage.remove();lJParent.IEHtmlAppend(this.construirePage(this),{controleur:this.controleur});}
GHtml.setDisplay(this.id.Form,false);GHtml.setDisplay(this.id.BandeauLogin,false);GHtml.setDisplay(this.id.BandeauDoubleAuth,true);}
callbackPersonnalisationMDP_promise(aParam){GHtml.setDisplay(this.id.ChangementMDP,true);GHtml.setDisplay(this.id.Form,false);GHtml.setDisplay(this.id.BandeauLogin,false);GHtml.setDisplay(this.id.BandeauDoubleAuth,true);return new Promise(function(aResolve){this.GetInstance(this.identForcerChangementMDP).setOptions({pourMobile:true,forcerModificationMdp:true,classRequeteSecurisation:ObjetRequeteSecurisationCompteDoubleAuth,actionRequeteSecurisation:TypeCommandeSecurisationCompteHttp.csch_VerifierMotDePassePersonnalise,donneesReglesMdp:aParam.reglesSaisieMDP,messageExplication:aParam.messageForcerModificationMdp,callbackFocusValidation:function(){GHtml.setFocus(this.id.BtnChangementMDP);}.bind(this),callbackApresValidation:function(aParamsForcer){aResolve({reussite:aParamsForcer&&!aParamsForcer.avecErreur,paramForcerMDP:aParamsForcer});}.bind(this)}).SetDonnees();}.bind(this));}
callbackSecurisationDoubleAuth_promise(aParam){GHtml.setDisplay(this.id.ChangementMDP,false);GHtml.setDisplay(this.id.Form,false);GHtml.setDisplay(this.id.securisationCompte,true);GHtml.setDisplay(this.id.BandeauLogin,false);GHtml.setDisplay(this.id.BandeauDoubleAuth,true);return this.GetInstance(this.identSecurisationCompte).setDonneesPromise(aParam);}
_reussiteAuthentification(aParamsAuthentification){Requetes('ParametresUtilisateur',this).lancerRequete().then(function(aParam){const lParams=Object.assign(aParamsAuthentification,aParam);GApplication.initAuthentification(lParams);GEtatUtilisateur.initAuthentification(lParams);GParametres.initAuthentification(lParams);const lOnglet=_getOngletDemarrage();if(lOnglet!==null){GEtatUtilisateur.setGenreOnglet(lOnglet);}
const lParametres={libelle:GEtatUtilisateur.Identification.ressource.GetLibelle(),listeRessource:GEtatUtilisateur.Identification.ListeRessources};GApplication.afficherEspaceApresAuthentification(lParametres);}.bind(this));}
_echecAuthentification(){const lMessageErreur=this.moteurConnexion.erreur?this.moteurConnexion.erreur.message||'':'';if(this.moteurConnexion.modeValidationAppliMobile){window.loginState={status:1,message:lMessageErreur};} else if(GApplication.estAppliMobile){window.messageData.push({action:'surNonAuth',message:lMessageErreur});}}
passerEnModeValidationAppliMobile(aLogin,aUuid,aJeton,aCode){this.moteurConnexion.modeValidationAppliMobile=true;this.moteurConnexion.uuidAppliMobile=aUuid;this.moteurConnexion.modeValidationAppliMobileJeton=!!aLogin&&!!aUuid&&!!aJeton&&!!aCode;$('#'+this.id.checkSouvenir).closest('div.check-field').hide();$('#'+this.id.btnConnexion).text(GTraductions.getValeur('Valider'));if(this.moteurConnexion.modeValidationAppliMobileJeton){const lLoginDecode=GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:aLogin,cle:GCryptage.getBuffer(aCode),iv:GCryptage.getBuffer('')});const lJetonDecode=GCryptage.decrypter({genreCryptage:EGenreCryptage.AES,chaine:aJeton,cle:GCryptage.getBuffer(aCode),iv:GCryptage.getBuffer('')});setTimeout(this.traiterEvenementValidation.bind(this,lLoginDecode,lJetonDecode,null,aUuid),250);} else if(aLogin){this.moteurConnexion.setLogin(aLogin);$('#'+this.id.identification).focus().blur();}}
AfficherCookieInfo(){let lGenreEspace=global.GEtatUtilisateur!==undefined?'_'+GEtatUtilisateur.GenreEspace:'';IELocalStorage.getItem(lCookieLocalStorage+lGenreEspace)===null?IELocalStorage.setItem(lCookieLocalStorage+lGenreEspace,true):IELocalStorage.getItem(lCookieLocalStorage+lGenreEspace);return IELocalStorage.getItem(lCookieLocalStorage+lGenreEspace)==='true';}}
function _getOngletDemarrage(){if($.isNumeric(GEtatUtilisateur.getGenreOnglet())){return null;}
let lOnglet=null;if(GEtatUtilisateur.avecPageAccueil()&&
GEtatUtilisateur.estOngletAutorise(EGenreOnglet.Accueil)&&((GApplication.parametresUtilisateur.has('demarrerSurPageAccueil')&&GApplication.parametresUtilisateur.get('demarrerSurPageAccueil'))||
lOnglet===null)){lOnglet=EGenreOnglet.Accueil;}
return lOnglet;}
module.exports=InterfaceConnexion_Mobile;},fn:"interfaceconnexion_mobile.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteConsultation}=require('ObjetRequeteJSON.js');const Requetes=require('CollectionRequetes.js');class ObjetRequetePresence extends ObjetRequeteConsultation{constructor(){super(null,function(){},function(){});this.setOptions({sansBlocageInterface:true});}
lancerRequete(){return this.appelAsynchrone();}
actionApresRequete(){}}
Requetes.inscrire('Presence',ObjetRequetePresence);module.exports=ObjetRequetePresence;},fn:"objetrequetepresence.js"});;
IE.fModule({f:function(exports,require,module,global){const GUID=require('GUID.js');const IELocalStorage=require('LocalStorage.js');const GTraductions=require('ObjetTraduction.js');let lTimeout=null,lIframe;class ObjetSmartAppBanner{constructor(aNom){this.Nom=aNom;this.id=GUID.getId();this.os=GNavigateur.isAndroid?'android':GNavigateur.isIphone?'ios':false;this.isOpen=false;this.options={urlApp:'pronote://launch?action="setprofil"&url="'+location.href+'"',delai:1000,delta:500,autoClose:20,daysHidden:30,maxClose:3,maxInst:10,maxAff:12,title:'<div class="Image_Logo_Pronote_AppliMobile">&nbsp;</div>',android:{appId:'com.IndexEducation.Pronote',storeLink:'market://details?id=com.IndexEducation.Pronote',line1:GTraductions.getValeur('mobile.bandeauAndroid1'),line2:GTraductions.getValeur('mobile.bandeauAndroid2')},ios:{appId:'1138223804',storeLink:'itms-apps://itunes.apple.com/app/PRONOTE/id1138223804?mt=8',storeText:GTraductions.getValeur('mobile.storeTextIOS'),line1:GTraductions.getValeur('mobile.bandeauIOS1'),line2:GTraductions.getValeur('mobile.bandeauIOS2')}};this.IELocalStorage='ObjetSmartAppBanner';this.affichages=IELocalStorage.getItemJSON(this.IELocalStorage);if(!this.affichages){this.affichages={nbClose:0,dateClose:false,nbAff:0,nbInst:0};IELocalStorage.setItemJSON(this.IELocalStorage,this.affichages);} else{if(this.affichages.dateClose+(this.options.daysHidden*24*60*60*1000)<new Date().getTime()&&this.affichages.nbAff<this.options.maxAff&&this.affichages.nbInst<this.options.maxInst){this.affichages.nbClose=0;}
IELocalStorage.setItemJSON(this.IELocalStorage,this.affichages);}
this.canBeOpen=!GApplication.getDemo()&&!!this.os&&this.affichages.nbClose<this.options.maxClose&&this.affichages.nbAff<this.options.maxAff&&this.affichages.nbInst<this.options.maxInst;}
show(){if(!this.canBeOpen||this.isOpen){return;}
var lThis=this;this.affichages.nbAff+=1;$('body').append(compose.call(this));$('#'+this.id).delay(600).queue(function(){lThis.isOpen=true;$(this).addClass('smartbanner-show');$(this).dequeue();});}
hide(aEvent){if(!!aEvent){aEvent.stopImmediatePropagation();}
if(!!aEvent){aEvent.preventDefault();}
this.affichages.nbClose+=1;this.affichages.dateClose=new Date().getTime();IELocalStorage.setItemJSON(this.IELocalStorage,this.affichages);this.isOpen=false;$('#'+this.id).removeClass('smartbanner-show').delay(600).queue(function(){$(this).remove();$(this).dequeue();});return false;}
open(){if(!this.os){return;}
this.affichages.nbInst+=1;IELocalStorage.setItemJSON(this.IELocalStorage,this.affichages);var lUri=this.options.urlApp;if(GNavigateur.isIphone){lIframe=window.open(lUri);$(lIframe.document.head).append('<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, width=device-width, user-scalable=no" />');$(lIframe.document.body).append('<a href="'+this.options[this.os].storeLink+'" style="font-size:25px;display:block;text-align:center;padding:15px;font-family:Arial;" onclick="setTimeout(window.close, 1000);">'+this.options[this.os].storeText+'</a>');return true;} else if(GNavigateur.isAndroid){if(!GNavigateur.IsGecko){var matches=lUri.match(/([^:]+):\/\/(.+)$/i);lUri="intent://"+matches[2]+"#Intent;scheme="+matches[1];lUri+=";package="+this.options.android.appId+";end";}
lIframe=document.createElement("iframe");lTimeout=setTimeout(openFallbackAndroid.bind(this,new Date().getTime()),this.options.delai);lIframe.onload=function(){clearTimeout(lTimeout);lIframe.parentNode.removeChild(lIframe);window.location.href=lUri;};lIframe.src=lUri;lIframe.setAttribute("style","display:none;");document.body.appendChild(lIframe);return true;} else if(GNavigateur.isWinMob){lIframe=document.createElement("iframe");lTimeout=setTimeout(function(){if(lIframe){lIframe.parentNode.removeChild(lIframe);}},this.options.delai);lIframe.onload=function(){clearTimeout(lTimeout);lIframe.parentNode.removeChild(lIframe);};lIframe.src=this.options[this.os].storeLink;lIframe.setAttribute("style","display:none;");document.body.appendChild(lIframe);}}}
function compose(){var lHtml=[];lHtml.push('<div id="'+this.id+'" class="smartbanner-container">'+'<div onclick="'+this.Nom+'.open();" class="smartbanner">'+'<span class="smartbanner-icon"></span>'+'<div class="smartbanner-info">'+'<div class="smartbanner-title">'+this.options.title+'</div>'+'<div>'+this.options[this.os].line1+'</div>'+'<span>'+this.options[this.os].line2+'</span>'+'</div>'+'</div>'+'<div onclick="'+this.Nom+'.hide(event);" class="smartbanner-close">&times;</div>'+'</div>');return lHtml.join('');}
function openFallbackAndroid(aTimeStamp){clearTimeout(lTimeout);if((new Date().getTime()-aTimeStamp)<(this.options.delai+this.options.delta)){window.location.href=this.options[this.os].storeLink;}
if(lIframe){lIframe.parentNode.removeChild(lIframe);}}
module.exports=ObjetSmartAppBanner;},fn:"objetsmartappbanner.js"});;
IE.fModule({f:function(exports,require,module,global){const GHtml=require('GHtml.js');const GTraductions=require('ObjetTraduction.js');class UtilitaireFinSession_Mobile{_construireEnTetePageFinSession(aParam){const lHtml=[];lHtml.push('<nav class="nav-login">','<div class="nav-wrapper design-2021">','<div class="header-gauche">','<div class="masque-vide"></div>','</div>','<div class="header-droit">','<div class="infos-container" tabIndex="0" role="heading">','<h1>',aParam.nomEspace,'</h1>','<h2>',aParam.nomEtablissement,'</h2>','</div>','</div>','</div>','</nav>');return lHtml.join('');}
_construirePageFinSession(aParametres){if(this._unloadEnCours){return;}
if(this.estAppliMobile){window.messageData.push({action:'finSession',data:aParametres});}
const lCouleur={texte:'black',fond:'white',bordure:'black'};const lParametresFin={jsonErreur:null,statut:'',couleur:lCouleur,sansBoutonSeConnecter:false};$.extend(lParametresFin,aParametres);let lTitre=null;let lMessage=null;let lGenreErreur;if(lParametresFin.jsonErreur){lGenreErreur=lParametresFin.jsonErreur.G;lTitre=lParametresFin.jsonErreur.Titre;lMessage=lParametresFin.jsonErreur.Message;}
lTitre=lTitre===null||lTitre===undefined?GTraductions.getValeur('connexion.PageIndisponible'):lTitre;lMessage=lMessage===null||lMessage===undefined?GTraductions.getValeur('connexion.AffichagePageImpossible'):lMessage;const T=[];try{T.push(this.construireEnTetePageFinSession(lParametresFin));} catch(e){}
T.push('<main class="deconnexion">','<div class="title-content">');T.push((GApplication.estEDT?'<h3 class="logo_edt"><span>EDT</span></h3>':GApplication.estPrimaire?'<h3 class="logo_pronote primaire"><span>Pronote primaire</span></h3>':'<h3 class="logo_pronote"><span>Pronote</span></h3>'));T.push('<h4>'+GTraductions.getValeur('connexion.Deconnecter')+'</h4>',(lTitre?'<p class="pageDeconnexion_titre">'+lTitre+(lParametresFin.statut?' ('+GTraductions.getValeur('connexion.Erreur')+' '+lParametresFin.statut+')':'')+'</p>':''),(lMessage?'<p>'+lMessage+'</p>':''),'</div>',(lGenreErreur!==7&&!lParametresFin.sansBoutonSeConnecter?'<ie-bouton class="themeBoutonPrimaire" onkeyup="if (GNavigateur.IsToucheSelection()) window.location.reload()" onclick="window.location.reload ()">'+GTraductions.getValeur('connexion.SeConnecter')+'</ie-bouton>':''),'</main>');GHtml.setHtml(this.getIdConteneur(),T.join(''));try{$('.modal, .modal-overlay, .sidenav-overlay').remove();} catch(e){require('IELog.js').addLog('Erreur suppression modals');setTimeout(function(){$('.modal, .modal-overlay, .sidenav-overlay').remove();},0);}}}
module.exports=UtilitaireFinSession_Mobile;},fn:"utilitairefinsession_mobile.js"});;
IE.fModule({f:function(exports,require,module,global){const TypeGenreTokenPush={GTP_TokenAndroid:0,GTP_TokenIos:1,GTP_TokenWeb:2,GTP_TokenHuawei:3};module.exports.TypeGenreTokenPush=TypeGenreTokenPush;},fn:"typegenretokenpush.js"});;
IE.fModule({f:function(exports,require,module,global){const{ObjetRequeteSaisie}=require('ObjetRequeteJSON.js');const Requetes=require('CollectionRequetes.js');const TypeGenreTokenPush=require('TypeGenreTokenPush.js').TypeGenreTokenPush;class ObjetRequeteSaisieTokenPush extends ObjetRequeteSaisie{constructor(...aParams){super(...aParams);}
lancerRequete(aParam){const lMapGenreToken={'android':TypeGenreTokenPush.GTP_TokenAndroid,'ios':TypeGenreTokenPush.GTP_TokenIos,'web':TypeGenreTokenPush.GTP_TokenWeb,'androidhms':TypeGenreTokenPush.GTP_TokenHuawei};this.JSON={token:aParam.token,genreToken:lMapGenreToken[aParam.platform.toLowerCase()],uuid:aParam.uuid,suppr:aParam.suppr};return this.appelAsynchrone();}
actionApresRequete(){this.callbackReussite.appel(this.JSONReponse);}}
Requetes.inscrire('SaisieTokenPush',ObjetRequeteSaisieTokenPush);module.exports=ObjetRequeteSaisieTokenPush;},fn:"objetrequetesaisietokenpush.js"});;
IE.fModule({f:function(exports,require,module,global){require('namespaceIE.js');require('DeclarationJQuery.js');require('DeclarationJQueryUI.js');require('DeclarationMaterialize.js');require('DeclarationGeogebra.js');require('DeclarationCurseurPN.js');require('DeclarationindexFont.js');require('produit/css/general/Alignements.css');require('produit/css/general/Couleurs.css');require('produit/css/general/Divers.css');require('produit/css/general/Espace.css');require('produit/css/general/Styles.css');require('Produit/css/SurFocus.css');require('Produit/css/ImagesQCM.css');require('Mobile/Css/communMobile.css');require('Mobile/Css/ThemeMobile.css');require('mobile/css/pn-theme.css');require('mobile/css/SmartAppBanner.css');require('ObjetNavigateur_Mobile.js');const ObjetApplicationSco=require('ObjetApplicationSco.js');require('jIECheckbox.js');require('Parametres.js');const ObjetEtatUtilisateur_Mobile=require('ObjetEtatUtilisateur_Mobile.js');const InterfaceConnexion_Mobile=require('InterfaceConnexion_Mobile.js');require('ObjetRequetePresence.js');const ObjetSmartAppBanner=require('ObjetSmartAppBanner.js');const deferLoadingScript=require('deferLoadingScript.js');const _ObjetCommunication=require('_ObjetCommunication.js');const UtilitaireFinSession_Mobile=require('UtilitaireFinSession_Mobile.js');const EGenreEspace=require('Enumere_Espace.js');global.GInterface=null;class ObjetApplicationScoMobile extends ObjetApplicationSco{constructor(){super();this.estAppliMobile=false;this.infoAppliMobile={};this.utilitaireFinSession=new UtilitaireFinSession_Mobile();}
static beforeCreateApp_promise(aNomApp){if(navigator.userAgent.search(aNomApp)> -1){return new Promise(function(aResolve){setTimeout(function(){aResolve();},100);});}
return Promise.resolve();}
initialisation(aParametres){GEtatUtilisateur=new ObjetEtatUtilisateur_Mobile(aParametres.genreEspace);GEtatUtilisateur.premierChargement=true;this.setCommunication(new _ObjetCommunication(aParametres.genreEspace,aParametres.numeroSession));}
initialisationApresParametres(aParametres){super.initialisationApresParametres(aParametres);$('head').append('<meta name="theme-color" content="#21874a">');$('head').append('<meta name="msapplication-navbutton-color" content="#21874a">');$('head').append('<meta name="apple-mobile-web-app-status-bar-style" content="#21874a">');if(global.GCouleur){GCouleur.baseMobile='#21874a';}
if(!this.estAppliMobile){this.smartAppBanner=new ObjetSmartAppBanner('GApplication.smartAppBanner');}
GInterface=new InterfaceConnexion_Mobile('GInterface',null,null,null);GInterface.Initialiser();if(this.acces.estConnexionCAS()||this.acces.estConnexionCookie()){GInterface.traiterEvenementValidation(this.acces.utilisateur.identifiant,this.acces.utilisateur.password,true);} else if((!GApplication.getDemo())&&(GEtatUtilisateur.GenreEspace!==EGenreEspace.Commun)&&
IE.optionsDebug&&
IE.optionsDebug.identificationAuto&&
IE.optionsDebug.getLogin()&&
IE.optionsDebug.getMdp()){GInterface.traiterEvenementValidation(IE.optionsDebug.getLogin(),IE.optionsDebug.getMdp());}
deferLoadingScript.load(['defer'],{done:_finLoadingScript.bind(this),eventIO:false});}
afficherEspaceApresAuthentification(aParametres){if(this._scriptsCharges){_afficherEspaceApresAuthentification.call(this,aParametres);} else{this._authentification=aParametres;if(!deferLoadingScript.afficherPatience()){_afficherEspaceApresAuthentification.call(this,aParametres);}}}
getConstructeursDebug(){const ObjetFenetre_Debug=require('ObjetFenetre_Debug.js');const ObjetTraitementMobile_Debug=require('ObjetTraitementMobile_Debug.js');return{constructeurFenetre:ObjetFenetre_Debug,constructeurTraitements:ObjetTraitementMobile_Debug};}
construireEnTetePageFinSession(){return this.utilitaireFinSession._construireEnTetePageFinSession({nomEspace:GParametres.GetNomEspace(),nomEtablissement:GParametres.nomEtablissementConnexion});}
construirePageFinSession(aParametres){this.utilitaireFinSession._construirePageFinSession.call(this,aParametres);}
postToken(aPlatform,aUuid,aToken,aSuppr){const lSuppr=aSuppr||false;const ObjetRequeteTokenPush=require('ObjetRequeteSaisieTokenPush.js');new ObjetRequeteTokenPush(this).lancerRequete({platform:aPlatform,uuid:aUuid,token:aToken,suppr:lSuppr});}
initApp(aParams){GApplication.estAppliMobile=aParams.estAppliMobile;GApplication.infoAppliMobile={avecExitApp:aParams.avecExitApp};if(GApplication.smartAppBanner){$('#'+GApplication.smartAppBanner.id.escapeJQ()).remove();}
GInterface.traiterEvenementValidation(aParams.login,aParams.mdp,null,aParams.uuid);}}
function _afficherEspaceApresAuthentification(aParametres){try{if(GInterface&&GInterface.free){GInterface.free();}
const ObjetInterfaceMobile=require('InterfaceMobile.js');GInterface=new ObjetInterfaceMobile('GInterface',null,null,null);GInterface.Initialiser();GInterface.SetDonnees(aParametres.libelle,aParametres.listeRessource);this.getCommunication().activerPresence();if(this.avecGestionModeExclusif()){if(this.getModeExclusif()){this.entreeModeExclusif();}}
if(!this.estAppliMobile&&(this.acces.estConnexionCAS()||this.acces.estConnexionCookie())&&this.smartAppBanner){this.smartAppBanner.show();}} catch(e){if(window.messageErreur){window.messageErreur('apresAuthentification/'+e);}
require('UtilitaireDeconnexion.js').deconnexionEchecChargement();}}
function _finLoadingScript(){this._scriptsCharges=true;if(this._authentification){_afficherEspaceApresAuthentification.call(this,this._authentification);}
if(window._finLoadingScriptAppliMobile){if(!window.GTraductions){window.GTraductions=require('ObjetTraduction.js');}
window._finLoadingScriptAppliMobile();}}
module.exports=ObjetApplicationScoMobile;},fn:"objetapplicationscomobile.js"});;
IE.fModule({f:function(exports,require,module,global){require('images/css/Image.css')
;},fn:"declarationimagecp.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationImageCP.js');require('images/css/ImageEspacesCP.css')
;},fn:"declarationimageespacescp.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationImageEspacesCP.js');require('produit/css/ImageSco.css')
;},fn:"declarationimagesco.js"});;
IE.fModule({f:function(exports,require,module,global){;},fn:"declarationimageconnexionpn.js"});;
IE.fModule({f:function(exports,require,module,global){;},fn:"declarationimagefaviconpn.js"});;
IE.fModule({f:function(exports,require,module,global){require('espace/css/LogoPN.css')
;},fn:"declarationimagelogopn.js"});;
IE.fModule({f:function(exports,require,module,global){require('DeclarationImageSco.js');require('produit/css/ImagePN.css');require('DeclarationImageConnexionPN.js');require('DeclarationImageFaviconPN.js');require('DeclarationImageLogoPN.js')
;},fn:"declarationimagepn.js"});;
IE.fModule({f:function(exports,require,module,global){const ObjetApplicationScoMobile=require('ObjetApplicationScoMobile.js');require('DeclarationImagePN.js');global.Start=function(aParam){ObjetApplicationScoMobile.beforeCreateApp_promise('PRONOTE Mobile APP').then(function(){GApplication=new ObjetApplicationPNMobile();GApplication.lancer(aParam);});};class ObjetApplicationPNMobile extends ObjetApplicationScoMobile{constructor(){super();}}
module.exports=ObjetApplicationPNMobile;},fn:"objetapplicationpnmobile.js"});;
